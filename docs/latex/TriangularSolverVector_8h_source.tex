\hypertarget{TriangularSolverVector_8h_source}{}\doxysection{Triangular\+Solver\+Vector.\+h}
\label{TriangularSolverVector_8h_source}\index{include/Eigen/src/Core/products/TriangularSolverVector.h@{include/Eigen/src/Core/products/TriangularSolverVector.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}}
\DoxyCodeLine{2 \textcolor{comment}{// for linear algebra.}}
\DoxyCodeLine{3 \textcolor{comment}{//}}
\DoxyCodeLine{4 \textcolor{comment}{// Copyright (C) 2008-\/2010 Gael Guennebaud <gael.guennebaud@inria.fr>}}
\DoxyCodeLine{5 \textcolor{comment}{//}}
\DoxyCodeLine{6 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}}
\DoxyCodeLine{7 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}}
\DoxyCodeLine{8 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{preprocessor}{\#ifndef EIGEN\_TRIANGULAR\_SOLVER\_VECTOR\_H}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#define EIGEN\_TRIANGULAR\_SOLVER\_VECTOR\_H}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include "{}../InternalHeaderCheck.h"{}}}
\DoxyCodeLine{14 }
\DoxyCodeLine{15 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceEigen}{Eigen}} \{}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{keyword}{namespace }internal \{}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsScalar, \textcolor{keyword}{typename} RhsScalar, \textcolor{keyword}{typename} Index, \textcolor{keywordtype}{int} Mode, \textcolor{keywordtype}{bool} Conjugate, \textcolor{keywordtype}{int} StorageOrder>}
\DoxyCodeLine{20 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1triangular__solve__vector}{triangular\_solve\_vector}}<LhsScalar, RhsScalar, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}, \mbox{\hyperlink{group__enums_ggac22de43beeac7a78b384f99bed5cee0ba329fc3a54ceb2b6e0e73b400998b8a82}{OnTheRight}}, Mode, \mbox{\hyperlink{classEigen_1_1Conjugate}{Conjugate}}, StorageOrder>}
\DoxyCodeLine{21 \{}
\DoxyCodeLine{22   \textcolor{keyword}{static} \textcolor{keywordtype}{void} run(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} size, \textcolor{keyword}{const} LhsScalar* \_lhs, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} lhsStride, RhsScalar* rhs)}
\DoxyCodeLine{23   \{}
\DoxyCodeLine{24     \mbox{\hyperlink{structEigen_1_1internal_1_1triangular__solve__vector}{triangular\_solve\_vector}}<LhsScalar,RhsScalar,\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}},\mbox{\hyperlink{group__enums_ggac22de43beeac7a78b384f99bed5cee0ba21b30a61e9cb10c967aec17567804007}{OnTheLeft}},}
\DoxyCodeLine{25         ((Mode\&\mbox{\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdafca2ccebb604f171656deb53e8c083c1}{Upper}})==\mbox{\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdafca2ccebb604f171656deb53e8c083c1}{Upper}} ? \mbox{\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdaf581029282d421eee5aae14238c6f749}{Lower}} : \mbox{\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdafca2ccebb604f171656deb53e8c083c1}{Upper}}) | (Mode\&\mbox{\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda2ef430bff6cc12c2d1e0ef01b95f7ff3}{UnitDiag}}),}
\DoxyCodeLine{26         \mbox{\hyperlink{classEigen_1_1Conjugate}{Conjugate}},StorageOrder==\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a77c993a8d9f6efe5c1159fb2ab07dd4f}{RowMajor}}?\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0103672ae41005ab03b4176c765afd62}{ColMajor}}:\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a77c993a8d9f6efe5c1159fb2ab07dd4f}{RowMajor}}}
\DoxyCodeLine{27       >::run(size, \_lhs, lhsStride, rhs);}
\DoxyCodeLine{28   \}}
\DoxyCodeLine{29 \};}
\DoxyCodeLine{30 }
\DoxyCodeLine{31 \textcolor{comment}{// forward and backward substitution, row-\/major, rhs is a vector}}
\DoxyCodeLine{32 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsScalar, \textcolor{keyword}{typename} RhsScalar, \textcolor{keyword}{typename} Index, \textcolor{keywordtype}{int} Mode, \textcolor{keywordtype}{bool} Conjugate>}
\DoxyCodeLine{33 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1triangular__solve__vector}{triangular\_solve\_vector}}<LhsScalar, RhsScalar, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}, \mbox{\hyperlink{group__enums_ggac22de43beeac7a78b384f99bed5cee0ba21b30a61e9cb10c967aec17567804007}{OnTheLeft}}, Mode, \mbox{\hyperlink{classEigen_1_1Conjugate}{Conjugate}}, \mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a77c993a8d9f6efe5c1159fb2ab07dd4f}{RowMajor}}>}
\DoxyCodeLine{34 \{}
\DoxyCodeLine{35   \textcolor{keyword}{enum} \{}
\DoxyCodeLine{36     IsLower = ((Mode\&\mbox{\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdaf581029282d421eee5aae14238c6f749}{Lower}})==\mbox{\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdaf581029282d421eee5aae14238c6f749}{Lower}})}
\DoxyCodeLine{37   \};}
\DoxyCodeLine{38   \textcolor{keyword}{static} \textcolor{keywordtype}{void} run(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} size, \textcolor{keyword}{const} LhsScalar* \_lhs, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} lhsStride, RhsScalar* rhs)}
\DoxyCodeLine{39   \{}
\DoxyCodeLine{40     \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1Map}{Map<const Matrix<LhsScalar,Dynamic,Dynamic,RowMajor>}}, 0, \mbox{\hyperlink{classEigen_1_1OuterStride}{OuterStride<>}} > LhsMap;}
\DoxyCodeLine{41     \textcolor{keyword}{const} LhsMap lhs(\_lhs,size,size,\mbox{\hyperlink{classEigen_1_1OuterStride}{OuterStride<>}}(lhsStride));}
\DoxyCodeLine{42 }
\DoxyCodeLine{43     \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1internal_1_1const__blas__data__mapper}{const\_blas\_data\_mapper<LhsScalar,Index,RowMajor>}} LhsMapper;}
\DoxyCodeLine{44     \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1internal_1_1const__blas__data__mapper}{const\_blas\_data\_mapper<RhsScalar,Index,ColMajor>}} RhsMapper;}
\DoxyCodeLine{45 }
\DoxyCodeLine{46     \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1conditional}{internal::conditional}}<}
\DoxyCodeLine{47                           \mbox{\hyperlink{classEigen_1_1Conjugate}{Conjugate}},}
\DoxyCodeLine{48                           \textcolor{keyword}{const} \mbox{\hyperlink{classEigen_1_1CwiseUnaryOp}{CwiseUnaryOp<typename internal::scalar\_conjugate\_op<LhsScalar>}},LhsMap>,}
\DoxyCodeLine{49                           \textcolor{keyword}{const} LhsMap\&>}
\DoxyCodeLine{50                         ::type cjLhs(lhs);}
\DoxyCodeLine{51     \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} PanelWidth = EIGEN\_TUNE\_TRIANGULAR\_PANEL\_WIDTH;}
\DoxyCodeLine{52     \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} pi=IsLower ? 0 : size;}
\DoxyCodeLine{53         IsLower ? pi<size : pi>0;}
\DoxyCodeLine{54         IsLower ? pi+=PanelWidth : pi-\/=PanelWidth)}
\DoxyCodeLine{55     \{}
\DoxyCodeLine{56       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} actualPanelWidth = (std::min)(IsLower ? size -\/ pi : pi, PanelWidth);}
\DoxyCodeLine{57 }
\DoxyCodeLine{58       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} r = IsLower ? pi : size -\/ pi; \textcolor{comment}{// remaining size}}
\DoxyCodeLine{59       \textcolor{keywordflow}{if} (r > 0)}
\DoxyCodeLine{60       \{}
\DoxyCodeLine{61         \textcolor{comment}{// let's directly call the low level product function because:}}
\DoxyCodeLine{62         \textcolor{comment}{// 1 -\/ it is faster to compile}}
\DoxyCodeLine{63         \textcolor{comment}{// 2 -\/ it is slightly faster at runtime}}
\DoxyCodeLine{64         \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} startRow = IsLower ? pi : pi-\/actualPanelWidth;}
\DoxyCodeLine{65         \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} startCol = IsLower ? 0 : pi;}
\DoxyCodeLine{66 }
\DoxyCodeLine{67         \mbox{\hyperlink{structEigen_1_1internal_1_1general__matrix__vector__product}{general\_matrix\_vector\_product<Index,LhsScalar,LhsMapper,RowMajor,Conjugate,RhsScalar,RhsMapper,false>::run}}(}
\DoxyCodeLine{68           actualPanelWidth, r,}
\DoxyCodeLine{69           LhsMapper(\&lhs.coeffRef(startRow,startCol), lhsStride),}
\DoxyCodeLine{70           RhsMapper(rhs + startCol, 1),}
\DoxyCodeLine{71           rhs + startRow, 1,}
\DoxyCodeLine{72           RhsScalar(-\/1));}
\DoxyCodeLine{73       \}}
\DoxyCodeLine{74 }
\DoxyCodeLine{75       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0; k<actualPanelWidth; ++k)}
\DoxyCodeLine{76       \{}
\DoxyCodeLine{77         \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} i = IsLower ? pi+k : pi-\/k-\/1;}
\DoxyCodeLine{78         \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} s = IsLower ? pi   : i+1;}
\DoxyCodeLine{79         \textcolor{keywordflow}{if} (k>0)}
\DoxyCodeLine{80           rhs[i] -\/= (cjLhs.row(i).segment(s,k).transpose().cwiseProduct(\mbox{\hyperlink{classEigen_1_1Map}{Map}}<\textcolor{keyword}{const} \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix<RhsScalar,Dynamic,1>}} >(rhs+s,k))).sum();}
\DoxyCodeLine{81 }
\DoxyCodeLine{82         \textcolor{keywordflow}{if}((!(Mode \& \mbox{\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda2ef430bff6cc12c2d1e0ef01b95f7ff3}{UnitDiag}})) \&\& numext::not\_equal\_strict(rhs[i],RhsScalar(0)))}
\DoxyCodeLine{83           rhs[i] /= cjLhs(i,i);}
\DoxyCodeLine{84       \}}
\DoxyCodeLine{85     \}}
\DoxyCodeLine{86   \}}
\DoxyCodeLine{87 \};}
\DoxyCodeLine{88 }
\DoxyCodeLine{89 \textcolor{comment}{// forward and backward substitution, column-\/major, rhs is a vector}}
\DoxyCodeLine{90 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsScalar, \textcolor{keyword}{typename} RhsScalar, \textcolor{keyword}{typename} Index, \textcolor{keywordtype}{int} Mode, \textcolor{keywordtype}{bool} Conjugate>}
\DoxyCodeLine{91 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1triangular__solve__vector}{triangular\_solve\_vector}}<LhsScalar, RhsScalar, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}, \mbox{\hyperlink{group__enums_ggac22de43beeac7a78b384f99bed5cee0ba21b30a61e9cb10c967aec17567804007}{OnTheLeft}}, Mode, \mbox{\hyperlink{classEigen_1_1Conjugate}{Conjugate}}, \mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0103672ae41005ab03b4176c765afd62}{ColMajor}}>}
\DoxyCodeLine{92 \{}
\DoxyCodeLine{93   \textcolor{keyword}{enum} \{}
\DoxyCodeLine{94     IsLower = ((Mode\&\mbox{\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdaf581029282d421eee5aae14238c6f749}{Lower}})==\mbox{\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdaf581029282d421eee5aae14238c6f749}{Lower}})}
\DoxyCodeLine{95   \};}
\DoxyCodeLine{96   \textcolor{keyword}{static} \textcolor{keywordtype}{void} run(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} size, \textcolor{keyword}{const} LhsScalar* \_lhs, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} lhsStride, RhsScalar* rhs)}
\DoxyCodeLine{97   \{}
\DoxyCodeLine{98     \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1Map}{Map<const Matrix<LhsScalar,Dynamic,Dynamic,ColMajor>}}, 0, \mbox{\hyperlink{classEigen_1_1OuterStride}{OuterStride<>}} > LhsMap;}
\DoxyCodeLine{99     \textcolor{keyword}{const} LhsMap lhs(\_lhs,size,size,\mbox{\hyperlink{classEigen_1_1OuterStride}{OuterStride<>}}(lhsStride));}
\DoxyCodeLine{100     \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1internal_1_1const__blas__data__mapper}{const\_blas\_data\_mapper<LhsScalar,Index,ColMajor>}} LhsMapper;}
\DoxyCodeLine{101     \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1internal_1_1const__blas__data__mapper}{const\_blas\_data\_mapper<RhsScalar,Index,ColMajor>}} RhsMapper;}
\DoxyCodeLine{102     \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1conditional}{internal::conditional}}<\mbox{\hyperlink{classEigen_1_1Conjugate}{Conjugate}},}
\DoxyCodeLine{103                                    \textcolor{keyword}{const} \mbox{\hyperlink{classEigen_1_1CwiseUnaryOp}{CwiseUnaryOp<typename internal::scalar\_conjugate\_op<LhsScalar>}},LhsMap>,}
\DoxyCodeLine{104                                    \textcolor{keyword}{const} LhsMap\&}
\DoxyCodeLine{105                                   >::type cjLhs(lhs);}
\DoxyCodeLine{106     \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} PanelWidth = EIGEN\_TUNE\_TRIANGULAR\_PANEL\_WIDTH;}
\DoxyCodeLine{107 }
\DoxyCodeLine{108     \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} pi=IsLower ? 0 : size;}
\DoxyCodeLine{109         IsLower ? pi<size : pi>0;}
\DoxyCodeLine{110         IsLower ? pi+=PanelWidth : pi-\/=PanelWidth)}
\DoxyCodeLine{111     \{}
\DoxyCodeLine{112       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} actualPanelWidth = (std::min)(IsLower ? size -\/ pi : pi, PanelWidth);}
\DoxyCodeLine{113       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} startBlock = IsLower ? pi : pi-\/actualPanelWidth;}
\DoxyCodeLine{114       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} endBlock = IsLower ? pi + actualPanelWidth : 0;}
\DoxyCodeLine{115 }
\DoxyCodeLine{116       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0; k<actualPanelWidth; ++k)}
\DoxyCodeLine{117       \{}
\DoxyCodeLine{118         \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} i = IsLower ? pi+k : pi-\/k-\/1;}
\DoxyCodeLine{119         \textcolor{keywordflow}{if}(numext::not\_equal\_strict(rhs[i],RhsScalar(0)))}
\DoxyCodeLine{120         \{}
\DoxyCodeLine{121           \textcolor{keywordflow}{if}(!(Mode \& \mbox{\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda2ef430bff6cc12c2d1e0ef01b95f7ff3}{UnitDiag}}))}
\DoxyCodeLine{122             rhs[i] /= cjLhs.coeff(i,i);}
\DoxyCodeLine{123 }
\DoxyCodeLine{124           \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} r = actualPanelWidth -\/ k -\/ 1; \textcolor{comment}{// remaining size}}
\DoxyCodeLine{125           \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} s = IsLower ? i+1 : i-\/r;}
\DoxyCodeLine{126           \textcolor{keywordflow}{if} (r>0)}
\DoxyCodeLine{127             \mbox{\hyperlink{classEigen_1_1Map}{Map<Matrix<RhsScalar,Dynamic,1>}} >(rhs+s,r) -\/= rhs[i] * cjLhs.col(i).segment(s,r);}
\DoxyCodeLine{128         \}}
\DoxyCodeLine{129       \}}
\DoxyCodeLine{130       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} r = IsLower ? size -\/ endBlock : startBlock; \textcolor{comment}{// remaining size}}
\DoxyCodeLine{131       \textcolor{keywordflow}{if} (r > 0)}
\DoxyCodeLine{132       \{}
\DoxyCodeLine{133         \textcolor{comment}{// let's directly call the low level product function because:}}
\DoxyCodeLine{134         \textcolor{comment}{// 1 -\/ it is faster to compile}}
\DoxyCodeLine{135         \textcolor{comment}{// 2 -\/ it is slightly faster at runtime}}
\DoxyCodeLine{136         \mbox{\hyperlink{structEigen_1_1internal_1_1general__matrix__vector__product}{general\_matrix\_vector\_product<Index,LhsScalar,LhsMapper,ColMajor,Conjugate,RhsScalar,RhsMapper,false>::run}}(}
\DoxyCodeLine{137             r, actualPanelWidth,}
\DoxyCodeLine{138             LhsMapper(\&lhs.coeffRef(endBlock,startBlock), lhsStride),}
\DoxyCodeLine{139             RhsMapper(rhs+startBlock, 1),}
\DoxyCodeLine{140             rhs+endBlock, 1, RhsScalar(-\/1));}
\DoxyCodeLine{141       \}}
\DoxyCodeLine{142     \}}
\DoxyCodeLine{143   \}}
\DoxyCodeLine{144 \};}
\DoxyCodeLine{145 }
\DoxyCodeLine{146 \} \textcolor{comment}{// end namespace internal}}
\DoxyCodeLine{147 }
\DoxyCodeLine{148 \} \textcolor{comment}{// end namespace Eigen}}
\DoxyCodeLine{149 }
\DoxyCodeLine{150 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// EIGEN\_TRIANGULAR\_SOLVER\_VECTOR\_H}}

\end{DoxyCode}
