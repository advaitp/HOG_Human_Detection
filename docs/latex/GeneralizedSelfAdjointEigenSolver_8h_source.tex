\hypertarget{GeneralizedSelfAdjointEigenSolver_8h_source}{}\doxysection{Generalized\+Self\+Adjoint\+Eigen\+Solver.\+h}
\label{GeneralizedSelfAdjointEigenSolver_8h_source}\index{include/Eigen/src/Eigenvalues/GeneralizedSelfAdjointEigenSolver.h@{include/Eigen/src/Eigenvalues/GeneralizedSelfAdjointEigenSolver.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}}
\DoxyCodeLine{2 \textcolor{comment}{// for linear algebra.}}
\DoxyCodeLine{3 \textcolor{comment}{//}}
\DoxyCodeLine{4 \textcolor{comment}{// Copyright (C) 2008-\/2010 Gael Guennebaud <gael.guennebaud@inria.fr>}}
\DoxyCodeLine{5 \textcolor{comment}{// Copyright (C) 2010 Jitse Niesen <jitse@maths.leeds.ac.uk>}}
\DoxyCodeLine{6 \textcolor{comment}{//}}
\DoxyCodeLine{7 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}}
\DoxyCodeLine{8 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}}
\DoxyCodeLine{9 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{preprocessor}{\#ifndef EIGEN\_GENERALIZEDSELFADJOINTEIGENSOLVER\_H}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#define EIGEN\_GENERALIZEDSELFADJOINTEIGENSOLVER\_H}}
\DoxyCodeLine{13 }
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include "{}./Tridiagonalization.h"{}}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include "{}./InternalHeaderCheck.h"{}}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceEigen}{Eigen}} \{ }
\DoxyCodeLine{19 }
\DoxyCodeLine{49 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType\_>}
\DoxyCodeLine{50 \textcolor{keyword}{class }\mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver}{GeneralizedSelfAdjointEigenSolver}} : \textcolor{keyword}{public} \mbox{\hyperlink{classEigen_1_1SelfAdjointEigenSolver}{SelfAdjointEigenSolver}}<MatrixType\_>}
\DoxyCodeLine{51 \{}
\DoxyCodeLine{52     \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1SelfAdjointEigenSolver}{SelfAdjointEigenSolver<MatrixType\_>}} \mbox{\hyperlink{classEigen_1_1SelfAdjointEigenSolver}{Base}};}
\DoxyCodeLine{53   \textcolor{keyword}{public}:}
\DoxyCodeLine{54 }
\DoxyCodeLine{55     \textcolor{keyword}{typedef} MatrixType\_ MatrixType;}
\DoxyCodeLine{56 }
\DoxyCodeLine{64     \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_a192647b027848d25f4a4ac5965aeb8f0}{GeneralizedSelfAdjointEigenSolver}}() : \mbox{\hyperlink{classEigen_1_1SelfAdjointEigenSolver}{Base}}() \{\}}
\DoxyCodeLine{65 }
\DoxyCodeLine{78     \textcolor{keyword}{explicit} \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_a248d3362abd1ddd9b3a7ec858c427d05}{GeneralizedSelfAdjointEigenSolver}}(\mbox{\hyperlink{classEigen_1_1SelfAdjointEigenSolver_a7c52c334cec08ff33425e4b3f5474eb8}{Index}} size)}
\DoxyCodeLine{79         : \mbox{\hyperlink{classEigen_1_1SelfAdjointEigenSolver}{Base}}(size)}
\DoxyCodeLine{80     \{\}}
\DoxyCodeLine{81 }
\DoxyCodeLine{108     \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_ad08a2daa46bf7c329432bee51927982c}{GeneralizedSelfAdjointEigenSolver}}(\textcolor{keyword}{const} MatrixType\& matA, \textcolor{keyword}{const} MatrixType\& matB,}
\DoxyCodeLine{109                                       \textcolor{keywordtype}{int} options = \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}}|\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a5eb11a88a4bd445f58f1b24598d3848f}{Ax\_lBx}})}
\DoxyCodeLine{110       : \mbox{\hyperlink{classEigen_1_1SelfAdjointEigenSolver}{Base}}(matA.cols())}
\DoxyCodeLine{111     \{}
\DoxyCodeLine{112       \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_a724764fe196612b752042692156ed023}{compute}}(matA, matB, options);}
\DoxyCodeLine{113     \}}
\DoxyCodeLine{114 }
\DoxyCodeLine{155     \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver}{GeneralizedSelfAdjointEigenSolver}}\& \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_a724764fe196612b752042692156ed023}{compute}}(\textcolor{keyword}{const} MatrixType\& matA, \textcolor{keyword}{const} MatrixType\& matB,}
\DoxyCodeLine{156                                                \textcolor{keywordtype}{int} options = \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}}|\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a5eb11a88a4bd445f58f1b24598d3848f}{Ax\_lBx}});}
\DoxyCodeLine{157 }
\DoxyCodeLine{158   \textcolor{keyword}{protected}:}
\DoxyCodeLine{159 }
\DoxyCodeLine{160 \};}
\DoxyCodeLine{161 }
\DoxyCodeLine{162 }
\DoxyCodeLine{163 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>}
\DoxyCodeLine{164 \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver}{GeneralizedSelfAdjointEigenSolver<MatrixType>}}\& \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_a724764fe196612b752042692156ed023}{GeneralizedSelfAdjointEigenSolver<MatrixType>::}}}
\DoxyCodeLine{165 \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_a724764fe196612b752042692156ed023}{compute}}(\textcolor{keyword}{const} MatrixType\& matA, \textcolor{keyword}{const} MatrixType\& matB, \textcolor{keywordtype}{int} options)}
\DoxyCodeLine{166 \{}
\DoxyCodeLine{167   eigen\_assert(matA.cols()==matA.rows() \&\& matB.rows()==matA.rows() \&\& matB.cols()==matB.rows());}
\DoxyCodeLine{168   eigen\_assert((options\&\string~(EigVecMask|GenEigMask))==0}
\DoxyCodeLine{169           \&\& (options\&EigVecMask)!=EigVecMask}
\DoxyCodeLine{170           \&\& ((options\&GenEigMask)==0 || (options\&GenEigMask)==\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a5eb11a88a4bd445f58f1b24598d3848f}{Ax\_lBx}}}
\DoxyCodeLine{171            || (options\&GenEigMask)==\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a9a7d9813cec527e299a36b749b0f7e1e}{ABx\_lx}} || (options\&GenEigMask)==\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a9870817d373c41ba0dc7f6b5ab0895b8}{BAx\_lx}})}
\DoxyCodeLine{172           \&\& \textcolor{stringliteral}{"{}invalid option parameter"{}});}
\DoxyCodeLine{173 }
\DoxyCodeLine{174   \textcolor{keywordtype}{bool} computeEigVecs = ((options\&EigVecMask)==0) || ((options\&EigVecMask)==\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}});}
\DoxyCodeLine{175 }
\DoxyCodeLine{176   \textcolor{comment}{// Compute the cholesky decomposition of matB = L L' = U'U}}
\DoxyCodeLine{177   \mbox{\hyperlink{classEigen_1_1LLT}{LLT<MatrixType>}} cholB(matB);}
\DoxyCodeLine{178 }
\DoxyCodeLine{179   \textcolor{keywordtype}{int} type = (options\&GenEigMask);}
\DoxyCodeLine{180   \textcolor{keywordflow}{if}(type==0)}
\DoxyCodeLine{181     type = \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a5eb11a88a4bd445f58f1b24598d3848f}{Ax\_lBx}};}
\DoxyCodeLine{182 }
\DoxyCodeLine{183   \textcolor{keywordflow}{if}(type==\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a5eb11a88a4bd445f58f1b24598d3848f}{Ax\_lBx}})}
\DoxyCodeLine{184   \{}
\DoxyCodeLine{185     \textcolor{comment}{// compute C = inv(L) A inv(L')}}
\DoxyCodeLine{186     MatrixType matC = matA.template selfadjointView<Lower>();}
\DoxyCodeLine{187     cholB.\mbox{\hyperlink{classEigen_1_1LLT_afb5490bbbe504d4d4cdb9ae4a7305fbc}{matrixL}}().template solveInPlace<OnTheLeft>(matC);}
\DoxyCodeLine{188     cholB.\mbox{\hyperlink{classEigen_1_1LLT_ad5d56462f3a9823723814acb0834983d}{matrixU}}().template solveInPlace<OnTheRight>(matC);}
\DoxyCodeLine{189 }
\DoxyCodeLine{190     Base::compute(matC, computeEigVecs ? \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}} : \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9afd06633f270207c373875fd7ca03e906}{EigenvaluesOnly}} );}
\DoxyCodeLine{191 }
\DoxyCodeLine{192     \textcolor{comment}{// transform back the eigen vectors: evecs = inv(U) * evecs}}
\DoxyCodeLine{193     \textcolor{keywordflow}{if}(computeEigVecs)}
\DoxyCodeLine{194       cholB.\mbox{\hyperlink{classEigen_1_1LLT_ad5d56462f3a9823723814acb0834983d}{matrixU}}().solveInPlace(Base::m\_eivec);}
\DoxyCodeLine{195   \}}
\DoxyCodeLine{196   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(type==\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a9a7d9813cec527e299a36b749b0f7e1e}{ABx\_lx}})}
\DoxyCodeLine{197   \{}
\DoxyCodeLine{198     \textcolor{comment}{// compute C = L' A L}}
\DoxyCodeLine{199     MatrixType matC = matA.template selfadjointView<Lower>();}
\DoxyCodeLine{200     matC = matC * cholB.\mbox{\hyperlink{classEigen_1_1LLT_afb5490bbbe504d4d4cdb9ae4a7305fbc}{matrixL}}();}
\DoxyCodeLine{201     matC = cholB.\mbox{\hyperlink{classEigen_1_1LLT_ad5d56462f3a9823723814acb0834983d}{matrixU}}() * matC;}
\DoxyCodeLine{202 }
\DoxyCodeLine{203     Base::compute(matC, computeEigVecs ? \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}} : \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9afd06633f270207c373875fd7ca03e906}{EigenvaluesOnly}});}
\DoxyCodeLine{204 }
\DoxyCodeLine{205     \textcolor{comment}{// transform back the eigen vectors: evecs = inv(U) * evecs}}
\DoxyCodeLine{206     \textcolor{keywordflow}{if}(computeEigVecs)}
\DoxyCodeLine{207       cholB.\mbox{\hyperlink{classEigen_1_1LLT_ad5d56462f3a9823723814acb0834983d}{matrixU}}().solveInPlace(Base::m\_eivec);}
\DoxyCodeLine{208   \}}
\DoxyCodeLine{209   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(type==\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a9870817d373c41ba0dc7f6b5ab0895b8}{BAx\_lx}})}
\DoxyCodeLine{210   \{}
\DoxyCodeLine{211     \textcolor{comment}{// compute C = L' A L}}
\DoxyCodeLine{212     MatrixType matC = matA.template selfadjointView<Lower>();}
\DoxyCodeLine{213     matC = matC * cholB.\mbox{\hyperlink{classEigen_1_1LLT_afb5490bbbe504d4d4cdb9ae4a7305fbc}{matrixL}}();}
\DoxyCodeLine{214     matC = cholB.\mbox{\hyperlink{classEigen_1_1LLT_ad5d56462f3a9823723814acb0834983d}{matrixU}}() * matC;}
\DoxyCodeLine{215 }
\DoxyCodeLine{216     Base::compute(matC, computeEigVecs ? \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}} : \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9afd06633f270207c373875fd7ca03e906}{EigenvaluesOnly}});}
\DoxyCodeLine{217 }
\DoxyCodeLine{218     \textcolor{comment}{// transform back the eigen vectors: evecs = L * evecs}}
\DoxyCodeLine{219     \textcolor{keywordflow}{if}(computeEigVecs)}
\DoxyCodeLine{220       Base::m\_eivec = cholB.\mbox{\hyperlink{classEigen_1_1LLT_afb5490bbbe504d4d4cdb9ae4a7305fbc}{matrixL}}() * Base::m\_eivec;}
\DoxyCodeLine{221   \}}
\DoxyCodeLine{222 }
\DoxyCodeLine{223   \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{224 \}}
\DoxyCodeLine{225 }
\DoxyCodeLine{226 \} \textcolor{comment}{// end namespace Eigen}}
\DoxyCodeLine{227 }
\DoxyCodeLine{228 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// EIGEN\_GENERALIZEDSELFADJOINTEIGENSOLVER\_H}}

\end{DoxyCode}
