\hypertarget{products_2GeneralBlockPanelKernel_8h_source}{}\doxysection{General\+Block\+Panel\+Kernel.\+h}
\label{products_2GeneralBlockPanelKernel_8h_source}\index{include/Eigen/src/Core/products/GeneralBlockPanelKernel.h@{include/Eigen/src/Core/products/GeneralBlockPanelKernel.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}}
\DoxyCodeLine{2 \textcolor{comment}{// for linear algebra.}}
\DoxyCodeLine{3 \textcolor{comment}{//}}
\DoxyCodeLine{4 \textcolor{comment}{// Copyright (C) 2008-\/2009 Gael Guennebaud <gael.guennebaud@inria.fr>}}
\DoxyCodeLine{5 \textcolor{comment}{//}}
\DoxyCodeLine{6 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}}
\DoxyCodeLine{7 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}}
\DoxyCodeLine{8 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{preprocessor}{\#ifndef EIGEN\_GENERAL\_BLOCK\_PANEL\_H}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#define EIGEN\_GENERAL\_BLOCK\_PANEL\_H}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 }
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include "{}../InternalHeaderCheck.h"{}}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceEigen}{Eigen}} \{}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{keyword}{namespace }internal \{}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{keyword}{enum} GEBPPacketSizeType \{}
\DoxyCodeLine{21   GEBPPacketFull = 0,}
\DoxyCodeLine{22   GEBPPacketHalf,}
\DoxyCodeLine{23   GEBPPacketQuarter}
\DoxyCodeLine{24 \};}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsScalar\_, \textcolor{keyword}{typename} RhsScalar\_, \textcolor{keywordtype}{bool} ConjLhs\_=false, \textcolor{keywordtype}{bool} ConjRhs\_=false, \textcolor{keywordtype}{int} Arch=Architecture::Target, \textcolor{keywordtype}{int} PacketSize\_=GEBPPacketFull>}
\DoxyCodeLine{27 \textcolor{keyword}{class }gebp\_traits;}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 }
\DoxyCodeLine{31 \textcolor{keyword}{inline} std::ptrdiff\_t manage\_caching\_sizes\_helper(std::ptrdiff\_t a, std::ptrdiff\_t b)}
\DoxyCodeLine{32 \{}
\DoxyCodeLine{33   \textcolor{keywordflow}{return} a<=0 ? b : a;}
\DoxyCodeLine{34 \}}
\DoxyCodeLine{35 }
\DoxyCodeLine{36 \textcolor{preprocessor}{\#if defined(EIGEN\_DEFAULT\_L1\_CACHE\_SIZE)}}
\DoxyCodeLine{37 \textcolor{preprocessor}{\#define EIGEN\_SET\_DEFAULT\_L1\_CACHE\_SIZE(val) EIGEN\_DEFAULT\_L1\_CACHE\_SIZE}}
\DoxyCodeLine{38 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{39 \textcolor{preprocessor}{\#define EIGEN\_SET\_DEFAULT\_L1\_CACHE\_SIZE(val) val}}
\DoxyCodeLine{40 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// defined(EIGEN\_DEFAULT\_L1\_CACHE\_SIZE)}}
\DoxyCodeLine{41 }
\DoxyCodeLine{42 \textcolor{preprocessor}{\#if defined(EIGEN\_DEFAULT\_L2\_CACHE\_SIZE)}}
\DoxyCodeLine{43 \textcolor{preprocessor}{\#define EIGEN\_SET\_DEFAULT\_L2\_CACHE\_SIZE(val) EIGEN\_DEFAULT\_L2\_CACHE\_SIZE}}
\DoxyCodeLine{44 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{45 \textcolor{preprocessor}{\#define EIGEN\_SET\_DEFAULT\_L2\_CACHE\_SIZE(val) val}}
\DoxyCodeLine{46 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// defined(EIGEN\_DEFAULT\_L2\_CACHE\_SIZE)}}
\DoxyCodeLine{47 }
\DoxyCodeLine{48 \textcolor{preprocessor}{\#if defined(EIGEN\_DEFAULT\_L3\_CACHE\_SIZE)}}
\DoxyCodeLine{49 \textcolor{preprocessor}{\#define EIGEN\_SET\_DEFAULT\_L3\_CACHE\_SIZE(val) EIGEN\_DEFAULT\_L3\_CACHE\_SIZE}}
\DoxyCodeLine{50 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{51 \textcolor{preprocessor}{\#define EIGEN\_SET\_DEFAULT\_L3\_CACHE\_SIZE(val) val}}
\DoxyCodeLine{52 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// defined(EIGEN\_DEFAULT\_L3\_CACHE\_SIZE)}}
\DoxyCodeLine{53   }
\DoxyCodeLine{54 \textcolor{preprocessor}{\#if EIGEN\_ARCH\_i386\_OR\_x86\_64}}
\DoxyCodeLine{55 \textcolor{keyword}{const} std::ptrdiff\_t defaultL1CacheSize = EIGEN\_SET\_DEFAULT\_L1\_CACHE\_SIZE(32*1024);}
\DoxyCodeLine{56 \textcolor{keyword}{const} std::ptrdiff\_t defaultL2CacheSize = EIGEN\_SET\_DEFAULT\_L2\_CACHE\_SIZE(256*1024);}
\DoxyCodeLine{57 \textcolor{keyword}{const} std::ptrdiff\_t defaultL3CacheSize = EIGEN\_SET\_DEFAULT\_L3\_CACHE\_SIZE(2*1024*1024);}
\DoxyCodeLine{58 \textcolor{preprocessor}{\#elif EIGEN\_ARCH\_PPC}}
\DoxyCodeLine{59 \textcolor{keyword}{const} std::ptrdiff\_t defaultL1CacheSize = EIGEN\_SET\_DEFAULT\_L1\_CACHE\_SIZE(64*1024);}
\DoxyCodeLine{60 \textcolor{keyword}{const} std::ptrdiff\_t defaultL2CacheSize = EIGEN\_SET\_DEFAULT\_L2\_CACHE\_SIZE(512*1024);}
\DoxyCodeLine{61 \textcolor{keyword}{const} std::ptrdiff\_t defaultL3CacheSize = EIGEN\_SET\_DEFAULT\_L3\_CACHE\_SIZE(4*1024*1024);}
\DoxyCodeLine{62 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{63 \textcolor{keyword}{const} std::ptrdiff\_t defaultL1CacheSize = EIGEN\_SET\_DEFAULT\_L1\_CACHE\_SIZE(16*1024);}
\DoxyCodeLine{64 \textcolor{keyword}{const} std::ptrdiff\_t defaultL2CacheSize = EIGEN\_SET\_DEFAULT\_L2\_CACHE\_SIZE(512*1024);}
\DoxyCodeLine{65 \textcolor{keyword}{const} std::ptrdiff\_t defaultL3CacheSize = EIGEN\_SET\_DEFAULT\_L3\_CACHE\_SIZE(512*1024);}
\DoxyCodeLine{66 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{67 }
\DoxyCodeLine{68 \textcolor{preprocessor}{\#undef EIGEN\_SET\_DEFAULT\_L1\_CACHE\_SIZE}}
\DoxyCodeLine{69 \textcolor{preprocessor}{\#undef EIGEN\_SET\_DEFAULT\_L2\_CACHE\_SIZE}}
\DoxyCodeLine{70 \textcolor{preprocessor}{\#undef EIGEN\_SET\_DEFAULT\_L3\_CACHE\_SIZE}}
\DoxyCodeLine{71 }
\DoxyCodeLine{73 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1CacheSizes}{CacheSizes}} \{}
\DoxyCodeLine{74   \mbox{\hyperlink{structEigen_1_1internal_1_1CacheSizes}{CacheSizes}}(): m\_l1(-\/1),m\_l2(-\/1),m\_l3(-\/1) \{}
\DoxyCodeLine{75     \textcolor{keywordtype}{int} \mbox{\hyperlink{namespaceEigen_a2669f89ff38296a38e6d973552eb4e33}{l1CacheSize}}, \mbox{\hyperlink{namespaceEigen_a2cfc0330ba567d63a496be1cac8427ae}{l2CacheSize}}, \mbox{\hyperlink{namespaceEigen_ae2efa4852ea90c2d47b7dcec5b40ba2b}{l3CacheSize}};}
\DoxyCodeLine{76     queryCacheSizes(\mbox{\hyperlink{namespaceEigen_a2669f89ff38296a38e6d973552eb4e33}{l1CacheSize}}, \mbox{\hyperlink{namespaceEigen_a2cfc0330ba567d63a496be1cac8427ae}{l2CacheSize}}, \mbox{\hyperlink{namespaceEigen_ae2efa4852ea90c2d47b7dcec5b40ba2b}{l3CacheSize}});}
\DoxyCodeLine{77     m\_l1 = manage\_caching\_sizes\_helper(\mbox{\hyperlink{namespaceEigen_a2669f89ff38296a38e6d973552eb4e33}{l1CacheSize}}, defaultL1CacheSize);}
\DoxyCodeLine{78     m\_l2 = manage\_caching\_sizes\_helper(\mbox{\hyperlink{namespaceEigen_a2cfc0330ba567d63a496be1cac8427ae}{l2CacheSize}}, defaultL2CacheSize);}
\DoxyCodeLine{79     m\_l3 = manage\_caching\_sizes\_helper(\mbox{\hyperlink{namespaceEigen_ae2efa4852ea90c2d47b7dcec5b40ba2b}{l3CacheSize}}, defaultL3CacheSize);}
\DoxyCodeLine{80   \}}
\DoxyCodeLine{81 }
\DoxyCodeLine{82   std::ptrdiff\_t m\_l1;}
\DoxyCodeLine{83   std::ptrdiff\_t m\_l2;}
\DoxyCodeLine{84   std::ptrdiff\_t m\_l3;}
\DoxyCodeLine{85 \};}
\DoxyCodeLine{86 }
\DoxyCodeLine{88 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} manage\_caching\_sizes(Action action, std::ptrdiff\_t* l1, std::ptrdiff\_t* l2, std::ptrdiff\_t* l3)}
\DoxyCodeLine{89 \{}
\DoxyCodeLine{90   \textcolor{keyword}{static} \mbox{\hyperlink{structEigen_1_1internal_1_1CacheSizes}{CacheSizes}} m\_cacheSizes;}
\DoxyCodeLine{91 }
\DoxyCodeLine{92   \textcolor{keywordflow}{if}(action==SetAction)}
\DoxyCodeLine{93   \{}
\DoxyCodeLine{94     \textcolor{comment}{// set the cpu cache size and cache all block sizes from a global cache size in byte}}
\DoxyCodeLine{95     eigen\_internal\_assert(l1!=0 \&\& l2!=0);}
\DoxyCodeLine{96     m\_cacheSizes.m\_l1 = *l1;}
\DoxyCodeLine{97     m\_cacheSizes.m\_l2 = *l2;}
\DoxyCodeLine{98     m\_cacheSizes.m\_l3 = *l3;}
\DoxyCodeLine{99   \}}
\DoxyCodeLine{100   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(action==GetAction)}
\DoxyCodeLine{101   \{}
\DoxyCodeLine{102     eigen\_internal\_assert(l1!=0 \&\& l2!=0);}
\DoxyCodeLine{103     *l1 = m\_cacheSizes.m\_l1;}
\DoxyCodeLine{104     *l2 = m\_cacheSizes.m\_l2;}
\DoxyCodeLine{105     *l3 = m\_cacheSizes.m\_l3;}
\DoxyCodeLine{106   \}}
\DoxyCodeLine{107   \textcolor{keywordflow}{else}}
\DoxyCodeLine{108   \{}
\DoxyCodeLine{109     eigen\_internal\_assert(\textcolor{keyword}{false});}
\DoxyCodeLine{110   \}}
\DoxyCodeLine{111 \}}
\DoxyCodeLine{112 }
\DoxyCodeLine{113 \textcolor{comment}{/* Helper for computeProductBlockingSizes.}}
\DoxyCodeLine{114 \textcolor{comment}{ *}}
\DoxyCodeLine{115 \textcolor{comment}{ * Given a m x k times k x n matrix product of scalar types \(\backslash\)c LhsScalar and \(\backslash\)c RhsScalar,}}
\DoxyCodeLine{116 \textcolor{comment}{ * this function computes the blocking size parameters along the respective dimensions}}
\DoxyCodeLine{117 \textcolor{comment}{ * for matrix products and related algorithms. The blocking sizes depends on various}}
\DoxyCodeLine{118 \textcolor{comment}{ * parameters:}}
\DoxyCodeLine{119 \textcolor{comment}{ * -\/ the L1 and L2 cache sizes,}}
\DoxyCodeLine{120 \textcolor{comment}{ * -\/ the register level blocking sizes defined by gebp\_traits,}}
\DoxyCodeLine{121 \textcolor{comment}{ * -\/ the number of scalars that fit into a packet (when vectorization is enabled).}}
\DoxyCodeLine{122 \textcolor{comment}{ *}}
\DoxyCodeLine{123 \textcolor{comment}{ * \(\backslash\)sa setCpuCacheSizes */}}
\DoxyCodeLine{124 }
\DoxyCodeLine{125 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsScalar, \textcolor{keyword}{typename} RhsScalar, \textcolor{keywordtype}{int} KcFactor, \textcolor{keyword}{typename} Index>}
\DoxyCodeLine{126 \textcolor{keywordtype}{void} evaluateProductBlockingSizesHeuristic(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\& k, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\& m, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\& n, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} num\_threads = 1)}
\DoxyCodeLine{127 \{}
\DoxyCodeLine{128   \textcolor{keyword}{typedef} gebp\_traits<LhsScalar,RhsScalar> Traits;}
\DoxyCodeLine{129 }
\DoxyCodeLine{130   \textcolor{comment}{// Explanations:}}
\DoxyCodeLine{131   \textcolor{comment}{// Let's recall that the product algorithms form mc x kc vertical panels A' on the lhs and}}
\DoxyCodeLine{132   \textcolor{comment}{// kc x nc blocks B' on the rhs. B' has to fit into L2/L3 cache. Moreover, A' is processed}}
\DoxyCodeLine{133   \textcolor{comment}{// per mr x kc horizontal small panels where mr is the blocking size along the m dimension}}
\DoxyCodeLine{134   \textcolor{comment}{// at the register level. This small horizontal panel has to stay within L1 cache.}}
\DoxyCodeLine{135   std::ptrdiff\_t l1, l2, l3;}
\DoxyCodeLine{136   manage\_caching\_sizes(GetAction, \&l1, \&l2, \&l3);}
\DoxyCodeLine{137 \textcolor{preprocessor}{  \#ifdef EIGEN\_VECTORIZE\_AVX512}}
\DoxyCodeLine{138   \textcolor{comment}{// We need to find a rationale for that, but without this adjustment,}}
\DoxyCodeLine{139   \textcolor{comment}{// performance with AVX512 is pretty bad, like -\/20\% slower.}}
\DoxyCodeLine{140   \textcolor{comment}{// One reason is that with increasing packet-\/size, the blocking size k}}
\DoxyCodeLine{141   \textcolor{comment}{// has to become pretty small if we want that 1 lhs panel fit within L1.}}
\DoxyCodeLine{142   \textcolor{comment}{// For instance, with the 3pX4 kernel and double, the size of the lhs+rhs panels are:}}
\DoxyCodeLine{143   \textcolor{comment}{//   k*(3*64 + 4*8) Bytes, with l1=32kBytes, and k\%8=0, we have k=144.}}
\DoxyCodeLine{144   \textcolor{comment}{// This is quite small for a good reuse of the accumulation registers.}}
\DoxyCodeLine{145   l1 *= 4;}
\DoxyCodeLine{146 \textcolor{preprocessor}{  \#endif}}
\DoxyCodeLine{147 }
\DoxyCodeLine{148   \textcolor{keywordflow}{if} (num\_threads > 1) \{}
\DoxyCodeLine{149     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} Traits::ResScalar ResScalar;}
\DoxyCodeLine{150     \textcolor{keyword}{enum} \{}
\DoxyCodeLine{151       kdiv = KcFactor * (Traits::mr * \textcolor{keyword}{sizeof}(LhsScalar) + Traits::nr * \textcolor{keyword}{sizeof}(RhsScalar)),}
\DoxyCodeLine{152       ksub = Traits::mr * Traits::nr * \textcolor{keyword}{sizeof}(ResScalar),}
\DoxyCodeLine{153       kr = 8,}
\DoxyCodeLine{154       mr = Traits::mr,}
\DoxyCodeLine{155       nr = Traits::nr}
\DoxyCodeLine{156     \};}
\DoxyCodeLine{157     \textcolor{comment}{// Increasing k gives us more time to prefetch the content of the "{}C"{}}}
\DoxyCodeLine{158     \textcolor{comment}{// registers. However once the latency is hidden there is no point in}}
\DoxyCodeLine{159     \textcolor{comment}{// increasing the value of k, so we'll cap it at 320 (value determined}}
\DoxyCodeLine{160     \textcolor{comment}{// experimentally).}}
\DoxyCodeLine{161     \textcolor{comment}{// To avoid that k vanishes, we make k\_cache at least as big as kr}}
\DoxyCodeLine{162     \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k\_cache = numext::maxi<Index>(kr, (numext::mini<Index>)((l1-\/ksub)/kdiv, 320));}
\DoxyCodeLine{163     \textcolor{keywordflow}{if} (k\_cache < k) \{}
\DoxyCodeLine{164       k = k\_cache -\/ (k\_cache \% kr);}
\DoxyCodeLine{165       eigen\_internal\_assert(k > 0);}
\DoxyCodeLine{166     \}}
\DoxyCodeLine{167 }
\DoxyCodeLine{168     \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} n\_cache = (l2-\/l1) / (nr * \textcolor{keyword}{sizeof}(RhsScalar) * k);}
\DoxyCodeLine{169     \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} n\_per\_thread = numext::div\_ceil(n, num\_threads);}
\DoxyCodeLine{170     \textcolor{keywordflow}{if} (n\_cache <= n\_per\_thread) \{}
\DoxyCodeLine{171       \textcolor{comment}{// Don't exceed the capacity of the l2 cache.}}
\DoxyCodeLine{172       eigen\_internal\_assert(n\_cache >= \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\textcolor{keyword}{>}(nr));}
\DoxyCodeLine{173       n = n\_cache -\/ (n\_cache \% nr);}
\DoxyCodeLine{174       eigen\_internal\_assert(n > 0);}
\DoxyCodeLine{175     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{176       n = (numext::mini<Index>)(n, (n\_per\_thread + nr -\/ 1) -\/ ((n\_per\_thread + nr -\/ 1) \% nr));}
\DoxyCodeLine{177     \}}
\DoxyCodeLine{178 }
\DoxyCodeLine{179     \textcolor{keywordflow}{if} (l3 > l2) \{}
\DoxyCodeLine{180       \textcolor{comment}{// l3 is shared between all cores, so we'll give each thread its own chunk of l3.}}
\DoxyCodeLine{181       \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} m\_cache = (l3-\/l2) / (\textcolor{keyword}{sizeof}(LhsScalar) * k * num\_threads);}
\DoxyCodeLine{182       \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} m\_per\_thread = numext::div\_ceil(m, num\_threads);}
\DoxyCodeLine{183       \textcolor{keywordflow}{if}(m\_cache < m\_per\_thread \&\& m\_cache >= \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\textcolor{keyword}{>}(mr)) \{}
\DoxyCodeLine{184         m = m\_cache -\/ (m\_cache \% mr);}
\DoxyCodeLine{185         eigen\_internal\_assert(m > 0);}
\DoxyCodeLine{186       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{187         m = (numext::mini<Index>)(m, (m\_per\_thread + mr -\/ 1) -\/ ((m\_per\_thread + mr -\/ 1) \% mr));}
\DoxyCodeLine{188       \}}
\DoxyCodeLine{189     \}}
\DoxyCodeLine{190   \}}
\DoxyCodeLine{191   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{192     \textcolor{comment}{// In unit tests we do not want to use extra large matrices,}}
\DoxyCodeLine{193     \textcolor{comment}{// so we reduce the cache size to check the blocking strategy is not flawed}}
\DoxyCodeLine{194 \textcolor{preprocessor}{\#ifdef EIGEN\_DEBUG\_SMALL\_PRODUCT\_BLOCKS}}
\DoxyCodeLine{195     l1 = 9*1024;}
\DoxyCodeLine{196     l2 = 32*1024;}
\DoxyCodeLine{197     l3 = 512*1024;}
\DoxyCodeLine{198 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{199 }
\DoxyCodeLine{200     \textcolor{comment}{// Early return for small problems because the computation below are time consuming for small problems.}}
\DoxyCodeLine{201     \textcolor{comment}{// Perhaps it would make more sense to consider k*n*m??}}
\DoxyCodeLine{202     \textcolor{comment}{// Note that for very tiny problem, this function should be bypassed anyway}}
\DoxyCodeLine{203     \textcolor{comment}{// because we use the coefficient-\/based implementation for them.}}
\DoxyCodeLine{204     \textcolor{keywordflow}{if}((numext::maxi)(k,(numext::maxi)(m,n))<48)}
\DoxyCodeLine{205       \textcolor{keywordflow}{return};}
\DoxyCodeLine{206 }
\DoxyCodeLine{207     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} Traits::ResScalar ResScalar;}
\DoxyCodeLine{208     \textcolor{keyword}{enum} \{}
\DoxyCodeLine{209       k\_peeling = 8,}
\DoxyCodeLine{210       k\_div = KcFactor * (Traits::mr * \textcolor{keyword}{sizeof}(LhsScalar) + Traits::nr * \textcolor{keyword}{sizeof}(RhsScalar)),}
\DoxyCodeLine{211       k\_sub = Traits::mr * Traits::nr * \textcolor{keyword}{sizeof}(ResScalar)}
\DoxyCodeLine{212     \};}
\DoxyCodeLine{213 }
\DoxyCodeLine{214     \textcolor{comment}{// -\/-\/-\/-\/ 1st level of blocking on L1, yields kc -\/-\/-\/-\/}}
\DoxyCodeLine{215 }
\DoxyCodeLine{216     \textcolor{comment}{// Blocking on the third dimension (i.e., k) is chosen so that an horizontal panel}}
\DoxyCodeLine{217     \textcolor{comment}{// of size mr x kc of the lhs plus a vertical panel of kc x nr of the rhs both fits within L1 cache.}}
\DoxyCodeLine{218     \textcolor{comment}{// We also include a register-\/level block of the result (mx x nr).}}
\DoxyCodeLine{219     \textcolor{comment}{// (In an ideal world only the lhs panel would stay in L1)}}
\DoxyCodeLine{220     \textcolor{comment}{// Moreover, kc has to be a multiple of 8 to be compatible with loop peeling, leading to a maximum blocking size of:}}
\DoxyCodeLine{221     \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} max\_kc = numext::maxi<Index>(((l1-\/k\_sub)/k\_div) \& (\string~(k\_peeling-\/1)),1);}
\DoxyCodeLine{222     \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} old\_k = k;}
\DoxyCodeLine{223     \textcolor{keywordflow}{if}(k>max\_kc)}
\DoxyCodeLine{224     \{}
\DoxyCodeLine{225       \textcolor{comment}{// We are really blocking on the third dimension:}}
\DoxyCodeLine{226       \textcolor{comment}{// -\/> reduce blocking size to make sure the last block is as large as possible}}
\DoxyCodeLine{227       \textcolor{comment}{//    while keeping the same number of sweeps over the result.}}
\DoxyCodeLine{228       k = (k\%max\_kc)==0 ? max\_kc}
\DoxyCodeLine{229                         : max\_kc -\/ k\_peeling * ((max\_kc-\/1-\/(k\%max\_kc))/(k\_peeling*(k/max\_kc+1)));}
\DoxyCodeLine{230 }
\DoxyCodeLine{231       eigen\_internal\_assert(((old\_k/k) == (old\_k/max\_kc)) \&\& \textcolor{stringliteral}{"{}the number of sweeps has to remain the same"{}});}
\DoxyCodeLine{232     \}}
\DoxyCodeLine{233 }
\DoxyCodeLine{234     \textcolor{comment}{// -\/-\/-\/-\/ 2nd level of blocking on max(L2,L3), yields nc -\/-\/-\/-\/}}
\DoxyCodeLine{235 }
\DoxyCodeLine{236     \textcolor{comment}{// TODO find a reliable way to get the actual amount of cache per core to use for 2nd level blocking, that is:}}
\DoxyCodeLine{237     \textcolor{comment}{//      actual\_l2 = max(l2, l3/nb\_core\_sharing\_l3)}}
\DoxyCodeLine{238     \textcolor{comment}{// The number below is quite conservative: it is better to underestimate the cache size rather than overestimating it)}}
\DoxyCodeLine{239     \textcolor{comment}{// For instance, it corresponds to 6MB of L3 shared among 4 cores.}}
\DoxyCodeLine{240 \textcolor{preprocessor}{    \#ifdef EIGEN\_DEBUG\_SMALL\_PRODUCT\_BLOCKS}}
\DoxyCodeLine{241     \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} actual\_l2 = l3;}
\DoxyCodeLine{242 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{243     \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} actual\_l2 = 1572864; \textcolor{comment}{// == 1.5 MB}}
\DoxyCodeLine{244 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{245 }
\DoxyCodeLine{246     \textcolor{comment}{// Here, nc is chosen such that a block of kc x nc of the rhs fit within half of L2.}}
\DoxyCodeLine{247     \textcolor{comment}{// The second half is implicitly reserved to access the result and lhs coefficients.}}
\DoxyCodeLine{248     \textcolor{comment}{// When k<max\_kc, then nc can arbitrarily growth. In practice, it seems to be fruitful}}
\DoxyCodeLine{249     \textcolor{comment}{// to limit this growth: we bound nc to growth by a factor x1.5.}}
\DoxyCodeLine{250     \textcolor{comment}{// However, if the entire lhs block fit within L1, then we are not going to block on the rows at all,}}
\DoxyCodeLine{251     \textcolor{comment}{// and it becomes fruitful to keep the packed rhs blocks in L1 if there is enough remaining space.}}
\DoxyCodeLine{252     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} max\_nc;}
\DoxyCodeLine{253     \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} lhs\_bytes = m * k * \textcolor{keyword}{sizeof}(LhsScalar);}
\DoxyCodeLine{254     \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} remaining\_l1 = l1-\/ k\_sub -\/ lhs\_bytes;}
\DoxyCodeLine{255     \textcolor{keywordflow}{if}(remaining\_l1 >= \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}(Traits::nr*\textcolor{keyword}{sizeof}(RhsScalar))*k)}
\DoxyCodeLine{256     \{}
\DoxyCodeLine{257       \textcolor{comment}{// L1 blocking}}
\DoxyCodeLine{258       max\_nc = remaining\_l1 / (k*\textcolor{keyword}{sizeof}(RhsScalar));}
\DoxyCodeLine{259     \}}
\DoxyCodeLine{260     \textcolor{keywordflow}{else}}
\DoxyCodeLine{261     \{}
\DoxyCodeLine{262       \textcolor{comment}{// L2 blocking}}
\DoxyCodeLine{263       max\_nc = (3*actual\_l2)/(2*2*max\_kc*\textcolor{keyword}{sizeof}(RhsScalar));}
\DoxyCodeLine{264     \}}
\DoxyCodeLine{265     \textcolor{comment}{// WARNING Below, we assume that Traits::nr is a power of two.}}
\DoxyCodeLine{266     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} nc = numext::mini<Index>(actual\_l2/(2*k*\textcolor{keyword}{sizeof}(RhsScalar)), max\_nc) \& (\string~(Traits::nr-\/1));}
\DoxyCodeLine{267     \textcolor{keywordflow}{if}(n>nc)}
\DoxyCodeLine{268     \{}
\DoxyCodeLine{269       \textcolor{comment}{// We are really blocking over the columns:}}
\DoxyCodeLine{270       \textcolor{comment}{// -\/> reduce blocking size to make sure the last block is as large as possible}}
\DoxyCodeLine{271       \textcolor{comment}{//    while keeping the same number of sweeps over the packed lhs.}}
\DoxyCodeLine{272       \textcolor{comment}{//    Here we allow one more sweep if this gives us a perfect match, thus the commented "{}-\/1"{}}}
\DoxyCodeLine{273       n = (n\%nc)==0 ? nc}
\DoxyCodeLine{274                     : (nc -\/ Traits::nr * ((nc\textcolor{comment}{/*-\/1*/}-\/(n\%nc))/(Traits::nr*(n/nc+1))));}
\DoxyCodeLine{275     \}}
\DoxyCodeLine{276     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(old\_k==k)}
\DoxyCodeLine{277     \{}
\DoxyCodeLine{278       \textcolor{comment}{// So far, no blocking at all, i.e., kc==k, and nc==n.}}
\DoxyCodeLine{279       \textcolor{comment}{// In this case, let's perform a blocking over the rows such that the packed lhs data is kept in cache L1/L2}}
\DoxyCodeLine{280       \textcolor{comment}{// TODO: part of this blocking strategy is now implemented within the kernel itself, so the L1-\/based heuristic here should be obsolete.}}
\DoxyCodeLine{281       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} problem\_size = k*n*\textcolor{keyword}{sizeof}(LhsScalar);}
\DoxyCodeLine{282       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} actual\_lm = actual\_l2;}
\DoxyCodeLine{283       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} max\_mc = m;}
\DoxyCodeLine{284       \textcolor{keywordflow}{if}(problem\_size<=1024)}
\DoxyCodeLine{285       \{}
\DoxyCodeLine{286         \textcolor{comment}{// problem is small enough to keep in L1}}
\DoxyCodeLine{287         \textcolor{comment}{// Let's choose m such that lhs's block fit in 1/3 of L1}}
\DoxyCodeLine{288         actual\_lm = l1;}
\DoxyCodeLine{289       \}}
\DoxyCodeLine{290       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(l3!=0 \&\& problem\_size<=32768)}
\DoxyCodeLine{291       \{}
\DoxyCodeLine{292         \textcolor{comment}{// we have both L2 and L3, and problem is small enough to be kept in L2}}
\DoxyCodeLine{293         \textcolor{comment}{// Let's choose m such that lhs's block fit in 1/3 of L2}}
\DoxyCodeLine{294         actual\_lm = l2;}
\DoxyCodeLine{295         max\_mc = (numext::mini<Index>)(576,max\_mc);}
\DoxyCodeLine{296       \}}
\DoxyCodeLine{297       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} mc = (numext::mini<Index>)(actual\_lm/(3*k*\textcolor{keyword}{sizeof}(LhsScalar)), max\_mc);}
\DoxyCodeLine{298       \textcolor{keywordflow}{if} (mc > Traits::mr) mc -\/= mc \% Traits::mr;}
\DoxyCodeLine{299       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mc==0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{300       m = (m\%mc)==0 ? mc}
\DoxyCodeLine{301                     : (mc -\/ Traits::mr * ((mc\textcolor{comment}{/*-\/1*/}-\/(m\%mc))/(Traits::mr*(m/mc+1))));}
\DoxyCodeLine{302     \}}
\DoxyCodeLine{303   \}}
\DoxyCodeLine{304 \}}
\DoxyCodeLine{305 }
\DoxyCodeLine{306 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Index>}
\DoxyCodeLine{307 \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} useSpecificBlockingSizes(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\& k, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\& m, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\& n)}
\DoxyCodeLine{308 \{}
\DoxyCodeLine{309 \textcolor{preprocessor}{\#ifdef EIGEN\_TEST\_SPECIFIC\_BLOCKING\_SIZES}}
\DoxyCodeLine{310   \textcolor{keywordflow}{if} (EIGEN\_TEST\_SPECIFIC\_BLOCKING\_SIZES) \{}
\DoxyCodeLine{311     k = numext::mini<Index>(k, EIGEN\_TEST\_SPECIFIC\_BLOCKING\_SIZE\_K);}
\DoxyCodeLine{312     m = numext::mini<Index>(m, EIGEN\_TEST\_SPECIFIC\_BLOCKING\_SIZE\_M);}
\DoxyCodeLine{313     n = numext::mini<Index>(n, EIGEN\_TEST\_SPECIFIC\_BLOCKING\_SIZE\_N);}
\DoxyCodeLine{314     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{315   \}}
\DoxyCodeLine{316 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{317   EIGEN\_UNUSED\_VARIABLE(k)}
\DoxyCodeLine{318   EIGEN\_UNUSED\_VARIABLE(m)}
\DoxyCodeLine{319   EIGEN\_UNUSED\_VARIABLE(n)}
\DoxyCodeLine{320 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{321   \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{322 \}}
\DoxyCodeLine{323 }
\DoxyCodeLine{340 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsScalar, \textcolor{keyword}{typename} RhsScalar, \textcolor{keywordtype}{int} KcFactor, \textcolor{keyword}{typename} Index>}
\DoxyCodeLine{341 \textcolor{keywordtype}{void} computeProductBlockingSizes(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\& k, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\& m, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\& n, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} num\_threads = 1)}
\DoxyCodeLine{342 \{}
\DoxyCodeLine{343   \textcolor{keywordflow}{if} (!useSpecificBlockingSizes(k, m, n)) \{}
\DoxyCodeLine{344     evaluateProductBlockingSizesHeuristic<LhsScalar, RhsScalar, KcFactor, Index>(k, m, n, num\_threads);}
\DoxyCodeLine{345   \}}
\DoxyCodeLine{346 \}}
\DoxyCodeLine{347 }
\DoxyCodeLine{348 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsScalar, \textcolor{keyword}{typename} RhsScalar, \textcolor{keyword}{typename} Index>}
\DoxyCodeLine{349 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} computeProductBlockingSizes(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\& k, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\& m, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\& n, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} num\_threads = 1)}
\DoxyCodeLine{350 \{}
\DoxyCodeLine{351   computeProductBlockingSizes<LhsScalar,RhsScalar,1,Index>(k, m, n, num\_threads);}
\DoxyCodeLine{352 \}}
\DoxyCodeLine{353 }
\DoxyCodeLine{354 \textcolor{keyword}{template} <\textcolor{keyword}{typename} RhsPacket, \textcolor{keyword}{typename} RhsPacketx4, \textcolor{keywordtype}{int} registers\_taken>}
\DoxyCodeLine{355 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1RhsPanelHelper}{RhsPanelHelper}} \{}
\DoxyCodeLine{356  \textcolor{keyword}{private}:}
\DoxyCodeLine{357   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} remaining\_registers = EIGEN\_ARCH\_DEFAULT\_NUMBER\_OF\_REGISTERS -\/ registers\_taken;}
\DoxyCodeLine{358  \textcolor{keyword}{public}:}
\DoxyCodeLine{359   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1conditional}{conditional<remaining\_registers>}}=4, RhsPacketx4, RhsPacket>::type type;}
\DoxyCodeLine{360 \};}
\DoxyCodeLine{361 }
\DoxyCodeLine{362 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Packet>}
\DoxyCodeLine{363 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{QuadPacket}}}
\DoxyCodeLine{364 \{}
\DoxyCodeLine{365   \mbox{\hyperlink{unionEigen_1_1internal_1_1Packet}{Packet}} B\_0, B1, B2, B3;}
\DoxyCodeLine{366   \textcolor{keyword}{const} \mbox{\hyperlink{unionEigen_1_1internal_1_1Packet}{Packet}}\& get(\textcolor{keyword}{const} \mbox{\hyperlink{classEigen_1_1internal_1_1FixedInt}{FixedInt<0>}}\&)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} B\_0; \}}
\DoxyCodeLine{367   \textcolor{keyword}{const} \mbox{\hyperlink{unionEigen_1_1internal_1_1Packet}{Packet}}\& get(\textcolor{keyword}{const} \mbox{\hyperlink{classEigen_1_1internal_1_1FixedInt}{FixedInt<1>}}\&)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} B1; \}}
\DoxyCodeLine{368   \textcolor{keyword}{const} \mbox{\hyperlink{unionEigen_1_1internal_1_1Packet}{Packet}}\& get(\textcolor{keyword}{const} \mbox{\hyperlink{classEigen_1_1internal_1_1FixedInt}{FixedInt<2>}}\&)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} B2; \}}
\DoxyCodeLine{369   \textcolor{keyword}{const} \mbox{\hyperlink{unionEigen_1_1internal_1_1Packet}{Packet}}\& get(\textcolor{keyword}{const} \mbox{\hyperlink{classEigen_1_1internal_1_1FixedInt}{FixedInt<3>}}\&)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} B3; \}}
\DoxyCodeLine{370 \};}
\DoxyCodeLine{371 }
\DoxyCodeLine{372 \textcolor{keyword}{template} <\textcolor{keywordtype}{int} N, \textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2, \textcolor{keyword}{typename} T3>}
\DoxyCodeLine{373 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1packet__conditional}{packet\_conditional}} \{ \textcolor{keyword}{typedef} T3 type; \};}
\DoxyCodeLine{374 }
\DoxyCodeLine{375 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2, \textcolor{keyword}{typename} T3>}
\DoxyCodeLine{376 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1packet__conditional}{packet\_conditional}}<GEBPPacketFull, T1, T2, T3> \{ \textcolor{keyword}{typedef} T1 type; \};}
\DoxyCodeLine{377 }
\DoxyCodeLine{378 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2, \textcolor{keyword}{typename} T3>}
\DoxyCodeLine{379 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1packet__conditional}{packet\_conditional}}<GEBPPacketHalf, T1, T2, T3> \{ \textcolor{keyword}{typedef} T2 type; \};}
\DoxyCodeLine{380 }
\DoxyCodeLine{381 \textcolor{preprocessor}{\#define PACKET\_DECL\_COND\_PREFIX(prefix, name, packet\_size)         \(\backslash\)}}
\DoxyCodeLine{382 \textcolor{preprocessor}{  typedef typename packet\_conditional<packet\_size,                 \(\backslash\)}}
\DoxyCodeLine{383 \textcolor{preprocessor}{                                      typename packet\_traits<name \#\# Scalar>::type, \(\backslash\)}}
\DoxyCodeLine{384 \textcolor{preprocessor}{                                      typename packet\_traits<name \#\# Scalar>::half, \(\backslash\)}}
\DoxyCodeLine{385 \textcolor{preprocessor}{                                      typename unpacket\_traits<typename packet\_traits<name \#\# Scalar>::half>::half>::type \(\backslash\)}}
\DoxyCodeLine{386 \textcolor{preprocessor}{  prefix \#\# name \#\# Packet}}
\DoxyCodeLine{387 }
\DoxyCodeLine{388 \textcolor{preprocessor}{\#define PACKET\_DECL\_COND(name, packet\_size)                        \(\backslash\)}}
\DoxyCodeLine{389 \textcolor{preprocessor}{  typedef typename packet\_conditional<packet\_size,                 \(\backslash\)}}
\DoxyCodeLine{390 \textcolor{preprocessor}{                                      typename packet\_traits<name \#\# Scalar>::type, \(\backslash\)}}
\DoxyCodeLine{391 \textcolor{preprocessor}{                                      typename packet\_traits<name \#\# Scalar>::half, \(\backslash\)}}
\DoxyCodeLine{392 \textcolor{preprocessor}{                                      typename unpacket\_traits<typename packet\_traits<name \#\# Scalar>::half>::half>::type \(\backslash\)}}
\DoxyCodeLine{393 \textcolor{preprocessor}{  name \#\# Packet}}
\DoxyCodeLine{394 }
\DoxyCodeLine{395 \textcolor{preprocessor}{\#define PACKET\_DECL\_COND\_SCALAR\_PREFIX(prefix, packet\_size)        \(\backslash\)}}
\DoxyCodeLine{396 \textcolor{preprocessor}{  typedef typename packet\_conditional<packet\_size,                 \(\backslash\)}}
\DoxyCodeLine{397 \textcolor{preprocessor}{                                      typename packet\_traits<Scalar>::type, \(\backslash\)}}
\DoxyCodeLine{398 \textcolor{preprocessor}{                                      typename packet\_traits<Scalar>::half, \(\backslash\)}}
\DoxyCodeLine{399 \textcolor{preprocessor}{                                      typename unpacket\_traits<typename packet\_traits<Scalar>::half>::half>::type \(\backslash\)}}
\DoxyCodeLine{400 \textcolor{preprocessor}{  prefix \#\# ScalarPacket}}
\DoxyCodeLine{401 }
\DoxyCodeLine{402 \textcolor{preprocessor}{\#define PACKET\_DECL\_COND\_SCALAR(packet\_size)                       \(\backslash\)}}
\DoxyCodeLine{403 \textcolor{preprocessor}{  typedef typename packet\_conditional<packet\_size,                 \(\backslash\)}}
\DoxyCodeLine{404 \textcolor{preprocessor}{                                      typename packet\_traits<Scalar>::type, \(\backslash\)}}
\DoxyCodeLine{405 \textcolor{preprocessor}{                                      typename packet\_traits<Scalar>::half, \(\backslash\)}}
\DoxyCodeLine{406 \textcolor{preprocessor}{                                      typename unpacket\_traits<typename packet\_traits<Scalar>::half>::half>::type \(\backslash\)}}
\DoxyCodeLine{407 \textcolor{preprocessor}{  ScalarPacket}}
\DoxyCodeLine{408 }
\DoxyCodeLine{409 \textcolor{comment}{/* Vectorization logic}}
\DoxyCodeLine{410 \textcolor{comment}{ *  real*real: unpack rhs to constant packets, ...}}
\DoxyCodeLine{411 \textcolor{comment}{ * }}
\DoxyCodeLine{412 \textcolor{comment}{ *  cd*cd : unpack rhs to (b\_r,b\_r), (b\_i,b\_i), mul to get (a\_r b\_r,a\_i b\_r) (a\_r b\_i,a\_i b\_i),}}
\DoxyCodeLine{413 \textcolor{comment}{ *          storing each res packet into two packets (2x2),}}
\DoxyCodeLine{414 \textcolor{comment}{ *          at the end combine them: swap the second and addsub them }}
\DoxyCodeLine{415 \textcolor{comment}{ *  cf*cf : same but with 2x4 blocks}}
\DoxyCodeLine{416 \textcolor{comment}{ *  cplx*real : unpack rhs to constant packets, ...}}
\DoxyCodeLine{417 \textcolor{comment}{ *  real*cplx : load lhs as (a0,a0,a1,a1), and mul as usual}}
\DoxyCodeLine{418 \textcolor{comment}{ */}}
\DoxyCodeLine{419 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsScalar\_, \textcolor{keyword}{typename} RhsScalar\_, \textcolor{keywordtype}{bool} ConjLhs\_, \textcolor{keywordtype}{bool} ConjRhs\_, \textcolor{keywordtype}{int} Arch, \textcolor{keywordtype}{int} PacketSize\_>}
\DoxyCodeLine{420 \textcolor{keyword}{class }\mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{gebp\_traits}}}
\DoxyCodeLine{421 \{}
\DoxyCodeLine{422 \textcolor{keyword}{public}:}
\DoxyCodeLine{423   \textcolor{keyword}{typedef} LhsScalar\_ LhsScalar;}
\DoxyCodeLine{424   \textcolor{keyword}{typedef} RhsScalar\_ RhsScalar;}
\DoxyCodeLine{425   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1ScalarBinaryOpTraits}{ScalarBinaryOpTraits<LhsScalar, RhsScalar>::ReturnType}} ResScalar;}
\DoxyCodeLine{426 }
\DoxyCodeLine{427   PACKET\_DECL\_COND\_PREFIX(\_, Lhs, PacketSize\_);}
\DoxyCodeLine{428   PACKET\_DECL\_COND\_PREFIX(\_, Rhs, PacketSize\_);}
\DoxyCodeLine{429   PACKET\_DECL\_COND\_PREFIX(\_, Res, PacketSize\_);}
\DoxyCodeLine{430 }
\DoxyCodeLine{431   \textcolor{keyword}{enum} \{}
\DoxyCodeLine{432     ConjLhs = ConjLhs\_,}
\DoxyCodeLine{433     ConjRhs = ConjRhs\_,}
\DoxyCodeLine{434     Vectorizable = \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_LhsPacket>::vectorizable}} \&\& \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_RhsPacket>::vectorizable}},}
\DoxyCodeLine{435     LhsPacketSize = Vectorizable ? \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_LhsPacket>::size}} : 1,}
\DoxyCodeLine{436     RhsPacketSize = Vectorizable ? \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_RhsPacket>::size}} : 1,}
\DoxyCodeLine{437     ResPacketSize = Vectorizable ? \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_ResPacket>::size}} : 1,}
\DoxyCodeLine{438     }
\DoxyCodeLine{439     NumberOfRegisters = EIGEN\_ARCH\_DEFAULT\_NUMBER\_OF\_REGISTERS,}
\DoxyCodeLine{440 }
\DoxyCodeLine{441     \textcolor{comment}{// register block size along the N direction must be 1 or 4}}
\DoxyCodeLine{442     nr = 4,}
\DoxyCodeLine{443 }
\DoxyCodeLine{444     \textcolor{comment}{// register block size along the M direction (currently, this one cannot be modified)}}
\DoxyCodeLine{445     default\_mr = (EIGEN\_PLAIN\_ENUM\_MIN(16,NumberOfRegisters)/2/nr)*LhsPacketSize,}
\DoxyCodeLine{446 \#\textcolor{keywordflow}{if} defined(EIGEN\_HAS\_SINGLE\_INSTRUCTION\_MADD) \&\& !defined(EIGEN\_VECTORIZE\_ALTIVEC) \&\& !defined(EIGEN\_VECTORIZE\_VSX) \(\backslash\)}
\DoxyCodeLine{447     \&\& ((!EIGEN\_COMP\_MSVC) || (EIGEN\_COMP\_MSVC>=1914))}
\DoxyCodeLine{448     \textcolor{comment}{// we assume 16 registers or more}}
\DoxyCodeLine{449     \textcolor{comment}{// See bug 992, if the scalar type is not vectorizable but that EIGEN\_HAS\_SINGLE\_INSTRUCTION\_MADD is defined,}}
\DoxyCodeLine{450     \textcolor{comment}{// then using 3*LhsPacketSize triggers non-\/implemented paths in syrk.}}
\DoxyCodeLine{451     \textcolor{comment}{// Bug 1515: MSVC prior to v19.14 yields to register spilling.}}
\DoxyCodeLine{452     mr = Vectorizable ? 3*LhsPacketSize : default\_mr,}
\DoxyCodeLine{453 \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{454     mr = default\_mr,}
\DoxyCodeLine{455 \#endif}
\DoxyCodeLine{456     }
\DoxyCodeLine{457     LhsProgress = LhsPacketSize,}
\DoxyCodeLine{458     RhsProgress = 1}
\DoxyCodeLine{459   \};}
\DoxyCodeLine{460 }
\DoxyCodeLine{461 }
\DoxyCodeLine{462   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{conditional<Vectorizable,\_LhsPacket,LhsScalar>::type}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacket}};}
\DoxyCodeLine{463   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{conditional<Vectorizable,\_RhsPacket,RhsScalar>::type}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacket}};}
\DoxyCodeLine{464   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{conditional<Vectorizable,\_ResPacket,ResScalar>::type}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ResPacket}};}
\DoxyCodeLine{465   \textcolor{keyword}{typedef} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacket4Packing}};}
\DoxyCodeLine{466 }
\DoxyCodeLine{467   \textcolor{keyword}{typedef} \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{QuadPacket<RhsPacket>}} \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{RhsPacketx4}};}
\DoxyCodeLine{468   \textcolor{keyword}{typedef} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ResPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{AccPacket}};}
\DoxyCodeLine{469   }
\DoxyCodeLine{470   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} initAcc(\mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{AccPacket}}\& p)}
\DoxyCodeLine{471   \{}
\DoxyCodeLine{472     p = pset1<ResPacket>(ResScalar(0));}
\DoxyCodeLine{473   \}}
\DoxyCodeLine{474 }
\DoxyCodeLine{475   \textcolor{keyword}{template}<\textcolor{keyword}{typename} RhsPacketType>}
\DoxyCodeLine{476   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadRhs(\textcolor{keyword}{const} RhsScalar* b, RhsPacketType\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{477 \textcolor{keyword}{  }\{}
\DoxyCodeLine{478     dest = pset1<RhsPacketType>(*b);}
\DoxyCodeLine{479   \}}
\DoxyCodeLine{480 }
\DoxyCodeLine{481   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadRhs(\textcolor{keyword}{const} RhsScalar* b, \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{RhsPacketx4}}\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{482 \textcolor{keyword}{  }\{}
\DoxyCodeLine{483     pbroadcast4(b, dest.B\_0, dest.B1, dest.B2, dest.B3);}
\DoxyCodeLine{484   \}}
\DoxyCodeLine{485 }
\DoxyCodeLine{486   \textcolor{keyword}{template}<\textcolor{keyword}{typename} RhsPacketType>}
\DoxyCodeLine{487   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} updateRhs(\textcolor{keyword}{const} RhsScalar* b, RhsPacketType\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{488 \textcolor{keyword}{  }\{}
\DoxyCodeLine{489     loadRhs(b, dest);}
\DoxyCodeLine{490   \}}
\DoxyCodeLine{491 }
\DoxyCodeLine{492   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} updateRhs(\textcolor{keyword}{const} RhsScalar*, \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{RhsPacketx4}}\&)\textcolor{keyword}{ const}}
\DoxyCodeLine{493 \textcolor{keyword}{  }\{}
\DoxyCodeLine{494   \}}
\DoxyCodeLine{495 }
\DoxyCodeLine{496   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadRhsQuad(\textcolor{keyword}{const} RhsScalar* b, \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacket}}\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{497 \textcolor{keyword}{  }\{}
\DoxyCodeLine{498     dest = ploadquad<RhsPacket>(b);}
\DoxyCodeLine{499   \}}
\DoxyCodeLine{500 }
\DoxyCodeLine{501   \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsPacketType>}
\DoxyCodeLine{502   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadLhs(\textcolor{keyword}{const} LhsScalar* a, LhsPacketType\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{503 \textcolor{keyword}{  }\{}
\DoxyCodeLine{504     dest = pload<LhsPacketType>(a);}
\DoxyCodeLine{505   \}}
\DoxyCodeLine{506 }
\DoxyCodeLine{507   \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsPacketType>}
\DoxyCodeLine{508   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadLhsUnaligned(\textcolor{keyword}{const} LhsScalar* a, LhsPacketType\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{509 \textcolor{keyword}{  }\{}
\DoxyCodeLine{510     dest = ploadu<LhsPacketType>(a);}
\DoxyCodeLine{511   \}}
\DoxyCodeLine{512 }
\DoxyCodeLine{513   \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsPacketType, \textcolor{keyword}{typename} RhsPacketType, \textcolor{keyword}{typename} AccPacketType, \textcolor{keyword}{typename} LaneIdType>}
\DoxyCodeLine{514   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} madd(\textcolor{keyword}{const} LhsPacketType\& a, \textcolor{keyword}{const} RhsPacketType\& b, AccPacketType\& c, RhsPacketType\& tmp, \textcolor{keyword}{const} LaneIdType\&)\textcolor{keyword}{ const}}
\DoxyCodeLine{515 \textcolor{keyword}{  }\{}
\DoxyCodeLine{516     \mbox{\hyperlink{structEigen_1_1internal_1_1conj__helper}{conj\_helper<LhsPacketType,RhsPacketType,ConjLhs,ConjRhs>}} cj;}
\DoxyCodeLine{517     \textcolor{comment}{// It would be a lot cleaner to call pmadd all the time. Unfortunately if we}}
\DoxyCodeLine{518     \textcolor{comment}{// let gcc allocate the register in which to store the result of the pmul}}
\DoxyCodeLine{519     \textcolor{comment}{// (in the case where there is no FMA) gcc fails to figure out how to avoid}}
\DoxyCodeLine{520     \textcolor{comment}{// spilling register.}}
\DoxyCodeLine{521 \textcolor{preprocessor}{\#ifdef EIGEN\_HAS\_SINGLE\_INSTRUCTION\_MADD}}
\DoxyCodeLine{522     EIGEN\_UNUSED\_VARIABLE(tmp);}
\DoxyCodeLine{523     c = cj.pmadd(a,b,c);}
\DoxyCodeLine{524 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{525     tmp = b; tmp = cj.pmul(a,tmp); c = padd(c,tmp);}
\DoxyCodeLine{526 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{527   \}}
\DoxyCodeLine{528 }
\DoxyCodeLine{529   \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsPacketType, \textcolor{keyword}{typename} AccPacketType, \textcolor{keyword}{typename} LaneIdType>}
\DoxyCodeLine{530   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} madd(\textcolor{keyword}{const} LhsPacketType\& a, \textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{RhsPacketx4}}\& b, AccPacketType\& c, \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacket}}\& tmp, \textcolor{keyword}{const} LaneIdType\& lane)\textcolor{keyword}{ const}}
\DoxyCodeLine{531 \textcolor{keyword}{  }\{}
\DoxyCodeLine{532     madd(a, b.get(lane), c, tmp, lane);}
\DoxyCodeLine{533   \}}
\DoxyCodeLine{534 }
\DoxyCodeLine{535   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} acc(\textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{AccPacket}}\& c, \textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ResPacket}}\& alpha, \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ResPacket}}\& r)\textcolor{keyword}{ const}}
\DoxyCodeLine{536 \textcolor{keyword}{  }\{}
\DoxyCodeLine{537     r = pmadd(c,alpha,r);}
\DoxyCodeLine{538   \}}
\DoxyCodeLine{539   }
\DoxyCodeLine{540   \textcolor{keyword}{template}<\textcolor{keyword}{typename} ResPacketHalf>}
\DoxyCodeLine{541   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} acc(\textcolor{keyword}{const} ResPacketHalf\& c, \textcolor{keyword}{const} ResPacketHalf\& alpha, ResPacketHalf\& r)\textcolor{keyword}{ const}}
\DoxyCodeLine{542 \textcolor{keyword}{  }\{}
\DoxyCodeLine{543     r = pmadd(c,alpha,r);}
\DoxyCodeLine{544   \}}
\DoxyCodeLine{545 }
\DoxyCodeLine{546 \};}
\DoxyCodeLine{547 }
\DoxyCodeLine{548 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealScalar, \textcolor{keywordtype}{bool} ConjLhs\_, \textcolor{keywordtype}{int} Arch, \textcolor{keywordtype}{int} PacketSize\_>}
\DoxyCodeLine{549 \textcolor{keyword}{class }\mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{gebp\_traits}}<std::complex<RealScalar>, RealScalar, ConjLhs\_, false, Arch, PacketSize\_>}
\DoxyCodeLine{550 \{}
\DoxyCodeLine{551 \textcolor{keyword}{public}:}
\DoxyCodeLine{552   \textcolor{keyword}{typedef} std::complex<RealScalar> LhsScalar;}
\DoxyCodeLine{553   \textcolor{keyword}{typedef} RealScalar RhsScalar;}
\DoxyCodeLine{554   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1ScalarBinaryOpTraits}{ScalarBinaryOpTraits<LhsScalar, RhsScalar>::ReturnType}} ResScalar;}
\DoxyCodeLine{555 }
\DoxyCodeLine{556   PACKET\_DECL\_COND\_PREFIX(\_, Lhs, PacketSize\_);}
\DoxyCodeLine{557   PACKET\_DECL\_COND\_PREFIX(\_, Rhs, PacketSize\_);}
\DoxyCodeLine{558   PACKET\_DECL\_COND\_PREFIX(\_, Res, PacketSize\_);}
\DoxyCodeLine{559 }
\DoxyCodeLine{560   \textcolor{keyword}{enum} \{}
\DoxyCodeLine{561     ConjLhs = ConjLhs\_,}
\DoxyCodeLine{562     ConjRhs = \textcolor{keyword}{false},}
\DoxyCodeLine{563     Vectorizable = \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_LhsPacket>::vectorizable}} \&\& \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_RhsPacket>::vectorizable}},}
\DoxyCodeLine{564     LhsPacketSize = Vectorizable ? \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_LhsPacket>::size}} : 1,}
\DoxyCodeLine{565     RhsPacketSize = Vectorizable ? \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_RhsPacket>::size}} : 1,}
\DoxyCodeLine{566     ResPacketSize = Vectorizable ? \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_ResPacket>::size}} : 1,}
\DoxyCodeLine{567     }
\DoxyCodeLine{568     NumberOfRegisters = EIGEN\_ARCH\_DEFAULT\_NUMBER\_OF\_REGISTERS,}
\DoxyCodeLine{569     nr = 4,}
\DoxyCodeLine{570 \textcolor{preprocessor}{\#if defined(EIGEN\_HAS\_SINGLE\_INSTRUCTION\_MADD) \&\& !defined(EIGEN\_VECTORIZE\_ALTIVEC) \&\& !defined(EIGEN\_VECTORIZE\_VSX)}}
\DoxyCodeLine{571     \textcolor{comment}{// we assume 16 registers}}
\DoxyCodeLine{572     mr = 3*LhsPacketSize,}
\DoxyCodeLine{573 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{574     mr = (EIGEN\_PLAIN\_ENUM\_MIN(16,NumberOfRegisters)/2/nr)*LhsPacketSize,}
\DoxyCodeLine{575 \#endif}
\DoxyCodeLine{576 }
\DoxyCodeLine{577     LhsProgress = LhsPacketSize,}
\DoxyCodeLine{578     RhsProgress = 1}
\DoxyCodeLine{579   \};}
\DoxyCodeLine{580 }
\DoxyCodeLine{581   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{conditional<Vectorizable,\_LhsPacket,LhsScalar>::type}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacket}};}
\DoxyCodeLine{582   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{conditional<Vectorizable,\_RhsPacket,RhsScalar>::type}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacket}};}
\DoxyCodeLine{583   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{conditional<Vectorizable,\_ResPacket,ResScalar>::type}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ResPacket}};}
\DoxyCodeLine{584   \textcolor{keyword}{typedef} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacket4Packing}};}
\DoxyCodeLine{585 }
\DoxyCodeLine{586   \textcolor{keyword}{typedef} \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{QuadPacket<RhsPacket>}} \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{RhsPacketx4}};}
\DoxyCodeLine{587 }
\DoxyCodeLine{588   \textcolor{keyword}{typedef} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ResPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{AccPacket}};}
\DoxyCodeLine{589 }
\DoxyCodeLine{590   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} initAcc(\mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{AccPacket}}\& p)}
\DoxyCodeLine{591   \{}
\DoxyCodeLine{592     p = pset1<ResPacket>(ResScalar(0));}
\DoxyCodeLine{593   \}}
\DoxyCodeLine{594 }
\DoxyCodeLine{595   \textcolor{keyword}{template}<\textcolor{keyword}{typename} RhsPacketType>}
\DoxyCodeLine{596   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadRhs(\textcolor{keyword}{const} RhsScalar* b, RhsPacketType\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{597 \textcolor{keyword}{  }\{}
\DoxyCodeLine{598     dest = pset1<RhsPacketType>(*b);}
\DoxyCodeLine{599   \}}
\DoxyCodeLine{600 }
\DoxyCodeLine{601   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadRhs(\textcolor{keyword}{const} RhsScalar* b, \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{RhsPacketx4}}\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{602 \textcolor{keyword}{  }\{}
\DoxyCodeLine{603     pbroadcast4(b, dest.B\_0, dest.B1, dest.B2, dest.B3);}
\DoxyCodeLine{604   \}}
\DoxyCodeLine{605 }
\DoxyCodeLine{606   \textcolor{keyword}{template}<\textcolor{keyword}{typename} RhsPacketType>}
\DoxyCodeLine{607   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} updateRhs(\textcolor{keyword}{const} RhsScalar* b, RhsPacketType\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{608 \textcolor{keyword}{  }\{}
\DoxyCodeLine{609     loadRhs(b, dest);}
\DoxyCodeLine{610   \}}
\DoxyCodeLine{611 }
\DoxyCodeLine{612   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} updateRhs(\textcolor{keyword}{const} RhsScalar*, \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{RhsPacketx4}}\&)\textcolor{keyword}{ const}}
\DoxyCodeLine{613 \textcolor{keyword}{  }\{\}}
\DoxyCodeLine{614   }
\DoxyCodeLine{615   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadRhsQuad(\textcolor{keyword}{const} RhsScalar* b, \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacket}}\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{616 \textcolor{keyword}{  }\{}
\DoxyCodeLine{617     loadRhsQuad\_impl(b,dest, \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{conditional<RhsPacketSize==16,true\_type,false\_type>::type}}());}
\DoxyCodeLine{618   \}}
\DoxyCodeLine{619 }
\DoxyCodeLine{620   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadRhsQuad\_impl(\textcolor{keyword}{const} RhsScalar* b, \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacket}}\& dest, \textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{true\_type}}\&)\textcolor{keyword}{ const}}
\DoxyCodeLine{621 \textcolor{keyword}{  }\{}
\DoxyCodeLine{622     \textcolor{comment}{// FIXME we can do better!}}
\DoxyCodeLine{623     \textcolor{comment}{// what we want here is a ploadheight}}
\DoxyCodeLine{624     RhsScalar tmp[4] = \{b[0],b[0],b[1],b[1]\};}
\DoxyCodeLine{625     dest = ploadquad<RhsPacket>(tmp);}
\DoxyCodeLine{626   \}}
\DoxyCodeLine{627 }
\DoxyCodeLine{628   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadRhsQuad\_impl(\textcolor{keyword}{const} RhsScalar* b, \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacket}}\& dest, \textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1internal_1_1false__type}{false\_type}}\&)\textcolor{keyword}{ const}}
\DoxyCodeLine{629 \textcolor{keyword}{  }\{}
\DoxyCodeLine{630     eigen\_internal\_assert(RhsPacketSize<=8);}
\DoxyCodeLine{631     dest = pset1<RhsPacket>(*b);}
\DoxyCodeLine{632   \}}
\DoxyCodeLine{633 }
\DoxyCodeLine{634   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadLhs(\textcolor{keyword}{const} LhsScalar* a, \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacket}}\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{635 \textcolor{keyword}{  }\{}
\DoxyCodeLine{636     dest = pload<LhsPacket>(a);}
\DoxyCodeLine{637   \}}
\DoxyCodeLine{638 }
\DoxyCodeLine{639   \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsPacketType>}
\DoxyCodeLine{640   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadLhsUnaligned(\textcolor{keyword}{const} LhsScalar* a, LhsPacketType\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{641 \textcolor{keyword}{  }\{}
\DoxyCodeLine{642     dest = ploadu<LhsPacketType>(a);}
\DoxyCodeLine{643   \}}
\DoxyCodeLine{644 }
\DoxyCodeLine{645   \textcolor{keyword}{template} <\textcolor{keyword}{typename} LhsPacketType, \textcolor{keyword}{typename} RhsPacketType, \textcolor{keyword}{typename} AccPacketType, \textcolor{keyword}{typename} LaneIdType>}
\DoxyCodeLine{646   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} madd(\textcolor{keyword}{const} LhsPacketType\& a, \textcolor{keyword}{const} RhsPacketType\& b, AccPacketType\& c, RhsPacketType\& tmp, \textcolor{keyword}{const} LaneIdType\&)\textcolor{keyword}{ const}}
\DoxyCodeLine{647 \textcolor{keyword}{  }\{}
\DoxyCodeLine{648     madd\_impl(a, b, c, tmp, \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{conditional<Vectorizable,true\_type,false\_type>::type}}());}
\DoxyCodeLine{649   \}}
\DoxyCodeLine{650 }
\DoxyCodeLine{651   \textcolor{keyword}{template} <\textcolor{keyword}{typename} LhsPacketType, \textcolor{keyword}{typename} RhsPacketType, \textcolor{keyword}{typename} AccPacketType>}
\DoxyCodeLine{652   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} madd\_impl(\textcolor{keyword}{const} LhsPacketType\& a, \textcolor{keyword}{const} RhsPacketType\& b, AccPacketType\& c, RhsPacketType\& tmp, \textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{true\_type}}\&)\textcolor{keyword}{ const}}
\DoxyCodeLine{653 \textcolor{keyword}{  }\{}
\DoxyCodeLine{654 \textcolor{preprocessor}{\#ifdef EIGEN\_HAS\_SINGLE\_INSTRUCTION\_MADD}}
\DoxyCodeLine{655     EIGEN\_UNUSED\_VARIABLE(tmp);}
\DoxyCodeLine{656     c.v = pmadd(a.v,b,c.v);}
\DoxyCodeLine{657 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{658     tmp = b; tmp = pmul(a.v,tmp); c.v = padd(c.v,tmp);}
\DoxyCodeLine{659 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{660   \}}
\DoxyCodeLine{661 }
\DoxyCodeLine{662   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} madd\_impl(\textcolor{keyword}{const} LhsScalar\& a, \textcolor{keyword}{const} RhsScalar\& b, ResScalar\& c, RhsScalar\& \textcolor{comment}{/*tmp*/}, \textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1internal_1_1false__type}{false\_type}}\&)\textcolor{keyword}{ const}}
\DoxyCodeLine{663 \textcolor{keyword}{  }\{}
\DoxyCodeLine{664     c += a * b;}
\DoxyCodeLine{665   \}}
\DoxyCodeLine{666 }
\DoxyCodeLine{667   \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsPacketType, \textcolor{keyword}{typename} AccPacketType, \textcolor{keyword}{typename} LaneIdType>}
\DoxyCodeLine{668   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} madd(\textcolor{keyword}{const} LhsPacketType\& a, \textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{RhsPacketx4}}\& b, AccPacketType\& c, \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacket}}\& tmp, \textcolor{keyword}{const} LaneIdType\& lane)\textcolor{keyword}{ const}}
\DoxyCodeLine{669 \textcolor{keyword}{  }\{}
\DoxyCodeLine{670     madd(a, b.get(lane), c, tmp, lane);}
\DoxyCodeLine{671   \}}
\DoxyCodeLine{672 }
\DoxyCodeLine{673   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ResPacketType, \textcolor{keyword}{typename} AccPacketType>}
\DoxyCodeLine{674   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} acc(\textcolor{keyword}{const} AccPacketType\& c, \textcolor{keyword}{const} ResPacketType\& alpha, ResPacketType\& r)\textcolor{keyword}{ const}}
\DoxyCodeLine{675 \textcolor{keyword}{  }\{}
\DoxyCodeLine{676     \mbox{\hyperlink{structEigen_1_1internal_1_1conj__helper}{conj\_helper<ResPacketType,ResPacketType,ConjLhs,false>}} cj;}
\DoxyCodeLine{677     r = cj.pmadd(c,alpha,r);}
\DoxyCodeLine{678   \}}
\DoxyCodeLine{679 }
\DoxyCodeLine{680 \textcolor{keyword}{protected}:}
\DoxyCodeLine{681 \};}
\DoxyCodeLine{682 }
\DoxyCodeLine{683 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Packet>}
\DoxyCodeLine{684 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1DoublePacket}{DoublePacket}}}
\DoxyCodeLine{685 \{}
\DoxyCodeLine{686   \mbox{\hyperlink{unionEigen_1_1internal_1_1Packet}{Packet}} first;}
\DoxyCodeLine{687   \mbox{\hyperlink{unionEigen_1_1internal_1_1Packet}{Packet}} second;}
\DoxyCodeLine{688 \};}
\DoxyCodeLine{689 }
\DoxyCodeLine{690 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Packet>}
\DoxyCodeLine{691 \mbox{\hyperlink{structEigen_1_1internal_1_1DoublePacket}{DoublePacket<Packet>}} padd(\textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1internal_1_1DoublePacket}{DoublePacket<Packet>}} \&a, \textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1internal_1_1DoublePacket}{DoublePacket<Packet>}} \&b)}
\DoxyCodeLine{692 \{}
\DoxyCodeLine{693   \mbox{\hyperlink{structEigen_1_1internal_1_1DoublePacket}{DoublePacket<Packet>}} res;}
\DoxyCodeLine{694   res.first  = padd(a.first, b.first);}
\DoxyCodeLine{695   res.second = padd(a.second,b.second);}
\DoxyCodeLine{696   \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{697 \}}
\DoxyCodeLine{698 }
\DoxyCodeLine{699 \textcolor{comment}{// note that for DoublePacket<RealPacket> the "{}4"{} in "{}downto4"{}}}
\DoxyCodeLine{700 \textcolor{comment}{// corresponds to the number of complexes, so it means "{}8"{}}}
\DoxyCodeLine{701 \textcolor{comment}{// it terms of real coefficients.}}
\DoxyCodeLine{702 }
\DoxyCodeLine{703 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Packet>}
\DoxyCodeLine{704 \textcolor{keyword}{const} DoublePacket<Packet>\&}
\DoxyCodeLine{705 predux\_half\_dowto4(\textcolor{keyword}{const} DoublePacket<Packet> \&a,}
\DoxyCodeLine{706                    \textcolor{keyword}{typename} enable\_if<unpacket\_traits<Packet>::size<=8>::type* = 0)}
\DoxyCodeLine{707 \{}
\DoxyCodeLine{708   \textcolor{keywordflow}{return} a;}
\DoxyCodeLine{709 \}}
\DoxyCodeLine{710 }
\DoxyCodeLine{711 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Packet>}
\DoxyCodeLine{712 DoublePacket<typename unpacket\_traits<Packet>::half>}
\DoxyCodeLine{713 predux\_half\_dowto4(\textcolor{keyword}{const} DoublePacket<Packet> \&a,}
\DoxyCodeLine{714                    \textcolor{keyword}{typename} enable\_if<unpacket\_traits<Packet>::size==16>::type* = 0)}
\DoxyCodeLine{715 \{}
\DoxyCodeLine{716   \textcolor{comment}{// yes, that's pretty hackish :(}}
\DoxyCodeLine{717   DoublePacket<typename unpacket\_traits<Packet>::half> res;}
\DoxyCodeLine{718   \textcolor{keyword}{typedef} std::complex<typename unpacket\_traits<Packet>::type> Cplx;}
\DoxyCodeLine{719   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} packet\_traits<Cplx>::type CplxPacket;}
\DoxyCodeLine{720   res.first  = predux\_half\_dowto4(CplxPacket(a.first)).v;}
\DoxyCodeLine{721   res.second = predux\_half\_dowto4(CplxPacket(a.second)).v;}
\DoxyCodeLine{722   \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{723 \}}
\DoxyCodeLine{724 }
\DoxyCodeLine{725 \textcolor{comment}{// same here, "{}quad"{} actually means "{}8"{} in terms of real coefficients}}
\DoxyCodeLine{726 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} RealPacket>}
\DoxyCodeLine{727 \textcolor{keywordtype}{void} loadQuadToDoublePacket(\textcolor{keyword}{const} Scalar* b, DoublePacket<RealPacket>\& dest,}
\DoxyCodeLine{728                             \textcolor{keyword}{typename} enable\_if<unpacket\_traits<RealPacket>::size<=8>::type* = 0)}
\DoxyCodeLine{729 \{}
\DoxyCodeLine{730   dest.first  = pset1<RealPacket>(numext::real(*b));}
\DoxyCodeLine{731   dest.second = pset1<RealPacket>(numext::imag(*b));}
\DoxyCodeLine{732 \}}
\DoxyCodeLine{733 }
\DoxyCodeLine{734 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} RealPacket>}
\DoxyCodeLine{735 \textcolor{keywordtype}{void} loadQuadToDoublePacket(\textcolor{keyword}{const} Scalar* b, DoublePacket<RealPacket>\& dest,}
\DoxyCodeLine{736                             \textcolor{keyword}{typename} enable\_if<unpacket\_traits<RealPacket>::size==16>::type* = 0)}
\DoxyCodeLine{737 \{}
\DoxyCodeLine{738   \textcolor{comment}{// yes, that's pretty hackish too :(}}
\DoxyCodeLine{739   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} NumTraits<Scalar>::Real RealScalar;}
\DoxyCodeLine{740   RealScalar r[4] = \{numext::real(b[0]), numext::real(b[0]), numext::real(b[1]), numext::real(b[1])\};}
\DoxyCodeLine{741   RealScalar i[4] = \{numext::imag(b[0]), numext::imag(b[0]), numext::imag(b[1]), numext::imag(b[1])\};}
\DoxyCodeLine{742   dest.first  = ploadquad<RealPacket>(r);}
\DoxyCodeLine{743   dest.second = ploadquad<RealPacket>(i);}
\DoxyCodeLine{744 \}}
\DoxyCodeLine{745 }
\DoxyCodeLine{746 }
\DoxyCodeLine{747 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Packet> \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits}}<\mbox{\hyperlink{structEigen_1_1internal_1_1DoublePacket}{DoublePacket}}<\mbox{\hyperlink{unionEigen_1_1internal_1_1Packet}{Packet}}> > \{}
\DoxyCodeLine{748   \textcolor{keyword}{typedef} \mbox{\hyperlink{structEigen_1_1internal_1_1DoublePacket}{DoublePacket<typename unpacket\_traits<Packet>::half}}> \mbox{\hyperlink{structEigen_1_1internal_1_1DoublePacket}{half}};}
\DoxyCodeLine{749 \};}
\DoxyCodeLine{750 \textcolor{comment}{// template<typename Packet>}}
\DoxyCodeLine{751 \textcolor{comment}{// DoublePacket<Packet> pmadd(const DoublePacket<Packet> \&a, const DoublePacket<Packet> \&b)}}
\DoxyCodeLine{752 \textcolor{comment}{// \{}}
\DoxyCodeLine{753 \textcolor{comment}{//   DoublePacket<Packet> res;}}
\DoxyCodeLine{754 \textcolor{comment}{//   res.first  = padd(a.first, b.first);}}
\DoxyCodeLine{755 \textcolor{comment}{//   res.second = padd(a.second,b.second);}}
\DoxyCodeLine{756 \textcolor{comment}{//   return res;}}
\DoxyCodeLine{757 \textcolor{comment}{// \}}}
\DoxyCodeLine{758 }
\DoxyCodeLine{759 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealScalar, \textcolor{keywordtype}{bool} ConjLhs\_, \textcolor{keywordtype}{bool} ConjRhs\_, \textcolor{keywordtype}{int} Arch, \textcolor{keywordtype}{int} PacketSize\_>}
\DoxyCodeLine{760 \textcolor{keyword}{class }\mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{gebp\_traits}}<std::complex<RealScalar>, std::complex<RealScalar>, ConjLhs\_, ConjRhs\_, Arch, PacketSize\_ >}
\DoxyCodeLine{761 \{}
\DoxyCodeLine{762 \textcolor{keyword}{public}:}
\DoxyCodeLine{763   \textcolor{keyword}{typedef} std::complex<RealScalar>  Scalar;}
\DoxyCodeLine{764   \textcolor{keyword}{typedef} std::complex<RealScalar>  LhsScalar;}
\DoxyCodeLine{765   \textcolor{keyword}{typedef} std::complex<RealScalar>  RhsScalar;}
\DoxyCodeLine{766   \textcolor{keyword}{typedef} std::complex<RealScalar>  ResScalar;}
\DoxyCodeLine{767   }
\DoxyCodeLine{768   PACKET\_DECL\_COND\_PREFIX(\_, Lhs, PacketSize\_);}
\DoxyCodeLine{769   PACKET\_DECL\_COND\_PREFIX(\_, Rhs, PacketSize\_);}
\DoxyCodeLine{770   PACKET\_DECL\_COND\_PREFIX(\_, Res, PacketSize\_);}
\DoxyCodeLine{771   PACKET\_DECL\_COND(Real, PacketSize\_);}
\DoxyCodeLine{772   PACKET\_DECL\_COND\_SCALAR(PacketSize\_);}
\DoxyCodeLine{773 }
\DoxyCodeLine{774   \textcolor{keyword}{enum} \{}
\DoxyCodeLine{775     ConjLhs = ConjLhs\_,}
\DoxyCodeLine{776     ConjRhs = ConjRhs\_,}
\DoxyCodeLine{777     Vectorizable = \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<RealPacket>::vectorizable}}}
\DoxyCodeLine{778                 \&\& \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<ScalarPacket>::vectorizable}},}
\DoxyCodeLine{779     ResPacketSize   = Vectorizable ? \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_ResPacket>::size}} : 1,}
\DoxyCodeLine{780     LhsPacketSize = Vectorizable ? \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_LhsPacket>::size}} : 1,}
\DoxyCodeLine{781     RhsPacketSize = Vectorizable ? \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<RhsScalar>::size}} : 1,}
\DoxyCodeLine{782     RealPacketSize  = Vectorizable ? \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<RealPacket>::size}} : 1,}
\DoxyCodeLine{783 }
\DoxyCodeLine{784     \textcolor{comment}{// FIXME: should depend on NumberOfRegisters}}
\DoxyCodeLine{785     nr = 4,}
\DoxyCodeLine{786     mr = ResPacketSize,}
\DoxyCodeLine{787 }
\DoxyCodeLine{788     LhsProgress = ResPacketSize,}
\DoxyCodeLine{789     RhsProgress = 1}
\DoxyCodeLine{790   \};}
\DoxyCodeLine{791   }
\DoxyCodeLine{792   \textcolor{keyword}{typedef} \mbox{\hyperlink{structEigen_1_1internal_1_1DoublePacket}{DoublePacket<RealPacket>}}                 \mbox{\hyperlink{structEigen_1_1internal_1_1DoublePacket}{DoublePacketType}};}
\DoxyCodeLine{793 }
\DoxyCodeLine{794   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{conditional<Vectorizable,ScalarPacket,Scalar>::type}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacket4Packing}};}
\DoxyCodeLine{795   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{conditional<Vectorizable,RealPacket,  Scalar>::type}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacket}};}
\DoxyCodeLine{796   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{conditional<Vectorizable,DoublePacketType,Scalar>::type}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacket}};}
\DoxyCodeLine{797   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{conditional<Vectorizable,ScalarPacket,Scalar>::type}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ResPacket}};}
\DoxyCodeLine{798   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{conditional<Vectorizable,DoublePacketType,Scalar>::type}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{AccPacket}};}
\DoxyCodeLine{799 }
\DoxyCodeLine{800   \textcolor{comment}{// this actually holds 8 packets!}}
\DoxyCodeLine{801   \textcolor{keyword}{typedef} \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{QuadPacket<RhsPacket>}} \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{RhsPacketx4}};}
\DoxyCodeLine{802   }
\DoxyCodeLine{803   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} initAcc(Scalar\& p) \{ p = Scalar(0); \}}
\DoxyCodeLine{804 }
\DoxyCodeLine{805   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} initAcc(\mbox{\hyperlink{structEigen_1_1internal_1_1DoublePacket}{DoublePacketType}}\& p)}
\DoxyCodeLine{806   \{}
\DoxyCodeLine{807     p.first   = pset1<RealPacket>(RealScalar(0));}
\DoxyCodeLine{808     p.second  = pset1<RealPacket>(RealScalar(0));}
\DoxyCodeLine{809   \}}
\DoxyCodeLine{810 }
\DoxyCodeLine{811   \textcolor{comment}{// Scalar path}}
\DoxyCodeLine{812   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadRhs(\textcolor{keyword}{const} RhsScalar* b, ScalarPacket\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{813 \textcolor{keyword}{  }\{}
\DoxyCodeLine{814     dest = pset1<ScalarPacket>(*b);}
\DoxyCodeLine{815   \}}
\DoxyCodeLine{816 }
\DoxyCodeLine{817   \textcolor{comment}{// Vectorized path}}
\DoxyCodeLine{818   \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealPacketType>}
\DoxyCodeLine{819   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadRhs(\textcolor{keyword}{const} RhsScalar* b, \mbox{\hyperlink{structEigen_1_1internal_1_1DoublePacket}{DoublePacket<RealPacketType>}}\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{820 \textcolor{keyword}{  }\{}
\DoxyCodeLine{821     dest.first  = pset1<RealPacketType>(numext::real(*b));}
\DoxyCodeLine{822     dest.second = pset1<RealPacketType>(numext::imag(*b));}
\DoxyCodeLine{823   \}}
\DoxyCodeLine{824 }
\DoxyCodeLine{825   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadRhs(\textcolor{keyword}{const} RhsScalar* b, \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{RhsPacketx4}}\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{826 \textcolor{keyword}{  }\{}
\DoxyCodeLine{827     loadRhs(b, dest.B\_0);}
\DoxyCodeLine{828     loadRhs(b + 1, dest.B1);}
\DoxyCodeLine{829     loadRhs(b + 2, dest.B2);}
\DoxyCodeLine{830     loadRhs(b + 3, dest.B3);}
\DoxyCodeLine{831   \}}
\DoxyCodeLine{832 }
\DoxyCodeLine{833   \textcolor{comment}{// Scalar path}}
\DoxyCodeLine{834   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} updateRhs(\textcolor{keyword}{const} RhsScalar* b, ScalarPacket\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{835 \textcolor{keyword}{  }\{}
\DoxyCodeLine{836     loadRhs(b, dest);}
\DoxyCodeLine{837   \}}
\DoxyCodeLine{838 }
\DoxyCodeLine{839   \textcolor{comment}{// Vectorized path}}
\DoxyCodeLine{840   \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealPacketType>}
\DoxyCodeLine{841   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} updateRhs(\textcolor{keyword}{const} RhsScalar* b, \mbox{\hyperlink{structEigen_1_1internal_1_1DoublePacket}{DoublePacket<RealPacketType>}}\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{842 \textcolor{keyword}{  }\{}
\DoxyCodeLine{843     loadRhs(b, dest);}
\DoxyCodeLine{844   \}}
\DoxyCodeLine{845 }
\DoxyCodeLine{846   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} updateRhs(\textcolor{keyword}{const} RhsScalar*, \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{RhsPacketx4}}\&)\textcolor{keyword}{ const }\{\}}
\DoxyCodeLine{847   }
\DoxyCodeLine{848   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadRhsQuad(\textcolor{keyword}{const} RhsScalar* b, \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ResPacket}}\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{849 \textcolor{keyword}{  }\{}
\DoxyCodeLine{850     loadRhs(b,dest);}
\DoxyCodeLine{851   \}}
\DoxyCodeLine{852   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadRhsQuad(\textcolor{keyword}{const} RhsScalar* b, \mbox{\hyperlink{structEigen_1_1internal_1_1DoublePacket}{DoublePacketType}}\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{853 \textcolor{keyword}{  }\{}
\DoxyCodeLine{854     loadQuadToDoublePacket(b,dest);}
\DoxyCodeLine{855   \}}
\DoxyCodeLine{856 }
\DoxyCodeLine{857   \textcolor{comment}{// nothing special here}}
\DoxyCodeLine{858   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadLhs(\textcolor{keyword}{const} LhsScalar* a, \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacket}}\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{859 \textcolor{keyword}{  }\{}
\DoxyCodeLine{860     dest = pload<LhsPacket>((\textcolor{keyword}{const} \textcolor{keyword}{typename} \mbox{\hyperlink{unionEigen_1_1internal_1_1Packet}{unpacket\_traits<LhsPacket>::type}}*)(a));}
\DoxyCodeLine{861   \}}
\DoxyCodeLine{862 }
\DoxyCodeLine{863   \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsPacketType>}
\DoxyCodeLine{864   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadLhsUnaligned(\textcolor{keyword}{const} LhsScalar* a, LhsPacketType\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{865 \textcolor{keyword}{  }\{}
\DoxyCodeLine{866     dest = ploadu<LhsPacketType>((\textcolor{keyword}{const} \textcolor{keyword}{typename} \mbox{\hyperlink{unionEigen_1_1internal_1_1Packet}{unpacket\_traits<LhsPacketType>::type}}*)(a));}
\DoxyCodeLine{867   \}}
\DoxyCodeLine{868 }
\DoxyCodeLine{869   \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsPacketType, \textcolor{keyword}{typename} RhsPacketType, \textcolor{keyword}{typename} ResPacketType, \textcolor{keyword}{typename} TmpType, \textcolor{keyword}{typename} LaneIdType>}
\DoxyCodeLine{870   EIGEN\_STRONG\_INLINE}
\DoxyCodeLine{871   \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1enable__if}{enable\_if<!is\_same<RhsPacketType,RhsPacketx4>::value}}>::type}
\DoxyCodeLine{872   madd(\textcolor{keyword}{const} LhsPacketType\& a, \textcolor{keyword}{const} RhsPacketType\& b, \mbox{\hyperlink{structEigen_1_1internal_1_1DoublePacket}{DoublePacket<ResPacketType>}}\& c, TmpType\& \textcolor{comment}{/*tmp*/}, \textcolor{keyword}{const} LaneIdType\&)\textcolor{keyword}{ const}}
\DoxyCodeLine{873 \textcolor{keyword}{  }\{}
\DoxyCodeLine{874     c.first   = padd(pmul(a,b.first), c.first);}
\DoxyCodeLine{875     c.second  = padd(pmul(a,b.second),c.second);}
\DoxyCodeLine{876   \}}
\DoxyCodeLine{877 }
\DoxyCodeLine{878   \textcolor{keyword}{template}<\textcolor{keyword}{typename} LaneIdType>}
\DoxyCodeLine{879   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} madd(\textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacket}}\& a, \textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacket}}\& b, \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ResPacket}}\& c, \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacket}}\& \textcolor{comment}{/*tmp*/}, \textcolor{keyword}{const} LaneIdType\&)\textcolor{keyword}{ const}}
\DoxyCodeLine{880 \textcolor{keyword}{  }\{}
\DoxyCodeLine{881     c = cj.pmadd(a,b,c);}
\DoxyCodeLine{882   \}}
\DoxyCodeLine{883 }
\DoxyCodeLine{884   \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsPacketType, \textcolor{keyword}{typename} AccPacketType, \textcolor{keyword}{typename} LaneIdType>}
\DoxyCodeLine{885   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} madd(\textcolor{keyword}{const} LhsPacketType\& a, \textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{RhsPacketx4}}\& b, AccPacketType\& c, \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacket}}\& tmp, \textcolor{keyword}{const} LaneIdType\& lane)\textcolor{keyword}{ const}}
\DoxyCodeLine{886 \textcolor{keyword}{  }\{}
\DoxyCodeLine{887     madd(a, b.get(lane), c, tmp, lane);}
\DoxyCodeLine{888   \}}
\DoxyCodeLine{889   }
\DoxyCodeLine{890   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} acc(\textcolor{keyword}{const} Scalar\& c, \textcolor{keyword}{const} Scalar\& alpha, Scalar\& r)\textcolor{keyword}{ const }\{ r += alpha * c; \}}
\DoxyCodeLine{891   }
\DoxyCodeLine{892   \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealPacketType, \textcolor{keyword}{typename} ResPacketType>}
\DoxyCodeLine{893   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} acc(\textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1internal_1_1DoublePacket}{DoublePacket<RealPacketType>}}\& c, \textcolor{keyword}{const} ResPacketType\& alpha, ResPacketType\& r)\textcolor{keyword}{ const}}
\DoxyCodeLine{894 \textcolor{keyword}{  }\{}
\DoxyCodeLine{895     \textcolor{comment}{// assemble c}}
\DoxyCodeLine{896     ResPacketType tmp;}
\DoxyCodeLine{897     \textcolor{keywordflow}{if}((!ConjLhs)\&\&(!ConjRhs))}
\DoxyCodeLine{898     \{}
\DoxyCodeLine{899       tmp = pcplxflip(pconj(ResPacketType(c.second)));}
\DoxyCodeLine{900       tmp = padd(ResPacketType(c.first),tmp);}
\DoxyCodeLine{901     \}}
\DoxyCodeLine{902     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((!ConjLhs)\&\&(ConjRhs))}
\DoxyCodeLine{903     \{}
\DoxyCodeLine{904       tmp = pconj(pcplxflip(ResPacketType(c.second)));}
\DoxyCodeLine{905       tmp = padd(ResPacketType(c.first),tmp);}
\DoxyCodeLine{906     \}}
\DoxyCodeLine{907     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((ConjLhs)\&\&(!ConjRhs))}
\DoxyCodeLine{908     \{}
\DoxyCodeLine{909       tmp = pcplxflip(ResPacketType(c.second));}
\DoxyCodeLine{910       tmp = padd(pconj(ResPacketType(c.first)),tmp);}
\DoxyCodeLine{911     \}}
\DoxyCodeLine{912     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((ConjLhs)\&\&(ConjRhs))}
\DoxyCodeLine{913     \{}
\DoxyCodeLine{914       tmp = pcplxflip(ResPacketType(c.second));}
\DoxyCodeLine{915       tmp = psub(pconj(ResPacketType(c.first)),tmp);}
\DoxyCodeLine{916     \}}
\DoxyCodeLine{917     }
\DoxyCodeLine{918     r = pmadd(tmp,alpha,r);}
\DoxyCodeLine{919   \}}
\DoxyCodeLine{920 }
\DoxyCodeLine{921 \textcolor{keyword}{protected}:}
\DoxyCodeLine{922   \mbox{\hyperlink{structEigen_1_1internal_1_1conj__helper}{conj\_helper<LhsScalar,RhsScalar,ConjLhs,ConjRhs>}} cj;}
\DoxyCodeLine{923 \};}
\DoxyCodeLine{924 }
\DoxyCodeLine{925 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealScalar, \textcolor{keywordtype}{bool} ConjRhs\_, \textcolor{keywordtype}{int} Arch, \textcolor{keywordtype}{int} PacketSize\_>}
\DoxyCodeLine{926 \textcolor{keyword}{class }\mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{gebp\_traits}}<RealScalar, std::complex<RealScalar>, false, ConjRhs\_, Arch, PacketSize\_ >}
\DoxyCodeLine{927 \{}
\DoxyCodeLine{928 \textcolor{keyword}{public}:}
\DoxyCodeLine{929   \textcolor{keyword}{typedef} std::complex<RealScalar>  Scalar;}
\DoxyCodeLine{930   \textcolor{keyword}{typedef} RealScalar  LhsScalar;}
\DoxyCodeLine{931   \textcolor{keyword}{typedef} Scalar      RhsScalar;}
\DoxyCodeLine{932   \textcolor{keyword}{typedef} Scalar      ResScalar;}
\DoxyCodeLine{933 }
\DoxyCodeLine{934   PACKET\_DECL\_COND\_PREFIX(\_, Lhs, PacketSize\_);}
\DoxyCodeLine{935   PACKET\_DECL\_COND\_PREFIX(\_, Rhs, PacketSize\_);}
\DoxyCodeLine{936   PACKET\_DECL\_COND\_PREFIX(\_, Res, PacketSize\_);}
\DoxyCodeLine{937   PACKET\_DECL\_COND\_PREFIX(\_, Real, PacketSize\_);}
\DoxyCodeLine{938   PACKET\_DECL\_COND\_SCALAR\_PREFIX(\_, PacketSize\_);}
\DoxyCodeLine{939 }
\DoxyCodeLine{940 \textcolor{preprocessor}{\#undef PACKET\_DECL\_COND\_SCALAR\_PREFIX}}
\DoxyCodeLine{941 \textcolor{preprocessor}{\#undef PACKET\_DECL\_COND\_PREFIX}}
\DoxyCodeLine{942 \textcolor{preprocessor}{\#undef PACKET\_DECL\_COND\_SCALAR}}
\DoxyCodeLine{943 \textcolor{preprocessor}{\#undef PACKET\_DECL\_COND}}
\DoxyCodeLine{944 }
\DoxyCodeLine{945   \textcolor{keyword}{enum} \{}
\DoxyCodeLine{946     ConjLhs = \textcolor{keyword}{false},}
\DoxyCodeLine{947     ConjRhs = ConjRhs\_,}
\DoxyCodeLine{948     Vectorizable = \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_RealPacket>::vectorizable}}}
\DoxyCodeLine{949                 \&\& \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_ScalarPacket>::vectorizable}},}
\DoxyCodeLine{950     LhsPacketSize = Vectorizable ? \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_LhsPacket>::size}} : 1,}
\DoxyCodeLine{951     RhsPacketSize = Vectorizable ? \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_RhsPacket>::size}} : 1,}
\DoxyCodeLine{952     ResPacketSize = Vectorizable ? \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_ResPacket>::size}} : 1,}
\DoxyCodeLine{953     }
\DoxyCodeLine{954     NumberOfRegisters = EIGEN\_ARCH\_DEFAULT\_NUMBER\_OF\_REGISTERS,}
\DoxyCodeLine{955     \textcolor{comment}{// FIXME: should depend on NumberOfRegisters}}
\DoxyCodeLine{956     nr = 4,}
\DoxyCodeLine{957     mr = (EIGEN\_PLAIN\_ENUM\_MIN(16,NumberOfRegisters)/2/nr)*ResPacketSize,}
\DoxyCodeLine{958 }
\DoxyCodeLine{959     LhsProgress = ResPacketSize,}
\DoxyCodeLine{960     RhsProgress = 1}
\DoxyCodeLine{961   \};}
\DoxyCodeLine{962 }
\DoxyCodeLine{963   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{conditional<Vectorizable,\_LhsPacket,LhsScalar>::type}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacket}};}
\DoxyCodeLine{964   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{conditional<Vectorizable,\_RhsPacket,RhsScalar>::type}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacket}};}
\DoxyCodeLine{965   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{conditional<Vectorizable,\_ResPacket,ResScalar>::type}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ResPacket}};}
\DoxyCodeLine{966   \textcolor{keyword}{typedef} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacket4Packing}};}
\DoxyCodeLine{967   \textcolor{keyword}{typedef} \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{QuadPacket<RhsPacket>}} \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{RhsPacketx4}};}
\DoxyCodeLine{968   \textcolor{keyword}{typedef} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ResPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{AccPacket}};}
\DoxyCodeLine{969 }
\DoxyCodeLine{970   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} initAcc(\mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{AccPacket}}\& p)}
\DoxyCodeLine{971   \{}
\DoxyCodeLine{972     p = pset1<ResPacket>(ResScalar(0));}
\DoxyCodeLine{973   \}}
\DoxyCodeLine{974 }
\DoxyCodeLine{975   \textcolor{keyword}{template}<\textcolor{keyword}{typename} RhsPacketType>}
\DoxyCodeLine{976   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadRhs(\textcolor{keyword}{const} RhsScalar* b, RhsPacketType\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{977 \textcolor{keyword}{  }\{}
\DoxyCodeLine{978     dest = pset1<RhsPacketType>(*b);}
\DoxyCodeLine{979   \}}
\DoxyCodeLine{980 }
\DoxyCodeLine{981   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadRhs(\textcolor{keyword}{const} RhsScalar* b, \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{RhsPacketx4}}\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{982 \textcolor{keyword}{  }\{}
\DoxyCodeLine{983     pbroadcast4(b, dest.B\_0, dest.B1, dest.B2, dest.B3);}
\DoxyCodeLine{984   \}}
\DoxyCodeLine{985 }
\DoxyCodeLine{986   \textcolor{keyword}{template}<\textcolor{keyword}{typename} RhsPacketType>}
\DoxyCodeLine{987   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} updateRhs(\textcolor{keyword}{const} RhsScalar* b, RhsPacketType\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{988 \textcolor{keyword}{  }\{}
\DoxyCodeLine{989     loadRhs(b, dest);}
\DoxyCodeLine{990   \}}
\DoxyCodeLine{991 }
\DoxyCodeLine{992   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} updateRhs(\textcolor{keyword}{const} RhsScalar*, \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{RhsPacketx4}}\&)\textcolor{keyword}{ const}}
\DoxyCodeLine{993 \textcolor{keyword}{  }\{\}}
\DoxyCodeLine{994 }
\DoxyCodeLine{995   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadLhs(\textcolor{keyword}{const} LhsScalar* a, \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacket}}\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{996 \textcolor{keyword}{  }\{}
\DoxyCodeLine{997     dest = ploaddup<LhsPacket>(a);}
\DoxyCodeLine{998   \}}
\DoxyCodeLine{999   }
\DoxyCodeLine{1000   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadRhsQuad(\textcolor{keyword}{const} RhsScalar* b, \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacket}}\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{1001 \textcolor{keyword}{  }\{}
\DoxyCodeLine{1002     dest = ploadquad<RhsPacket>(b);}
\DoxyCodeLine{1003   \}}
\DoxyCodeLine{1004 }
\DoxyCodeLine{1005   \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsPacketType>}
\DoxyCodeLine{1006   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} loadLhsUnaligned(\textcolor{keyword}{const} LhsScalar* a, LhsPacketType\& dest)\textcolor{keyword}{ const}}
\DoxyCodeLine{1007 \textcolor{keyword}{  }\{}
\DoxyCodeLine{1008     dest = ploaddup<LhsPacketType>(a);}
\DoxyCodeLine{1009   \}}
\DoxyCodeLine{1010 }
\DoxyCodeLine{1011   \textcolor{keyword}{template} <\textcolor{keyword}{typename} LhsPacketType, \textcolor{keyword}{typename} RhsPacketType, \textcolor{keyword}{typename} AccPacketType, \textcolor{keyword}{typename} LaneIdType>}
\DoxyCodeLine{1012   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} madd(\textcolor{keyword}{const} LhsPacketType\& a, \textcolor{keyword}{const} RhsPacketType\& b, AccPacketType\& c, RhsPacketType\& tmp, \textcolor{keyword}{const} LaneIdType\&)\textcolor{keyword}{ const}}
\DoxyCodeLine{1013 \textcolor{keyword}{  }\{}
\DoxyCodeLine{1014     madd\_impl(a, b, c, tmp, \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{conditional<Vectorizable,true\_type,false\_type>::type}}());}
\DoxyCodeLine{1015   \}}
\DoxyCodeLine{1016 }
\DoxyCodeLine{1017   \textcolor{keyword}{template} <\textcolor{keyword}{typename} LhsPacketType, \textcolor{keyword}{typename} RhsPacketType, \textcolor{keyword}{typename} AccPacketType>}
\DoxyCodeLine{1018   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} madd\_impl(\textcolor{keyword}{const} LhsPacketType\& a, \textcolor{keyword}{const} RhsPacketType\& b, AccPacketType\& c, RhsPacketType\& tmp, \textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{true\_type}}\&)\textcolor{keyword}{ const}}
\DoxyCodeLine{1019 \textcolor{keyword}{  }\{}
\DoxyCodeLine{1020 \textcolor{preprocessor}{\#ifdef EIGEN\_HAS\_SINGLE\_INSTRUCTION\_MADD}}
\DoxyCodeLine{1021     EIGEN\_UNUSED\_VARIABLE(tmp);}
\DoxyCodeLine{1022     c.v = pmadd(a,b.v,c.v);}
\DoxyCodeLine{1023 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1024     tmp = b; tmp.v = pmul(a,tmp.v); c = padd(c,tmp);}
\DoxyCodeLine{1025 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1026     }
\DoxyCodeLine{1027   \}}
\DoxyCodeLine{1028 }
\DoxyCodeLine{1029   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} madd\_impl(\textcolor{keyword}{const} LhsScalar\& a, \textcolor{keyword}{const} RhsScalar\& b, ResScalar\& c, RhsScalar\& \textcolor{comment}{/*tmp*/}, \textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1internal_1_1false__type}{false\_type}}\&)\textcolor{keyword}{ const}}
\DoxyCodeLine{1030 \textcolor{keyword}{  }\{}
\DoxyCodeLine{1031     c += a * b;}
\DoxyCodeLine{1032   \}}
\DoxyCodeLine{1033 }
\DoxyCodeLine{1034   \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsPacketType, \textcolor{keyword}{typename} AccPacketType, \textcolor{keyword}{typename} LaneIdType>}
\DoxyCodeLine{1035   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} madd(\textcolor{keyword}{const} LhsPacketType\& a, \textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{RhsPacketx4}}\& b, AccPacketType\& c, \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacket}}\& tmp, \textcolor{keyword}{const} LaneIdType\& lane)\textcolor{keyword}{ const}}
\DoxyCodeLine{1036 \textcolor{keyword}{  }\{}
\DoxyCodeLine{1037     madd(a, b.get(lane), c, tmp, lane);}
\DoxyCodeLine{1038   \}}
\DoxyCodeLine{1039 }
\DoxyCodeLine{1040   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ResPacketType, \textcolor{keyword}{typename} AccPacketType>}
\DoxyCodeLine{1041   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} acc(\textcolor{keyword}{const} AccPacketType\& c, \textcolor{keyword}{const} ResPacketType\& alpha, ResPacketType\& r)\textcolor{keyword}{ const}}
\DoxyCodeLine{1042 \textcolor{keyword}{  }\{}
\DoxyCodeLine{1043     \mbox{\hyperlink{structEigen_1_1internal_1_1conj__helper}{conj\_helper<ResPacketType,ResPacketType,false,ConjRhs>}} cj;}
\DoxyCodeLine{1044     r = cj.pmadd(alpha,c,r);}
\DoxyCodeLine{1045   \}}
\DoxyCodeLine{1046 }
\DoxyCodeLine{1047 \textcolor{keyword}{protected}:}
\DoxyCodeLine{1048 }
\DoxyCodeLine{1049 \};}
\DoxyCodeLine{1050 }
\DoxyCodeLine{1051 \textcolor{comment}{/* optimized General packed Block * packed Panel product kernel}}
\DoxyCodeLine{1052 \textcolor{comment}{ *}}
\DoxyCodeLine{1053 \textcolor{comment}{ * Mixing type logic: C += A * B}}
\DoxyCodeLine{1054 \textcolor{comment}{ *  |  A  |  B  | comments}}
\DoxyCodeLine{1055 \textcolor{comment}{ *  |real |cplx | no vectorization yet, would require to pack A with duplication}}
\DoxyCodeLine{1056 \textcolor{comment}{ *  |cplx |real | easy vectorization}}
\DoxyCodeLine{1057 \textcolor{comment}{ */}}
\DoxyCodeLine{1058 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsScalar, \textcolor{keyword}{typename} RhsScalar, \textcolor{keyword}{typename} Index, \textcolor{keyword}{typename} DataMapper, \textcolor{keywordtype}{int} mr, \textcolor{keywordtype}{int} nr, \textcolor{keywordtype}{bool} ConjugateLhs, \textcolor{keywordtype}{bool} ConjugateRhs>}
\DoxyCodeLine{1059 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1gebp__kernel}{gebp\_kernel}}}
\DoxyCodeLine{1060 \{}
\DoxyCodeLine{1061   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{gebp\_traits<LhsScalar,RhsScalar,ConjugateLhs,ConjugateRhs,Architecture::Target>}} \mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{Traits}};}
\DoxyCodeLine{1062   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{gebp\_traits<LhsScalar,RhsScalar,ConjugateLhs,ConjugateRhs,Architecture::Target,GEBPPacketHalf>}} \mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{HalfTraits}};}
\DoxyCodeLine{1063   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{gebp\_traits<LhsScalar,RhsScalar,ConjugateLhs,ConjugateRhs,Architecture::Target,GEBPPacketQuarter>}} \mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{QuarterTraits}};}
\DoxyCodeLine{1064   }
\DoxyCodeLine{1065   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} Traits::ResScalar ResScalar;}
\DoxyCodeLine{1066   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{Traits::LhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacket}};}
\DoxyCodeLine{1067   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{Traits::RhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacket}};}
\DoxyCodeLine{1068   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{Traits::ResPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ResPacket}};}
\DoxyCodeLine{1069   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{Traits::AccPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{AccPacket}};}
\DoxyCodeLine{1070   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{Traits::RhsPacketx4}} \mbox{\hyperlink{structEigen_1_1internal_1_1QuadPacket}{RhsPacketx4}};}
\DoxyCodeLine{1071 }
\DoxyCodeLine{1072   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} RhsPanelHelper<RhsPacket, RhsPacketx4, 15>::type RhsPanel15;}
\DoxyCodeLine{1073 }
\DoxyCodeLine{1074   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{gebp\_traits<RhsScalar,LhsScalar,ConjugateRhs,ConjugateLhs,Architecture::Target>}} \mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{SwappedTraits}};}
\DoxyCodeLine{1075 }
\DoxyCodeLine{1076   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} SwappedTraits::ResScalar SResScalar;}
\DoxyCodeLine{1077   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SwappedTraits::LhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SLhsPacket}};}
\DoxyCodeLine{1078   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SwappedTraits::RhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SRhsPacket}};}
\DoxyCodeLine{1079   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SwappedTraits::ResPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SResPacket}};}
\DoxyCodeLine{1080   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SwappedTraits::AccPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SAccPacket}};}
\DoxyCodeLine{1081 }
\DoxyCodeLine{1082   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{HalfTraits::LhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacketHalf}};}
\DoxyCodeLine{1083   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{HalfTraits::RhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacketHalf}};}
\DoxyCodeLine{1084   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{HalfTraits::ResPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ResPacketHalf}};}
\DoxyCodeLine{1085   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{HalfTraits::AccPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{AccPacketHalf}};}
\DoxyCodeLine{1086 }
\DoxyCodeLine{1087   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{QuarterTraits::LhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacketQuarter}};}
\DoxyCodeLine{1088   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{QuarterTraits::RhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacketQuarter}};}
\DoxyCodeLine{1089   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{QuarterTraits::ResPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ResPacketQuarter}};}
\DoxyCodeLine{1090   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{QuarterTraits::AccPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{AccPacketQuarter}};}
\DoxyCodeLine{1091 }
\DoxyCodeLine{1092   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} DataMapper::LinearMapper LinearMapper;}
\DoxyCodeLine{1093 }
\DoxyCodeLine{1094   \textcolor{keyword}{enum} \{}
\DoxyCodeLine{1095     Vectorizable  = Traits::Vectorizable,}
\DoxyCodeLine{1096     LhsProgress   = Traits::LhsProgress,}
\DoxyCodeLine{1097     LhsProgressHalf      = HalfTraits::LhsProgress,}
\DoxyCodeLine{1098     LhsProgressQuarter   = QuarterTraits::LhsProgress,}
\DoxyCodeLine{1099     RhsProgress   = Traits::RhsProgress,}
\DoxyCodeLine{1100     RhsProgressHalf      = HalfTraits::RhsProgress,}
\DoxyCodeLine{1101     RhsProgressQuarter   = QuarterTraits::RhsProgress,}
\DoxyCodeLine{1102     ResPacketSize = Traits::ResPacketSize}
\DoxyCodeLine{1103   \};}
\DoxyCodeLine{1104 }
\DoxyCodeLine{1105   EIGEN\_DONT\_INLINE}
\DoxyCodeLine{1106   \textcolor{keywordtype}{void} operator()(\textcolor{keyword}{const} DataMapper\& res, \textcolor{keyword}{const} LhsScalar* blockA, \textcolor{keyword}{const} RhsScalar* blockB,}
\DoxyCodeLine{1107                   \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} rows, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} depth, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} cols, ResScalar alpha,}
\DoxyCodeLine{1108                   \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} strideA=-\/1, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} strideB=-\/1, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} offsetA=0, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} offsetB=0);}
\DoxyCodeLine{1109 \};}
\DoxyCodeLine{1110 }
\DoxyCodeLine{1111 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsScalar, \textcolor{keyword}{typename} RhsScalar, \textcolor{keyword}{typename} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}, \textcolor{keyword}{typename} DataMapper, \textcolor{keywordtype}{int} mr, \textcolor{keywordtype}{int} nr, \textcolor{keywordtype}{bool} ConjugateLhs, \textcolor{keywordtype}{bool} ConjugateRhs,}
\DoxyCodeLine{1112 \textcolor{keywordtype}{int} SwappedLhsProgress = \mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{gebp\_traits<RhsScalar,LhsScalar,ConjugateRhs,ConjugateLhs,Architecture::Target>::LhsProgress}}>}
\DoxyCodeLine{1113 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1last__row__process__16__packets}{last\_row\_process\_16\_packets}}}
\DoxyCodeLine{1114 \{}
\DoxyCodeLine{1115   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{gebp\_traits<LhsScalar,RhsScalar,ConjugateLhs,ConjugateRhs,Architecture::Target>}} \mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{Traits}};}
\DoxyCodeLine{1116   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{gebp\_traits<RhsScalar,LhsScalar,ConjugateRhs,ConjugateLhs,Architecture::Target>}} \mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{SwappedTraits}};}
\DoxyCodeLine{1117 }
\DoxyCodeLine{1118   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} Traits::ResScalar ResScalar;}
\DoxyCodeLine{1119   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SwappedTraits::LhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SLhsPacket}};}
\DoxyCodeLine{1120   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SwappedTraits::RhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SRhsPacket}};}
\DoxyCodeLine{1121   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SwappedTraits::ResPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SResPacket}};}
\DoxyCodeLine{1122   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SwappedTraits::AccPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SAccPacket}};}
\DoxyCodeLine{1123 }
\DoxyCodeLine{1124   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} operator()(\textcolor{keyword}{const} DataMapper\& res, \mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{SwappedTraits}} \&straits, \textcolor{keyword}{const} LhsScalar* blA,}
\DoxyCodeLine{1125                   \textcolor{keyword}{const} RhsScalar* blB, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} depth, \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} endk, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} i, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j2,}
\DoxyCodeLine{1126                   ResScalar alpha, \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SAccPacket}} \&C0)}
\DoxyCodeLine{1127     \{}
\DoxyCodeLine{1128       EIGEN\_UNUSED\_VARIABLE(res);}
\DoxyCodeLine{1129       EIGEN\_UNUSED\_VARIABLE(straits);}
\DoxyCodeLine{1130       EIGEN\_UNUSED\_VARIABLE(blA);}
\DoxyCodeLine{1131       EIGEN\_UNUSED\_VARIABLE(blB);}
\DoxyCodeLine{1132       EIGEN\_UNUSED\_VARIABLE(depth);}
\DoxyCodeLine{1133       EIGEN\_UNUSED\_VARIABLE(endk);}
\DoxyCodeLine{1134       EIGEN\_UNUSED\_VARIABLE(i);}
\DoxyCodeLine{1135       EIGEN\_UNUSED\_VARIABLE(j2);}
\DoxyCodeLine{1136       EIGEN\_UNUSED\_VARIABLE(alpha);}
\DoxyCodeLine{1137       EIGEN\_UNUSED\_VARIABLE(C0);}
\DoxyCodeLine{1138     \}}
\DoxyCodeLine{1139 \};}
\DoxyCodeLine{1140 }
\DoxyCodeLine{1141 }
\DoxyCodeLine{1142 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsScalar, \textcolor{keyword}{typename} RhsScalar, \textcolor{keyword}{typename} Index, \textcolor{keyword}{typename} DataMapper, \textcolor{keywordtype}{int} mr, \textcolor{keywordtype}{int} nr, \textcolor{keywordtype}{bool} ConjugateLhs, \textcolor{keywordtype}{bool} ConjugateRhs>}
\DoxyCodeLine{1143 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1last__row__process__16__packets}{last\_row\_process\_16\_packets}}<LhsScalar, RhsScalar, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}, DataMapper,  mr,  nr, ConjugateLhs,  ConjugateRhs, 16> \{}
\DoxyCodeLine{1144   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{gebp\_traits<LhsScalar,RhsScalar,ConjugateLhs,ConjugateRhs,Architecture::Target>}} \mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{Traits}};}
\DoxyCodeLine{1145   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{gebp\_traits<RhsScalar,LhsScalar,ConjugateRhs,ConjugateLhs,Architecture::Target>}} \mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{SwappedTraits}};}
\DoxyCodeLine{1146 }
\DoxyCodeLine{1147   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} Traits::ResScalar ResScalar;}
\DoxyCodeLine{1148   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SwappedTraits::LhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SLhsPacket}};}
\DoxyCodeLine{1149   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SwappedTraits::RhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SRhsPacket}};}
\DoxyCodeLine{1150   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SwappedTraits::ResPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SResPacket}};}
\DoxyCodeLine{1151   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SwappedTraits::AccPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SAccPacket}};}
\DoxyCodeLine{1152 }
\DoxyCodeLine{1153   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} operator()(\textcolor{keyword}{const} DataMapper\& res, \mbox{\hyperlink{classEigen_1_1internal_1_1gebp__traits}{SwappedTraits}} \&straits, \textcolor{keyword}{const} LhsScalar* blA,}
\DoxyCodeLine{1154                   \textcolor{keyword}{const} RhsScalar* blB, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} depth, \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} endk, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} i, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j2,}
\DoxyCodeLine{1155                   ResScalar alpha, \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{SAccPacket}} \&C0)}
\DoxyCodeLine{1156   \{}
\DoxyCodeLine{1157     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<typename unpacket\_traits<SResPacket>::half}}>\mbox{\hyperlink{structEigen_1_1half}{::half}} SResPacketQuarter;}
\DoxyCodeLine{1158     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<typename unpacket\_traits<SLhsPacket>::half}}>\mbox{\hyperlink{structEigen_1_1half}{::half}} SLhsPacketQuarter;}
\DoxyCodeLine{1159     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<typename unpacket\_traits<SRhsPacket>::half}}>\mbox{\hyperlink{structEigen_1_1half}{::half}} SRhsPacketQuarter;}
\DoxyCodeLine{1160     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<typename unpacket\_traits<SAccPacket>::half}}>\mbox{\hyperlink{structEigen_1_1half}{::half}} SAccPacketQuarter;}
\DoxyCodeLine{1161 }
\DoxyCodeLine{1162     SResPacketQuarter R = res.template gatherPacket<SResPacketQuarter>(i, j2);}
\DoxyCodeLine{1163     SResPacketQuarter alphav = pset1<SResPacketQuarter>(alpha);}
\DoxyCodeLine{1164 }
\DoxyCodeLine{1165     \textcolor{keywordflow}{if} (depth -\/ endk > 0)}
\DoxyCodeLine{1166       \{}
\DoxyCodeLine{1167     \textcolor{comment}{// We have to handle the last row(s) of the rhs, which}}
\DoxyCodeLine{1168     \textcolor{comment}{// correspond to a half-\/packet}}
\DoxyCodeLine{1169     SAccPacketQuarter c0 = predux\_half\_dowto4(predux\_half\_dowto4(C0));}
\DoxyCodeLine{1170 }
\DoxyCodeLine{1171     \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} kk = endk; kk < depth; kk++)}
\DoxyCodeLine{1172       \{}
\DoxyCodeLine{1173         SLhsPacketQuarter a0;}
\DoxyCodeLine{1174         SRhsPacketQuarter b0;}
\DoxyCodeLine{1175         straits.loadLhsUnaligned(blB, a0);}
\DoxyCodeLine{1176         straits.loadRhs(blA, b0);}
\DoxyCodeLine{1177         straits.madd(a0,b0,c0,b0, fix<0>);}
\DoxyCodeLine{1178         blB += SwappedTraits::LhsProgress/4;}
\DoxyCodeLine{1179         blA += 1;}
\DoxyCodeLine{1180       \}}
\DoxyCodeLine{1181     straits.acc(c0, alphav, R);}
\DoxyCodeLine{1182       \}}
\DoxyCodeLine{1183     \textcolor{keywordflow}{else}}
\DoxyCodeLine{1184       \{}
\DoxyCodeLine{1185     straits.acc(predux\_half\_dowto4(predux\_half\_dowto4(C0)), alphav, R);}
\DoxyCodeLine{1186       \}}
\DoxyCodeLine{1187     res.scatterPacket(i, j2, R);}
\DoxyCodeLine{1188   \}}
\DoxyCodeLine{1189 \};}
\DoxyCodeLine{1190 }
\DoxyCodeLine{1191 \textcolor{keyword}{template}<\textcolor{keywordtype}{int} nr, Index LhsProgress, Index RhsProgress, \textcolor{keyword}{typename} LhsScalar, \textcolor{keyword}{typename} RhsScalar, \textcolor{keyword}{typename} ResScalar, \textcolor{keyword}{typename} AccPacket, \textcolor{keyword}{typename} LhsPacket, \textcolor{keyword}{typename} RhsPacket, \textcolor{keyword}{typename} ResPacket, \textcolor{keyword}{typename} GEBPTraits, \textcolor{keyword}{typename} LinearMapper, \textcolor{keyword}{typename} DataMapper>}
\DoxyCodeLine{1192 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1lhs__process__one__packet}{lhs\_process\_one\_packet}}}
\DoxyCodeLine{1193 \{}
\DoxyCodeLine{1194   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} GEBPTraits::RhsPacketx4 RhsPacketx4;}
\DoxyCodeLine{1195 }
\DoxyCodeLine{1196   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} peeled\_kc\_onestep(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} K, \textcolor{keyword}{const} LhsScalar* blA, \textcolor{keyword}{const} RhsScalar* blB, GEBPTraits \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}, LhsPacket *A0, RhsPacketx4 *rhs\_panel, RhsPacket *T0, AccPacket *C0, AccPacket *C1, AccPacket *C2, AccPacket *C3)}
\DoxyCodeLine{1197   \{}
\DoxyCodeLine{1198     EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}begin step of gebp micro kernel 1X4"{}});}
\DoxyCodeLine{1199     EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}Note: these asm comments work around bug 935!"{}});}
\DoxyCodeLine{1200     \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.loadLhs(\&blA[(0+1*K)*LhsProgress], *A0);}
\DoxyCodeLine{1201     \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.loadRhs(\&blB[(0+4*K)*RhsProgress], *rhs\_panel);}
\DoxyCodeLine{1202     \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.madd(*A0, *rhs\_panel, *C0, *T0, fix<0>);}
\DoxyCodeLine{1203     \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.madd(*A0, *rhs\_panel, *C1, *T0, fix<1>);}
\DoxyCodeLine{1204     \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.madd(*A0, *rhs\_panel, *C2, *T0, fix<2>);}
\DoxyCodeLine{1205     \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.madd(*A0, *rhs\_panel, *C3, *T0, fix<3>);}
\DoxyCodeLine{1206 \textcolor{preprocessor}{    \#if EIGEN\_GNUC\_AT\_LEAST(6,0) \&\& defined(EIGEN\_VECTORIZE\_SSE)}}
\DoxyCodeLine{1207     \_\_asm\_\_  (\textcolor{stringliteral}{"{}"{}} : \textcolor{stringliteral}{"{}+x,m"{}} (*A0));}
\DoxyCodeLine{1208 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{1209     EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}end step of gebp micro kernel 1X4"{}});}
\DoxyCodeLine{1210   \}}
\DoxyCodeLine{1211 }
\DoxyCodeLine{1212   EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} operator()(}
\DoxyCodeLine{1213     \textcolor{keyword}{const} DataMapper\& res, \textcolor{keyword}{const} LhsScalar* blockA, \textcolor{keyword}{const} RhsScalar* blockB, ResScalar alpha,}
\DoxyCodeLine{1214     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} peelStart, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} peelEnd, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} strideA, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} strideB, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} offsetA, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} offsetB,}
\DoxyCodeLine{1215     \textcolor{keywordtype}{int} prefetch\_res\_offset, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} peeled\_kc, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} pk, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} cols, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} depth, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} packet\_cols4)}
\DoxyCodeLine{1216   \{}
\DoxyCodeLine{1217     GEBPTraits \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}};}
\DoxyCodeLine{1218 }
\DoxyCodeLine{1219     \textcolor{comment}{// loops on each largest micro horizontal panel of lhs}}
\DoxyCodeLine{1220     \textcolor{comment}{// (LhsProgress x depth)}}
\DoxyCodeLine{1221     \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} i=peelStart; i<peelEnd; i+=LhsProgress)}
\DoxyCodeLine{1222     \{}
\DoxyCodeLine{1223       \textcolor{comment}{// loops on each largest micro vertical panel of rhs (depth * nr)}}
\DoxyCodeLine{1224       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j2=0; j2<packet\_cols4; j2+=nr)}
\DoxyCodeLine{1225       \{}
\DoxyCodeLine{1226         \textcolor{comment}{// We select a LhsProgress x nr micro block of res}}
\DoxyCodeLine{1227         \textcolor{comment}{// which is entirely stored into 1 x nr registers.}}
\DoxyCodeLine{1228 }
\DoxyCodeLine{1229         \textcolor{keyword}{const} LhsScalar* blA = \&blockA[i*strideA+offsetA*(LhsProgress)];}
\DoxyCodeLine{1230         prefetch(\&blA[0]);}
\DoxyCodeLine{1231 }
\DoxyCodeLine{1232         \textcolor{comment}{// gets res block as register}}
\DoxyCodeLine{1233         AccPacket C0, C1, C2, C3;}
\DoxyCodeLine{1234         \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.initAcc(C0);}
\DoxyCodeLine{1235         \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.initAcc(C1);}
\DoxyCodeLine{1236         \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.initAcc(C2);}
\DoxyCodeLine{1237         \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.initAcc(C3);}
\DoxyCodeLine{1238         \textcolor{comment}{// To improve instruction pipelining, let's double the accumulation registers:}}
\DoxyCodeLine{1239         \textcolor{comment}{//  even k will accumulate in C*, while odd k will accumulate in D*.}}
\DoxyCodeLine{1240         \textcolor{comment}{// This trick is crutial to get good performance with FMA, otherwise it is }}
\DoxyCodeLine{1241         \textcolor{comment}{// actually faster to perform separated MUL+ADD because of a naturally}}
\DoxyCodeLine{1242         \textcolor{comment}{// better instruction-\/level parallelism.}}
\DoxyCodeLine{1243         AccPacket D0, D1, D2, D3;}
\DoxyCodeLine{1244         \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.initAcc(D0);}
\DoxyCodeLine{1245         \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.initAcc(D1);}
\DoxyCodeLine{1246         \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.initAcc(D2);}
\DoxyCodeLine{1247         \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.initAcc(D3);}
\DoxyCodeLine{1248 }
\DoxyCodeLine{1249         LinearMapper r0 = res.getLinearMapper(i, j2 + 0);}
\DoxyCodeLine{1250         LinearMapper r1 = res.getLinearMapper(i, j2 + 1);}
\DoxyCodeLine{1251         LinearMapper r2 = res.getLinearMapper(i, j2 + 2);}
\DoxyCodeLine{1252         LinearMapper r3 = res.getLinearMapper(i, j2 + 3);}
\DoxyCodeLine{1253 }
\DoxyCodeLine{1254         r0.prefetch(prefetch\_res\_offset);}
\DoxyCodeLine{1255         r1.prefetch(prefetch\_res\_offset);}
\DoxyCodeLine{1256         r2.prefetch(prefetch\_res\_offset);}
\DoxyCodeLine{1257         r3.prefetch(prefetch\_res\_offset);}
\DoxyCodeLine{1258 }
\DoxyCodeLine{1259         \textcolor{comment}{// performs "{}inner"{} products}}
\DoxyCodeLine{1260         \textcolor{keyword}{const} RhsScalar* blB = \&blockB[j2*strideB+offsetB*nr];}
\DoxyCodeLine{1261         prefetch(\&blB[0]);}
\DoxyCodeLine{1262         LhsPacket A0, A1;}
\DoxyCodeLine{1263 }
\DoxyCodeLine{1264         \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0; k<peeled\_kc; k+=pk)}
\DoxyCodeLine{1265         \{}
\DoxyCodeLine{1266           EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}begin gebp micro kernel 1/half/quarterX4"{}});}
\DoxyCodeLine{1267           RhsPacketx4 rhs\_panel;}
\DoxyCodeLine{1268           RhsPacket T0;}
\DoxyCodeLine{1269 }
\DoxyCodeLine{1270           internal::prefetch(blB+(48+0));}
\DoxyCodeLine{1271           peeled\_kc\_onestep(0, blA, blB, \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}, \&A0, \&rhs\_panel, \&T0, \&C0, \&C1, \&C2, \&C3);}
\DoxyCodeLine{1272           peeled\_kc\_onestep(1, blA, blB, \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}, \&A1, \&rhs\_panel, \&T0, \&D0, \&D1, \&D2, \&D3);}
\DoxyCodeLine{1273           peeled\_kc\_onestep(2, blA, blB, \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}, \&A0, \&rhs\_panel, \&T0, \&C0, \&C1, \&C2, \&C3);}
\DoxyCodeLine{1274           peeled\_kc\_onestep(3, blA, blB, \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}, \&A1, \&rhs\_panel, \&T0, \&D0, \&D1, \&D2, \&D3);}
\DoxyCodeLine{1275           internal::prefetch(blB+(48+16));}
\DoxyCodeLine{1276           peeled\_kc\_onestep(4, blA, blB, \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}, \&A0, \&rhs\_panel, \&T0, \&C0, \&C1, \&C2, \&C3);}
\DoxyCodeLine{1277           peeled\_kc\_onestep(5, blA, blB, \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}, \&A1, \&rhs\_panel, \&T0, \&D0, \&D1, \&D2, \&D3);}
\DoxyCodeLine{1278           peeled\_kc\_onestep(6, blA, blB, \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}, \&A0, \&rhs\_panel, \&T0, \&C0, \&C1, \&C2, \&C3);}
\DoxyCodeLine{1279           peeled\_kc\_onestep(7, blA, blB, \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}, \&A1, \&rhs\_panel, \&T0, \&D0, \&D1, \&D2, \&D3);}
\DoxyCodeLine{1280 }
\DoxyCodeLine{1281           blB += pk*4*RhsProgress;}
\DoxyCodeLine{1282           blA += pk*LhsProgress;}
\DoxyCodeLine{1283 }
\DoxyCodeLine{1284           EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}end gebp micro kernel 1/half/quarterX4"{}});}
\DoxyCodeLine{1285         \}}
\DoxyCodeLine{1286         C0 = padd(C0,D0);}
\DoxyCodeLine{1287         C1 = padd(C1,D1);}
\DoxyCodeLine{1288         C2 = padd(C2,D2);}
\DoxyCodeLine{1289         C3 = padd(C3,D3);}
\DoxyCodeLine{1290 }
\DoxyCodeLine{1291         \textcolor{comment}{// process remaining peeled loop}}
\DoxyCodeLine{1292         \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=peeled\_kc; k<depth; k++)}
\DoxyCodeLine{1293         \{}
\DoxyCodeLine{1294           RhsPacketx4 rhs\_panel;}
\DoxyCodeLine{1295           RhsPacket T0;}
\DoxyCodeLine{1296           peeled\_kc\_onestep(0, blA, blB, \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}, \&A0, \&rhs\_panel, \&T0, \&C0, \&C1, \&C2, \&C3);}
\DoxyCodeLine{1297           blB += 4*RhsProgress;}
\DoxyCodeLine{1298           blA += LhsProgress;}
\DoxyCodeLine{1299         \}}
\DoxyCodeLine{1300 }
\DoxyCodeLine{1301         ResPacket R0, R1;}
\DoxyCodeLine{1302         ResPacket alphav = pset1<ResPacket>(alpha);}
\DoxyCodeLine{1303 }
\DoxyCodeLine{1304         R0 = r0.template loadPacket<ResPacket>(0);}
\DoxyCodeLine{1305         R1 = r1.template loadPacket<ResPacket>(0);}
\DoxyCodeLine{1306         \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.acc(C0, alphav, R0);}
\DoxyCodeLine{1307         \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.acc(C1,  alphav, R1);}
\DoxyCodeLine{1308         r0.storePacket(0, R0);}
\DoxyCodeLine{1309         r1.storePacket(0, R1);}
\DoxyCodeLine{1310 }
\DoxyCodeLine{1311         R0 = r2.template loadPacket<ResPacket>(0);}
\DoxyCodeLine{1312         R1 = r3.template loadPacket<ResPacket>(0);}
\DoxyCodeLine{1313         \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.acc(C2,  alphav, R0);}
\DoxyCodeLine{1314         \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.acc(C3,  alphav, R1);}
\DoxyCodeLine{1315         r2.storePacket(0, R0);}
\DoxyCodeLine{1316         r3.storePacket(0, R1);}
\DoxyCodeLine{1317       \}}
\DoxyCodeLine{1318 }
\DoxyCodeLine{1319       \textcolor{comment}{// Deal with remaining columns of the rhs}}
\DoxyCodeLine{1320       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j2=packet\_cols4; j2<cols; j2++)}
\DoxyCodeLine{1321       \{}
\DoxyCodeLine{1322         \textcolor{comment}{// One column at a time}}
\DoxyCodeLine{1323         \textcolor{keyword}{const} LhsScalar* blA = \&blockA[i*strideA+offsetA*(LhsProgress)];}
\DoxyCodeLine{1324         prefetch(\&blA[0]);}
\DoxyCodeLine{1325 }
\DoxyCodeLine{1326         \textcolor{comment}{// gets res block as register}}
\DoxyCodeLine{1327         AccPacket C0;}
\DoxyCodeLine{1328         \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.initAcc(C0);}
\DoxyCodeLine{1329 }
\DoxyCodeLine{1330         LinearMapper r0 = res.getLinearMapper(i, j2);}
\DoxyCodeLine{1331 }
\DoxyCodeLine{1332         \textcolor{comment}{// performs "{}inner"{} products}}
\DoxyCodeLine{1333         \textcolor{keyword}{const} RhsScalar* blB = \&blockB[j2*strideB+offsetB];}
\DoxyCodeLine{1334         LhsPacket A0;}
\DoxyCodeLine{1335 }
\DoxyCodeLine{1336         \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k= 0; k<peeled\_kc; k+=pk)}
\DoxyCodeLine{1337         \{}
\DoxyCodeLine{1338           EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}begin gebp micro kernel 1/half/quarterX1"{}});}
\DoxyCodeLine{1339           RhsPacket B\_0;}
\DoxyCodeLine{1340 }
\DoxyCodeLine{1341 \textcolor{preprocessor}{\#define EIGEN\_GEBGP\_ONESTEP(K)                                          \(\backslash\)}}
\DoxyCodeLine{1342 \textcolor{preprocessor}{          do \{                                                      \(\backslash\)}}
\DoxyCodeLine{1343 \textcolor{preprocessor}{        EIGEN\_ASM\_COMMENT("{}begin step of gebp micro kernel 1/half/quarterX1"{}}); \(\backslash\)}
\DoxyCodeLine{1344         EIGEN\_ASM\_COMMENT("{}Note: these asm comments work around bug 935!"{}); \(\backslash\)}
\DoxyCodeLine{1345     \textcolor{comment}{/* FIXME: why unaligned???? */}\textcolor{preprocessor}{ \(\backslash\)}}
\DoxyCodeLine{1346 \textcolor{preprocessor}{        traits.loadLhsUnaligned(\&blA[(0+1*K)*LhsProgress], A0); \(\backslash\)}}
\DoxyCodeLine{1347 \textcolor{preprocessor}{        traits.loadRhs(\&blB[(0+K)*RhsProgress], B\_0);       \(\backslash\)}}
\DoxyCodeLine{1348 \textcolor{preprocessor}{        traits.madd(A0, B\_0, C0, B\_0, fix<0>);              \(\backslash\)}}
\DoxyCodeLine{1349 \textcolor{preprocessor}{        EIGEN\_ASM\_COMMENT("{}end step of gebp micro kernel 1/half/quarterX1"{}}); \(\backslash\)}
\DoxyCodeLine{1350           \} while(false);}
\DoxyCodeLine{1351 }
\DoxyCodeLine{1352           EIGEN\_GEBGP\_ONESTEP(0);}
\DoxyCodeLine{1353           EIGEN\_GEBGP\_ONESTEP(1);}
\DoxyCodeLine{1354           EIGEN\_GEBGP\_ONESTEP(2);}
\DoxyCodeLine{1355           EIGEN\_GEBGP\_ONESTEP(3);}
\DoxyCodeLine{1356           EIGEN\_GEBGP\_ONESTEP(4);}
\DoxyCodeLine{1357           EIGEN\_GEBGP\_ONESTEP(5);}
\DoxyCodeLine{1358           EIGEN\_GEBGP\_ONESTEP(6);}
\DoxyCodeLine{1359           EIGEN\_GEBGP\_ONESTEP(7);}
\DoxyCodeLine{1360 }
\DoxyCodeLine{1361           blB += pk*RhsProgress;}
\DoxyCodeLine{1362           blA += pk*LhsProgress;}
\DoxyCodeLine{1363 }
\DoxyCodeLine{1364           EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}end gebp micro kernel 1/half/quarterX1"{}});}
\DoxyCodeLine{1365         \}}
\DoxyCodeLine{1366 }
\DoxyCodeLine{1367         \textcolor{comment}{// process remaining peeled loop}}
\DoxyCodeLine{1368         \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=peeled\_kc; k<depth; k++)}
\DoxyCodeLine{1369         \{}
\DoxyCodeLine{1370           RhsPacket B\_0;}
\DoxyCodeLine{1371           EIGEN\_GEBGP\_ONESTEP(0);}
\DoxyCodeLine{1372           blB += RhsProgress;}
\DoxyCodeLine{1373           blA += LhsProgress;}
\DoxyCodeLine{1374         \}}
\DoxyCodeLine{1375 \textcolor{preprocessor}{\#undef EIGEN\_GEBGP\_ONESTEP}}
\DoxyCodeLine{1376         ResPacket R0;}
\DoxyCodeLine{1377         ResPacket alphav = pset1<ResPacket>(alpha);}
\DoxyCodeLine{1378         R0 = r0.template loadPacket<ResPacket>(0);}
\DoxyCodeLine{1379         \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.acc(C0, alphav, R0);}
\DoxyCodeLine{1380         r0.storePacket(0, R0);}
\DoxyCodeLine{1381       \}}
\DoxyCodeLine{1382     \}}
\DoxyCodeLine{1383   \}}
\DoxyCodeLine{1384 \};}
\DoxyCodeLine{1385 }
\DoxyCodeLine{1386 \textcolor{keyword}{template}<\textcolor{keywordtype}{int} nr, Index LhsProgress, Index RhsProgress, \textcolor{keyword}{typename} LhsScalar, \textcolor{keyword}{typename} RhsScalar, \textcolor{keyword}{typename} ResScalar, \textcolor{keyword}{typename} AccPacket, \textcolor{keyword}{typename} LhsPacket, \textcolor{keyword}{typename} RhsPacket, \textcolor{keyword}{typename} ResPacket, \textcolor{keyword}{typename} GEBPTraits, \textcolor{keyword}{typename} LinearMapper, \textcolor{keyword}{typename} DataMapper>}
\DoxyCodeLine{1387 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1lhs__process__fraction__of__packet}{lhs\_process\_fraction\_of\_packet}} : \mbox{\hyperlink{structEigen_1_1internal_1_1lhs__process__one__packet}{lhs\_process\_one\_packet}}<nr, LhsProgress, RhsProgress, LhsScalar, RhsScalar, ResScalar, AccPacket, LhsPacket, RhsPacket, ResPacket, GEBPTraits, LinearMapper, DataMapper>}
\DoxyCodeLine{1388 \{}
\DoxyCodeLine{1389 }
\DoxyCodeLine{1390 EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} peeled\_kc\_onestep(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} K, \textcolor{keyword}{const} LhsScalar* blA, \textcolor{keyword}{const} RhsScalar* blB, GEBPTraits \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}, LhsPacket *A0, RhsPacket *B\_0, RhsPacket *B1, RhsPacket *B2, RhsPacket *B3, AccPacket *C0, AccPacket *C1, AccPacket *C2, AccPacket *C3)}
\DoxyCodeLine{1391   \{}
\DoxyCodeLine{1392         EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}begin step of gebp micro kernel 1X4"{}});}
\DoxyCodeLine{1393         EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}Note: these asm comments work around bug 935!"{}});}
\DoxyCodeLine{1394         \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.loadLhsUnaligned(\&blA[(0+1*K)*(LhsProgress)], *A0);}
\DoxyCodeLine{1395         \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.broadcastRhs(\&blB[(0+4*K)*RhsProgress], *B\_0, *B1, *B2, *B3);}
\DoxyCodeLine{1396         \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.madd(*A0, *B\_0, *C0, *B\_0);}
\DoxyCodeLine{1397         \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.madd(*A0, *B1,  *C1, *B1);}
\DoxyCodeLine{1398         \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.madd(*A0, *B2,  *C2, *B2);}
\DoxyCodeLine{1399         \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}.madd(*A0, *B3,  *C3, *B3);}
\DoxyCodeLine{1400         EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}end step of gebp micro kernel 1X4"{}});}
\DoxyCodeLine{1401   \}}
\DoxyCodeLine{1402 \};}
\DoxyCodeLine{1403 }
\DoxyCodeLine{1404 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsScalar, \textcolor{keyword}{typename} RhsScalar, \textcolor{keyword}{typename} Index, \textcolor{keyword}{typename} DataMapper, \textcolor{keywordtype}{int} mr, \textcolor{keywordtype}{int} nr, \textcolor{keywordtype}{bool} ConjugateLhs, \textcolor{keywordtype}{bool} ConjugateRhs>}
\DoxyCodeLine{1405 EIGEN\_DONT\_INLINE}
\DoxyCodeLine{1406 \textcolor{keywordtype}{void} \mbox{\hyperlink{structEigen_1_1internal_1_1gebp__kernel}{gebp\_kernel<LhsScalar,RhsScalar,Index,DataMapper,mr,nr,ConjugateLhs,ConjugateRhs>}}}
\DoxyCodeLine{1407 \mbox{\hyperlink{structEigen_1_1internal_1_1gebp__kernel}{  ::operator()}}(\textcolor{keyword}{const} DataMapper\& res, \textcolor{keyword}{const} LhsScalar* blockA, \textcolor{keyword}{const} RhsScalar* blockB,}
\DoxyCodeLine{1408                \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} rows, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} depth, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} cols, ResScalar alpha,}
\DoxyCodeLine{1409                \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} strideA, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} strideB, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} offsetA, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} offsetB)}
\DoxyCodeLine{1410   \{}
\DoxyCodeLine{1411     Traits \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}};}
\DoxyCodeLine{1412     SwappedTraits straits;}
\DoxyCodeLine{1413     }
\DoxyCodeLine{1414     \textcolor{keywordflow}{if}(strideA==-\/1) strideA = depth;}
\DoxyCodeLine{1415     \textcolor{keywordflow}{if}(strideB==-\/1) strideB = depth;}
\DoxyCodeLine{1416     \mbox{\hyperlink{structEigen_1_1internal_1_1conj__helper}{conj\_helper<LhsScalar,RhsScalar,ConjugateLhs,ConjugateRhs>}} cj;}
\DoxyCodeLine{1417     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} packet\_cols4 = nr>=4 ? (cols/4) * 4 : 0;}
\DoxyCodeLine{1418     \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} peeled\_mc3 = mr>=3*Traits::LhsProgress ? (rows/(3*LhsProgress))*(3*LhsProgress) : 0;}
\DoxyCodeLine{1419     \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} peeled\_mc2 = mr>=2*Traits::LhsProgress ? peeled\_mc3+((rows-\/peeled\_mc3)/(2*LhsProgress))*(2*LhsProgress) : 0;}
\DoxyCodeLine{1420     \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} peeled\_mc1 = mr>=1*Traits::LhsProgress ? peeled\_mc2+((rows-\/peeled\_mc2)/(1*LhsProgress))*(1*LhsProgress) : 0;}
\DoxyCodeLine{1421     \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} peeled\_mc\_half = mr>=LhsProgressHalf ? peeled\_mc1+((rows-\/peeled\_mc1)/(LhsProgressHalf))*(LhsProgressHalf) : 0;}
\DoxyCodeLine{1422     \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} peeled\_mc\_quarter = mr>=LhsProgressQuarter ? peeled\_mc\_half+((rows-\/peeled\_mc\_half)/(LhsProgressQuarter))*(LhsProgressQuarter) : 0;}
\DoxyCodeLine{1423     \textcolor{keyword}{enum} \{ pk = 8 \}; \textcolor{comment}{// NOTE Such a large peeling factor is important for large matrices (\string~ +5\% when >1000 on Haswell)}}
\DoxyCodeLine{1424     \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} peeled\_kc  = depth \& \string~(pk-\/1);}
\DoxyCodeLine{1425     \textcolor{keyword}{const} \textcolor{keywordtype}{int} prefetch\_res\_offset = 32/\textcolor{keyword}{sizeof}(ResScalar);    }
\DoxyCodeLine{1426 \textcolor{comment}{//     const Index depth2     = depth \& \string~1;}}
\DoxyCodeLine{1427 }
\DoxyCodeLine{1428     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ Process 3 * LhsProgress rows at once -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1429     \textcolor{comment}{// This corresponds to 3*LhsProgress x nr register blocks.}}
\DoxyCodeLine{1430     \textcolor{comment}{// Usually, make sense only with FMA}}
\DoxyCodeLine{1431     \textcolor{keywordflow}{if}(mr>=3*Traits::LhsProgress)}
\DoxyCodeLine{1432     \{}
\DoxyCodeLine{1433       \textcolor{comment}{// Here, the general idea is to loop on each largest micro horizontal panel of the lhs (3*Traits::LhsProgress x depth)}}
\DoxyCodeLine{1434       \textcolor{comment}{// and on each largest micro vertical panel of the rhs (depth * nr).}}
\DoxyCodeLine{1435       \textcolor{comment}{// Blocking sizes, i.e., 'depth' has been computed so that the micro horizontal panel of the lhs fit in L1.}}
\DoxyCodeLine{1436       \textcolor{comment}{// However, if depth is too small, we can extend the number of rows of these horizontal panels.}}
\DoxyCodeLine{1437       \textcolor{comment}{// This actual number of rows is computed as follow:}}
\DoxyCodeLine{1438       \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} l1 = defaultL1CacheSize; \textcolor{comment}{// in Bytes, TODO, l1 should be passed to this function.}}
\DoxyCodeLine{1439       \textcolor{comment}{// The max(1, ...) here is needed because we may be using blocking params larger than what our known l1 cache size}}
\DoxyCodeLine{1440       \textcolor{comment}{// suggests we should be using: either because our known l1 cache size is inaccurate (e.g. on Android, we can only guess),}}
\DoxyCodeLine{1441       \textcolor{comment}{// or because we are testing specific blocking sizes.}}
\DoxyCodeLine{1442       \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} actual\_panel\_rows = (3*LhsProgress) * std::max<Index>(1,( (l1 -\/ \textcolor{keyword}{sizeof}(ResScalar)*mr*nr -\/ depth*nr*\textcolor{keyword}{sizeof}(RhsScalar)) / (depth * \textcolor{keyword}{sizeof}(LhsScalar) * 3*LhsProgress) ));}
\DoxyCodeLine{1443       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} i1=0; i1<peeled\_mc3; i1+=actual\_panel\_rows)}
\DoxyCodeLine{1444       \{}
\DoxyCodeLine{1445         \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} actual\_panel\_end = (std::min)(i1+actual\_panel\_rows, peeled\_mc3);}
\DoxyCodeLine{1446         \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j2=0; j2<packet\_cols4; j2+=nr)}
\DoxyCodeLine{1447         \{}
\DoxyCodeLine{1448           \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} i=i1; i<actual\_panel\_end; i+=3*LhsProgress)}
\DoxyCodeLine{1449           \{}
\DoxyCodeLine{1450           }
\DoxyCodeLine{1451           \textcolor{comment}{// We selected a 3*Traits::LhsProgress x nr micro block of res which is entirely}}
\DoxyCodeLine{1452           \textcolor{comment}{// stored into 3 x nr registers.}}
\DoxyCodeLine{1453           }
\DoxyCodeLine{1454           \textcolor{keyword}{const} LhsScalar* blA = \&blockA[i*strideA+offsetA*(3*LhsProgress)];}
\DoxyCodeLine{1455           prefetch(\&blA[0]);}
\DoxyCodeLine{1456 }
\DoxyCodeLine{1457           \textcolor{comment}{// gets res block as register}}
\DoxyCodeLine{1458           AccPacket C0, C1, C2,  C3,}
\DoxyCodeLine{1459                     C4, C5, C6,  C7,}
\DoxyCodeLine{1460                     C8, C9, C10, C11;}
\DoxyCodeLine{1461           traits.initAcc(C0);  traits.initAcc(C1);  traits.initAcc(C2);  traits.initAcc(C3);}
\DoxyCodeLine{1462           traits.initAcc(C4);  traits.initAcc(C5);  traits.initAcc(C6);  traits.initAcc(C7);}
\DoxyCodeLine{1463           traits.initAcc(C8);  traits.initAcc(C9);  traits.initAcc(C10); traits.initAcc(C11);}
\DoxyCodeLine{1464 }
\DoxyCodeLine{1465           LinearMapper r0 = res.getLinearMapper(i, j2 + 0);}
\DoxyCodeLine{1466           LinearMapper r1 = res.getLinearMapper(i, j2 + 1);}
\DoxyCodeLine{1467           LinearMapper r2 = res.getLinearMapper(i, j2 + 2);}
\DoxyCodeLine{1468           LinearMapper r3 = res.getLinearMapper(i, j2 + 3);}
\DoxyCodeLine{1469 }
\DoxyCodeLine{1470           r0.prefetch(0);}
\DoxyCodeLine{1471           r1.prefetch(0);}
\DoxyCodeLine{1472           r2.prefetch(0);}
\DoxyCodeLine{1473           r3.prefetch(0);}
\DoxyCodeLine{1474 }
\DoxyCodeLine{1475           \textcolor{comment}{// performs "{}inner"{} products}}
\DoxyCodeLine{1476           \textcolor{keyword}{const} RhsScalar* blB = \&blockB[j2*strideB+offsetB*nr];}
\DoxyCodeLine{1477           prefetch(\&blB[0]);}
\DoxyCodeLine{1478           LhsPacket A0, A1;}
\DoxyCodeLine{1479 }
\DoxyCodeLine{1480           \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0; k<peeled\_kc; k+=pk)}
\DoxyCodeLine{1481           \{}
\DoxyCodeLine{1482             EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}begin gebp micro kernel 3pX4"{}});}
\DoxyCodeLine{1483             \textcolor{comment}{// 15 registers are taken (12 for acc, 2 for lhs).}}
\DoxyCodeLine{1484             RhsPanel15 rhs\_panel;}
\DoxyCodeLine{1485             RhsPacket T0;}
\DoxyCodeLine{1486             LhsPacket A2;}
\DoxyCodeLine{1487 \textcolor{preprocessor}{            \#if EIGEN\_COMP\_GNUC\_STRICT \&\& EIGEN\_ARCH\_ARM64 \&\& defined(EIGEN\_VECTORIZE\_NEON) \&\& !(EIGEN\_GNUC\_AT\_LEAST(9,0))}}
\DoxyCodeLine{1488             \textcolor{comment}{// see http://eigen.tuxfamily.org/bz/show\_bug.cgi?id=1633}}
\DoxyCodeLine{1489             \textcolor{comment}{// without this workaround A0, A1, and A2 are loaded in the same register,}}
\DoxyCodeLine{1490             \textcolor{comment}{// which is not good for pipelining}}
\DoxyCodeLine{1491 \textcolor{preprocessor}{            \#define EIGEN\_GEBP\_3PX4\_REGISTER\_ALLOC\_WORKAROUND \_\_asm\_\_  ("{}"{}} : "{}+w,m"{} (A0), "{}+w,m"{} (A1), "{}+w,m"{} (A2));}
\DoxyCodeLine{1492 \textcolor{preprocessor}{            \#else}}
\DoxyCodeLine{1493 \textcolor{preprocessor}{            \#define EIGEN\_GEBP\_3PX4\_REGISTER\_ALLOC\_WORKAROUND}}
\DoxyCodeLine{1494 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{1495 \textcolor{preprocessor}{\#define EIGEN\_GEBP\_ONESTEP(K)                                                     \(\backslash\)}}
\DoxyCodeLine{1496 \textcolor{preprocessor}{            do \{                                                                  \(\backslash\)}}
\DoxyCodeLine{1497 \textcolor{preprocessor}{              EIGEN\_ASM\_COMMENT("{}begin step of gebp micro kernel 3pX4"{}});          \(\backslash\)}
\DoxyCodeLine{1498               EIGEN\_ASM\_COMMENT("{}Note: these asm comments work around bug 935!"{}); \(\backslash\)}
\DoxyCodeLine{1499               internal::prefetch(blA + (3 * K + 16) * LhsProgress);               \(\backslash\)}
\DoxyCodeLine{1500               if (EIGEN\_ARCH\_ARM || EIGEN\_ARCH\_MIPS) \{                            \(\backslash\)}
\DoxyCodeLine{1501                 internal::prefetch(blB + (4 * K + 16) * RhsProgress);             \(\backslash\)}
\DoxyCodeLine{1502               \} \textcolor{comment}{/* Bug 953 */}\textcolor{preprocessor}{                                                     \(\backslash\)}}
\DoxyCodeLine{1503 \textcolor{preprocessor}{              traits.loadLhs(\&blA[(0 + 3 * K) * LhsProgress], A0);                \(\backslash\)}}
\DoxyCodeLine{1504 \textcolor{preprocessor}{              traits.loadLhs(\&blA[(1 + 3 * K) * LhsProgress], A1);                \(\backslash\)}}
\DoxyCodeLine{1505 \textcolor{preprocessor}{              traits.loadLhs(\&blA[(2 + 3 * K) * LhsProgress], A2);                \(\backslash\)}}
\DoxyCodeLine{1506 \textcolor{preprocessor}{              EIGEN\_GEBP\_3PX4\_REGISTER\_ALLOC\_WORKAROUND \(\backslash\)}}
\DoxyCodeLine{1507 \textcolor{preprocessor}{              traits.loadRhs(blB + (0+4*K) * Traits::RhsProgress, rhs\_panel);     \(\backslash\)}}
\DoxyCodeLine{1508 \textcolor{preprocessor}{              traits.madd(A0, rhs\_panel, C0, T0, fix<0>);                         \(\backslash\)}}
\DoxyCodeLine{1509 \textcolor{preprocessor}{              traits.madd(A1, rhs\_panel, C4, T0, fix<0>);                         \(\backslash\)}}
\DoxyCodeLine{1510 \textcolor{preprocessor}{              traits.madd(A2, rhs\_panel, C8, T0, fix<0>);                         \(\backslash\)}}
\DoxyCodeLine{1511 \textcolor{preprocessor}{              traits.updateRhs(blB + (1+4*K) * Traits::RhsProgress, rhs\_panel);   \(\backslash\)}}
\DoxyCodeLine{1512 \textcolor{preprocessor}{              traits.madd(A0, rhs\_panel, C1, T0, fix<1>);                         \(\backslash\)}}
\DoxyCodeLine{1513 \textcolor{preprocessor}{              traits.madd(A1, rhs\_panel, C5, T0, fix<1>);                         \(\backslash\)}}
\DoxyCodeLine{1514 \textcolor{preprocessor}{              traits.madd(A2, rhs\_panel, C9, T0, fix<1>);                         \(\backslash\)}}
\DoxyCodeLine{1515 \textcolor{preprocessor}{              traits.updateRhs(blB + (2+4*K) * Traits::RhsProgress, rhs\_panel);   \(\backslash\)}}
\DoxyCodeLine{1516 \textcolor{preprocessor}{              traits.madd(A0, rhs\_panel, C2, T0, fix<2>);                         \(\backslash\)}}
\DoxyCodeLine{1517 \textcolor{preprocessor}{              traits.madd(A1, rhs\_panel, C6, T0, fix<2>);                         \(\backslash\)}}
\DoxyCodeLine{1518 \textcolor{preprocessor}{              traits.madd(A2, rhs\_panel, C10, T0, fix<2>);                        \(\backslash\)}}
\DoxyCodeLine{1519 \textcolor{preprocessor}{              traits.updateRhs(blB + (3+4*K) * Traits::RhsProgress, rhs\_panel);   \(\backslash\)}}
\DoxyCodeLine{1520 \textcolor{preprocessor}{              traits.madd(A0, rhs\_panel, C3, T0, fix<3>);                         \(\backslash\)}}
\DoxyCodeLine{1521 \textcolor{preprocessor}{              traits.madd(A1, rhs\_panel, C7, T0, fix<3>);                         \(\backslash\)}}
\DoxyCodeLine{1522 \textcolor{preprocessor}{              traits.madd(A2, rhs\_panel, C11, T0, fix<3>);                        \(\backslash\)}}
\DoxyCodeLine{1523 \textcolor{preprocessor}{              EIGEN\_ASM\_COMMENT("{}end step of gebp micro kernel 3pX4"{}});            \(\backslash\)}
\DoxyCodeLine{1524             \} while (false)}
\DoxyCodeLine{1525 }
\DoxyCodeLine{1526             internal::prefetch(blB);}
\DoxyCodeLine{1527             EIGEN\_GEBP\_ONESTEP(0);}
\DoxyCodeLine{1528             EIGEN\_GEBP\_ONESTEP(1);}
\DoxyCodeLine{1529             EIGEN\_GEBP\_ONESTEP(2);}
\DoxyCodeLine{1530             EIGEN\_GEBP\_ONESTEP(3);}
\DoxyCodeLine{1531             EIGEN\_GEBP\_ONESTEP(4);}
\DoxyCodeLine{1532             EIGEN\_GEBP\_ONESTEP(5);}
\DoxyCodeLine{1533             EIGEN\_GEBP\_ONESTEP(6);}
\DoxyCodeLine{1534             EIGEN\_GEBP\_ONESTEP(7);}
\DoxyCodeLine{1535 }
\DoxyCodeLine{1536             blB += pk*4*RhsProgress;}
\DoxyCodeLine{1537             blA += pk*3*Traits::LhsProgress;}
\DoxyCodeLine{1538 }
\DoxyCodeLine{1539             EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}end gebp micro kernel 3pX4"{}});}
\DoxyCodeLine{1540           \}}
\DoxyCodeLine{1541           \textcolor{comment}{// process remaining peeled loop}}
\DoxyCodeLine{1542           \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=peeled\_kc; k<depth; k++)}
\DoxyCodeLine{1543           \{}
\DoxyCodeLine{1544             RhsPanel15 rhs\_panel;}
\DoxyCodeLine{1545             RhsPacket T0;}
\DoxyCodeLine{1546             LhsPacket A2;}
\DoxyCodeLine{1547             EIGEN\_GEBP\_ONESTEP(0);}
\DoxyCodeLine{1548             blB += 4*RhsProgress;}
\DoxyCodeLine{1549             blA += 3*Traits::LhsProgress;}
\DoxyCodeLine{1550           \}}
\DoxyCodeLine{1551 }
\DoxyCodeLine{1552 \textcolor{preprocessor}{\#undef EIGEN\_GEBP\_ONESTEP}}
\DoxyCodeLine{1553 }
\DoxyCodeLine{1554           ResPacket R0, R1, R2;}
\DoxyCodeLine{1555           ResPacket alphav = pset1<ResPacket>(alpha);}
\DoxyCodeLine{1556 }
\DoxyCodeLine{1557           R0 = r0.template loadPacket<ResPacket>(0 * Traits::ResPacketSize);}
\DoxyCodeLine{1558           R1 = r0.template loadPacket<ResPacket>(1 * Traits::ResPacketSize);}
\DoxyCodeLine{1559           R2 = r0.template loadPacket<ResPacket>(2 * Traits::ResPacketSize);}
\DoxyCodeLine{1560           traits.acc(C0, alphav, R0);}
\DoxyCodeLine{1561           traits.acc(C4, alphav, R1);}
\DoxyCodeLine{1562           traits.acc(C8, alphav, R2);}
\DoxyCodeLine{1563           r0.storePacket(0 * Traits::ResPacketSize, R0);}
\DoxyCodeLine{1564           r0.storePacket(1 * Traits::ResPacketSize, R1);}
\DoxyCodeLine{1565           r0.storePacket(2 * Traits::ResPacketSize, R2);}
\DoxyCodeLine{1566 }
\DoxyCodeLine{1567           R0 = r1.template loadPacket<ResPacket>(0 * Traits::ResPacketSize);}
\DoxyCodeLine{1568           R1 = r1.template loadPacket<ResPacket>(1 * Traits::ResPacketSize);}
\DoxyCodeLine{1569           R2 = r1.template loadPacket<ResPacket>(2 * Traits::ResPacketSize);}
\DoxyCodeLine{1570           traits.acc(C1, alphav, R0);}
\DoxyCodeLine{1571           traits.acc(C5, alphav, R1);}
\DoxyCodeLine{1572           traits.acc(C9, alphav, R2);}
\DoxyCodeLine{1573           r1.storePacket(0 * Traits::ResPacketSize, R0);}
\DoxyCodeLine{1574           r1.storePacket(1 * Traits::ResPacketSize, R1);}
\DoxyCodeLine{1575           r1.storePacket(2 * Traits::ResPacketSize, R2);}
\DoxyCodeLine{1576 }
\DoxyCodeLine{1577           R0 = r2.template loadPacket<ResPacket>(0 * Traits::ResPacketSize);}
\DoxyCodeLine{1578           R1 = r2.template loadPacket<ResPacket>(1 * Traits::ResPacketSize);}
\DoxyCodeLine{1579           R2 = r2.template loadPacket<ResPacket>(2 * Traits::ResPacketSize);}
\DoxyCodeLine{1580           traits.acc(C2, alphav, R0);}
\DoxyCodeLine{1581           traits.acc(C6, alphav, R1);}
\DoxyCodeLine{1582           traits.acc(C10, alphav, R2);}
\DoxyCodeLine{1583           r2.storePacket(0 * Traits::ResPacketSize, R0);}
\DoxyCodeLine{1584           r2.storePacket(1 * Traits::ResPacketSize, R1);}
\DoxyCodeLine{1585           r2.storePacket(2 * Traits::ResPacketSize, R2);}
\DoxyCodeLine{1586 }
\DoxyCodeLine{1587           R0 = r3.template loadPacket<ResPacket>(0 * Traits::ResPacketSize);}
\DoxyCodeLine{1588           R1 = r3.template loadPacket<ResPacket>(1 * Traits::ResPacketSize);}
\DoxyCodeLine{1589           R2 = r3.template loadPacket<ResPacket>(2 * Traits::ResPacketSize);}
\DoxyCodeLine{1590           traits.acc(C3, alphav, R0);}
\DoxyCodeLine{1591           traits.acc(C7, alphav, R1);}
\DoxyCodeLine{1592           traits.acc(C11, alphav, R2);}
\DoxyCodeLine{1593           r3.storePacket(0 * Traits::ResPacketSize, R0);}
\DoxyCodeLine{1594           r3.storePacket(1 * Traits::ResPacketSize, R1);}
\DoxyCodeLine{1595           r3.storePacket(2 * Traits::ResPacketSize, R2);          }
\DoxyCodeLine{1596           \}}
\DoxyCodeLine{1597         \}}
\DoxyCodeLine{1598 }
\DoxyCodeLine{1599         \textcolor{comment}{// Deal with remaining columns of the rhs}}
\DoxyCodeLine{1600         \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j2=packet\_cols4; j2<cols; j2++)}
\DoxyCodeLine{1601         \{}
\DoxyCodeLine{1602           \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} i=i1; i<actual\_panel\_end; i+=3*LhsProgress)}
\DoxyCodeLine{1603           \{}
\DoxyCodeLine{1604           \textcolor{comment}{// One column at a time}}
\DoxyCodeLine{1605           \textcolor{keyword}{const} LhsScalar* blA = \&blockA[i*strideA+offsetA*(3*Traits::LhsProgress)];}
\DoxyCodeLine{1606           prefetch(\&blA[0]);}
\DoxyCodeLine{1607 }
\DoxyCodeLine{1608           \textcolor{comment}{// gets res block as register}}
\DoxyCodeLine{1609           AccPacket C0, C4, C8;}
\DoxyCodeLine{1610           traits.initAcc(C0);}
\DoxyCodeLine{1611           traits.initAcc(C4);}
\DoxyCodeLine{1612           traits.initAcc(C8);}
\DoxyCodeLine{1613 }
\DoxyCodeLine{1614           LinearMapper r0 = res.getLinearMapper(i, j2);}
\DoxyCodeLine{1615           r0.prefetch(0);}
\DoxyCodeLine{1616 }
\DoxyCodeLine{1617           \textcolor{comment}{// performs "{}inner"{} products}}
\DoxyCodeLine{1618           \textcolor{keyword}{const} RhsScalar* blB = \&blockB[j2*strideB+offsetB];}
\DoxyCodeLine{1619           LhsPacket A0, A1, A2;}
\DoxyCodeLine{1620           }
\DoxyCodeLine{1621           \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0; k<peeled\_kc; k+=pk)}
\DoxyCodeLine{1622           \{}
\DoxyCodeLine{1623             EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}begin gebp micro kernel 3pX1"{}});}
\DoxyCodeLine{1624             RhsPacket B\_0;}
\DoxyCodeLine{1625 \textcolor{preprocessor}{\#define EIGEN\_GEBGP\_ONESTEP(K)                                                    \(\backslash\)}}
\DoxyCodeLine{1626 \textcolor{preprocessor}{            do \{                                                                  \(\backslash\)}}
\DoxyCodeLine{1627 \textcolor{preprocessor}{              EIGEN\_ASM\_COMMENT("{}begin step of gebp micro kernel 3pX1"{}});          \(\backslash\)}
\DoxyCodeLine{1628               EIGEN\_ASM\_COMMENT("{}Note: these asm comments work around bug 935!"{}); \(\backslash\)}
\DoxyCodeLine{1629               traits.loadLhs(\&blA[(0 + 3 * K) * LhsProgress], A0);                \(\backslash\)}
\DoxyCodeLine{1630               traits.loadLhs(\&blA[(1 + 3 * K) * LhsProgress], A1);                \(\backslash\)}
\DoxyCodeLine{1631               traits.loadLhs(\&blA[(2 + 3 * K) * LhsProgress], A2);                \(\backslash\)}
\DoxyCodeLine{1632               traits.loadRhs(\&blB[(0 + K) * RhsProgress], B\_0);                   \(\backslash\)}
\DoxyCodeLine{1633               traits.madd(A0, B\_0, C0, B\_0, fix<0>);                              \(\backslash\)}
\DoxyCodeLine{1634               traits.madd(A1, B\_0, C4, B\_0, fix<0>);                              \(\backslash\)}
\DoxyCodeLine{1635               traits.madd(A2, B\_0, C8, B\_0, fix<0>);                              \(\backslash\)}
\DoxyCodeLine{1636               EIGEN\_ASM\_COMMENT("{}end step of gebp micro kernel 3pX1"{});            \(\backslash\)}
\DoxyCodeLine{1637             \} while (false)}
\DoxyCodeLine{1638 }
\DoxyCodeLine{1639             EIGEN\_GEBGP\_ONESTEP(0);}
\DoxyCodeLine{1640             EIGEN\_GEBGP\_ONESTEP(1);}
\DoxyCodeLine{1641             EIGEN\_GEBGP\_ONESTEP(2);}
\DoxyCodeLine{1642             EIGEN\_GEBGP\_ONESTEP(3);}
\DoxyCodeLine{1643             EIGEN\_GEBGP\_ONESTEP(4);}
\DoxyCodeLine{1644             EIGEN\_GEBGP\_ONESTEP(5);}
\DoxyCodeLine{1645             EIGEN\_GEBGP\_ONESTEP(6);}
\DoxyCodeLine{1646             EIGEN\_GEBGP\_ONESTEP(7);}
\DoxyCodeLine{1647 }
\DoxyCodeLine{1648             blB += int(pk) * int(RhsProgress);}
\DoxyCodeLine{1649             blA += int(pk) * 3 * int(Traits::LhsProgress);}
\DoxyCodeLine{1650 }
\DoxyCodeLine{1651             EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}end gebp micro kernel 3pX1"{}});}
\DoxyCodeLine{1652           \}}
\DoxyCodeLine{1653 }
\DoxyCodeLine{1654           \textcolor{comment}{// process remaining peeled loop}}
\DoxyCodeLine{1655           \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=peeled\_kc; k<depth; k++)}
\DoxyCodeLine{1656           \{}
\DoxyCodeLine{1657             RhsPacket B\_0;}
\DoxyCodeLine{1658             EIGEN\_GEBGP\_ONESTEP(0);}
\DoxyCodeLine{1659             blB += RhsProgress;}
\DoxyCodeLine{1660             blA += 3*Traits::LhsProgress;}
\DoxyCodeLine{1661           \}}
\DoxyCodeLine{1662 \textcolor{preprocessor}{\#undef EIGEN\_GEBGP\_ONESTEP}}
\DoxyCodeLine{1663           ResPacket R0, R1, R2;}
\DoxyCodeLine{1664           ResPacket alphav = pset1<ResPacket>(alpha);}
\DoxyCodeLine{1665 }
\DoxyCodeLine{1666           R0 = r0.template loadPacket<ResPacket>(0 * Traits::ResPacketSize);}
\DoxyCodeLine{1667           R1 = r0.template loadPacket<ResPacket>(1 * Traits::ResPacketSize);}
\DoxyCodeLine{1668           R2 = r0.template loadPacket<ResPacket>(2 * Traits::ResPacketSize);}
\DoxyCodeLine{1669           traits.acc(C0, alphav, R0);}
\DoxyCodeLine{1670           traits.acc(C4, alphav, R1);}
\DoxyCodeLine{1671           traits.acc(C8, alphav, R2);}
\DoxyCodeLine{1672           r0.storePacket(0 * Traits::ResPacketSize, R0);}
\DoxyCodeLine{1673           r0.storePacket(1 * Traits::ResPacketSize, R1);}
\DoxyCodeLine{1674           r0.storePacket(2 * Traits::ResPacketSize, R2);          }
\DoxyCodeLine{1675           \}}
\DoxyCodeLine{1676         \}}
\DoxyCodeLine{1677       \}}
\DoxyCodeLine{1678     \}}
\DoxyCodeLine{1679 }
\DoxyCodeLine{1680     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ Process 2 * LhsProgress rows at once -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1681     \textcolor{keywordflow}{if}(mr>=2*Traits::LhsProgress)}
\DoxyCodeLine{1682     \{}
\DoxyCodeLine{1683       \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} l1 = defaultL1CacheSize; \textcolor{comment}{// in Bytes, TODO, l1 should be passed to this function.}}
\DoxyCodeLine{1684       \textcolor{comment}{// The max(1, ...) here is needed because we may be using blocking params larger than what our known l1 cache size}}
\DoxyCodeLine{1685       \textcolor{comment}{// suggests we should be using: either because our known l1 cache size is inaccurate (e.g. on Android, we can only guess),}}
\DoxyCodeLine{1686       \textcolor{comment}{// or because we are testing specific blocking sizes.}}
\DoxyCodeLine{1687       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} actual\_panel\_rows = (2*LhsProgress) * std::max<Index>(1,( (l1 -\/ \textcolor{keyword}{sizeof}(ResScalar)*mr*nr -\/ depth*nr*\textcolor{keyword}{sizeof}(RhsScalar)) / (depth * \textcolor{keyword}{sizeof}(LhsScalar) * 2*LhsProgress) ));}
\DoxyCodeLine{1688 }
\DoxyCodeLine{1689       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} i1=peeled\_mc3; i1<peeled\_mc2; i1+=actual\_panel\_rows)}
\DoxyCodeLine{1690       \{}
\DoxyCodeLine{1691         \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} actual\_panel\_end = (std::min)(i1+actual\_panel\_rows, peeled\_mc2);}
\DoxyCodeLine{1692         \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j2=0; j2<packet\_cols4; j2+=nr)}
\DoxyCodeLine{1693         \{}
\DoxyCodeLine{1694           \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} i=i1; i<actual\_panel\_end; i+=2*LhsProgress)}
\DoxyCodeLine{1695           \{}
\DoxyCodeLine{1696           }
\DoxyCodeLine{1697           \textcolor{comment}{// We selected a 2*Traits::LhsProgress x nr micro block of res which is entirely}}
\DoxyCodeLine{1698           \textcolor{comment}{// stored into 2 x nr registers.}}
\DoxyCodeLine{1699           }
\DoxyCodeLine{1700           \textcolor{keyword}{const} LhsScalar* blA = \&blockA[i*strideA+offsetA*(2*Traits::LhsProgress)];}
\DoxyCodeLine{1701           prefetch(\&blA[0]);}
\DoxyCodeLine{1702 }
\DoxyCodeLine{1703           \textcolor{comment}{// gets res block as register}}
\DoxyCodeLine{1704           AccPacket C0, C1, C2, C3,}
\DoxyCodeLine{1705                     C4, C5, C6, C7;}
\DoxyCodeLine{1706           traits.initAcc(C0); traits.initAcc(C1); traits.initAcc(C2); traits.initAcc(C3);}
\DoxyCodeLine{1707           traits.initAcc(C4); traits.initAcc(C5); traits.initAcc(C6); traits.initAcc(C7);}
\DoxyCodeLine{1708 }
\DoxyCodeLine{1709           LinearMapper r0 = res.getLinearMapper(i, j2 + 0);}
\DoxyCodeLine{1710           LinearMapper r1 = res.getLinearMapper(i, j2 + 1);}
\DoxyCodeLine{1711           LinearMapper r2 = res.getLinearMapper(i, j2 + 2);}
\DoxyCodeLine{1712           LinearMapper r3 = res.getLinearMapper(i, j2 + 3);}
\DoxyCodeLine{1713 }
\DoxyCodeLine{1714           r0.prefetch(prefetch\_res\_offset);}
\DoxyCodeLine{1715           r1.prefetch(prefetch\_res\_offset);}
\DoxyCodeLine{1716           r2.prefetch(prefetch\_res\_offset);}
\DoxyCodeLine{1717           r3.prefetch(prefetch\_res\_offset);}
\DoxyCodeLine{1718 }
\DoxyCodeLine{1719           \textcolor{comment}{// performs "{}inner"{} products}}
\DoxyCodeLine{1720           \textcolor{keyword}{const} RhsScalar* blB = \&blockB[j2*strideB+offsetB*nr];}
\DoxyCodeLine{1721           prefetch(\&blB[0]);}
\DoxyCodeLine{1722           LhsPacket A0, A1;}
\DoxyCodeLine{1723 }
\DoxyCodeLine{1724           \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0; k<peeled\_kc; k+=pk)}
\DoxyCodeLine{1725           \{}
\DoxyCodeLine{1726             EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}begin gebp micro kernel 2pX4"{}});}
\DoxyCodeLine{1727             RhsPacketx4 rhs\_panel;}
\DoxyCodeLine{1728             RhsPacket T0;}
\DoxyCodeLine{1729 }
\DoxyCodeLine{1730           \textcolor{comment}{// NOTE: the begin/end asm comments below work around bug 935!}}
\DoxyCodeLine{1731           \textcolor{comment}{// but they are not enough for gcc>=6 without FMA (bug 1637)}}
\DoxyCodeLine{1732 \textcolor{preprocessor}{          \#if EIGEN\_GNUC\_AT\_LEAST(6,0) \&\& defined(EIGEN\_VECTORIZE\_SSE)}}
\DoxyCodeLine{1733 \textcolor{preprocessor}{            \#define EIGEN\_GEBP\_2PX4\_SPILLING\_WORKAROUND \_\_asm\_\_  ("{}"{}} : [a0] "{}+x,m"{} (A0),[a1] "{}+x,m"{} (A1));}
\DoxyCodeLine{1734 \textcolor{preprocessor}{          \#else}}
\DoxyCodeLine{1735 \textcolor{preprocessor}{            \#define EIGEN\_GEBP\_2PX4\_SPILLING\_WORKAROUND}}
\DoxyCodeLine{1736 \textcolor{preprocessor}{          \#endif}}
\DoxyCodeLine{1737 \textcolor{preprocessor}{\#define EIGEN\_GEBGP\_ONESTEP(K)                                            \(\backslash\)}}
\DoxyCodeLine{1738 \textcolor{preprocessor}{            do \{                                                          \(\backslash\)}}
\DoxyCodeLine{1739 \textcolor{preprocessor}{              EIGEN\_ASM\_COMMENT("{}begin step of gebp micro kernel 2pX4"{}});  \(\backslash\)}
\DoxyCodeLine{1740               traits.loadLhs(\&blA[(0 + 2 * K) * LhsProgress], A0);        \(\backslash\)}
\DoxyCodeLine{1741               traits.loadLhs(\&blA[(1 + 2 * K) * LhsProgress], A1);        \(\backslash\)}
\DoxyCodeLine{1742               traits.loadRhs(\&blB[(0 + 4 * K) * RhsProgress], rhs\_panel); \(\backslash\)}
\DoxyCodeLine{1743               traits.madd(A0, rhs\_panel, C0, T0, fix<0>);                 \(\backslash\)}
\DoxyCodeLine{1744               traits.madd(A1, rhs\_panel, C4, T0, fix<0>);                 \(\backslash\)}
\DoxyCodeLine{1745               traits.madd(A0, rhs\_panel, C1, T0, fix<1>);                 \(\backslash\)}
\DoxyCodeLine{1746               traits.madd(A1, rhs\_panel, C5, T0, fix<1>);                 \(\backslash\)}
\DoxyCodeLine{1747               traits.madd(A0, rhs\_panel, C2, T0, fix<2>);                 \(\backslash\)}
\DoxyCodeLine{1748               traits.madd(A1, rhs\_panel, C6, T0, fix<2>);                 \(\backslash\)}
\DoxyCodeLine{1749               traits.madd(A0, rhs\_panel, C3, T0, fix<3>);                 \(\backslash\)}
\DoxyCodeLine{1750               traits.madd(A1, rhs\_panel, C7, T0, fix<3>);                 \(\backslash\)}
\DoxyCodeLine{1751               EIGEN\_GEBP\_2PX4\_SPILLING\_WORKAROUND                         \(\backslash\)}
\DoxyCodeLine{1752               EIGEN\_ASM\_COMMENT("{}end step of gebp micro kernel 2pX4"{});    \(\backslash\)}
\DoxyCodeLine{1753             \} while (false)}
\DoxyCodeLine{1754 }
\DoxyCodeLine{1755             internal::prefetch(blB+(48+0));}
\DoxyCodeLine{1756             EIGEN\_GEBGP\_ONESTEP(0);}
\DoxyCodeLine{1757             EIGEN\_GEBGP\_ONESTEP(1);}
\DoxyCodeLine{1758             EIGEN\_GEBGP\_ONESTEP(2);}
\DoxyCodeLine{1759             EIGEN\_GEBGP\_ONESTEP(3);}
\DoxyCodeLine{1760             internal::prefetch(blB+(48+16));}
\DoxyCodeLine{1761             EIGEN\_GEBGP\_ONESTEP(4);}
\DoxyCodeLine{1762             EIGEN\_GEBGP\_ONESTEP(5);}
\DoxyCodeLine{1763             EIGEN\_GEBGP\_ONESTEP(6);}
\DoxyCodeLine{1764             EIGEN\_GEBGP\_ONESTEP(7);}
\DoxyCodeLine{1765 }
\DoxyCodeLine{1766             blB += pk*4*RhsProgress;}
\DoxyCodeLine{1767             blA += pk*(2*Traits::LhsProgress);}
\DoxyCodeLine{1768 }
\DoxyCodeLine{1769             EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}end gebp micro kernel 2pX4"{}});}
\DoxyCodeLine{1770           \}}
\DoxyCodeLine{1771           \textcolor{comment}{// process remaining peeled loop}}
\DoxyCodeLine{1772           \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=peeled\_kc; k<depth; k++)}
\DoxyCodeLine{1773           \{}
\DoxyCodeLine{1774             RhsPacketx4 rhs\_panel;}
\DoxyCodeLine{1775             RhsPacket T0;}
\DoxyCodeLine{1776             EIGEN\_GEBGP\_ONESTEP(0);}
\DoxyCodeLine{1777             blB += 4*RhsProgress;}
\DoxyCodeLine{1778             blA += 2*Traits::LhsProgress;}
\DoxyCodeLine{1779           \}}
\DoxyCodeLine{1780 \textcolor{preprocessor}{\#undef EIGEN\_GEBGP\_ONESTEP}}
\DoxyCodeLine{1781 }
\DoxyCodeLine{1782           ResPacket R0, R1, R2, R3;}
\DoxyCodeLine{1783           ResPacket alphav = pset1<ResPacket>(alpha);}
\DoxyCodeLine{1784 }
\DoxyCodeLine{1785           R0 = r0.template loadPacket<ResPacket>(0 * Traits::ResPacketSize);}
\DoxyCodeLine{1786           R1 = r0.template loadPacket<ResPacket>(1 * Traits::ResPacketSize);}
\DoxyCodeLine{1787           R2 = r1.template loadPacket<ResPacket>(0 * Traits::ResPacketSize);}
\DoxyCodeLine{1788           R3 = r1.template loadPacket<ResPacket>(1 * Traits::ResPacketSize);}
\DoxyCodeLine{1789           traits.acc(C0, alphav, R0);}
\DoxyCodeLine{1790           traits.acc(C4, alphav, R1);}
\DoxyCodeLine{1791           traits.acc(C1, alphav, R2);}
\DoxyCodeLine{1792           traits.acc(C5, alphav, R3);}
\DoxyCodeLine{1793           r0.storePacket(0 * Traits::ResPacketSize, R0);}
\DoxyCodeLine{1794           r0.storePacket(1 * Traits::ResPacketSize, R1);}
\DoxyCodeLine{1795           r1.storePacket(0 * Traits::ResPacketSize, R2);}
\DoxyCodeLine{1796           r1.storePacket(1 * Traits::ResPacketSize, R3);}
\DoxyCodeLine{1797 }
\DoxyCodeLine{1798           R0 = r2.template loadPacket<ResPacket>(0 * Traits::ResPacketSize);}
\DoxyCodeLine{1799           R1 = r2.template loadPacket<ResPacket>(1 * Traits::ResPacketSize);}
\DoxyCodeLine{1800           R2 = r3.template loadPacket<ResPacket>(0 * Traits::ResPacketSize);}
\DoxyCodeLine{1801           R3 = r3.template loadPacket<ResPacket>(1 * Traits::ResPacketSize);}
\DoxyCodeLine{1802           traits.acc(C2,  alphav, R0);}
\DoxyCodeLine{1803           traits.acc(C6,  alphav, R1);}
\DoxyCodeLine{1804           traits.acc(C3,  alphav, R2);}
\DoxyCodeLine{1805           traits.acc(C7,  alphav, R3);}
\DoxyCodeLine{1806           r2.storePacket(0 * Traits::ResPacketSize, R0);}
\DoxyCodeLine{1807           r2.storePacket(1 * Traits::ResPacketSize, R1);}
\DoxyCodeLine{1808           r3.storePacket(0 * Traits::ResPacketSize, R2);}
\DoxyCodeLine{1809           r3.storePacket(1 * Traits::ResPacketSize, R3);}
\DoxyCodeLine{1810           \}}
\DoxyCodeLine{1811         \}}
\DoxyCodeLine{1812       }
\DoxyCodeLine{1813         \textcolor{comment}{// Deal with remaining columns of the rhs}}
\DoxyCodeLine{1814         \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j2=packet\_cols4; j2<cols; j2++)}
\DoxyCodeLine{1815         \{}
\DoxyCodeLine{1816           \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} i=i1; i<actual\_panel\_end; i+=2*LhsProgress)}
\DoxyCodeLine{1817           \{}
\DoxyCodeLine{1818           \textcolor{comment}{// One column at a time}}
\DoxyCodeLine{1819           \textcolor{keyword}{const} LhsScalar* blA = \&blockA[i*strideA+offsetA*(2*Traits::LhsProgress)];}
\DoxyCodeLine{1820           prefetch(\&blA[0]);}
\DoxyCodeLine{1821 }
\DoxyCodeLine{1822           \textcolor{comment}{// gets res block as register}}
\DoxyCodeLine{1823           AccPacket C0, C4;}
\DoxyCodeLine{1824           traits.initAcc(C0);}
\DoxyCodeLine{1825           traits.initAcc(C4);}
\DoxyCodeLine{1826 }
\DoxyCodeLine{1827           LinearMapper r0 = res.getLinearMapper(i, j2);}
\DoxyCodeLine{1828           r0.prefetch(prefetch\_res\_offset);}
\DoxyCodeLine{1829 }
\DoxyCodeLine{1830           \textcolor{comment}{// performs "{}inner"{} products}}
\DoxyCodeLine{1831           \textcolor{keyword}{const} RhsScalar* blB = \&blockB[j2*strideB+offsetB];}
\DoxyCodeLine{1832           LhsPacket A0, A1;}
\DoxyCodeLine{1833 }
\DoxyCodeLine{1834           \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0; k<peeled\_kc; k+=pk)}
\DoxyCodeLine{1835           \{}
\DoxyCodeLine{1836             EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}begin gebp micro kernel 2pX1"{}});}
\DoxyCodeLine{1837             RhsPacket B\_0, B1;}
\DoxyCodeLine{1838         }
\DoxyCodeLine{1839 \textcolor{preprocessor}{\#define EIGEN\_GEBGP\_ONESTEP(K) \(\backslash\)}}
\DoxyCodeLine{1840 \textcolor{preprocessor}{            do \{                                                                  \(\backslash\)}}
\DoxyCodeLine{1841 \textcolor{preprocessor}{              EIGEN\_ASM\_COMMENT("{}begin step of gebp micro kernel 2pX1"{}});          \(\backslash\)}
\DoxyCodeLine{1842               EIGEN\_ASM\_COMMENT("{}Note: these asm comments work around bug 935!"{}); \(\backslash\)}
\DoxyCodeLine{1843               traits.loadLhs(\&blA[(0+2*K)*LhsProgress], A0);                      \(\backslash\)}
\DoxyCodeLine{1844               traits.loadLhs(\&blA[(1+2*K)*LhsProgress], A1);                      \(\backslash\)}
\DoxyCodeLine{1845               traits.loadRhs(\&blB[(0+K)*RhsProgress], B\_0);                       \(\backslash\)}
\DoxyCodeLine{1846               traits.madd(A0, B\_0, C0, B1, fix<0>);                               \(\backslash\)}
\DoxyCodeLine{1847               traits.madd(A1, B\_0, C4, B\_0, fix<0>);                              \(\backslash\)}
\DoxyCodeLine{1848               EIGEN\_ASM\_COMMENT("{}end step of gebp micro kernel 2pX1"{});            \(\backslash\)}
\DoxyCodeLine{1849             \} while(false)}
\DoxyCodeLine{1850         }
\DoxyCodeLine{1851             EIGEN\_GEBGP\_ONESTEP(0);}
\DoxyCodeLine{1852             EIGEN\_GEBGP\_ONESTEP(1);}
\DoxyCodeLine{1853             EIGEN\_GEBGP\_ONESTEP(2);}
\DoxyCodeLine{1854             EIGEN\_GEBGP\_ONESTEP(3);}
\DoxyCodeLine{1855             EIGEN\_GEBGP\_ONESTEP(4);}
\DoxyCodeLine{1856             EIGEN\_GEBGP\_ONESTEP(5);}
\DoxyCodeLine{1857             EIGEN\_GEBGP\_ONESTEP(6);}
\DoxyCodeLine{1858             EIGEN\_GEBGP\_ONESTEP(7);}
\DoxyCodeLine{1859 }
\DoxyCodeLine{1860             blB += int(pk) * int(RhsProgress);}
\DoxyCodeLine{1861             blA += int(pk) * 2 * int(Traits::LhsProgress);}
\DoxyCodeLine{1862 }
\DoxyCodeLine{1863             EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}end gebp micro kernel 2pX1"{}});}
\DoxyCodeLine{1864           \}}
\DoxyCodeLine{1865 }
\DoxyCodeLine{1866           \textcolor{comment}{// process remaining peeled loop}}
\DoxyCodeLine{1867           \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=peeled\_kc; k<depth; k++)}
\DoxyCodeLine{1868           \{}
\DoxyCodeLine{1869             RhsPacket B\_0, B1;}
\DoxyCodeLine{1870             EIGEN\_GEBGP\_ONESTEP(0);}
\DoxyCodeLine{1871             blB += RhsProgress;}
\DoxyCodeLine{1872             blA += 2*Traits::LhsProgress;}
\DoxyCodeLine{1873           \}}
\DoxyCodeLine{1874 \textcolor{preprocessor}{\#undef EIGEN\_GEBGP\_ONESTEP}}
\DoxyCodeLine{1875           ResPacket R0, R1;}
\DoxyCodeLine{1876           ResPacket alphav = pset1<ResPacket>(alpha);}
\DoxyCodeLine{1877 }
\DoxyCodeLine{1878           R0 = r0.template loadPacket<ResPacket>(0 * Traits::ResPacketSize);}
\DoxyCodeLine{1879           R1 = r0.template loadPacket<ResPacket>(1 * Traits::ResPacketSize);}
\DoxyCodeLine{1880           traits.acc(C0, alphav, R0);}
\DoxyCodeLine{1881           traits.acc(C4, alphav, R1);}
\DoxyCodeLine{1882           r0.storePacket(0 * Traits::ResPacketSize, R0);}
\DoxyCodeLine{1883           r0.storePacket(1 * Traits::ResPacketSize, R1);}
\DoxyCodeLine{1884           \}}
\DoxyCodeLine{1885         \}}
\DoxyCodeLine{1886       \}}
\DoxyCodeLine{1887     \}}
\DoxyCodeLine{1888     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ Process 1 * LhsProgress rows at once -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1889     \textcolor{keywordflow}{if}(mr>=1*Traits::LhsProgress)}
\DoxyCodeLine{1890     \{}
\DoxyCodeLine{1891       lhs\_process\_one\_packet<nr, LhsProgress, RhsProgress, LhsScalar, RhsScalar, ResScalar, AccPacket, LhsPacket, RhsPacket, ResPacket, Traits, LinearMapper, DataMapper> p;}
\DoxyCodeLine{1892       p(res, blockA, blockB, alpha, peeled\_mc2, peeled\_mc1, strideA, strideB, offsetA, offsetB, prefetch\_res\_offset, peeled\_kc, pk, cols, depth, packet\_cols4);}
\DoxyCodeLine{1893     \}}
\DoxyCodeLine{1894     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ Process LhsProgressHalf rows at once -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1895     \textcolor{keywordflow}{if}((LhsProgressHalf < LhsProgress) \&\& mr>=LhsProgressHalf)}
\DoxyCodeLine{1896     \{}
\DoxyCodeLine{1897       lhs\_process\_fraction\_of\_packet<nr, LhsProgressHalf, RhsProgressHalf, LhsScalar, RhsScalar, ResScalar, AccPacketHalf, LhsPacketHalf, RhsPacketHalf, ResPacketHalf, HalfTraits, LinearMapper, DataMapper> p;}
\DoxyCodeLine{1898       p(res, blockA, blockB, alpha, peeled\_mc1, peeled\_mc\_half, strideA, strideB, offsetA, offsetB, prefetch\_res\_offset, peeled\_kc, pk, cols, depth, packet\_cols4);}
\DoxyCodeLine{1899     \}}
\DoxyCodeLine{1900     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ Process LhsProgressQuarter rows at once -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1901     \textcolor{keywordflow}{if}((LhsProgressQuarter < LhsProgressHalf) \&\& mr>=LhsProgressQuarter)}
\DoxyCodeLine{1902     \{}
\DoxyCodeLine{1903       lhs\_process\_fraction\_of\_packet<nr, LhsProgressQuarter, RhsProgressQuarter, LhsScalar, RhsScalar, ResScalar, AccPacketQuarter, LhsPacketQuarter, RhsPacketQuarter, ResPacketQuarter, QuarterTraits, LinearMapper, DataMapper> p;}
\DoxyCodeLine{1904       p(res, blockA, blockB, alpha, peeled\_mc\_half, peeled\_mc\_quarter, strideA, strideB, offsetA, offsetB, prefetch\_res\_offset, peeled\_kc, pk, cols, depth, packet\_cols4);}
\DoxyCodeLine{1905     \}}
\DoxyCodeLine{1906     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ Process remaining rows, 1 at once -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1907     \textcolor{keywordflow}{if}(peeled\_mc\_quarter<rows)}
\DoxyCodeLine{1908     \{}
\DoxyCodeLine{1909       \textcolor{comment}{// loop on each panel of the rhs}}
\DoxyCodeLine{1910       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j2=0; j2<packet\_cols4; j2+=nr)}
\DoxyCodeLine{1911       \{}
\DoxyCodeLine{1912         \textcolor{comment}{// loop on each row of the lhs (1*LhsProgress x depth)}}
\DoxyCodeLine{1913         \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} i=peeled\_mc\_quarter; i<rows; i+=1)}
\DoxyCodeLine{1914         \{}
\DoxyCodeLine{1915           \textcolor{keyword}{const} LhsScalar* blA = \&blockA[i*strideA+offsetA];}
\DoxyCodeLine{1916           prefetch(\&blA[0]);}
\DoxyCodeLine{1917           \textcolor{keyword}{const} RhsScalar* blB = \&blockB[j2*strideB+offsetB*nr];}
\DoxyCodeLine{1918 }
\DoxyCodeLine{1919           \textcolor{comment}{// If LhsProgress is 8 or 16, it assumes that there is a}}
\DoxyCodeLine{1920           \textcolor{comment}{// half or quarter packet, respectively, of the same size as}}
\DoxyCodeLine{1921           \textcolor{comment}{// nr (which is currently 4) for the return type.}}
\DoxyCodeLine{1922           \textcolor{keyword}{const} \textcolor{keywordtype}{int} SResPacketHalfSize = unpacket\_traits<typename unpacket\_traits<SResPacket>::half>::size;}
\DoxyCodeLine{1923           \textcolor{keyword}{const} \textcolor{keywordtype}{int} SResPacketQuarterSize = unpacket\_traits<typename unpacket\_traits<typename unpacket\_traits<SResPacket>::half>::half>::size;}
\DoxyCodeLine{1924           \textcolor{keywordflow}{if} ((SwappedTraits::LhsProgress \% 4) == 0 \&\&}
\DoxyCodeLine{1925               (SwappedTraits::LhsProgress<=16) \&\&}
\DoxyCodeLine{1926               (SwappedTraits::LhsProgress!=8  || SResPacketHalfSize==nr) \&\&}
\DoxyCodeLine{1927               (SwappedTraits::LhsProgress!=16 || SResPacketQuarterSize==nr))}
\DoxyCodeLine{1928           \{}
\DoxyCodeLine{1929             SAccPacket C0, C1, C2, C3;}
\DoxyCodeLine{1930             straits.initAcc(C0);}
\DoxyCodeLine{1931             straits.initAcc(C1);}
\DoxyCodeLine{1932             straits.initAcc(C2);}
\DoxyCodeLine{1933             straits.initAcc(C3);}
\DoxyCodeLine{1934 }
\DoxyCodeLine{1935             \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} spk   = (std::max)(1,SwappedTraits::LhsProgress/4);}
\DoxyCodeLine{1936             \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} endk  = (depth/spk)*spk;}
\DoxyCodeLine{1937             \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} endk4 = (depth/(spk*4))*(spk*4);}
\DoxyCodeLine{1938 }
\DoxyCodeLine{1939             \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0;}
\DoxyCodeLine{1940             \textcolor{keywordflow}{for}(; k<endk4; k+=4*spk)}
\DoxyCodeLine{1941             \{}
\DoxyCodeLine{1942               SLhsPacket A0,A1;}
\DoxyCodeLine{1943               SRhsPacket B\_0,B\_1;}
\DoxyCodeLine{1944 }
\DoxyCodeLine{1945               straits.loadLhsUnaligned(blB+0*SwappedTraits::LhsProgress, A0);}
\DoxyCodeLine{1946               straits.loadLhsUnaligned(blB+1*SwappedTraits::LhsProgress, A1);}
\DoxyCodeLine{1947 }
\DoxyCodeLine{1948               straits.loadRhsQuad(blA+0*spk, B\_0);}
\DoxyCodeLine{1949               straits.loadRhsQuad(blA+1*spk, B\_1);}
\DoxyCodeLine{1950               straits.madd(A0,B\_0,C0,B\_0, fix<0>);}
\DoxyCodeLine{1951               straits.madd(A1,B\_1,C1,B\_1, fix<0>);}
\DoxyCodeLine{1952 }
\DoxyCodeLine{1953               straits.loadLhsUnaligned(blB+2*SwappedTraits::LhsProgress, A0);}
\DoxyCodeLine{1954               straits.loadLhsUnaligned(blB+3*SwappedTraits::LhsProgress, A1);}
\DoxyCodeLine{1955               straits.loadRhsQuad(blA+2*spk, B\_0);}
\DoxyCodeLine{1956               straits.loadRhsQuad(blA+3*spk, B\_1);}
\DoxyCodeLine{1957               straits.madd(A0,B\_0,C2,B\_0, fix<0>);}
\DoxyCodeLine{1958               straits.madd(A1,B\_1,C3,B\_1, fix<0>);}
\DoxyCodeLine{1959 }
\DoxyCodeLine{1960               blB += 4*SwappedTraits::LhsProgress;}
\DoxyCodeLine{1961               blA += 4*spk;}
\DoxyCodeLine{1962             \}}
\DoxyCodeLine{1963             C0 = padd(padd(C0,C1),padd(C2,C3));}
\DoxyCodeLine{1964             \textcolor{keywordflow}{for}(; k<endk; k+=spk)}
\DoxyCodeLine{1965             \{}
\DoxyCodeLine{1966               SLhsPacket A0;}
\DoxyCodeLine{1967               SRhsPacket B\_0;}
\DoxyCodeLine{1968 }
\DoxyCodeLine{1969               straits.loadLhsUnaligned(blB, A0);}
\DoxyCodeLine{1970               straits.loadRhsQuad(blA, B\_0);}
\DoxyCodeLine{1971               straits.madd(A0,B\_0,C0,B\_0, fix<0>);}
\DoxyCodeLine{1972 }
\DoxyCodeLine{1973               blB += SwappedTraits::LhsProgress;}
\DoxyCodeLine{1974               blA += spk;}
\DoxyCodeLine{1975             \}}
\DoxyCodeLine{1976             \textcolor{keywordflow}{if}(SwappedTraits::LhsProgress==8)}
\DoxyCodeLine{1977             \{}
\DoxyCodeLine{1978               \textcolor{comment}{// Special case where we have to first reduce the accumulation register C0}}
\DoxyCodeLine{1979               \textcolor{keyword}{typedef} \textcolor{keyword}{typename} conditional<SwappedTraits::LhsProgress>=8,\textcolor{keyword}{typename} unpacket\_traits<SResPacket>::half,SResPacket>::type SResPacketHalf;}
\DoxyCodeLine{1980               \textcolor{keyword}{typedef} \textcolor{keyword}{typename} conditional<SwappedTraits::LhsProgress>=8,\textcolor{keyword}{typename} unpacket\_traits<SLhsPacket>::half,SLhsPacket>::type SLhsPacketHalf;}
\DoxyCodeLine{1981               \textcolor{keyword}{typedef} \textcolor{keyword}{typename} conditional<SwappedTraits::LhsProgress>=8,\textcolor{keyword}{typename} unpacket\_traits<SRhsPacket>::half,SRhsPacket>::type SRhsPacketHalf;}
\DoxyCodeLine{1982               \textcolor{keyword}{typedef} \textcolor{keyword}{typename} conditional<SwappedTraits::LhsProgress>=8,\textcolor{keyword}{typename} unpacket\_traits<SAccPacket>::half,SAccPacket>::type SAccPacketHalf;}
\DoxyCodeLine{1983 }
\DoxyCodeLine{1984               SResPacketHalf R = res.template gatherPacket<SResPacketHalf>(i, j2);}
\DoxyCodeLine{1985               SResPacketHalf alphav = pset1<SResPacketHalf>(alpha);}
\DoxyCodeLine{1986 }
\DoxyCodeLine{1987               \textcolor{keywordflow}{if}(depth-\/endk>0)}
\DoxyCodeLine{1988               \{}
\DoxyCodeLine{1989                 \textcolor{comment}{// We have to handle the last row of the rhs which corresponds to a half-\/packet}}
\DoxyCodeLine{1990                 SLhsPacketHalf a0;}
\DoxyCodeLine{1991                 SRhsPacketHalf b0;}
\DoxyCodeLine{1992                 straits.loadLhsUnaligned(blB, a0);}
\DoxyCodeLine{1993                 straits.loadRhs(blA, b0);}
\DoxyCodeLine{1994                 SAccPacketHalf c0 = predux\_half\_dowto4(C0);}
\DoxyCodeLine{1995                 straits.madd(a0,b0,c0,b0, fix<0>);}
\DoxyCodeLine{1996                 straits.acc(c0, alphav, R);}
\DoxyCodeLine{1997               \}}
\DoxyCodeLine{1998               \textcolor{keywordflow}{else}}
\DoxyCodeLine{1999               \{}
\DoxyCodeLine{2000                 straits.acc(predux\_half\_dowto4(C0), alphav, R);}
\DoxyCodeLine{2001               \}}
\DoxyCodeLine{2002               res.scatterPacket(i, j2, R);}
\DoxyCodeLine{2003             \}}
\DoxyCodeLine{2004             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (SwappedTraits::LhsProgress==16)}
\DoxyCodeLine{2005             \{}
\DoxyCodeLine{2006               \textcolor{comment}{// Special case where we have to first reduce the}}
\DoxyCodeLine{2007               \textcolor{comment}{// accumulation register C0. We specialize the block in}}
\DoxyCodeLine{2008               \textcolor{comment}{// template form, so that LhsProgress < 16 paths don't}}
\DoxyCodeLine{2009               \textcolor{comment}{// fail to compile}}
\DoxyCodeLine{2010               last\_row\_process\_16\_packets<LhsScalar, RhsScalar, Index, DataMapper, mr, nr, ConjugateLhs, ConjugateRhs> p;}
\DoxyCodeLine{2011                 p(res, straits, blA, blB, depth, endk, i, j2,alpha, C0);}
\DoxyCodeLine{2012             \}}
\DoxyCodeLine{2013             \textcolor{keywordflow}{else}}
\DoxyCodeLine{2014             \{}
\DoxyCodeLine{2015               SResPacket R = res.template gatherPacket<SResPacket>(i, j2);}
\DoxyCodeLine{2016               SResPacket alphav = pset1<SResPacket>(alpha);}
\DoxyCodeLine{2017               straits.acc(C0, alphav, R);}
\DoxyCodeLine{2018               res.scatterPacket(i, j2, R);}
\DoxyCodeLine{2019             \}}
\DoxyCodeLine{2020           \}}
\DoxyCodeLine{2021           \textcolor{keywordflow}{else} \textcolor{comment}{// scalar path}}
\DoxyCodeLine{2022           \{}
\DoxyCodeLine{2023             \textcolor{comment}{// get a 1 x 4 res block as registers}}
\DoxyCodeLine{2024             ResScalar C0(0), C1(0), C2(0), C3(0);}
\DoxyCodeLine{2025 }
\DoxyCodeLine{2026             \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0; k<depth; k++)}
\DoxyCodeLine{2027             \{}
\DoxyCodeLine{2028               LhsScalar A0;}
\DoxyCodeLine{2029               RhsScalar B\_0, B\_1;}
\DoxyCodeLine{2030 }
\DoxyCodeLine{2031               A0 = blA[k];}
\DoxyCodeLine{2032 }
\DoxyCodeLine{2033               B\_0 = blB[0];}
\DoxyCodeLine{2034               B\_1 = blB[1];}
\DoxyCodeLine{2035               C0 = cj.pmadd(A0,B\_0,C0);}
\DoxyCodeLine{2036               C1 = cj.pmadd(A0,B\_1,C1);}
\DoxyCodeLine{2037 }
\DoxyCodeLine{2038               B\_0 = blB[2];}
\DoxyCodeLine{2039               B\_1 = blB[3];}
\DoxyCodeLine{2040               C2 = cj.pmadd(A0,B\_0,C2);}
\DoxyCodeLine{2041               C3 = cj.pmadd(A0,B\_1,C3);}
\DoxyCodeLine{2042 }
\DoxyCodeLine{2043               blB += 4;}
\DoxyCodeLine{2044             \}}
\DoxyCodeLine{2045             res(i, j2 + 0) += alpha * C0;}
\DoxyCodeLine{2046             res(i, j2 + 1) += alpha * C1;}
\DoxyCodeLine{2047             res(i, j2 + 2) += alpha * C2;}
\DoxyCodeLine{2048             res(i, j2 + 3) += alpha * C3;}
\DoxyCodeLine{2049           \}}
\DoxyCodeLine{2050         \}}
\DoxyCodeLine{2051       \}}
\DoxyCodeLine{2052       \textcolor{comment}{// remaining columns}}
\DoxyCodeLine{2053       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j2=packet\_cols4; j2<cols; j2++)}
\DoxyCodeLine{2054       \{}
\DoxyCodeLine{2055         \textcolor{comment}{// loop on each row of the lhs (1*LhsProgress x depth)}}
\DoxyCodeLine{2056         \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} i=peeled\_mc\_quarter; i<rows; i+=1)}
\DoxyCodeLine{2057         \{}
\DoxyCodeLine{2058           \textcolor{keyword}{const} LhsScalar* blA = \&blockA[i*strideA+offsetA];}
\DoxyCodeLine{2059           prefetch(\&blA[0]);}
\DoxyCodeLine{2060           \textcolor{comment}{// gets a 1 x 1 res block as registers}}
\DoxyCodeLine{2061           ResScalar C0(0);}
\DoxyCodeLine{2062           \textcolor{keyword}{const} RhsScalar* blB = \&blockB[j2*strideB+offsetB];}
\DoxyCodeLine{2063           \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0; k<depth; k++)}
\DoxyCodeLine{2064           \{}
\DoxyCodeLine{2065             LhsScalar A0 = blA[k];}
\DoxyCodeLine{2066             RhsScalar B\_0 = blB[k];}
\DoxyCodeLine{2067             C0 = cj.pmadd(A0, B\_0, C0);}
\DoxyCodeLine{2068           \}}
\DoxyCodeLine{2069           res(i, j2) += alpha * C0;}
\DoxyCodeLine{2070         \}}
\DoxyCodeLine{2071       \}}
\DoxyCodeLine{2072     \}}
\DoxyCodeLine{2073   \}}
\DoxyCodeLine{2074 }
\DoxyCodeLine{2075 }
\DoxyCodeLine{2076 \textcolor{comment}{// pack a block of the lhs}}
\DoxyCodeLine{2077 \textcolor{comment}{// The traversal is as follow (mr==4):}}
\DoxyCodeLine{2078 \textcolor{comment}{//   0  4  8 12 ...}}
\DoxyCodeLine{2079 \textcolor{comment}{//   1  5  9 13 ...}}
\DoxyCodeLine{2080 \textcolor{comment}{//   2  6 10 14 ...}}
\DoxyCodeLine{2081 \textcolor{comment}{//   3  7 11 15 ...}}
\DoxyCodeLine{2082 \textcolor{comment}{//}}
\DoxyCodeLine{2083 \textcolor{comment}{//  16 20 24 28 ...}}
\DoxyCodeLine{2084 \textcolor{comment}{//  17 21 25 29 ...}}
\DoxyCodeLine{2085 \textcolor{comment}{//  18 22 26 30 ...}}
\DoxyCodeLine{2086 \textcolor{comment}{//  19 23 27 31 ...}}
\DoxyCodeLine{2087 \textcolor{comment}{//}}
\DoxyCodeLine{2088 \textcolor{comment}{//  32 33 34 35 ...}}
\DoxyCodeLine{2089 \textcolor{comment}{//  36 36 38 39 ...}}
\DoxyCodeLine{2090 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} Index, \textcolor{keyword}{typename} DataMapper, \textcolor{keywordtype}{int} Pack1, \textcolor{keywordtype}{int} Pack2, \textcolor{keyword}{typename} Packet, \textcolor{keywordtype}{bool} Conjugate, \textcolor{keywordtype}{bool} PanelMode>}
\DoxyCodeLine{2091 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1gemm__pack__lhs}{gemm\_pack\_lhs}}<Scalar, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}, DataMapper, Pack1, Pack2, \mbox{\hyperlink{unionEigen_1_1internal_1_1Packet}{Packet}}, \mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0103672ae41005ab03b4176c765afd62}{ColMajor}}, \mbox{\hyperlink{classEigen_1_1Conjugate}{Conjugate}}, PanelMode>}
\DoxyCodeLine{2092 \{}
\DoxyCodeLine{2093   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} DataMapper::LinearMapper LinearMapper;}
\DoxyCodeLine{2094   EIGEN\_DONT\_INLINE \textcolor{keywordtype}{void} operator()(Scalar* blockA, \textcolor{keyword}{const} DataMapper\& lhs, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} depth, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} rows, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} stride=0, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} offset=0);}
\DoxyCodeLine{2095 \};}
\DoxyCodeLine{2096 }
\DoxyCodeLine{2097 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} Index, \textcolor{keyword}{typename} DataMapper, \textcolor{keywordtype}{int} Pack1, \textcolor{keywordtype}{int} Pack2, \textcolor{keyword}{typename} Packet, \textcolor{keywordtype}{bool} Conjugate, \textcolor{keywordtype}{bool} PanelMode>}
\DoxyCodeLine{2098 EIGEN\_DONT\_INLINE \textcolor{keywordtype}{void} \mbox{\hyperlink{structEigen_1_1internal_1_1gemm__pack__lhs}{gemm\_pack\_lhs<Scalar, Index, DataMapper, Pack1, Pack2, Packet, ColMajor, Conjugate, PanelMode>}}}
\DoxyCodeLine{2099 \mbox{\hyperlink{structEigen_1_1internal_1_1gemm__pack__lhs}{  ::operator()}}(Scalar* blockA, \textcolor{keyword}{const} DataMapper\& lhs, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} depth, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} rows, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} stride, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} offset)}
\DoxyCodeLine{2100 \{}
\DoxyCodeLine{2101   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{unionEigen_1_1internal_1_1Packet}{unpacket\_traits<Packet>::half}} HalfPacket;}
\DoxyCodeLine{2102   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<typename unpacket\_traits<Packet>::half}}>\mbox{\hyperlink{structEigen_1_1half}{::half}} QuarterPacket;}
\DoxyCodeLine{2103   \textcolor{keyword}{enum} \{ PacketSize = \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<Packet>::size}},}
\DoxyCodeLine{2104          HalfPacketSize = \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<HalfPacket>::size}},}
\DoxyCodeLine{2105          QuarterPacketSize = \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<QuarterPacket>::size}},}
\DoxyCodeLine{2106          HasHalf = (int)HalfPacketSize < (\textcolor{keywordtype}{int})PacketSize,}
\DoxyCodeLine{2107          HasQuarter = (int)QuarterPacketSize < (\textcolor{keywordtype}{int})HalfPacketSize\};}
\DoxyCodeLine{2108 }
\DoxyCodeLine{2109   EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}EIGEN PRODUCT PACK LHS"{}});}
\DoxyCodeLine{2110   EIGEN\_UNUSED\_VARIABLE(stride);}
\DoxyCodeLine{2111   EIGEN\_UNUSED\_VARIABLE(offset);}
\DoxyCodeLine{2112   eigen\_assert(((!PanelMode) \&\& stride==0 \&\& offset==0) || (PanelMode \&\& stride>=depth \&\& offset<=stride));}
\DoxyCodeLine{2113   eigen\_assert( ((Pack1\%PacketSize)==0 \&\& Pack1<=4*PacketSize) || (Pack1<=4) );}
\DoxyCodeLine{2114   conj\_if<NumTraits<Scalar>::IsComplex \&\& \mbox{\hyperlink{classEigen_1_1Conjugate}{Conjugate}}> cj;}
\DoxyCodeLine{2115   \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} count = 0;}
\DoxyCodeLine{2116 }
\DoxyCodeLine{2117   \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} peeled\_mc3 = Pack1>=3*PacketSize ? (rows/(3*PacketSize))*(3*PacketSize) : 0;}
\DoxyCodeLine{2118   \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} peeled\_mc2 = Pack1>=2*PacketSize ? peeled\_mc3+((rows-\/peeled\_mc3)/(2*PacketSize))*(2*PacketSize) : 0;}
\DoxyCodeLine{2119   \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} peeled\_mc1 = Pack1>=1*PacketSize ? peeled\_mc2+((rows-\/peeled\_mc2)/(1*PacketSize))*(1*PacketSize) : 0;}
\DoxyCodeLine{2120   \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} peeled\_mc\_half = Pack1>=HalfPacketSize ? peeled\_mc1+((rows-\/peeled\_mc1)/(HalfPacketSize))*(HalfPacketSize) : 0;}
\DoxyCodeLine{2121   \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} peeled\_mc\_quarter = Pack1>=QuarterPacketSize ? (rows/(QuarterPacketSize))*(QuarterPacketSize) : 0;}
\DoxyCodeLine{2122   \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} last\_lhs\_progress = rows > peeled\_mc\_quarter ? (rows -\/ peeled\_mc\_quarter) \& \string~1 : 0;}
\DoxyCodeLine{2123   \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} peeled\_mc0 = Pack2>=PacketSize ? peeled\_mc\_quarter}
\DoxyCodeLine{2124                          : Pack2>1 \&\& last\_lhs\_progress ? (rows/last\_lhs\_progress)*last\_lhs\_progress : 0;}
\DoxyCodeLine{2125 }
\DoxyCodeLine{2126   \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} i=0;}
\DoxyCodeLine{2127 }
\DoxyCodeLine{2128   \textcolor{comment}{// Pack 3 packets}}
\DoxyCodeLine{2129   \textcolor{keywordflow}{if}(Pack1>=3*PacketSize)}
\DoxyCodeLine{2130   \{}
\DoxyCodeLine{2131     \textcolor{keywordflow}{for}(; i<peeled\_mc3; i+=3*PacketSize)}
\DoxyCodeLine{2132     \{}
\DoxyCodeLine{2133       \textcolor{keywordflow}{if}(PanelMode) count += (3*PacketSize) * offset;}
\DoxyCodeLine{2134 }
\DoxyCodeLine{2135       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0; k<depth; k++)}
\DoxyCodeLine{2136       \{}
\DoxyCodeLine{2137         Packet A, B, C;}
\DoxyCodeLine{2138         A = lhs.template loadPacket<Packet>(i+0*PacketSize, k);}
\DoxyCodeLine{2139         B = lhs.template loadPacket<Packet>(i+1*PacketSize, k);}
\DoxyCodeLine{2140         C = lhs.template loadPacket<Packet>(i+2*PacketSize, k);}
\DoxyCodeLine{2141         pstore(blockA+count, cj.pconj(A)); count+=PacketSize;}
\DoxyCodeLine{2142         pstore(blockA+count, cj.pconj(B)); count+=PacketSize;}
\DoxyCodeLine{2143         pstore(blockA+count, cj.pconj(C)); count+=PacketSize;}
\DoxyCodeLine{2144       \}}
\DoxyCodeLine{2145       \textcolor{keywordflow}{if}(PanelMode) count += (3*PacketSize) * (stride-\/offset-\/depth);}
\DoxyCodeLine{2146     \}}
\DoxyCodeLine{2147   \}}
\DoxyCodeLine{2148   \textcolor{comment}{// Pack 2 packets}}
\DoxyCodeLine{2149   \textcolor{keywordflow}{if}(Pack1>=2*PacketSize)}
\DoxyCodeLine{2150   \{}
\DoxyCodeLine{2151     \textcolor{keywordflow}{for}(; i<peeled\_mc2; i+=2*PacketSize)}
\DoxyCodeLine{2152     \{}
\DoxyCodeLine{2153       \textcolor{keywordflow}{if}(PanelMode) count += (2*PacketSize) * offset;}
\DoxyCodeLine{2154 }
\DoxyCodeLine{2155       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0; k<depth; k++)}
\DoxyCodeLine{2156       \{}
\DoxyCodeLine{2157         Packet A, B;}
\DoxyCodeLine{2158         A = lhs.template loadPacket<Packet>(i+0*PacketSize, k);}
\DoxyCodeLine{2159         B = lhs.template loadPacket<Packet>(i+1*PacketSize, k);}
\DoxyCodeLine{2160         pstore(blockA+count, cj.pconj(A)); count+=PacketSize;}
\DoxyCodeLine{2161         pstore(blockA+count, cj.pconj(B)); count+=PacketSize;}
\DoxyCodeLine{2162       \}}
\DoxyCodeLine{2163       \textcolor{keywordflow}{if}(PanelMode) count += (2*PacketSize) * (stride-\/offset-\/depth);}
\DoxyCodeLine{2164     \}}
\DoxyCodeLine{2165   \}}
\DoxyCodeLine{2166   \textcolor{comment}{// Pack 1 packets}}
\DoxyCodeLine{2167   \textcolor{keywordflow}{if}(Pack1>=1*PacketSize)}
\DoxyCodeLine{2168   \{}
\DoxyCodeLine{2169     \textcolor{keywordflow}{for}(; i<peeled\_mc1; i+=1*PacketSize)}
\DoxyCodeLine{2170     \{}
\DoxyCodeLine{2171       \textcolor{keywordflow}{if}(PanelMode) count += (1*PacketSize) * offset;}
\DoxyCodeLine{2172 }
\DoxyCodeLine{2173       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0; k<depth; k++)}
\DoxyCodeLine{2174       \{}
\DoxyCodeLine{2175         Packet A;}
\DoxyCodeLine{2176         A = lhs.template loadPacket<Packet>(i+0*PacketSize, k);}
\DoxyCodeLine{2177         pstore(blockA+count, cj.pconj(A));}
\DoxyCodeLine{2178         count+=PacketSize;}
\DoxyCodeLine{2179       \}}
\DoxyCodeLine{2180       \textcolor{keywordflow}{if}(PanelMode) count += (1*PacketSize) * (stride-\/offset-\/depth);}
\DoxyCodeLine{2181     \}}
\DoxyCodeLine{2182   \}}
\DoxyCodeLine{2183   \textcolor{comment}{// Pack half packets}}
\DoxyCodeLine{2184   \textcolor{keywordflow}{if}(HasHalf \&\& Pack1>=HalfPacketSize)}
\DoxyCodeLine{2185   \{}
\DoxyCodeLine{2186     \textcolor{keywordflow}{for}(; i<peeled\_mc\_half; i+=HalfPacketSize)}
\DoxyCodeLine{2187     \{}
\DoxyCodeLine{2188       \textcolor{keywordflow}{if}(PanelMode) count += (HalfPacketSize) * offset;}
\DoxyCodeLine{2189 }
\DoxyCodeLine{2190       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0; k<depth; k++)}
\DoxyCodeLine{2191       \{}
\DoxyCodeLine{2192         HalfPacket A;}
\DoxyCodeLine{2193         A = lhs.template loadPacket<HalfPacket>(i+0*(HalfPacketSize), k);}
\DoxyCodeLine{2194         pstoreu(blockA+count, cj.pconj(A));}
\DoxyCodeLine{2195         count+=HalfPacketSize;}
\DoxyCodeLine{2196       \}}
\DoxyCodeLine{2197       \textcolor{keywordflow}{if}(PanelMode) count += (HalfPacketSize) * (stride-\/offset-\/depth);}
\DoxyCodeLine{2198     \}}
\DoxyCodeLine{2199   \}}
\DoxyCodeLine{2200   \textcolor{comment}{// Pack quarter packets}}
\DoxyCodeLine{2201   \textcolor{keywordflow}{if}(HasQuarter \&\& Pack1>=QuarterPacketSize)}
\DoxyCodeLine{2202   \{}
\DoxyCodeLine{2203     \textcolor{keywordflow}{for}(; i<peeled\_mc\_quarter; i+=QuarterPacketSize)}
\DoxyCodeLine{2204     \{}
\DoxyCodeLine{2205       \textcolor{keywordflow}{if}(PanelMode) count += (QuarterPacketSize) * offset;}
\DoxyCodeLine{2206 }
\DoxyCodeLine{2207       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0; k<depth; k++)}
\DoxyCodeLine{2208       \{}
\DoxyCodeLine{2209         QuarterPacket A;}
\DoxyCodeLine{2210         A = lhs.template loadPacket<QuarterPacket>(i+0*(QuarterPacketSize), k);}
\DoxyCodeLine{2211         pstoreu(blockA+count, cj.pconj(A));}
\DoxyCodeLine{2212         count+=QuarterPacketSize;}
\DoxyCodeLine{2213       \}}
\DoxyCodeLine{2214       \textcolor{keywordflow}{if}(PanelMode) count += (QuarterPacketSize) * (stride-\/offset-\/depth);}
\DoxyCodeLine{2215     \}}
\DoxyCodeLine{2216   \}}
\DoxyCodeLine{2217   \textcolor{comment}{// Pack2 may be *smaller* than PacketSize—that happens for}}
\DoxyCodeLine{2218   \textcolor{comment}{// products like real * complex, where we have to go half the}}
\DoxyCodeLine{2219   \textcolor{comment}{// progress on the lhs in order to duplicate those operands to}}
\DoxyCodeLine{2220   \textcolor{comment}{// address both real \& imaginary parts on the rhs. This portion will}}
\DoxyCodeLine{2221   \textcolor{comment}{// pack those half ones until they match the number expected on the}}
\DoxyCodeLine{2222   \textcolor{comment}{// last peeling loop at this point (for the rhs).}}
\DoxyCodeLine{2223   \textcolor{keywordflow}{if}(Pack2<PacketSize \&\& Pack2>1)}
\DoxyCodeLine{2224   \{}
\DoxyCodeLine{2225     \textcolor{keywordflow}{for}(; i<peeled\_mc0; i+=last\_lhs\_progress)}
\DoxyCodeLine{2226     \{}
\DoxyCodeLine{2227       \textcolor{keywordflow}{if}(PanelMode) count += last\_lhs\_progress * offset;}
\DoxyCodeLine{2228 }
\DoxyCodeLine{2229       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0; k<depth; k++)}
\DoxyCodeLine{2230         \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} w=0; w<last\_lhs\_progress; w++)}
\DoxyCodeLine{2231           blockA[count++] = cj(lhs(i+w, k));}
\DoxyCodeLine{2232 }
\DoxyCodeLine{2233       \textcolor{keywordflow}{if}(PanelMode) count += last\_lhs\_progress * (stride-\/offset-\/depth);}
\DoxyCodeLine{2234     \}}
\DoxyCodeLine{2235   \}}
\DoxyCodeLine{2236   \textcolor{comment}{// Pack scalars}}
\DoxyCodeLine{2237   \textcolor{keywordflow}{for}(; i<rows; i++)}
\DoxyCodeLine{2238   \{}
\DoxyCodeLine{2239     \textcolor{keywordflow}{if}(PanelMode) count += offset;}
\DoxyCodeLine{2240     \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0; k<depth; k++)}
\DoxyCodeLine{2241       blockA[count++] = cj(lhs(i, k));}
\DoxyCodeLine{2242     \textcolor{keywordflow}{if}(PanelMode) count += (stride-\/offset-\/depth);}
\DoxyCodeLine{2243   \}}
\DoxyCodeLine{2244 \}}
\DoxyCodeLine{2245 }
\DoxyCodeLine{2246 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} Index, \textcolor{keyword}{typename} DataMapper, \textcolor{keywordtype}{int} Pack1, \textcolor{keywordtype}{int} Pack2, \textcolor{keyword}{typename} Packet, \textcolor{keywordtype}{bool} Conjugate, \textcolor{keywordtype}{bool} PanelMode>}
\DoxyCodeLine{2247 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1gemm__pack__lhs}{gemm\_pack\_lhs}}<Scalar, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}, DataMapper, Pack1, Pack2, \mbox{\hyperlink{unionEigen_1_1internal_1_1Packet}{Packet}}, \mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a77c993a8d9f6efe5c1159fb2ab07dd4f}{RowMajor}}, \mbox{\hyperlink{classEigen_1_1Conjugate}{Conjugate}}, PanelMode>}
\DoxyCodeLine{2248 \{}
\DoxyCodeLine{2249   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} DataMapper::LinearMapper LinearMapper;}
\DoxyCodeLine{2250   EIGEN\_DONT\_INLINE \textcolor{keywordtype}{void} operator()(Scalar* blockA, \textcolor{keyword}{const} DataMapper\& lhs, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} depth, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} rows, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} stride=0, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} offset=0);}
\DoxyCodeLine{2251 \};}
\DoxyCodeLine{2252 }
\DoxyCodeLine{2253 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} Index, \textcolor{keyword}{typename} DataMapper, \textcolor{keywordtype}{int} Pack1, \textcolor{keywordtype}{int} Pack2, \textcolor{keyword}{typename} Packet, \textcolor{keywordtype}{bool} Conjugate, \textcolor{keywordtype}{bool} PanelMode>}
\DoxyCodeLine{2254 EIGEN\_DONT\_INLINE \textcolor{keywordtype}{void} \mbox{\hyperlink{structEigen_1_1internal_1_1gemm__pack__lhs}{gemm\_pack\_lhs<Scalar, Index, DataMapper, Pack1, Pack2, Packet, RowMajor, Conjugate, PanelMode>}}}
\DoxyCodeLine{2255 \mbox{\hyperlink{structEigen_1_1internal_1_1gemm__pack__lhs}{  ::operator()}}(Scalar* blockA, \textcolor{keyword}{const} DataMapper\& lhs, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} depth, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} rows, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} stride, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} offset)}
\DoxyCodeLine{2256 \{}
\DoxyCodeLine{2257   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{unionEigen_1_1internal_1_1Packet}{unpacket\_traits<Packet>::half}} HalfPacket;}
\DoxyCodeLine{2258   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<typename unpacket\_traits<Packet>::half}}>\mbox{\hyperlink{structEigen_1_1half}{::half}} QuarterPacket;}
\DoxyCodeLine{2259   \textcolor{keyword}{enum} \{ PacketSize = \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<Packet>::size}},}
\DoxyCodeLine{2260          HalfPacketSize = \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<HalfPacket>::size}},}
\DoxyCodeLine{2261          QuarterPacketSize = \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<QuarterPacket>::size}},}
\DoxyCodeLine{2262          HasHalf = (int)HalfPacketSize < (\textcolor{keywordtype}{int})PacketSize,}
\DoxyCodeLine{2263          HasQuarter = (int)QuarterPacketSize < (\textcolor{keywordtype}{int})HalfPacketSize\};}
\DoxyCodeLine{2264 }
\DoxyCodeLine{2265   EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}EIGEN PRODUCT PACK LHS"{}});}
\DoxyCodeLine{2266   EIGEN\_UNUSED\_VARIABLE(stride);}
\DoxyCodeLine{2267   EIGEN\_UNUSED\_VARIABLE(offset);}
\DoxyCodeLine{2268   eigen\_assert(((!PanelMode) \&\& stride==0 \&\& offset==0) || (PanelMode \&\& stride>=depth \&\& offset<=stride));}
\DoxyCodeLine{2269   conj\_if<NumTraits<Scalar>::IsComplex \&\& \mbox{\hyperlink{classEigen_1_1Conjugate}{Conjugate}}> cj;}
\DoxyCodeLine{2270   \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} count = 0;}
\DoxyCodeLine{2271   \textcolor{keywordtype}{bool} gone\_half = \textcolor{keyword}{false}, gone\_quarter = \textcolor{keyword}{false}, gone\_last = \textcolor{keyword}{false};}
\DoxyCodeLine{2272 }
\DoxyCodeLine{2273   \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} i = 0;}
\DoxyCodeLine{2274   \textcolor{keywordtype}{int} pack = Pack1;}
\DoxyCodeLine{2275   \textcolor{keywordtype}{int} psize = PacketSize;}
\DoxyCodeLine{2276   \textcolor{keywordflow}{while}(pack>0)}
\DoxyCodeLine{2277   \{}
\DoxyCodeLine{2278     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} remaining\_rows = rows-\/i;}
\DoxyCodeLine{2279     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} peeled\_mc = gone\_last ? Pack2>1 ? (rows/pack)*pack : 0 : i+(remaining\_rows/pack)*pack;}
\DoxyCodeLine{2280     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} starting\_pos = i;}
\DoxyCodeLine{2281     \textcolor{keywordflow}{for}(; i<peeled\_mc; i+=pack)}
\DoxyCodeLine{2282     \{}
\DoxyCodeLine{2283       \textcolor{keywordflow}{if}(PanelMode) count += pack * offset;}
\DoxyCodeLine{2284 }
\DoxyCodeLine{2285       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0;}
\DoxyCodeLine{2286       \textcolor{keywordflow}{if}(pack>=psize \&\& psize >= QuarterPacketSize)}
\DoxyCodeLine{2287       \{}
\DoxyCodeLine{2288         \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} peeled\_k = (depth/psize)*psize;}
\DoxyCodeLine{2289         \textcolor{keywordflow}{for}(; k<peeled\_k; k+=psize)}
\DoxyCodeLine{2290         \{}
\DoxyCodeLine{2291           \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} m = 0; m < pack; m += psize)}
\DoxyCodeLine{2292           \{}
\DoxyCodeLine{2293             \textcolor{keywordflow}{if} (psize == PacketSize) \{}
\DoxyCodeLine{2294               PacketBlock<Packet> kernel;}
\DoxyCodeLine{2295               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} p = 0; p < psize; ++p) kernel.packet[p] = lhs.template loadPacket<Packet>(i+p+m, k);}
\DoxyCodeLine{2296               ptranspose(kernel);}
\DoxyCodeLine{2297               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} p = 0; p < psize; ++p) pstore(blockA+count+m+(pack)*p, cj.pconj(kernel.packet[p]));}
\DoxyCodeLine{2298             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (HasHalf \&\& psize == HalfPacketSize) \{}
\DoxyCodeLine{2299               gone\_half = \textcolor{keyword}{true};}
\DoxyCodeLine{2300               PacketBlock<HalfPacket> kernel\_half;}
\DoxyCodeLine{2301               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} p = 0; p < psize; ++p) kernel\_half.packet[p] = lhs.template loadPacket<HalfPacket>(i+p+m, k);}
\DoxyCodeLine{2302               ptranspose(kernel\_half);}
\DoxyCodeLine{2303               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} p = 0; p < psize; ++p) pstore(blockA+count+m+(pack)*p, cj.pconj(kernel\_half.packet[p]));}
\DoxyCodeLine{2304             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (HasQuarter \&\& psize == QuarterPacketSize) \{}
\DoxyCodeLine{2305               gone\_quarter = \textcolor{keyword}{true};}
\DoxyCodeLine{2306               PacketBlock<QuarterPacket> kernel\_quarter;}
\DoxyCodeLine{2307               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} p = 0; p < psize; ++p) kernel\_quarter.packet[p] = lhs.template loadPacket<QuarterPacket>(i+p+m, k);}
\DoxyCodeLine{2308               ptranspose(kernel\_quarter);}
\DoxyCodeLine{2309               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} p = 0; p < psize; ++p) pstore(blockA+count+m+(pack)*p, cj.pconj(kernel\_quarter.packet[p]));}
\DoxyCodeLine{2310         \}}
\DoxyCodeLine{2311           \}}
\DoxyCodeLine{2312           count += psize*pack;}
\DoxyCodeLine{2313         \}}
\DoxyCodeLine{2314       \}}
\DoxyCodeLine{2315 }
\DoxyCodeLine{2316       \textcolor{keywordflow}{for}(; k<depth; k++)}
\DoxyCodeLine{2317       \{}
\DoxyCodeLine{2318         \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} w=0;}
\DoxyCodeLine{2319         \textcolor{keywordflow}{for}(; w<pack-\/3; w+=4)}
\DoxyCodeLine{2320         \{}
\DoxyCodeLine{2321           Scalar a(cj(lhs(i+w+0, k))),}
\DoxyCodeLine{2322                  b(cj(lhs(i+w+1, k))),}
\DoxyCodeLine{2323                  c(cj(lhs(i+w+2, k))),}
\DoxyCodeLine{2324                  d(cj(lhs(i+w+3, k)));}
\DoxyCodeLine{2325           blockA[count++] = a;}
\DoxyCodeLine{2326           blockA[count++] = b;}
\DoxyCodeLine{2327           blockA[count++] = c;}
\DoxyCodeLine{2328           blockA[count++] = d;}
\DoxyCodeLine{2329         \}}
\DoxyCodeLine{2330         \textcolor{keywordflow}{if}(pack\%4)}
\DoxyCodeLine{2331           \textcolor{keywordflow}{for}(;w<pack;++w)}
\DoxyCodeLine{2332             blockA[count++] = cj(lhs(i+w, k));}
\DoxyCodeLine{2333       \}}
\DoxyCodeLine{2334 }
\DoxyCodeLine{2335       \textcolor{keywordflow}{if}(PanelMode) count += pack * (stride-\/offset-\/depth);}
\DoxyCodeLine{2336     \}}
\DoxyCodeLine{2337 }
\DoxyCodeLine{2338     pack -\/= psize;}
\DoxyCodeLine{2339     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} left = rows -\/ i;}
\DoxyCodeLine{2340     \textcolor{keywordflow}{if} (pack <= 0) \{}
\DoxyCodeLine{2341       \textcolor{keywordflow}{if} (!gone\_last \&\&}
\DoxyCodeLine{2342           (starting\_pos == i || left >= psize/2 || left >= psize/4) \&\&}
\DoxyCodeLine{2343           ((psize/2 == HalfPacketSize \&\& HasHalf \&\& !gone\_half) ||}
\DoxyCodeLine{2344            (psize/2 == QuarterPacketSize \&\& HasQuarter \&\& !gone\_quarter))) \{}
\DoxyCodeLine{2345         psize /= 2;}
\DoxyCodeLine{2346         pack = psize;}
\DoxyCodeLine{2347         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{2348       \}}
\DoxyCodeLine{2349       \textcolor{comment}{// Pack2 may be *smaller* than PacketSize—that happens for}}
\DoxyCodeLine{2350       \textcolor{comment}{// products like real * complex, where we have to go half the}}
\DoxyCodeLine{2351       \textcolor{comment}{// progress on the lhs in order to duplicate those operands to}}
\DoxyCodeLine{2352       \textcolor{comment}{// address both real \& imaginary parts on the rhs. This portion will}}
\DoxyCodeLine{2353       \textcolor{comment}{// pack those half ones until they match the number expected on the}}
\DoxyCodeLine{2354       \textcolor{comment}{// last peeling loop at this point (for the rhs).}}
\DoxyCodeLine{2355       \textcolor{keywordflow}{if} (Pack2 < PacketSize \&\& !gone\_last) \{}
\DoxyCodeLine{2356         gone\_last = \textcolor{keyword}{true};}
\DoxyCodeLine{2357         psize = pack = left \& \string~1;}
\DoxyCodeLine{2358       \}}
\DoxyCodeLine{2359     \}}
\DoxyCodeLine{2360   \}}
\DoxyCodeLine{2361 }
\DoxyCodeLine{2362   \textcolor{keywordflow}{for}(; i<rows; i++)}
\DoxyCodeLine{2363   \{}
\DoxyCodeLine{2364     \textcolor{keywordflow}{if}(PanelMode) count += offset;}
\DoxyCodeLine{2365     \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0; k<depth; k++)}
\DoxyCodeLine{2366       blockA[count++] = cj(lhs(i, k));}
\DoxyCodeLine{2367     \textcolor{keywordflow}{if}(PanelMode) count += (stride-\/offset-\/depth);}
\DoxyCodeLine{2368   \}}
\DoxyCodeLine{2369 \}}
\DoxyCodeLine{2370 }
\DoxyCodeLine{2371 \textcolor{comment}{// copy a complete panel of the rhs}}
\DoxyCodeLine{2372 \textcolor{comment}{// this version is optimized for column major matrices}}
\DoxyCodeLine{2373 \textcolor{comment}{// The traversal order is as follow: (nr==4):}}
\DoxyCodeLine{2374 \textcolor{comment}{//  0  1  2  3   12 13 14 15   24 27}}
\DoxyCodeLine{2375 \textcolor{comment}{//  4  5  6  7   16 17 18 19   25 28}}
\DoxyCodeLine{2376 \textcolor{comment}{//  8  9 10 11   20 21 22 23   26 29}}
\DoxyCodeLine{2377 \textcolor{comment}{//  .  .  .  .    .  .  .  .    .  .}}
\DoxyCodeLine{2378 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} Index, \textcolor{keyword}{typename} DataMapper, \textcolor{keywordtype}{int} nr, \textcolor{keywordtype}{bool} Conjugate, \textcolor{keywordtype}{bool} PanelMode>}
\DoxyCodeLine{2379 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1gemm__pack__rhs}{gemm\_pack\_rhs}}<Scalar, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}, DataMapper, nr, \mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0103672ae41005ab03b4176c765afd62}{ColMajor}}, \mbox{\hyperlink{classEigen_1_1Conjugate}{Conjugate}}, PanelMode>}
\DoxyCodeLine{2380 \{}
\DoxyCodeLine{2381   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} packet\_traits<Scalar>::type Packet;}
\DoxyCodeLine{2382   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} DataMapper::LinearMapper LinearMapper;}
\DoxyCodeLine{2383   \textcolor{keyword}{enum} \{ PacketSize = \mbox{\hyperlink{structEigen_1_1internal_1_1packet__traits}{packet\_traits<Scalar>::size}} \};}
\DoxyCodeLine{2384   EIGEN\_DONT\_INLINE \textcolor{keywordtype}{void} operator()(Scalar* blockB, \textcolor{keyword}{const} DataMapper\& rhs, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} depth, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} cols, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} stride=0, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} offset=0);}
\DoxyCodeLine{2385 \};}
\DoxyCodeLine{2386 }
\DoxyCodeLine{2387 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} Index, \textcolor{keyword}{typename} DataMapper, \textcolor{keywordtype}{int} nr, \textcolor{keywordtype}{bool} Conjugate, \textcolor{keywordtype}{bool} PanelMode>}
\DoxyCodeLine{2388 EIGEN\_DONT\_INLINE \textcolor{keywordtype}{void} \mbox{\hyperlink{structEigen_1_1internal_1_1gemm__pack__rhs}{gemm\_pack\_rhs<Scalar, Index, DataMapper, nr, ColMajor, Conjugate, PanelMode>}}}
\DoxyCodeLine{2389 \mbox{\hyperlink{structEigen_1_1internal_1_1gemm__pack__rhs}{  ::operator()}}(Scalar* blockB, \textcolor{keyword}{const} DataMapper\& rhs, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} depth, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} cols, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} stride, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} offset)}
\DoxyCodeLine{2390 \{}
\DoxyCodeLine{2391   EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}EIGEN PRODUCT PACK RHS COLMAJOR"{}});}
\DoxyCodeLine{2392   EIGEN\_UNUSED\_VARIABLE(stride);}
\DoxyCodeLine{2393   EIGEN\_UNUSED\_VARIABLE(offset);}
\DoxyCodeLine{2394   eigen\_assert(((!PanelMode) \&\& stride==0 \&\& offset==0) || (PanelMode \&\& stride>=depth \&\& offset<=stride));}
\DoxyCodeLine{2395   \mbox{\hyperlink{structEigen_1_1internal_1_1conj__if}{conj\_if<NumTraits<Scalar>::IsComplex}} \&\& \mbox{\hyperlink{classEigen_1_1Conjugate}{Conjugate}}> cj;}
\DoxyCodeLine{2396   \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} packet\_cols8 = nr>=8 ? (cols/8) * 8 : 0;}
\DoxyCodeLine{2397   \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} packet\_cols4 = nr>=4 ? (cols/4) * 4 : 0;}
\DoxyCodeLine{2398   \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} count = 0;}
\DoxyCodeLine{2399   \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} peeled\_k = (depth/PacketSize)*PacketSize;}
\DoxyCodeLine{2400 \textcolor{comment}{//   if(nr>=8)}}
\DoxyCodeLine{2401 \textcolor{comment}{//   \{}}
\DoxyCodeLine{2402 \textcolor{comment}{//     for(Index j2=0; j2<packet\_cols8; j2+=8)}}
\DoxyCodeLine{2403 \textcolor{comment}{//     \{}}
\DoxyCodeLine{2404 \textcolor{comment}{//       // skip what we have before}}
\DoxyCodeLine{2405 \textcolor{comment}{//       if(PanelMode) count += 8 * offset;}}
\DoxyCodeLine{2406 \textcolor{comment}{//       const Scalar* b0 = \&rhs[(j2+0)*rhsStride];}}
\DoxyCodeLine{2407 \textcolor{comment}{//       const Scalar* b1 = \&rhs[(j2+1)*rhsStride];}}
\DoxyCodeLine{2408 \textcolor{comment}{//       const Scalar* b2 = \&rhs[(j2+2)*rhsStride];}}
\DoxyCodeLine{2409 \textcolor{comment}{//       const Scalar* b3 = \&rhs[(j2+3)*rhsStride];}}
\DoxyCodeLine{2410 \textcolor{comment}{//       const Scalar* b4 = \&rhs[(j2+4)*rhsStride];}}
\DoxyCodeLine{2411 \textcolor{comment}{//       const Scalar* b5 = \&rhs[(j2+5)*rhsStride];}}
\DoxyCodeLine{2412 \textcolor{comment}{//       const Scalar* b6 = \&rhs[(j2+6)*rhsStride];}}
\DoxyCodeLine{2413 \textcolor{comment}{//       const Scalar* b7 = \&rhs[(j2+7)*rhsStride];}}
\DoxyCodeLine{2414 \textcolor{comment}{//       Index k=0;}}
\DoxyCodeLine{2415 \textcolor{comment}{//       if(PacketSize==8) // TODO enable vectorized transposition for PacketSize==4}}
\DoxyCodeLine{2416 \textcolor{comment}{//       \{}}
\DoxyCodeLine{2417 \textcolor{comment}{//         for(; k<peeled\_k; k+=PacketSize) \{}}
\DoxyCodeLine{2418 \textcolor{comment}{//           PacketBlock<Packet> kernel;}}
\DoxyCodeLine{2419 \textcolor{comment}{//           for (int p = 0; p < PacketSize; ++p) \{}}
\DoxyCodeLine{2420 \textcolor{comment}{//             kernel.packet[p] = ploadu<Packet>(\&rhs[(j2+p)*rhsStride+k]);}}
\DoxyCodeLine{2421 \textcolor{comment}{//           \}}}
\DoxyCodeLine{2422 \textcolor{comment}{//           ptranspose(kernel);}}
\DoxyCodeLine{2423 \textcolor{comment}{//           for (int p = 0; p < PacketSize; ++p) \{}}
\DoxyCodeLine{2424 \textcolor{comment}{//             pstoreu(blockB+count, cj.pconj(kernel.packet[p]));}}
\DoxyCodeLine{2425 \textcolor{comment}{//             count+=PacketSize;}}
\DoxyCodeLine{2426 \textcolor{comment}{//           \}}}
\DoxyCodeLine{2427 \textcolor{comment}{//         \}}}
\DoxyCodeLine{2428 \textcolor{comment}{//       \}}}
\DoxyCodeLine{2429 \textcolor{comment}{//       for(; k<depth; k++)}}
\DoxyCodeLine{2430 \textcolor{comment}{//       \{}}
\DoxyCodeLine{2431 \textcolor{comment}{//         blockB[count+0] = cj(b0[k]);}}
\DoxyCodeLine{2432 \textcolor{comment}{//         blockB[count+1] = cj(b1[k]);}}
\DoxyCodeLine{2433 \textcolor{comment}{//         blockB[count+2] = cj(b2[k]);}}
\DoxyCodeLine{2434 \textcolor{comment}{//         blockB[count+3] = cj(b3[k]);}}
\DoxyCodeLine{2435 \textcolor{comment}{//         blockB[count+4] = cj(b4[k]);}}
\DoxyCodeLine{2436 \textcolor{comment}{//         blockB[count+5] = cj(b5[k]);}}
\DoxyCodeLine{2437 \textcolor{comment}{//         blockB[count+6] = cj(b6[k]);}}
\DoxyCodeLine{2438 \textcolor{comment}{//         blockB[count+7] = cj(b7[k]);}}
\DoxyCodeLine{2439 \textcolor{comment}{//         count += 8;}}
\DoxyCodeLine{2440 \textcolor{comment}{//       \}}}
\DoxyCodeLine{2441 \textcolor{comment}{//       // skip what we have after}}
\DoxyCodeLine{2442 \textcolor{comment}{//       if(PanelMode) count += 8 * (stride-\/offset-\/depth);}}
\DoxyCodeLine{2443 \textcolor{comment}{//     \}}}
\DoxyCodeLine{2444 \textcolor{comment}{//   \}}}
\DoxyCodeLine{2445 }
\DoxyCodeLine{2446   \textcolor{keywordflow}{if}(nr>=4)}
\DoxyCodeLine{2447   \{}
\DoxyCodeLine{2448     \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j2=packet\_cols8; j2<packet\_cols4; j2+=4)}
\DoxyCodeLine{2449     \{}
\DoxyCodeLine{2450       \textcolor{comment}{// skip what we have before}}
\DoxyCodeLine{2451       \textcolor{keywordflow}{if}(PanelMode) count += 4 * offset;}
\DoxyCodeLine{2452       \textcolor{keyword}{const} LinearMapper dm0 = rhs.getLinearMapper(0, j2 + 0);}
\DoxyCodeLine{2453       \textcolor{keyword}{const} LinearMapper dm1 = rhs.getLinearMapper(0, j2 + 1);}
\DoxyCodeLine{2454       \textcolor{keyword}{const} LinearMapper dm2 = rhs.getLinearMapper(0, j2 + 2);}
\DoxyCodeLine{2455       \textcolor{keyword}{const} LinearMapper dm3 = rhs.getLinearMapper(0, j2 + 3);}
\DoxyCodeLine{2456 }
\DoxyCodeLine{2457       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0;}
\DoxyCodeLine{2458       \textcolor{keywordflow}{if}((PacketSize\%4)==0) \textcolor{comment}{// TODO enable vectorized transposition for PacketSize==2 ??}}
\DoxyCodeLine{2459       \{}
\DoxyCodeLine{2460         \textcolor{keywordflow}{for}(; k<peeled\_k; k+=PacketSize) \{}
\DoxyCodeLine{2461           \mbox{\hyperlink{structEigen_1_1internal_1_1PacketBlock}{PacketBlock}}<\mbox{\hyperlink{unionEigen_1_1internal_1_1Packet}{Packet}},(PacketSize\%4)==0?4:PacketSize> kernel;}
\DoxyCodeLine{2462           kernel.packet[0           ] = dm0.template loadPacket<Packet>(k);}
\DoxyCodeLine{2463           kernel.packet[1\%PacketSize] = dm1.template loadPacket<Packet>(k);}
\DoxyCodeLine{2464           kernel.packet[2\%PacketSize] = dm2.template loadPacket<Packet>(k);}
\DoxyCodeLine{2465           kernel.packet[3\%PacketSize] = dm3.template loadPacket<Packet>(k);}
\DoxyCodeLine{2466           ptranspose(kernel);}
\DoxyCodeLine{2467           pstoreu(blockB+count+0*PacketSize, cj.pconj(kernel.packet[0]));}
\DoxyCodeLine{2468           pstoreu(blockB+count+1*PacketSize, cj.pconj(kernel.packet[1\%PacketSize]));}
\DoxyCodeLine{2469           pstoreu(blockB+count+2*PacketSize, cj.pconj(kernel.packet[2\%PacketSize]));}
\DoxyCodeLine{2470           pstoreu(blockB+count+3*PacketSize, cj.pconj(kernel.packet[3\%PacketSize]));}
\DoxyCodeLine{2471           count+=4*PacketSize;}
\DoxyCodeLine{2472         \}}
\DoxyCodeLine{2473       \}}
\DoxyCodeLine{2474       \textcolor{keywordflow}{for}(; k<depth; k++)}
\DoxyCodeLine{2475       \{}
\DoxyCodeLine{2476         blockB[count+0] = cj(dm0(k));}
\DoxyCodeLine{2477         blockB[count+1] = cj(dm1(k));}
\DoxyCodeLine{2478         blockB[count+2] = cj(dm2(k));}
\DoxyCodeLine{2479         blockB[count+3] = cj(dm3(k));}
\DoxyCodeLine{2480         count += 4;}
\DoxyCodeLine{2481       \}}
\DoxyCodeLine{2482       \textcolor{comment}{// skip what we have after}}
\DoxyCodeLine{2483       \textcolor{keywordflow}{if}(PanelMode) count += 4 * (stride-\/offset-\/depth);}
\DoxyCodeLine{2484     \}}
\DoxyCodeLine{2485   \}}
\DoxyCodeLine{2486 }
\DoxyCodeLine{2487   \textcolor{comment}{// copy the remaining columns one at a time (nr==1)}}
\DoxyCodeLine{2488   \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j2=packet\_cols4; j2<cols; ++j2)}
\DoxyCodeLine{2489   \{}
\DoxyCodeLine{2490     \textcolor{keywordflow}{if}(PanelMode) count += offset;}
\DoxyCodeLine{2491     \textcolor{keyword}{const} LinearMapper dm0 = rhs.getLinearMapper(0, j2);}
\DoxyCodeLine{2492     \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0; k<depth; k++)}
\DoxyCodeLine{2493     \{}
\DoxyCodeLine{2494       blockB[count] = cj(dm0(k));}
\DoxyCodeLine{2495       count += 1;}
\DoxyCodeLine{2496     \}}
\DoxyCodeLine{2497     \textcolor{keywordflow}{if}(PanelMode) count += (stride-\/offset-\/depth);}
\DoxyCodeLine{2498   \}}
\DoxyCodeLine{2499 \}}
\DoxyCodeLine{2500 }
\DoxyCodeLine{2501 \textcolor{comment}{// this version is optimized for row major matrices}}
\DoxyCodeLine{2502 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} Index, \textcolor{keyword}{typename} DataMapper, \textcolor{keywordtype}{int} nr, \textcolor{keywordtype}{bool} Conjugate, \textcolor{keywordtype}{bool} PanelMode>}
\DoxyCodeLine{2503 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1gemm__pack__rhs}{gemm\_pack\_rhs}}<Scalar, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}, DataMapper, nr, \mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a77c993a8d9f6efe5c1159fb2ab07dd4f}{RowMajor}}, \mbox{\hyperlink{classEigen_1_1Conjugate}{Conjugate}}, PanelMode>}
\DoxyCodeLine{2504 \{}
\DoxyCodeLine{2505   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} packet\_traits<Scalar>::type Packet;}
\DoxyCodeLine{2506   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{unionEigen_1_1internal_1_1Packet}{unpacket\_traits<Packet>::half}} \mbox{\hyperlink{unionEigen_1_1internal_1_1Packet}{HalfPacket}};}
\DoxyCodeLine{2507   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<typename unpacket\_traits<Packet>::half}}>\mbox{\hyperlink{structEigen_1_1half}{::half}} \mbox{\hyperlink{unionEigen_1_1internal_1_1Packet}{QuarterPacket}};}
\DoxyCodeLine{2508   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} DataMapper::LinearMapper LinearMapper;}
\DoxyCodeLine{2509   \textcolor{keyword}{enum} \{ PacketSize = \mbox{\hyperlink{structEigen_1_1internal_1_1packet__traits}{packet\_traits<Scalar>::size}},}
\DoxyCodeLine{2510          HalfPacketSize = \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<HalfPacket>::size}},}
\DoxyCodeLine{2511          QuarterPacketSize = \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<QuarterPacket>::size}}\};}
\DoxyCodeLine{2512   EIGEN\_DONT\_INLINE \textcolor{keywordtype}{void} operator()(Scalar* blockB, \textcolor{keyword}{const} DataMapper\& rhs, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} depth, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} cols, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} stride=0, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} offset=0)}
\DoxyCodeLine{2513   \{}
\DoxyCodeLine{2514     EIGEN\_ASM\_COMMENT(\textcolor{stringliteral}{"{}EIGEN PRODUCT PACK RHS ROWMAJOR"{}});}
\DoxyCodeLine{2515     EIGEN\_UNUSED\_VARIABLE(stride);}
\DoxyCodeLine{2516     EIGEN\_UNUSED\_VARIABLE(offset);}
\DoxyCodeLine{2517     eigen\_assert(((!PanelMode) \&\& stride==0 \&\& offset==0) || (PanelMode \&\& stride>=depth \&\& offset<=stride));}
\DoxyCodeLine{2518     \textcolor{keyword}{const} \textcolor{keywordtype}{bool} HasHalf = (int)HalfPacketSize < (\textcolor{keywordtype}{int})PacketSize;}
\DoxyCodeLine{2519     \textcolor{keyword}{const} \textcolor{keywordtype}{bool} HasQuarter = (int)QuarterPacketSize < (\textcolor{keywordtype}{int})HalfPacketSize;}
\DoxyCodeLine{2520     \mbox{\hyperlink{structEigen_1_1internal_1_1conj__if}{conj\_if<NumTraits<Scalar>::IsComplex}} \&\& \mbox{\hyperlink{classEigen_1_1Conjugate}{Conjugate}}> cj;}
\DoxyCodeLine{2521     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} packet\_cols8 = nr>=8 ? (cols/8) * 8 : 0;}
\DoxyCodeLine{2522     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} packet\_cols4 = nr>=4 ? (cols/4) * 4 : 0;}
\DoxyCodeLine{2523     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} count = 0;}
\DoxyCodeLine{2524 }
\DoxyCodeLine{2525   \textcolor{comment}{//   if(nr>=8)}}
\DoxyCodeLine{2526   \textcolor{comment}{//   \{}}
\DoxyCodeLine{2527   \textcolor{comment}{//     for(Index j2=0; j2<packet\_cols8; j2+=8)}}
\DoxyCodeLine{2528   \textcolor{comment}{//     \{}}
\DoxyCodeLine{2529   \textcolor{comment}{//       // skip what we have before}}
\DoxyCodeLine{2530   \textcolor{comment}{//       if(PanelMode) count += 8 * offset;}}
\DoxyCodeLine{2531   \textcolor{comment}{//       for(Index k=0; k<depth; k++)}}
\DoxyCodeLine{2532   \textcolor{comment}{//       \{}}
\DoxyCodeLine{2533   \textcolor{comment}{//         if (PacketSize==8) \{}}
\DoxyCodeLine{2534   \textcolor{comment}{//           Packet A = ploadu<Packet>(\&rhs[k*rhsStride + j2]);}}
\DoxyCodeLine{2535   \textcolor{comment}{//           pstoreu(blockB+count, cj.pconj(A));}}
\DoxyCodeLine{2536   \textcolor{comment}{//         \} else if (PacketSize==4) \{}}
\DoxyCodeLine{2537   \textcolor{comment}{//           Packet A = ploadu<Packet>(\&rhs[k*rhsStride + j2]);}}
\DoxyCodeLine{2538   \textcolor{comment}{//           Packet B = ploadu<Packet>(\&rhs[k*rhsStride + j2 + PacketSize]);}}
\DoxyCodeLine{2539   \textcolor{comment}{//           pstoreu(blockB+count, cj.pconj(A));}}
\DoxyCodeLine{2540   \textcolor{comment}{//           pstoreu(blockB+count+PacketSize, cj.pconj(B));}}
\DoxyCodeLine{2541   \textcolor{comment}{//         \} else \{}}
\DoxyCodeLine{2542   \textcolor{comment}{//           const Scalar* b0 = \&rhs[k*rhsStride + j2];}}
\DoxyCodeLine{2543   \textcolor{comment}{//           blockB[count+0] = cj(b0[0]);}}
\DoxyCodeLine{2544   \textcolor{comment}{//           blockB[count+1] = cj(b0[1]);}}
\DoxyCodeLine{2545   \textcolor{comment}{//           blockB[count+2] = cj(b0[2]);}}
\DoxyCodeLine{2546   \textcolor{comment}{//           blockB[count+3] = cj(b0[3]);}}
\DoxyCodeLine{2547   \textcolor{comment}{//           blockB[count+4] = cj(b0[4]);}}
\DoxyCodeLine{2548   \textcolor{comment}{//           blockB[count+5] = cj(b0[5]);}}
\DoxyCodeLine{2549   \textcolor{comment}{//           blockB[count+6] = cj(b0[6]);}}
\DoxyCodeLine{2550   \textcolor{comment}{//           blockB[count+7] = cj(b0[7]);}}
\DoxyCodeLine{2551   \textcolor{comment}{//         \}}}
\DoxyCodeLine{2552   \textcolor{comment}{//         count += 8;}}
\DoxyCodeLine{2553   \textcolor{comment}{//       \}}}
\DoxyCodeLine{2554   \textcolor{comment}{//       // skip what we have after}}
\DoxyCodeLine{2555   \textcolor{comment}{//       if(PanelMode) count += 8 * (stride-\/offset-\/depth);}}
\DoxyCodeLine{2556   \textcolor{comment}{//     \}}}
\DoxyCodeLine{2557   \textcolor{comment}{//   \}}}
\DoxyCodeLine{2558     \textcolor{keywordflow}{if}(nr>=4)}
\DoxyCodeLine{2559     \{}
\DoxyCodeLine{2560       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j2=packet\_cols8; j2<packet\_cols4; j2+=4)}
\DoxyCodeLine{2561       \{}
\DoxyCodeLine{2562         \textcolor{comment}{// skip what we have before}}
\DoxyCodeLine{2563         \textcolor{keywordflow}{if}(PanelMode) count += 4 * offset;}
\DoxyCodeLine{2564         \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0; k<depth; k++)}
\DoxyCodeLine{2565         \{}
\DoxyCodeLine{2566           \textcolor{keywordflow}{if} (PacketSize==4) \{}
\DoxyCodeLine{2567             Packet A = rhs.template loadPacket<Packet>(k, j2);}
\DoxyCodeLine{2568             pstoreu(blockB+count, cj.pconj(A));}
\DoxyCodeLine{2569             count += PacketSize;}
\DoxyCodeLine{2570           \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (HasHalf \&\& HalfPacketSize==4) \{}
\DoxyCodeLine{2571             \mbox{\hyperlink{unionEigen_1_1internal_1_1Packet}{HalfPacket}} A = rhs.template loadPacket<HalfPacket>(k, j2);}
\DoxyCodeLine{2572             pstoreu(blockB+count, cj.pconj(A));}
\DoxyCodeLine{2573             count += HalfPacketSize;}
\DoxyCodeLine{2574           \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (HasQuarter \&\& QuarterPacketSize==4) \{}
\DoxyCodeLine{2575             \mbox{\hyperlink{unionEigen_1_1internal_1_1Packet}{QuarterPacket}} A = rhs.template loadPacket<QuarterPacket>(k, j2);}
\DoxyCodeLine{2576             pstoreu(blockB+count, cj.pconj(A));}
\DoxyCodeLine{2577             count += QuarterPacketSize;}
\DoxyCodeLine{2578           \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2579             \textcolor{keyword}{const} LinearMapper dm0 = rhs.getLinearMapper(k, j2);}
\DoxyCodeLine{2580             blockB[count+0] = cj(dm0(0));}
\DoxyCodeLine{2581             blockB[count+1] = cj(dm0(1));}
\DoxyCodeLine{2582             blockB[count+2] = cj(dm0(2));}
\DoxyCodeLine{2583             blockB[count+3] = cj(dm0(3));}
\DoxyCodeLine{2584             count += 4;}
\DoxyCodeLine{2585           \}}
\DoxyCodeLine{2586         \}}
\DoxyCodeLine{2587         \textcolor{comment}{// skip what we have after}}
\DoxyCodeLine{2588         \textcolor{keywordflow}{if}(PanelMode) count += 4 * (stride-\/offset-\/depth);}
\DoxyCodeLine{2589       \}}
\DoxyCodeLine{2590     \}}
\DoxyCodeLine{2591     \textcolor{comment}{// copy the remaining columns one at a time (nr==1)}}
\DoxyCodeLine{2592     \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j2=packet\_cols4; j2<cols; ++j2)}
\DoxyCodeLine{2593     \{}
\DoxyCodeLine{2594       \textcolor{keywordflow}{if}(PanelMode) count += offset;}
\DoxyCodeLine{2595       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k=0; k<depth; k++)}
\DoxyCodeLine{2596       \{}
\DoxyCodeLine{2597         blockB[count] = cj(rhs(k, j2));}
\DoxyCodeLine{2598         count += 1;}
\DoxyCodeLine{2599       \}}
\DoxyCodeLine{2600       \textcolor{keywordflow}{if}(PanelMode) count += stride-\/offset-\/depth;}
\DoxyCodeLine{2601     \}}
\DoxyCodeLine{2602   \}}
\DoxyCodeLine{2603 \};}
\DoxyCodeLine{2604 }
\DoxyCodeLine{2605 \} \textcolor{comment}{// end namespace internal}}
\DoxyCodeLine{2606 }
\DoxyCodeLine{2609 \textcolor{keyword}{inline} std::ptrdiff\_t \mbox{\hyperlink{namespaceEigen_a2669f89ff38296a38e6d973552eb4e33}{l1CacheSize}}()}
\DoxyCodeLine{2610 \{}
\DoxyCodeLine{2611   std::ptrdiff\_t l1, l2, l3;}
\DoxyCodeLine{2612   internal::manage\_caching\_sizes(GetAction, \&l1, \&l2, \&l3);}
\DoxyCodeLine{2613   \textcolor{keywordflow}{return} l1;}
\DoxyCodeLine{2614 \}}
\DoxyCodeLine{2615 }
\DoxyCodeLine{2618 \textcolor{keyword}{inline} std::ptrdiff\_t \mbox{\hyperlink{namespaceEigen_a2cfc0330ba567d63a496be1cac8427ae}{l2CacheSize}}()}
\DoxyCodeLine{2619 \{}
\DoxyCodeLine{2620   std::ptrdiff\_t l1, l2, l3;}
\DoxyCodeLine{2621   internal::manage\_caching\_sizes(GetAction, \&l1, \&l2, \&l3);}
\DoxyCodeLine{2622   \textcolor{keywordflow}{return} l2;}
\DoxyCodeLine{2623 \}}
\DoxyCodeLine{2624 }
\DoxyCodeLine{2628 \textcolor{keyword}{inline} std::ptrdiff\_t \mbox{\hyperlink{namespaceEigen_ae2efa4852ea90c2d47b7dcec5b40ba2b}{l3CacheSize}}()}
\DoxyCodeLine{2629 \{}
\DoxyCodeLine{2630   std::ptrdiff\_t l1, l2, l3;}
\DoxyCodeLine{2631   internal::manage\_caching\_sizes(GetAction, \&l1, \&l2, \&l3);}
\DoxyCodeLine{2632   \textcolor{keywordflow}{return} l3;}
\DoxyCodeLine{2633 \}}
\DoxyCodeLine{2634 }
\DoxyCodeLine{2640 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceEigen_ae64421554aa0a4bf9258bafe3170102b}{setCpuCacheSizes}}(std::ptrdiff\_t l1, std::ptrdiff\_t l2, std::ptrdiff\_t l3)}
\DoxyCodeLine{2641 \{}
\DoxyCodeLine{2642   internal::manage\_caching\_sizes(SetAction, \&l1, \&l2, \&l3);}
\DoxyCodeLine{2643 \}}
\DoxyCodeLine{2644 }
\DoxyCodeLine{2645 \} \textcolor{comment}{// end namespace Eigen}}
\DoxyCodeLine{2646 }
\DoxyCodeLine{2647 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// EIGEN\_GENERAL\_BLOCK\_PANEL\_H}}

\end{DoxyCode}
