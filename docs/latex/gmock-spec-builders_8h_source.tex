\hypertarget{gmock-spec-builders_8h_source}{}\doxysection{gmock-\/spec-\/builders.h}
\label{gmock-spec-builders_8h_source}\index{vendor/googletest/googlemock/include/gmock/gmock-\/spec-\/builders.h@{vendor/googletest/googlemock/include/gmock/gmock-\/spec-\/builders.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// Copyright 2007, Google Inc.}}
\DoxyCodeLine{2 \textcolor{comment}{// All rights reserved.}}
\DoxyCodeLine{3 \textcolor{comment}{//}}
\DoxyCodeLine{4 \textcolor{comment}{// Redistribution and use in source and binary forms, with or without}}
\DoxyCodeLine{5 \textcolor{comment}{// modification, are permitted provided that the following conditions are}}
\DoxyCodeLine{6 \textcolor{comment}{// met:}}
\DoxyCodeLine{7 \textcolor{comment}{//}}
\DoxyCodeLine{8 \textcolor{comment}{//     * Redistributions of source code must retain the above copyright}}
\DoxyCodeLine{9 \textcolor{comment}{// notice, this list of conditions and the following disclaimer.}}
\DoxyCodeLine{10 \textcolor{comment}{//     * Redistributions in binary form must reproduce the above}}
\DoxyCodeLine{11 \textcolor{comment}{// copyright notice, this list of conditions and the following disclaimer}}
\DoxyCodeLine{12 \textcolor{comment}{// in the documentation and/or other materials provided with the}}
\DoxyCodeLine{13 \textcolor{comment}{// distribution.}}
\DoxyCodeLine{14 \textcolor{comment}{//     * Neither the name of Google Inc. nor the names of its}}
\DoxyCodeLine{15 \textcolor{comment}{// contributors may be used to endorse or promote products derived from}}
\DoxyCodeLine{16 \textcolor{comment}{// this software without specific prior written permission.}}
\DoxyCodeLine{17 \textcolor{comment}{//}}
\DoxyCodeLine{18 \textcolor{comment}{// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS}}
\DoxyCodeLine{19 \textcolor{comment}{// "{}AS IS"{} AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT}}
\DoxyCodeLine{20 \textcolor{comment}{// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR}}
\DoxyCodeLine{21 \textcolor{comment}{// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT}}
\DoxyCodeLine{22 \textcolor{comment}{// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,}}
\DoxyCodeLine{23 \textcolor{comment}{// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT}}
\DoxyCodeLine{24 \textcolor{comment}{// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,}}
\DoxyCodeLine{25 \textcolor{comment}{// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY}}
\DoxyCodeLine{26 \textcolor{comment}{// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT}}
\DoxyCodeLine{27 \textcolor{comment}{// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE}}
\DoxyCodeLine{28 \textcolor{comment}{// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.}}
\DoxyCodeLine{29 \textcolor{comment}{//}}
\DoxyCodeLine{30 \textcolor{comment}{// Author: wan@google.com (Zhanyong Wan)}}
\DoxyCodeLine{31 }
\DoxyCodeLine{32 \textcolor{comment}{// Google Mock -\/ a framework for writing C++ mock classes.}}
\DoxyCodeLine{33 \textcolor{comment}{//}}
\DoxyCodeLine{34 \textcolor{comment}{// This file implements the ON\_CALL() and EXPECT\_CALL() macros.}}
\DoxyCodeLine{35 \textcolor{comment}{//}}
\DoxyCodeLine{36 \textcolor{comment}{// A user can use the ON\_CALL() macro to specify the default action of}}
\DoxyCodeLine{37 \textcolor{comment}{// a mock method.  The syntax is:}}
\DoxyCodeLine{38 \textcolor{comment}{//}}
\DoxyCodeLine{39 \textcolor{comment}{//   ON\_CALL(mock\_object, Method(argument-\/matchers))}}
\DoxyCodeLine{40 \textcolor{comment}{//       .With(multi-\/argument-\/matcher)}}
\DoxyCodeLine{41 \textcolor{comment}{//       .WillByDefault(action);}}
\DoxyCodeLine{42 \textcolor{comment}{//}}
\DoxyCodeLine{43 \textcolor{comment}{//  where the .With() clause is optional.}}
\DoxyCodeLine{44 \textcolor{comment}{//}}
\DoxyCodeLine{45 \textcolor{comment}{// A user can use the EXPECT\_CALL() macro to specify an expectation on}}
\DoxyCodeLine{46 \textcolor{comment}{// a mock method.  The syntax is:}}
\DoxyCodeLine{47 \textcolor{comment}{//}}
\DoxyCodeLine{48 \textcolor{comment}{//   EXPECT\_CALL(mock\_object, Method(argument-\/matchers))}}
\DoxyCodeLine{49 \textcolor{comment}{//       .With(multi-\/argument-\/matchers)}}
\DoxyCodeLine{50 \textcolor{comment}{//       .Times(cardinality)}}
\DoxyCodeLine{51 \textcolor{comment}{//       .InSequence(sequences)}}
\DoxyCodeLine{52 \textcolor{comment}{//       .After(expectations)}}
\DoxyCodeLine{53 \textcolor{comment}{//       .WillOnce(action)}}
\DoxyCodeLine{54 \textcolor{comment}{//       .WillRepeatedly(action)}}
\DoxyCodeLine{55 \textcolor{comment}{//       .RetiresOnSaturation();}}
\DoxyCodeLine{56 \textcolor{comment}{//}}
\DoxyCodeLine{57 \textcolor{comment}{// where all clauses are optional, and .InSequence()/.After()/}}
\DoxyCodeLine{58 \textcolor{comment}{// .WillOnce() can appear any number of times.}}
\DoxyCodeLine{59 }
\DoxyCodeLine{60 \textcolor{preprocessor}{\#ifndef GMOCK\_INCLUDE\_GMOCK\_GMOCK\_SPEC\_BUILDERS\_H\_}}
\DoxyCodeLine{61 \textcolor{preprocessor}{\#define GMOCK\_INCLUDE\_GMOCK\_GMOCK\_SPEC\_BUILDERS\_H\_}}
\DoxyCodeLine{62 }
\DoxyCodeLine{63 \textcolor{preprocessor}{\#include <map>}}
\DoxyCodeLine{64 \textcolor{preprocessor}{\#include <set>}}
\DoxyCodeLine{65 \textcolor{preprocessor}{\#include <sstream>}}
\DoxyCodeLine{66 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{67 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{68 }
\DoxyCodeLine{69 \textcolor{preprocessor}{\#if GTEST\_HAS\_EXCEPTIONS}}
\DoxyCodeLine{70 \textcolor{preprocessor}{\# include <stdexcept>}  \textcolor{comment}{// NOLINT}}
\DoxyCodeLine{71 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{72 }
\DoxyCodeLine{73 \textcolor{preprocessor}{\#include "{}gmock/gmock-\/actions.h"{}}}
\DoxyCodeLine{74 \textcolor{preprocessor}{\#include "{}gmock/gmock-\/cardinalities.h"{}}}
\DoxyCodeLine{75 \textcolor{preprocessor}{\#include "{}gmock/gmock-\/matchers.h"{}}}
\DoxyCodeLine{76 \textcolor{preprocessor}{\#include "{}gmock/internal/gmock-\/internal-\/utils.h"{}}}
\DoxyCodeLine{77 \textcolor{preprocessor}{\#include "{}gmock/internal/gmock-\/port.h"{}}}
\DoxyCodeLine{78 \textcolor{preprocessor}{\#include "{}gtest/gtest.h"{}}}
\DoxyCodeLine{79 }
\DoxyCodeLine{80 \textcolor{keyword}{namespace }testing \{}
\DoxyCodeLine{81 }
\DoxyCodeLine{82 \textcolor{comment}{// An abstract handle of an expectation.}}
\DoxyCodeLine{83 \textcolor{keyword}{class }Expectation;}
\DoxyCodeLine{84 }
\DoxyCodeLine{85 \textcolor{comment}{// A set of expectation handles.}}
\DoxyCodeLine{86 \textcolor{keyword}{class }ExpectationSet;}
\DoxyCodeLine{87 }
\DoxyCodeLine{88 \textcolor{comment}{// Anything inside the 'internal' namespace IS INTERNAL IMPLEMENTATION}}
\DoxyCodeLine{89 \textcolor{comment}{// and MUST NOT BE USED IN USER CODE!!!}}
\DoxyCodeLine{90 \textcolor{keyword}{namespace }internal \{}
\DoxyCodeLine{91 }
\DoxyCodeLine{92 \textcolor{comment}{// Implements a mock function.}}
\DoxyCodeLine{93 \textcolor{keyword}{template} <\textcolor{keyword}{typename} F> \textcolor{keyword}{class }FunctionMocker;}
\DoxyCodeLine{94 }
\DoxyCodeLine{95 \textcolor{comment}{// Base class for expectations.}}
\DoxyCodeLine{96 \textcolor{keyword}{class }ExpectationBase;}
\DoxyCodeLine{97 }
\DoxyCodeLine{98 \textcolor{comment}{// Implements an expectation.}}
\DoxyCodeLine{99 \textcolor{keyword}{template} <\textcolor{keyword}{typename} F> \textcolor{keyword}{class }TypedExpectation;}
\DoxyCodeLine{100 }
\DoxyCodeLine{101 \textcolor{comment}{// Helper class for testing the Expectation class template.}}
\DoxyCodeLine{102 \textcolor{keyword}{class }ExpectationTester;}
\DoxyCodeLine{103 }
\DoxyCodeLine{104 \textcolor{comment}{// Base class for function mockers.}}
\DoxyCodeLine{105 \textcolor{keyword}{template} <\textcolor{keyword}{typename} F> \textcolor{keyword}{class }FunctionMockerBase;}
\DoxyCodeLine{106 }
\DoxyCodeLine{107 \textcolor{comment}{// Protects the mock object registry (in class Mock), all function}}
\DoxyCodeLine{108 \textcolor{comment}{// mockers, and all expectations.}}
\DoxyCodeLine{109 \textcolor{comment}{//}}
\DoxyCodeLine{110 \textcolor{comment}{// The reason we don't use more fine-\/grained protection is: when a}}
\DoxyCodeLine{111 \textcolor{comment}{// mock function Foo() is called, it needs to consult its expectations}}
\DoxyCodeLine{112 \textcolor{comment}{// to see which one should be picked.  If another thread is allowed to}}
\DoxyCodeLine{113 \textcolor{comment}{// call a mock function (either Foo() or a different one) at the same}}
\DoxyCodeLine{114 \textcolor{comment}{// time, it could affect the "{}retired"{} attributes of Foo()'s}}
\DoxyCodeLine{115 \textcolor{comment}{// expectations when InSequence() is used, and thus affect which}}
\DoxyCodeLine{116 \textcolor{comment}{// expectation gets picked.  Therefore, we sequence all mock function}}
\DoxyCodeLine{117 \textcolor{comment}{// calls to ensure the integrity of the mock objects' states.}}
\DoxyCodeLine{118 GTEST\_API\_ GTEST\_DECLARE\_STATIC\_MUTEX\_(g\_gmock\_mutex);}
\DoxyCodeLine{119 }
\DoxyCodeLine{120 \textcolor{comment}{// Untyped base class for ActionResultHolder<R>.}}
\DoxyCodeLine{121 \textcolor{keyword}{class }UntypedActionResultHolderBase;}
\DoxyCodeLine{122 }
\DoxyCodeLine{123 \textcolor{comment}{// Abstract base class of FunctionMockerBase.  This is the}}
\DoxyCodeLine{124 \textcolor{comment}{// type-\/agnostic part of the function mocker interface.  Its pure}}
\DoxyCodeLine{125 \textcolor{comment}{// virtual methods are implemented by FunctionMockerBase.}}
\DoxyCodeLine{126 \textcolor{keyword}{class }GTEST\_API\_ \mbox{\hyperlink{classtesting_1_1internal_1_1UntypedFunctionMockerBase}{UntypedFunctionMockerBase}} \{}
\DoxyCodeLine{127  \textcolor{keyword}{public}:}
\DoxyCodeLine{128   \mbox{\hyperlink{classtesting_1_1internal_1_1UntypedFunctionMockerBase}{UntypedFunctionMockerBase}}();}
\DoxyCodeLine{129   \textcolor{keyword}{virtual} \mbox{\hyperlink{classtesting_1_1internal_1_1UntypedFunctionMockerBase}{\string~UntypedFunctionMockerBase}}();}
\DoxyCodeLine{130 }
\DoxyCodeLine{131   \textcolor{comment}{// Verifies that all expectations on this mock function have been}}
\DoxyCodeLine{132   \textcolor{comment}{// satisfied.  Reports one or more Google Test non-\/fatal failures}}
\DoxyCodeLine{133   \textcolor{comment}{// and returns false if not.}}
\DoxyCodeLine{134   \textcolor{keywordtype}{bool} VerifyAndClearExpectationsLocked()}
\DoxyCodeLine{135       GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex);}
\DoxyCodeLine{136 }
\DoxyCodeLine{137   \textcolor{comment}{// Clears the ON\_CALL()s set on this mock function.}}
\DoxyCodeLine{138   \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} ClearDefaultActionsLocked()}
\DoxyCodeLine{139       GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex) = 0;}
\DoxyCodeLine{140 }
\DoxyCodeLine{141   \textcolor{comment}{// In all of the following Untyped* functions, it's the caller's}}
\DoxyCodeLine{142   \textcolor{comment}{// responsibility to guarantee the correctness of the arguments'}}
\DoxyCodeLine{143   \textcolor{comment}{// types.}}
\DoxyCodeLine{144 }
\DoxyCodeLine{145   \textcolor{comment}{// Performs the default action with the given arguments and returns}}
\DoxyCodeLine{146   \textcolor{comment}{// the action's result.  The call description string will be used in}}
\DoxyCodeLine{147   \textcolor{comment}{// the error message to describe the call in the case the default}}
\DoxyCodeLine{148   \textcolor{comment}{// action fails.}}
\DoxyCodeLine{149   \textcolor{comment}{// L = *}}
\DoxyCodeLine{150   \textcolor{keyword}{virtual} \mbox{\hyperlink{classtesting_1_1internal_1_1UntypedActionResultHolderBase}{UntypedActionResultHolderBase}}* UntypedPerformDefaultAction(}
\DoxyCodeLine{151       \textcolor{keyword}{const} \textcolor{keywordtype}{void}* untyped\_args,}
\DoxyCodeLine{152       \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& call\_description) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{153 }
\DoxyCodeLine{154   \textcolor{comment}{// Performs the given action with the given arguments and returns}}
\DoxyCodeLine{155   \textcolor{comment}{// the action's result.}}
\DoxyCodeLine{156   \textcolor{comment}{// L = *}}
\DoxyCodeLine{157   \textcolor{keyword}{virtual} \mbox{\hyperlink{classtesting_1_1internal_1_1UntypedActionResultHolderBase}{UntypedActionResultHolderBase}}* UntypedPerformAction(}
\DoxyCodeLine{158       \textcolor{keyword}{const} \textcolor{keywordtype}{void}* untyped\_action,}
\DoxyCodeLine{159       \textcolor{keyword}{const} \textcolor{keywordtype}{void}* untyped\_args) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{160 }
\DoxyCodeLine{161   \textcolor{comment}{// Writes a message that the call is uninteresting (i.e. neither}}
\DoxyCodeLine{162   \textcolor{comment}{// explicitly expected nor explicitly unexpected) to the given}}
\DoxyCodeLine{163   \textcolor{comment}{// ostream.}}
\DoxyCodeLine{164   \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} UntypedDescribeUninterestingCall(}
\DoxyCodeLine{165       \textcolor{keyword}{const} \textcolor{keywordtype}{void}* untyped\_args,}
\DoxyCodeLine{166       ::std::ostream* os) \textcolor{keyword}{const}}
\DoxyCodeLine{167           GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex) = 0;}
\DoxyCodeLine{168 }
\DoxyCodeLine{169   \textcolor{comment}{// Returns the expectation that matches the given function arguments}}
\DoxyCodeLine{170   \textcolor{comment}{// (or NULL is there's no match); when a match is found,}}
\DoxyCodeLine{171   \textcolor{comment}{// untyped\_action is set to point to the action that should be}}
\DoxyCodeLine{172   \textcolor{comment}{// performed (or NULL if the action is "{}do default"{}), and}}
\DoxyCodeLine{173   \textcolor{comment}{// is\_excessive is modified to indicate whether the call exceeds the}}
\DoxyCodeLine{174   \textcolor{comment}{// expected number.}}
\DoxyCodeLine{175   \textcolor{keyword}{virtual} \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1internal_1_1ExpectationBase}{ExpectationBase}}* UntypedFindMatchingExpectation(}
\DoxyCodeLine{176       \textcolor{keyword}{const} \textcolor{keywordtype}{void}* untyped\_args,}
\DoxyCodeLine{177       \textcolor{keyword}{const} \textcolor{keywordtype}{void}** untyped\_action, \textcolor{keywordtype}{bool}* is\_excessive,}
\DoxyCodeLine{178       ::std::ostream* what, ::std::ostream* why)}
\DoxyCodeLine{179           GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex) = 0;}
\DoxyCodeLine{180 }
\DoxyCodeLine{181   \textcolor{comment}{// Prints the given function arguments to the ostream.}}
\DoxyCodeLine{182   \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} UntypedPrintArgs(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* untyped\_args,}
\DoxyCodeLine{183                                 ::std::ostream* os) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{184 }
\DoxyCodeLine{185   \textcolor{comment}{// Sets the mock object this mock method belongs to, and registers}}
\DoxyCodeLine{186   \textcolor{comment}{// this information in the global mock registry.  Will be called}}
\DoxyCodeLine{187   \textcolor{comment}{// whenever an EXPECT\_CALL() or ON\_CALL() is executed on this mock}}
\DoxyCodeLine{188   \textcolor{comment}{// method.}}
\DoxyCodeLine{189   \textcolor{comment}{// TODO(wan@google.com): rename to SetAndRegisterOwner().}}
\DoxyCodeLine{190   \textcolor{keywordtype}{void} RegisterOwner(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* mock\_obj)}
\DoxyCodeLine{191       GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex);}
\DoxyCodeLine{192 }
\DoxyCodeLine{193   \textcolor{comment}{// Sets the mock object this mock method belongs to, and sets the}}
\DoxyCodeLine{194   \textcolor{comment}{// name of the mock function.  Will be called upon each invocation}}
\DoxyCodeLine{195   \textcolor{comment}{// of this mock function.}}
\DoxyCodeLine{196   \textcolor{keywordtype}{void} SetOwnerAndName(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* mock\_obj, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* name)}
\DoxyCodeLine{197       GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex);}
\DoxyCodeLine{198 }
\DoxyCodeLine{199   \textcolor{comment}{// Returns the mock object this mock method belongs to.  Must be}}
\DoxyCodeLine{200   \textcolor{comment}{// called after RegisterOwner() or SetOwnerAndName() has been}}
\DoxyCodeLine{201   \textcolor{comment}{// called.}}
\DoxyCodeLine{202   \textcolor{keyword}{const} \textcolor{keywordtype}{void}* MockObject() \textcolor{keyword}{const}}
\DoxyCodeLine{203       GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex);}
\DoxyCodeLine{204 }
\DoxyCodeLine{205   \textcolor{comment}{// Returns the name of this mock method.  Must be called after}}
\DoxyCodeLine{206   \textcolor{comment}{// SetOwnerAndName() has been called.}}
\DoxyCodeLine{207   \textcolor{keyword}{const} \textcolor{keywordtype}{char}* Name() \textcolor{keyword}{const}}
\DoxyCodeLine{208       GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex);}
\DoxyCodeLine{209 }
\DoxyCodeLine{210   \textcolor{comment}{// Returns the result of invoking this mock function with the given}}
\DoxyCodeLine{211   \textcolor{comment}{// arguments.  This function can be safely called from multiple}}
\DoxyCodeLine{212   \textcolor{comment}{// threads concurrently.  The caller is responsible for deleting the}}
\DoxyCodeLine{213   \textcolor{comment}{// result.}}
\DoxyCodeLine{214   \mbox{\hyperlink{classtesting_1_1internal_1_1UntypedActionResultHolderBase}{UntypedActionResultHolderBase}}* UntypedInvokeWith(}
\DoxyCodeLine{215       \textcolor{keyword}{const} \textcolor{keywordtype}{void}* untyped\_args)}
\DoxyCodeLine{216           GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex);}
\DoxyCodeLine{217 }
\DoxyCodeLine{218  \textcolor{keyword}{protected}:}
\DoxyCodeLine{219   \textcolor{keyword}{typedef} std::vector<const void*> UntypedOnCallSpecs;}
\DoxyCodeLine{220 }
\DoxyCodeLine{221   \textcolor{keyword}{typedef} std::vector<internal::linked\_ptr<ExpectationBase> >}
\DoxyCodeLine{222   UntypedExpectations;}
\DoxyCodeLine{223 }
\DoxyCodeLine{224   \textcolor{comment}{// Returns an Expectation object that references and co-\/owns exp,}}
\DoxyCodeLine{225   \textcolor{comment}{// which must be an expectation on this mock function.}}
\DoxyCodeLine{226   \mbox{\hyperlink{classtesting_1_1Expectation}{Expectation}} GetHandleOf(\mbox{\hyperlink{classtesting_1_1internal_1_1ExpectationBase}{ExpectationBase}}* exp);}
\DoxyCodeLine{227 }
\DoxyCodeLine{228   \textcolor{comment}{// Address of the mock object this mock method belongs to.  Only}}
\DoxyCodeLine{229   \textcolor{comment}{// valid after this mock method has been called or}}
\DoxyCodeLine{230   \textcolor{comment}{// ON\_CALL/EXPECT\_CALL has been invoked on it.}}
\DoxyCodeLine{231   \textcolor{keyword}{const} \textcolor{keywordtype}{void}* mock\_obj\_;  \textcolor{comment}{// Protected by g\_gmock\_mutex.}}
\DoxyCodeLine{232 }
\DoxyCodeLine{233   \textcolor{comment}{// Name of the function being mocked.  Only valid after this mock}}
\DoxyCodeLine{234   \textcolor{comment}{// method has been called.}}
\DoxyCodeLine{235   \textcolor{keyword}{const} \textcolor{keywordtype}{char}* name\_;  \textcolor{comment}{// Protected by g\_gmock\_mutex.}}
\DoxyCodeLine{236 }
\DoxyCodeLine{237   \textcolor{comment}{// All default action specs for this function mocker.}}
\DoxyCodeLine{238   UntypedOnCallSpecs untyped\_on\_call\_specs\_;}
\DoxyCodeLine{239 }
\DoxyCodeLine{240   \textcolor{comment}{// All expectations for this function mocker.}}
\DoxyCodeLine{241   UntypedExpectations untyped\_expectations\_;}
\DoxyCodeLine{242 \};  \textcolor{comment}{// class UntypedFunctionMockerBase}}
\DoxyCodeLine{243 }
\DoxyCodeLine{244 \textcolor{comment}{// Untyped base class for OnCallSpec<F>.}}
\DoxyCodeLine{245 \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1internal_1_1UntypedOnCallSpecBase}{UntypedOnCallSpecBase}} \{}
\DoxyCodeLine{246  \textcolor{keyword}{public}:}
\DoxyCodeLine{247   \textcolor{comment}{// The arguments are the location of the ON\_CALL() statement.}}
\DoxyCodeLine{248   \mbox{\hyperlink{classtesting_1_1internal_1_1UntypedOnCallSpecBase}{UntypedOnCallSpecBase}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* a\_file, \textcolor{keywordtype}{int} a\_line)}
\DoxyCodeLine{249       : file\_(a\_file), line\_(a\_line), last\_clause\_(kNone) \{\}}
\DoxyCodeLine{250 }
\DoxyCodeLine{251   \textcolor{comment}{// Where in the source file was the default action spec defined?}}
\DoxyCodeLine{252   \textcolor{keyword}{const} \textcolor{keywordtype}{char}* file()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} file\_; \}}
\DoxyCodeLine{253   \textcolor{keywordtype}{int} line()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} line\_; \}}
\DoxyCodeLine{254 }
\DoxyCodeLine{255  \textcolor{keyword}{protected}:}
\DoxyCodeLine{256   \textcolor{comment}{// Gives each clause in the ON\_CALL() statement a name.}}
\DoxyCodeLine{257   \textcolor{keyword}{enum} Clause \{}
\DoxyCodeLine{258     \textcolor{comment}{// Do not change the order of the enum members!  The run-\/time}}
\DoxyCodeLine{259     \textcolor{comment}{// syntax checking relies on it.}}
\DoxyCodeLine{260     kNone,}
\DoxyCodeLine{261     kWith,}
\DoxyCodeLine{262     kWillByDefault}
\DoxyCodeLine{263   \};}
\DoxyCodeLine{264 }
\DoxyCodeLine{265   \textcolor{comment}{// Asserts that the ON\_CALL() statement has a certain property.}}
\DoxyCodeLine{266   \textcolor{keywordtype}{void} AssertSpecProperty(\textcolor{keywordtype}{bool} property, \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& failure\_message)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{267     Assert(property, file\_, line\_, failure\_message);}
\DoxyCodeLine{268   \}}
\DoxyCodeLine{269 }
\DoxyCodeLine{270   \textcolor{comment}{// Expects that the ON\_CALL() statement has a certain property.}}
\DoxyCodeLine{271   \textcolor{keywordtype}{void} ExpectSpecProperty(\textcolor{keywordtype}{bool} property, \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& failure\_message)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{272     Expect(property, file\_, line\_, failure\_message);}
\DoxyCodeLine{273   \}}
\DoxyCodeLine{274 }
\DoxyCodeLine{275   \textcolor{keyword}{const} \textcolor{keywordtype}{char}* file\_;}
\DoxyCodeLine{276   \textcolor{keywordtype}{int} line\_;}
\DoxyCodeLine{277 }
\DoxyCodeLine{278   \textcolor{comment}{// The last clause in the ON\_CALL() statement as seen so far.}}
\DoxyCodeLine{279   \textcolor{comment}{// Initially kNone and changes as the statement is parsed.}}
\DoxyCodeLine{280   Clause last\_clause\_;}
\DoxyCodeLine{281 \};  \textcolor{comment}{// class UntypedOnCallSpecBase}}
\DoxyCodeLine{282 }
\DoxyCodeLine{283 \textcolor{comment}{// This template class implements an ON\_CALL spec.}}
\DoxyCodeLine{284 \textcolor{keyword}{template} <\textcolor{keyword}{typename} F>}
\DoxyCodeLine{285 \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1internal_1_1OnCallSpec}{OnCallSpec}} : \textcolor{keyword}{public} \mbox{\hyperlink{classtesting_1_1internal_1_1UntypedOnCallSpecBase}{UntypedOnCallSpecBase}} \{}
\DoxyCodeLine{286  \textcolor{keyword}{public}:}
\DoxyCodeLine{287   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structtesting_1_1internal_1_1Function}{Function<F>::ArgumentTuple}} ArgumentTuple;}
\DoxyCodeLine{288   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structtesting_1_1internal_1_1Function}{Function<F>::ArgumentMatcherTuple}} ArgumentMatcherTuple;}
\DoxyCodeLine{289 }
\DoxyCodeLine{290   \textcolor{comment}{// Constructs an OnCallSpec object from the information inside}}
\DoxyCodeLine{291   \textcolor{comment}{// the parenthesis of an ON\_CALL() statement.}}
\DoxyCodeLine{292   \mbox{\hyperlink{classtesting_1_1internal_1_1OnCallSpec}{OnCallSpec}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* a\_file, \textcolor{keywordtype}{int} a\_line,}
\DoxyCodeLine{293              \textcolor{keyword}{const} ArgumentMatcherTuple\& matchers)}
\DoxyCodeLine{294       : \mbox{\hyperlink{classtesting_1_1internal_1_1UntypedOnCallSpecBase}{UntypedOnCallSpecBase}}(a\_file, a\_line),}
\DoxyCodeLine{295         matchers\_(matchers),}
\DoxyCodeLine{296         \textcolor{comment}{// By default, extra\_matcher\_ should match anything.  However,}}
\DoxyCodeLine{297         \textcolor{comment}{// we cannot initialize it with \_ as that triggers a compiler}}
\DoxyCodeLine{298         \textcolor{comment}{// bug in Symbian's C++ compiler (cannot decide between two}}
\DoxyCodeLine{299         \textcolor{comment}{// overloaded constructors of Matcher<const ArgumentTuple\&>).}}
\DoxyCodeLine{300         extra\_matcher\_(A<const ArgumentTuple\&>()) \{}
\DoxyCodeLine{301   \}}
\DoxyCodeLine{302 }
\DoxyCodeLine{303   \textcolor{comment}{// Implements the .With() clause.}}
\DoxyCodeLine{304   \mbox{\hyperlink{classtesting_1_1internal_1_1OnCallSpec}{OnCallSpec}}\& With(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Matcher}{Matcher<const ArgumentTuple\&>}}\& m) \{}
\DoxyCodeLine{305     \textcolor{comment}{// Makes sure this is called at most once.}}
\DoxyCodeLine{306     ExpectSpecProperty(last\_clause\_ < kWith,}
\DoxyCodeLine{307                        \textcolor{stringliteral}{"{}.With() cannot appear "{}}}
\DoxyCodeLine{308                        \textcolor{stringliteral}{"{}more than once in an ON\_CALL()."{}});}
\DoxyCodeLine{309     last\_clause\_ = kWith;}
\DoxyCodeLine{310 }
\DoxyCodeLine{311     extra\_matcher\_ = m;}
\DoxyCodeLine{312     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{313   \}}
\DoxyCodeLine{314 }
\DoxyCodeLine{315   \textcolor{comment}{// Implements the .WillByDefault() clause.}}
\DoxyCodeLine{316   \mbox{\hyperlink{classtesting_1_1internal_1_1OnCallSpec}{OnCallSpec}}\& WillByDefault(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Action}{Action<F>}}\& action) \{}
\DoxyCodeLine{317     ExpectSpecProperty(last\_clause\_ < kWillByDefault,}
\DoxyCodeLine{318                        \textcolor{stringliteral}{"{}.WillByDefault() must appear "{}}}
\DoxyCodeLine{319                        \textcolor{stringliteral}{"{}exactly once in an ON\_CALL()."{}});}
\DoxyCodeLine{320     last\_clause\_ = kWillByDefault;}
\DoxyCodeLine{321 }
\DoxyCodeLine{322     ExpectSpecProperty(!action.IsDoDefault(),}
\DoxyCodeLine{323                        \textcolor{stringliteral}{"{}DoDefault() cannot be used in ON\_CALL()."{}});}
\DoxyCodeLine{324     action\_ = action;}
\DoxyCodeLine{325     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{326   \}}
\DoxyCodeLine{327 }
\DoxyCodeLine{328   \textcolor{comment}{// Returns true iff the given arguments match the matchers.}}
\DoxyCodeLine{329   \textcolor{keywordtype}{bool} Matches(\textcolor{keyword}{const} ArgumentTuple\& args)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{330     \textcolor{keywordflow}{return} TupleMatches(matchers\_, args) \&\& extra\_matcher\_.Matches(args);}
\DoxyCodeLine{331   \}}
\DoxyCodeLine{332 }
\DoxyCodeLine{333   \textcolor{comment}{// Returns the action specified by the user.}}
\DoxyCodeLine{334   \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Action}{Action<F>}}\& GetAction()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{335     AssertSpecProperty(last\_clause\_ == kWillByDefault,}
\DoxyCodeLine{336                        \textcolor{stringliteral}{"{}.WillByDefault() must appear exactly "{}}}
\DoxyCodeLine{337                        \textcolor{stringliteral}{"{}once in an ON\_CALL()."{}});}
\DoxyCodeLine{338     \textcolor{keywordflow}{return} action\_;}
\DoxyCodeLine{339   \}}
\DoxyCodeLine{340 }
\DoxyCodeLine{341  \textcolor{keyword}{private}:}
\DoxyCodeLine{342   \textcolor{comment}{// The information in statement}}
\DoxyCodeLine{343   \textcolor{comment}{//}}
\DoxyCodeLine{344   \textcolor{comment}{//   ON\_CALL(mock\_object, Method(matchers))}}
\DoxyCodeLine{345   \textcolor{comment}{//       .With(multi-\/argument-\/matcher)}}
\DoxyCodeLine{346   \textcolor{comment}{//       .WillByDefault(action);}}
\DoxyCodeLine{347   \textcolor{comment}{//}}
\DoxyCodeLine{348   \textcolor{comment}{// is recorded in the data members like this:}}
\DoxyCodeLine{349   \textcolor{comment}{//}}
\DoxyCodeLine{350   \textcolor{comment}{//   source file that contains the statement => file\_}}
\DoxyCodeLine{351   \textcolor{comment}{//   line number of the statement            => line\_}}
\DoxyCodeLine{352   \textcolor{comment}{//   matchers                                => matchers\_}}
\DoxyCodeLine{353   \textcolor{comment}{//   multi-\/argument-\/matcher                  => extra\_matcher\_}}
\DoxyCodeLine{354   \textcolor{comment}{//   action                                  => action\_}}
\DoxyCodeLine{355   ArgumentMatcherTuple matchers\_;}
\DoxyCodeLine{356   \mbox{\hyperlink{classtesting_1_1Matcher}{Matcher<const ArgumentTuple\&>}} extra\_matcher\_;}
\DoxyCodeLine{357   \mbox{\hyperlink{classtesting_1_1Action}{Action<F>}} action\_;}
\DoxyCodeLine{358 \};  \textcolor{comment}{// class OnCallSpec}}
\DoxyCodeLine{359 }
\DoxyCodeLine{360 \textcolor{comment}{// Possible reactions on uninteresting calls.}}
\DoxyCodeLine{361 \textcolor{keyword}{enum} CallReaction \{}
\DoxyCodeLine{362   kAllow,}
\DoxyCodeLine{363   kWarn,}
\DoxyCodeLine{364   kFail,}
\DoxyCodeLine{365   kDefault = kWarn  \textcolor{comment}{// By default, warn about uninteresting calls.}}
\DoxyCodeLine{366 \};}
\DoxyCodeLine{367 }
\DoxyCodeLine{368 \}  \textcolor{comment}{// namespace internal}}
\DoxyCodeLine{369 }
\DoxyCodeLine{370 \textcolor{comment}{// Utilities for manipulating mock objects.}}
\DoxyCodeLine{371 \textcolor{keyword}{class }GTEST\_API\_ \mbox{\hyperlink{classtesting_1_1Mock}{Mock}} \{}
\DoxyCodeLine{372  \textcolor{keyword}{public}:}
\DoxyCodeLine{373   \textcolor{comment}{// The following public methods can be called concurrently.}}
\DoxyCodeLine{374 }
\DoxyCodeLine{375   \textcolor{comment}{// Tells Google Mock to ignore mock\_obj when checking for leaked}}
\DoxyCodeLine{376   \textcolor{comment}{// mock objects.}}
\DoxyCodeLine{377   \textcolor{keyword}{static} \textcolor{keywordtype}{void} AllowLeak(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* mock\_obj)}
\DoxyCodeLine{378       GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{379 }
\DoxyCodeLine{380   \textcolor{comment}{// Verifies and clears all expectations on the given mock object.}}
\DoxyCodeLine{381   \textcolor{comment}{// If the expectations aren't satisfied, generates one or more}}
\DoxyCodeLine{382   \textcolor{comment}{// Google Test non-\/fatal failures and returns false.}}
\DoxyCodeLine{383   \textcolor{keyword}{static} \textcolor{keywordtype}{bool} VerifyAndClearExpectations(\textcolor{keywordtype}{void}* mock\_obj)}
\DoxyCodeLine{384       GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{385 }
\DoxyCodeLine{386   \textcolor{comment}{// Verifies all expectations on the given mock object and clears its}}
\DoxyCodeLine{387   \textcolor{comment}{// default actions and expectations.  Returns true iff the}}
\DoxyCodeLine{388   \textcolor{comment}{// verification was successful.}}
\DoxyCodeLine{389   \textcolor{keyword}{static} \textcolor{keywordtype}{bool} VerifyAndClear(\textcolor{keywordtype}{void}* mock\_obj)}
\DoxyCodeLine{390       GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{391 }
\DoxyCodeLine{392  \textcolor{keyword}{private}:}
\DoxyCodeLine{393   \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1internal_1_1UntypedFunctionMockerBase}{internal::UntypedFunctionMockerBase}};}
\DoxyCodeLine{394 }
\DoxyCodeLine{395   \textcolor{comment}{// Needed for a function mocker to register itself (so that we know}}
\DoxyCodeLine{396   \textcolor{comment}{// how to clear a mock object).}}
\DoxyCodeLine{397   \textcolor{keyword}{template} <\textcolor{keyword}{typename} F>}
\DoxyCodeLine{398   \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1internal_1_1FunctionMockerBase}{internal::FunctionMockerBase}};}
\DoxyCodeLine{399 }
\DoxyCodeLine{400   \textcolor{keyword}{template} <\textcolor{keyword}{typename} M>}
\DoxyCodeLine{401   \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1NiceMock}{NiceMock}};}
\DoxyCodeLine{402 }
\DoxyCodeLine{403   \textcolor{keyword}{template} <\textcolor{keyword}{typename} M>}
\DoxyCodeLine{404   \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1NaggyMock}{NaggyMock}};}
\DoxyCodeLine{405 }
\DoxyCodeLine{406   \textcolor{keyword}{template} <\textcolor{keyword}{typename} M>}
\DoxyCodeLine{407   \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1StrictMock}{StrictMock}};}
\DoxyCodeLine{408 }
\DoxyCodeLine{409   \textcolor{comment}{// Tells Google Mock to allow uninteresting calls on the given mock}}
\DoxyCodeLine{410   \textcolor{comment}{// object.}}
\DoxyCodeLine{411   \textcolor{keyword}{static} \textcolor{keywordtype}{void} AllowUninterestingCalls(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* mock\_obj)}
\DoxyCodeLine{412       GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{413 }
\DoxyCodeLine{414   \textcolor{comment}{// Tells Google Mock to warn the user about uninteresting calls on}}
\DoxyCodeLine{415   \textcolor{comment}{// the given mock object.}}
\DoxyCodeLine{416   \textcolor{keyword}{static} \textcolor{keywordtype}{void} WarnUninterestingCalls(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* mock\_obj)}
\DoxyCodeLine{417       GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{418 }
\DoxyCodeLine{419   \textcolor{comment}{// Tells Google Mock to fail uninteresting calls on the given mock}}
\DoxyCodeLine{420   \textcolor{comment}{// object.}}
\DoxyCodeLine{421   \textcolor{keyword}{static} \textcolor{keywordtype}{void} FailUninterestingCalls(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* mock\_obj)}
\DoxyCodeLine{422       GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{423 }
\DoxyCodeLine{424   \textcolor{comment}{// Tells Google Mock the given mock object is being destroyed and}}
\DoxyCodeLine{425   \textcolor{comment}{// its entry in the call-\/reaction table should be removed.}}
\DoxyCodeLine{426   \textcolor{keyword}{static} \textcolor{keywordtype}{void} UnregisterCallReaction(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* mock\_obj)}
\DoxyCodeLine{427       GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{428 }
\DoxyCodeLine{429   \textcolor{comment}{// Returns the reaction Google Mock will have on uninteresting calls}}
\DoxyCodeLine{430   \textcolor{comment}{// made on the given mock object.}}
\DoxyCodeLine{431   \textcolor{keyword}{static} internal::CallReaction GetReactionOnUninterestingCalls(}
\DoxyCodeLine{432       \textcolor{keyword}{const} \textcolor{keywordtype}{void}* mock\_obj)}
\DoxyCodeLine{433           GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{434 }
\DoxyCodeLine{435   \textcolor{comment}{// Verifies that all expectations on the given mock object have been}}
\DoxyCodeLine{436   \textcolor{comment}{// satisfied.  Reports one or more Google Test non-\/fatal failures}}
\DoxyCodeLine{437   \textcolor{comment}{// and returns false if not.}}
\DoxyCodeLine{438   \textcolor{keyword}{static} \textcolor{keywordtype}{bool} VerifyAndClearExpectationsLocked(\textcolor{keywordtype}{void}* mock\_obj)}
\DoxyCodeLine{439       GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{440 }
\DoxyCodeLine{441   \textcolor{comment}{// Clears all ON\_CALL()s set on the given mock object.}}
\DoxyCodeLine{442   \textcolor{keyword}{static} \textcolor{keywordtype}{void} ClearDefaultActionsLocked(\textcolor{keywordtype}{void}* mock\_obj)}
\DoxyCodeLine{443       GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{444 }
\DoxyCodeLine{445   \textcolor{comment}{// Registers a mock object and a mock method it owns.}}
\DoxyCodeLine{446   \textcolor{keyword}{static} \textcolor{keywordtype}{void} Register(}
\DoxyCodeLine{447       \textcolor{keyword}{const} \textcolor{keywordtype}{void}* mock\_obj,}
\DoxyCodeLine{448       \mbox{\hyperlink{classtesting_1_1internal_1_1UntypedFunctionMockerBase}{internal::UntypedFunctionMockerBase}}* mocker)}
\DoxyCodeLine{449           GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{450 }
\DoxyCodeLine{451   \textcolor{comment}{// Tells Google Mock where in the source code mock\_obj is used in an}}
\DoxyCodeLine{452   \textcolor{comment}{// ON\_CALL or EXPECT\_CALL.  In case mock\_obj is leaked, this}}
\DoxyCodeLine{453   \textcolor{comment}{// information helps the user identify which object it is.}}
\DoxyCodeLine{454   \textcolor{keyword}{static} \textcolor{keywordtype}{void} RegisterUseByOnCallOrExpectCall(}
\DoxyCodeLine{455       \textcolor{keyword}{const} \textcolor{keywordtype}{void}* mock\_obj, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* file, \textcolor{keywordtype}{int} line)}
\DoxyCodeLine{456           GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{457 }
\DoxyCodeLine{458   \textcolor{comment}{// Unregisters a mock method; removes the owning mock object from}}
\DoxyCodeLine{459   \textcolor{comment}{// the registry when the last mock method associated with it has}}
\DoxyCodeLine{460   \textcolor{comment}{// been unregistered.  This is called only in the destructor of}}
\DoxyCodeLine{461   \textcolor{comment}{// FunctionMockerBase.}}
\DoxyCodeLine{462   \textcolor{keyword}{static} \textcolor{keywordtype}{void} UnregisterLocked(\mbox{\hyperlink{classtesting_1_1internal_1_1UntypedFunctionMockerBase}{internal::UntypedFunctionMockerBase}}* mocker)}
\DoxyCodeLine{463       GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{464 \};  \textcolor{comment}{// class Mock}}
\DoxyCodeLine{465 }
\DoxyCodeLine{466 \textcolor{comment}{// An abstract handle of an expectation.  Useful in the .After()}}
\DoxyCodeLine{467 \textcolor{comment}{// clause of EXPECT\_CALL() for setting the (partial) order of}}
\DoxyCodeLine{468 \textcolor{comment}{// expectations.  The syntax:}}
\DoxyCodeLine{469 \textcolor{comment}{//}}
\DoxyCodeLine{470 \textcolor{comment}{//   Expectation e1 = EXPECT\_CALL(...)...;}}
\DoxyCodeLine{471 \textcolor{comment}{//   EXPECT\_CALL(...).After(e1)...;}}
\DoxyCodeLine{472 \textcolor{comment}{//}}
\DoxyCodeLine{473 \textcolor{comment}{// sets two expectations where the latter can only be matched after}}
\DoxyCodeLine{474 \textcolor{comment}{// the former has been satisfied.}}
\DoxyCodeLine{475 \textcolor{comment}{//}}
\DoxyCodeLine{476 \textcolor{comment}{// Notes:}}
\DoxyCodeLine{477 \textcolor{comment}{//   -\/ This class is copyable and has value semantics.}}
\DoxyCodeLine{478 \textcolor{comment}{//   -\/ Constness is shallow: a const Expectation object itself cannot}}
\DoxyCodeLine{479 \textcolor{comment}{//     be modified, but the mutable methods of the ExpectationBase}}
\DoxyCodeLine{480 \textcolor{comment}{//     object it references can be called via expectation\_base().}}
\DoxyCodeLine{481 \textcolor{comment}{//   -\/ The constructors and destructor are defined out-\/of-\/line because}}
\DoxyCodeLine{482 \textcolor{comment}{//     the Symbian WINSCW compiler wants to otherwise instantiate them}}
\DoxyCodeLine{483 \textcolor{comment}{//     when it sees this class definition, at which point it doesn't have}}
\DoxyCodeLine{484 \textcolor{comment}{//     ExpectationBase available yet, leading to incorrect destruction}}
\DoxyCodeLine{485 \textcolor{comment}{//     in the linked\_ptr (or compilation errors if using a checking}}
\DoxyCodeLine{486 \textcolor{comment}{//     linked\_ptr).}}
\DoxyCodeLine{487 \textcolor{keyword}{class }GTEST\_API\_ \mbox{\hyperlink{classtesting_1_1Expectation}{Expectation}} \{}
\DoxyCodeLine{488  \textcolor{keyword}{public}:}
\DoxyCodeLine{489   \textcolor{comment}{// Constructs a null object that doesn't reference any expectation.}}
\DoxyCodeLine{490   \mbox{\hyperlink{classtesting_1_1Expectation}{Expectation}}();}
\DoxyCodeLine{491 }
\DoxyCodeLine{492   \mbox{\hyperlink{classtesting_1_1Expectation}{\string~Expectation}}();}
\DoxyCodeLine{493 }
\DoxyCodeLine{494   \textcolor{comment}{// This single-\/argument ctor must not be explicit, in order to support the}}
\DoxyCodeLine{495   \textcolor{comment}{//   Expectation e = EXPECT\_CALL(...);}}
\DoxyCodeLine{496   \textcolor{comment}{// syntax.}}
\DoxyCodeLine{497   \textcolor{comment}{//}}
\DoxyCodeLine{498   \textcolor{comment}{// A TypedExpectation object stores its pre-\/requisites as}}
\DoxyCodeLine{499   \textcolor{comment}{// Expectation objects, and needs to call the non-\/const Retire()}}
\DoxyCodeLine{500   \textcolor{comment}{// method on the ExpectationBase objects they reference.  Therefore}}
\DoxyCodeLine{501   \textcolor{comment}{// Expectation must receive a *non-\/const* reference to the}}
\DoxyCodeLine{502   \textcolor{comment}{// ExpectationBase object.}}
\DoxyCodeLine{503   \mbox{\hyperlink{classtesting_1_1Expectation}{Expectation}}(\mbox{\hyperlink{classtesting_1_1internal_1_1ExpectationBase}{internal::ExpectationBase}}\& exp);  \textcolor{comment}{// NOLINT}}
\DoxyCodeLine{504 }
\DoxyCodeLine{505   \textcolor{comment}{// The compiler-\/generated copy ctor and operator= work exactly as}}
\DoxyCodeLine{506   \textcolor{comment}{// intended, so we don't need to define our own.}}
\DoxyCodeLine{507 }
\DoxyCodeLine{508   \textcolor{comment}{// Returns true iff rhs references the same expectation as this object does.}}
\DoxyCodeLine{509   \textcolor{keywordtype}{bool} operator==(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Expectation}{Expectation}}\& rhs)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{510     \textcolor{keywordflow}{return} expectation\_base\_ == rhs.expectation\_base\_;}
\DoxyCodeLine{511   \}}
\DoxyCodeLine{512 }
\DoxyCodeLine{513   \textcolor{keywordtype}{bool} operator!=(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Expectation}{Expectation}}\& rhs)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} !(*\textcolor{keyword}{this} == rhs); \}}
\DoxyCodeLine{514 }
\DoxyCodeLine{515  \textcolor{keyword}{private}:}
\DoxyCodeLine{516   \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}};}
\DoxyCodeLine{517   \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1Sequence}{Sequence}};}
\DoxyCodeLine{518   \textcolor{keyword}{friend} class ::testing::internal::ExpectationBase;}
\DoxyCodeLine{519   \textcolor{keyword}{friend} class ::testing::internal::UntypedFunctionMockerBase;}
\DoxyCodeLine{520 }
\DoxyCodeLine{521   \textcolor{keyword}{template} <\textcolor{keyword}{typename} F>}
\DoxyCodeLine{522   \textcolor{keyword}{friend} class ::testing::internal::FunctionMockerBase;}
\DoxyCodeLine{523 }
\DoxyCodeLine{524   \textcolor{keyword}{template} <\textcolor{keyword}{typename} F>}
\DoxyCodeLine{525   \textcolor{keyword}{friend} class ::testing::internal::TypedExpectation;}
\DoxyCodeLine{526 }
\DoxyCodeLine{527   \textcolor{comment}{// This comparator is needed for putting Expectation objects into a set.}}
\DoxyCodeLine{528   \textcolor{keyword}{class }Less \{}
\DoxyCodeLine{529    \textcolor{keyword}{public}:}
\DoxyCodeLine{530     \textcolor{keywordtype}{bool} operator()(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Expectation}{Expectation}}\& lhs, \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Expectation}{Expectation}}\& rhs)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{531       \textcolor{keywordflow}{return} lhs.expectation\_base\_.get() < rhs.expectation\_base\_.get();}
\DoxyCodeLine{532     \}}
\DoxyCodeLine{533   \};}
\DoxyCodeLine{534 }
\DoxyCodeLine{535   typedef ::std::set<Expectation, Less> Set;}
\DoxyCodeLine{536 }
\DoxyCodeLine{537   \mbox{\hyperlink{classtesting_1_1Expectation}{Expectation}}(}
\DoxyCodeLine{538       \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1internal_1_1linked__ptr}{internal::linked\_ptr<internal::ExpectationBase>}}\& expectation\_base);}
\DoxyCodeLine{539 }
\DoxyCodeLine{540   \textcolor{comment}{// Returns the expectation this object references.}}
\DoxyCodeLine{541   \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1internal_1_1linked__ptr}{internal::linked\_ptr<internal::ExpectationBase>}}\&}
\DoxyCodeLine{542   expectation\_base()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{543     \textcolor{keywordflow}{return} expectation\_base\_;}
\DoxyCodeLine{544   \}}
\DoxyCodeLine{545 }
\DoxyCodeLine{546   \textcolor{comment}{// A linked\_ptr that co-\/owns the expectation this handle references.}}
\DoxyCodeLine{547   \mbox{\hyperlink{classtesting_1_1internal_1_1linked__ptr}{internal::linked\_ptr<internal::ExpectationBase>}} expectation\_base\_;}
\DoxyCodeLine{548 \};}
\DoxyCodeLine{549 }
\DoxyCodeLine{550 \textcolor{comment}{// A set of expectation handles.  Useful in the .After() clause of}}
\DoxyCodeLine{551 \textcolor{comment}{// EXPECT\_CALL() for setting the (partial) order of expectations.  The}}
\DoxyCodeLine{552 \textcolor{comment}{// syntax:}}
\DoxyCodeLine{553 \textcolor{comment}{//}}
\DoxyCodeLine{554 \textcolor{comment}{//   ExpectationSet es;}}
\DoxyCodeLine{555 \textcolor{comment}{//   es += EXPECT\_CALL(...)...;}}
\DoxyCodeLine{556 \textcolor{comment}{//   es += EXPECT\_CALL(...)...;}}
\DoxyCodeLine{557 \textcolor{comment}{//   EXPECT\_CALL(...).After(es)...;}}
\DoxyCodeLine{558 \textcolor{comment}{//}}
\DoxyCodeLine{559 \textcolor{comment}{// sets three expectations where the last one can only be matched}}
\DoxyCodeLine{560 \textcolor{comment}{// after the first two have both been satisfied.}}
\DoxyCodeLine{561 \textcolor{comment}{//}}
\DoxyCodeLine{562 \textcolor{comment}{// This class is copyable and has value semantics.}}
\DoxyCodeLine{563 \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}} \{}
\DoxyCodeLine{564  \textcolor{keyword}{public}:}
\DoxyCodeLine{565   \textcolor{comment}{// A bidirectional iterator that can read a const element in the set.}}
\DoxyCodeLine{566   \textcolor{keyword}{typedef} Expectation::Set::const\_iterator const\_iterator;}
\DoxyCodeLine{567 }
\DoxyCodeLine{568   \textcolor{comment}{// An object stored in the set.  This is an alias of Expectation.}}
\DoxyCodeLine{569   \textcolor{keyword}{typedef} Expectation::Set::value\_type value\_type;}
\DoxyCodeLine{570 }
\DoxyCodeLine{571   \textcolor{comment}{// Constructs an empty set.}}
\DoxyCodeLine{572   \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}() \{\}}
\DoxyCodeLine{573 }
\DoxyCodeLine{574   \textcolor{comment}{// This single-\/argument ctor must not be explicit, in order to support the}}
\DoxyCodeLine{575   \textcolor{comment}{//   ExpectationSet es = EXPECT\_CALL(...);}}
\DoxyCodeLine{576   \textcolor{comment}{// syntax.}}
\DoxyCodeLine{577   \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}(\mbox{\hyperlink{classtesting_1_1internal_1_1ExpectationBase}{internal::ExpectationBase}}\& exp) \{  \textcolor{comment}{// NOLINT}}
\DoxyCodeLine{578     *\textcolor{keyword}{this} += \mbox{\hyperlink{classtesting_1_1Expectation}{Expectation}}(exp);}
\DoxyCodeLine{579   \}}
\DoxyCodeLine{580 }
\DoxyCodeLine{581   \textcolor{comment}{// This single-\/argument ctor implements implicit conversion from}}
\DoxyCodeLine{582   \textcolor{comment}{// Expectation and thus must not be explicit.  This allows either an}}
\DoxyCodeLine{583   \textcolor{comment}{// Expectation or an ExpectationSet to be used in .After().}}
\DoxyCodeLine{584   \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Expectation}{Expectation}}\& e) \{  \textcolor{comment}{// NOLINT}}
\DoxyCodeLine{585     *\textcolor{keyword}{this} += e;}
\DoxyCodeLine{586   \}}
\DoxyCodeLine{587 }
\DoxyCodeLine{588   \textcolor{comment}{// The compiler-\/generator ctor and operator= works exactly as}}
\DoxyCodeLine{589   \textcolor{comment}{// intended, so we don't need to define our own.}}
\DoxyCodeLine{590 }
\DoxyCodeLine{591   \textcolor{comment}{// Returns true iff rhs contains the same set of Expectation objects}}
\DoxyCodeLine{592   \textcolor{comment}{// as this does.}}
\DoxyCodeLine{593   \textcolor{keywordtype}{bool} operator==(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}\& rhs)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{594     \textcolor{keywordflow}{return} expectations\_ == rhs.expectations\_;}
\DoxyCodeLine{595   \}}
\DoxyCodeLine{596 }
\DoxyCodeLine{597   \textcolor{keywordtype}{bool} operator!=(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}\& rhs)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} !(*\textcolor{keyword}{this} == rhs); \}}
\DoxyCodeLine{598 }
\DoxyCodeLine{599   \textcolor{comment}{// Implements the syntax}}
\DoxyCodeLine{600   \textcolor{comment}{//   expectation\_set += EXPECT\_CALL(...);}}
\DoxyCodeLine{601   \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}\& operator+=(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Expectation}{Expectation}}\& e) \{}
\DoxyCodeLine{602     expectations\_.insert(e);}
\DoxyCodeLine{603     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{604   \}}
\DoxyCodeLine{605 }
\DoxyCodeLine{606   \textcolor{keywordtype}{int} size()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(expectations\_.size()); \}}
\DoxyCodeLine{607 }
\DoxyCodeLine{608   const\_iterator begin()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} expectations\_.begin(); \}}
\DoxyCodeLine{609   const\_iterator end()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} expectations\_.end(); \}}
\DoxyCodeLine{610 }
\DoxyCodeLine{611  \textcolor{keyword}{private}:}
\DoxyCodeLine{612   Expectation::Set expectations\_;}
\DoxyCodeLine{613 \};}
\DoxyCodeLine{614 }
\DoxyCodeLine{615 }
\DoxyCodeLine{616 \textcolor{comment}{// Sequence objects are used by a user to specify the relative order}}
\DoxyCodeLine{617 \textcolor{comment}{// in which the expectations should match.  They are copyable (we rely}}
\DoxyCodeLine{618 \textcolor{comment}{// on the compiler-\/defined copy constructor and assignment operator).}}
\DoxyCodeLine{619 \textcolor{keyword}{class }GTEST\_API\_ \mbox{\hyperlink{classtesting_1_1Sequence}{Sequence}} \{}
\DoxyCodeLine{620  \textcolor{keyword}{public}:}
\DoxyCodeLine{621   \textcolor{comment}{// Constructs an empty sequence.}}
\DoxyCodeLine{622   \mbox{\hyperlink{classtesting_1_1Sequence}{Sequence}}() : last\_expectation\_(\textcolor{keyword}{new} \mbox{\hyperlink{classtesting_1_1Expectation}{Expectation}}) \{\}}
\DoxyCodeLine{623 }
\DoxyCodeLine{624   \textcolor{comment}{// Adds an expectation to this sequence.  The caller must ensure}}
\DoxyCodeLine{625   \textcolor{comment}{// that no other thread is accessing this Sequence object.}}
\DoxyCodeLine{626   \textcolor{keywordtype}{void} AddExpectation(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Expectation}{Expectation}}\& expectation) \textcolor{keyword}{const};}
\DoxyCodeLine{627 }
\DoxyCodeLine{628  \textcolor{keyword}{private}:}
\DoxyCodeLine{629   \textcolor{comment}{// The last expectation in this sequence.  We use a linked\_ptr here}}
\DoxyCodeLine{630   \textcolor{comment}{// because Sequence objects are copyable and we want the copies to}}
\DoxyCodeLine{631   \textcolor{comment}{// be aliases.  The linked\_ptr allows the copies to co-\/own and share}}
\DoxyCodeLine{632   \textcolor{comment}{// the same Expectation object.}}
\DoxyCodeLine{633   \mbox{\hyperlink{classtesting_1_1internal_1_1linked__ptr}{internal::linked\_ptr<Expectation>}} last\_expectation\_;}
\DoxyCodeLine{634 \};  \textcolor{comment}{// class Sequence}}
\DoxyCodeLine{635 }
\DoxyCodeLine{636 \textcolor{comment}{// An object of this type causes all EXPECT\_CALL() statements}}
\DoxyCodeLine{637 \textcolor{comment}{// encountered in its scope to be put in an anonymous sequence.  The}}
\DoxyCodeLine{638 \textcolor{comment}{// work is done in the constructor and destructor.  You should only}}
\DoxyCodeLine{639 \textcolor{comment}{// create an InSequence object on the stack.}}
\DoxyCodeLine{640 \textcolor{comment}{//}}
\DoxyCodeLine{641 \textcolor{comment}{// The sole purpose for this class is to support easy definition of}}
\DoxyCodeLine{642 \textcolor{comment}{// sequential expectations, e.g.}}
\DoxyCodeLine{643 \textcolor{comment}{//}}
\DoxyCodeLine{644 \textcolor{comment}{//   \{}}
\DoxyCodeLine{645 \textcolor{comment}{//     InSequence dummy;  // The name of the object doesn't matter.}}
\DoxyCodeLine{646 \textcolor{comment}{//}}
\DoxyCodeLine{647 \textcolor{comment}{//     // The following expectations must match in the order they appear.}}
\DoxyCodeLine{648 \textcolor{comment}{//     EXPECT\_CALL(a, Bar())...;}}
\DoxyCodeLine{649 \textcolor{comment}{//     EXPECT\_CALL(a, Baz())...;}}
\DoxyCodeLine{650 \textcolor{comment}{//     ...}}
\DoxyCodeLine{651 \textcolor{comment}{//     EXPECT\_CALL(b, Xyz())...;}}
\DoxyCodeLine{652 \textcolor{comment}{//   \}}}
\DoxyCodeLine{653 \textcolor{comment}{//}}
\DoxyCodeLine{654 \textcolor{comment}{// You can create InSequence objects in multiple threads, as long as}}
\DoxyCodeLine{655 \textcolor{comment}{// they are used to affect different mock objects.  The idea is that}}
\DoxyCodeLine{656 \textcolor{comment}{// each thread can create and set up its own mocks as if it's the only}}
\DoxyCodeLine{657 \textcolor{comment}{// thread.  However, for clarity of your tests we recommend you to set}}
\DoxyCodeLine{658 \textcolor{comment}{// up mocks in the main thread unless you have a good reason not to do}}
\DoxyCodeLine{659 \textcolor{comment}{// so.}}
\DoxyCodeLine{660 \textcolor{keyword}{class }GTEST\_API\_ \mbox{\hyperlink{classtesting_1_1InSequence}{InSequence}} \{}
\DoxyCodeLine{661  \textcolor{keyword}{public}:}
\DoxyCodeLine{662   \mbox{\hyperlink{classtesting_1_1InSequence}{InSequence}}();}
\DoxyCodeLine{663   \mbox{\hyperlink{classtesting_1_1InSequence}{\string~InSequence}}();}
\DoxyCodeLine{664  \textcolor{keyword}{private}:}
\DoxyCodeLine{665   \textcolor{keywordtype}{bool} sequence\_created\_;}
\DoxyCodeLine{666 }
\DoxyCodeLine{667   GTEST\_DISALLOW\_COPY\_AND\_ASSIGN\_(\mbox{\hyperlink{classtesting_1_1InSequence}{InSequence}});  \textcolor{comment}{// NOLINT}}
\DoxyCodeLine{668 \} GTEST\_ATTRIBUTE\_UNUSED\_;}
\DoxyCodeLine{669 }
\DoxyCodeLine{670 \textcolor{keyword}{namespace }internal \{}
\DoxyCodeLine{671 }
\DoxyCodeLine{672 \textcolor{comment}{// Points to the implicit sequence introduced by a living InSequence}}
\DoxyCodeLine{673 \textcolor{comment}{// object (if any) in the current thread or NULL.}}
\DoxyCodeLine{674 GTEST\_API\_ \textcolor{keyword}{extern} ThreadLocal<Sequence*> g\_gmock\_implicit\_sequence;}
\DoxyCodeLine{675 }
\DoxyCodeLine{676 \textcolor{comment}{// Base class for implementing expectations.}}
\DoxyCodeLine{677 \textcolor{comment}{//}}
\DoxyCodeLine{678 \textcolor{comment}{// There are two reasons for having a type-\/agnostic base class for}}
\DoxyCodeLine{679 \textcolor{comment}{// Expectation:}}
\DoxyCodeLine{680 \textcolor{comment}{//}}
\DoxyCodeLine{681 \textcolor{comment}{//   1. We need to store collections of expectations of different}}
\DoxyCodeLine{682 \textcolor{comment}{//   types (e.g. all pre-\/requisites of a particular expectation, all}}
\DoxyCodeLine{683 \textcolor{comment}{//   expectations in a sequence).  Therefore these expectation objects}}
\DoxyCodeLine{684 \textcolor{comment}{//   must share a common base class.}}
\DoxyCodeLine{685 \textcolor{comment}{//}}
\DoxyCodeLine{686 \textcolor{comment}{//   2. We can avoid binary code bloat by moving methods not depending}}
\DoxyCodeLine{687 \textcolor{comment}{//   on the template argument of Expectation to the base class.}}
\DoxyCodeLine{688 \textcolor{comment}{//}}
\DoxyCodeLine{689 \textcolor{comment}{// This class is internal and mustn't be used by user code directly.}}
\DoxyCodeLine{690 \textcolor{keyword}{class }GTEST\_API\_ \mbox{\hyperlink{classtesting_1_1internal_1_1ExpectationBase}{ExpectationBase}} \{}
\DoxyCodeLine{691  \textcolor{keyword}{public}:}
\DoxyCodeLine{692   \textcolor{comment}{// source\_text is the EXPECT\_CALL(...) source that created this Expectation.}}
\DoxyCodeLine{693   \mbox{\hyperlink{classtesting_1_1internal_1_1ExpectationBase}{ExpectationBase}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* file, \textcolor{keywordtype}{int} line, \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& source\_text);}
\DoxyCodeLine{694 }
\DoxyCodeLine{695   \textcolor{keyword}{virtual} \mbox{\hyperlink{classtesting_1_1internal_1_1ExpectationBase}{\string~ExpectationBase}}();}
\DoxyCodeLine{696 }
\DoxyCodeLine{697   \textcolor{comment}{// Where in the source file was the expectation spec defined?}}
\DoxyCodeLine{698   \textcolor{keyword}{const} \textcolor{keywordtype}{char}* file()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} file\_; \}}
\DoxyCodeLine{699   \textcolor{keywordtype}{int} line()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} line\_; \}}
\DoxyCodeLine{700   \textcolor{keyword}{const} \textcolor{keywordtype}{char}* source\_text()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} source\_text\_.c\_str(); \}}
\DoxyCodeLine{701   \textcolor{comment}{// Returns the cardinality specified in the expectation spec.}}
\DoxyCodeLine{702   \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Cardinality}{Cardinality}}\& cardinality()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} cardinality\_; \}}
\DoxyCodeLine{703 }
\DoxyCodeLine{704   \textcolor{comment}{// Describes the source file location of this expectation.}}
\DoxyCodeLine{705   \textcolor{keywordtype}{void} DescribeLocationTo(::std::ostream* os)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{706     *os << FormatFileLocation(file(), line()) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{707   \}}
\DoxyCodeLine{708 }
\DoxyCodeLine{709   \textcolor{comment}{// Describes how many times a function call matching this}}
\DoxyCodeLine{710   \textcolor{comment}{// expectation has occurred.}}
\DoxyCodeLine{711   \textcolor{keywordtype}{void} DescribeCallCountTo(::std::ostream* os) \textcolor{keyword}{const}}
\DoxyCodeLine{712       GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex);}
\DoxyCodeLine{713 }
\DoxyCodeLine{714   \textcolor{comment}{// If this mock method has an extra matcher (i.e. .With(matcher)),}}
\DoxyCodeLine{715   \textcolor{comment}{// describes it to the ostream.}}
\DoxyCodeLine{716   \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} MaybeDescribeExtraMatcherTo(::std::ostream* os) = 0;}
\DoxyCodeLine{717 }
\DoxyCodeLine{718  \textcolor{keyword}{protected}:}
\DoxyCodeLine{719   \textcolor{keyword}{friend} class ::testing::Expectation;}
\DoxyCodeLine{720   \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1internal_1_1UntypedFunctionMockerBase}{UntypedFunctionMockerBase}};}
\DoxyCodeLine{721 }
\DoxyCodeLine{722   \textcolor{keyword}{enum} Clause \{}
\DoxyCodeLine{723     \textcolor{comment}{// Don't change the order of the enum members!}}
\DoxyCodeLine{724     kNone,}
\DoxyCodeLine{725     kWith,}
\DoxyCodeLine{726     kTimes,}
\DoxyCodeLine{727     kInSequence,}
\DoxyCodeLine{728     kAfter,}
\DoxyCodeLine{729     kWillOnce,}
\DoxyCodeLine{730     kWillRepeatedly,}
\DoxyCodeLine{731     kRetiresOnSaturation}
\DoxyCodeLine{732   \};}
\DoxyCodeLine{733 }
\DoxyCodeLine{734   \textcolor{keyword}{typedef} std::vector<const void*> UntypedActions;}
\DoxyCodeLine{735 }
\DoxyCodeLine{736   \textcolor{comment}{// Returns an Expectation object that references and co-\/owns this}}
\DoxyCodeLine{737   \textcolor{comment}{// expectation.}}
\DoxyCodeLine{738   \textcolor{keyword}{virtual} \mbox{\hyperlink{classtesting_1_1Expectation}{Expectation}} GetHandle() = 0;}
\DoxyCodeLine{739 }
\DoxyCodeLine{740   \textcolor{comment}{// Asserts that the EXPECT\_CALL() statement has the given property.}}
\DoxyCodeLine{741   \textcolor{keywordtype}{void} AssertSpecProperty(\textcolor{keywordtype}{bool} property, \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& failure\_message)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{742     Assert(property, file\_, line\_, failure\_message);}
\DoxyCodeLine{743   \}}
\DoxyCodeLine{744 }
\DoxyCodeLine{745   \textcolor{comment}{// Expects that the EXPECT\_CALL() statement has the given property.}}
\DoxyCodeLine{746   \textcolor{keywordtype}{void} ExpectSpecProperty(\textcolor{keywordtype}{bool} property, \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& failure\_message)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{747     Expect(property, file\_, line\_, failure\_message);}
\DoxyCodeLine{748   \}}
\DoxyCodeLine{749 }
\DoxyCodeLine{750   \textcolor{comment}{// Explicitly specifies the cardinality of this expectation.  Used}}
\DoxyCodeLine{751   \textcolor{comment}{// by the subclasses to implement the .Times() clause.}}
\DoxyCodeLine{752   \textcolor{keywordtype}{void} SpecifyCardinality(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Cardinality}{Cardinality}}\& cardinality);}
\DoxyCodeLine{753 }
\DoxyCodeLine{754   \textcolor{comment}{// Returns true iff the user specified the cardinality explicitly}}
\DoxyCodeLine{755   \textcolor{comment}{// using a .Times().}}
\DoxyCodeLine{756   \textcolor{keywordtype}{bool} cardinality\_specified()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} cardinality\_specified\_; \}}
\DoxyCodeLine{757 }
\DoxyCodeLine{758   \textcolor{comment}{// Sets the cardinality of this expectation spec.}}
\DoxyCodeLine{759   \textcolor{keywordtype}{void} set\_cardinality(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Cardinality}{Cardinality}}\& a\_cardinality) \{}
\DoxyCodeLine{760     cardinality\_ = a\_cardinality;}
\DoxyCodeLine{761   \}}
\DoxyCodeLine{762 }
\DoxyCodeLine{763   \textcolor{comment}{// The following group of methods should only be called after the}}
\DoxyCodeLine{764   \textcolor{comment}{// EXPECT\_CALL() statement, and only when g\_gmock\_mutex is held by}}
\DoxyCodeLine{765   \textcolor{comment}{// the current thread.}}
\DoxyCodeLine{766 }
\DoxyCodeLine{767   \textcolor{comment}{// Retires all pre-\/requisites of this expectation.}}
\DoxyCodeLine{768   \textcolor{keywordtype}{void} RetireAllPreRequisites()}
\DoxyCodeLine{769       GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex);}
\DoxyCodeLine{770 }
\DoxyCodeLine{771   \textcolor{comment}{// Returns true iff this expectation is retired.}}
\DoxyCodeLine{772   \textcolor{keywordtype}{bool} is\_retired() \textcolor{keyword}{const}}
\DoxyCodeLine{773       GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{774     g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{775     \textcolor{keywordflow}{return} retired\_;}
\DoxyCodeLine{776   \}}
\DoxyCodeLine{777 }
\DoxyCodeLine{778   \textcolor{comment}{// Retires this expectation.}}
\DoxyCodeLine{779   \textcolor{keywordtype}{void} Retire()}
\DoxyCodeLine{780       GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{781     g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{782     retired\_ = \textcolor{keyword}{true};}
\DoxyCodeLine{783   \}}
\DoxyCodeLine{784 }
\DoxyCodeLine{785   \textcolor{comment}{// Returns true iff this expectation is satisfied.}}
\DoxyCodeLine{786   \textcolor{keywordtype}{bool} IsSatisfied() \textcolor{keyword}{const}}
\DoxyCodeLine{787       GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{788     g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{789     \textcolor{keywordflow}{return} cardinality().IsSatisfiedByCallCount(call\_count\_);}
\DoxyCodeLine{790   \}}
\DoxyCodeLine{791 }
\DoxyCodeLine{792   \textcolor{comment}{// Returns true iff this expectation is saturated.}}
\DoxyCodeLine{793   \textcolor{keywordtype}{bool} IsSaturated() \textcolor{keyword}{const}}
\DoxyCodeLine{794       GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{795     g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{796     \textcolor{keywordflow}{return} cardinality().IsSaturatedByCallCount(call\_count\_);}
\DoxyCodeLine{797   \}}
\DoxyCodeLine{798 }
\DoxyCodeLine{799   \textcolor{comment}{// Returns true iff this expectation is over-\/saturated.}}
\DoxyCodeLine{800   \textcolor{keywordtype}{bool} IsOverSaturated() \textcolor{keyword}{const}}
\DoxyCodeLine{801       GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{802     g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{803     \textcolor{keywordflow}{return} cardinality().IsOverSaturatedByCallCount(call\_count\_);}
\DoxyCodeLine{804   \}}
\DoxyCodeLine{805 }
\DoxyCodeLine{806   \textcolor{comment}{// Returns true iff all pre-\/requisites of this expectation are satisfied.}}
\DoxyCodeLine{807   \textcolor{keywordtype}{bool} AllPrerequisitesAreSatisfied() \textcolor{keyword}{const}}
\DoxyCodeLine{808       GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex);}
\DoxyCodeLine{809 }
\DoxyCodeLine{810   \textcolor{comment}{// Adds unsatisfied pre-\/requisites of this expectation to 'result'.}}
\DoxyCodeLine{811   \textcolor{keywordtype}{void} FindUnsatisfiedPrerequisites(\mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}* result) \textcolor{keyword}{const}}
\DoxyCodeLine{812       GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex);}
\DoxyCodeLine{813 }
\DoxyCodeLine{814   \textcolor{comment}{// Returns the number this expectation has been invoked.}}
\DoxyCodeLine{815   \textcolor{keywordtype}{int} call\_count() \textcolor{keyword}{const}}
\DoxyCodeLine{816       GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{817     g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{818     \textcolor{keywordflow}{return} call\_count\_;}
\DoxyCodeLine{819   \}}
\DoxyCodeLine{820 }
\DoxyCodeLine{821   \textcolor{comment}{// Increments the number this expectation has been invoked.}}
\DoxyCodeLine{822   \textcolor{keywordtype}{void} IncrementCallCount()}
\DoxyCodeLine{823       GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{824     g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{825     call\_count\_++;}
\DoxyCodeLine{826   \}}
\DoxyCodeLine{827 }
\DoxyCodeLine{828   \textcolor{comment}{// Checks the action count (i.e. the number of WillOnce() and}}
\DoxyCodeLine{829   \textcolor{comment}{// WillRepeatedly() clauses) against the cardinality if this hasn't}}
\DoxyCodeLine{830   \textcolor{comment}{// been done before.  Prints a warning if there are too many or too}}
\DoxyCodeLine{831   \textcolor{comment}{// few actions.}}
\DoxyCodeLine{832   \textcolor{keywordtype}{void} CheckActionCountIfNotDone() \textcolor{keyword}{const}}
\DoxyCodeLine{833       GTEST\_LOCK\_EXCLUDED\_(mutex\_);}
\DoxyCodeLine{834 }
\DoxyCodeLine{835   \textcolor{keyword}{friend} class ::testing::Sequence;}
\DoxyCodeLine{836   \textcolor{keyword}{friend} class ::testing::internal::ExpectationTester;}
\DoxyCodeLine{837 }
\DoxyCodeLine{838   \textcolor{keyword}{template} <\textcolor{keyword}{typename} Function>}
\DoxyCodeLine{839   \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation}};}
\DoxyCodeLine{840 }
\DoxyCodeLine{841   \textcolor{comment}{// Implements the .Times() clause.}}
\DoxyCodeLine{842   \textcolor{keywordtype}{void} UntypedTimes(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Cardinality}{Cardinality}}\& a\_cardinality);}
\DoxyCodeLine{843 }
\DoxyCodeLine{844   \textcolor{comment}{// This group of fields are part of the spec and won't change after}}
\DoxyCodeLine{845   \textcolor{comment}{// an EXPECT\_CALL() statement finishes.}}
\DoxyCodeLine{846   \textcolor{keyword}{const} \textcolor{keywordtype}{char}* file\_;          \textcolor{comment}{// The file that contains the expectation.}}
\DoxyCodeLine{847   \textcolor{keywordtype}{int} line\_;                  \textcolor{comment}{// The line number of the expectation.}}
\DoxyCodeLine{848   \textcolor{keyword}{const} \textcolor{keywordtype}{string} source\_text\_;  \textcolor{comment}{// The EXPECT\_CALL(...) source text.}}
\DoxyCodeLine{849   \textcolor{comment}{// True iff the cardinality is specified explicitly.}}
\DoxyCodeLine{850   \textcolor{keywordtype}{bool} cardinality\_specified\_;}
\DoxyCodeLine{851   \mbox{\hyperlink{classtesting_1_1Cardinality}{Cardinality}} cardinality\_;            \textcolor{comment}{// The cardinality of the expectation.}}
\DoxyCodeLine{852   \textcolor{comment}{// The immediate pre-\/requisites (i.e. expectations that must be}}
\DoxyCodeLine{853   \textcolor{comment}{// satisfied before this expectation can be matched) of this}}
\DoxyCodeLine{854   \textcolor{comment}{// expectation.  We use linked\_ptr in the set because we want an}}
\DoxyCodeLine{855   \textcolor{comment}{// Expectation object to be co-\/owned by its FunctionMocker and its}}
\DoxyCodeLine{856   \textcolor{comment}{// successors.  This allows multiple mock objects to be deleted at}}
\DoxyCodeLine{857   \textcolor{comment}{// different times.}}
\DoxyCodeLine{858   \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}} immediate\_prerequisites\_;}
\DoxyCodeLine{859 }
\DoxyCodeLine{860   \textcolor{comment}{// This group of fields are the current state of the expectation,}}
\DoxyCodeLine{861   \textcolor{comment}{// and can change as the mock function is called.}}
\DoxyCodeLine{862   \textcolor{keywordtype}{int} call\_count\_;  \textcolor{comment}{// How many times this expectation has been invoked.}}
\DoxyCodeLine{863   \textcolor{keywordtype}{bool} retired\_;    \textcolor{comment}{// True iff this expectation has retired.}}
\DoxyCodeLine{864   UntypedActions untyped\_actions\_;}
\DoxyCodeLine{865   \textcolor{keywordtype}{bool} extra\_matcher\_specified\_;}
\DoxyCodeLine{866   \textcolor{keywordtype}{bool} repeated\_action\_specified\_;  \textcolor{comment}{// True if a WillRepeatedly() was specified.}}
\DoxyCodeLine{867   \textcolor{keywordtype}{bool} retires\_on\_saturation\_;}
\DoxyCodeLine{868   Clause last\_clause\_;}
\DoxyCodeLine{869   \textcolor{keyword}{mutable} \textcolor{keywordtype}{bool} action\_count\_checked\_;  \textcolor{comment}{// Under mutex\_.}}
\DoxyCodeLine{870   \textcolor{keyword}{mutable} \mbox{\hyperlink{classtesting_1_1internal_1_1Mutex}{Mutex}} mutex\_;  \textcolor{comment}{// Protects action\_count\_checked\_.}}
\DoxyCodeLine{871 }
\DoxyCodeLine{872   GTEST\_DISALLOW\_ASSIGN\_(\mbox{\hyperlink{classtesting_1_1internal_1_1ExpectationBase}{ExpectationBase}});}
\DoxyCodeLine{873 \};  \textcolor{comment}{// class ExpectationBase}}
\DoxyCodeLine{874 }
\DoxyCodeLine{875 \textcolor{comment}{// Impements an expectation for the given function type.}}
\DoxyCodeLine{876 \textcolor{keyword}{template} <\textcolor{keyword}{typename} F>}
\DoxyCodeLine{877 \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation}} : \textcolor{keyword}{public} \mbox{\hyperlink{classtesting_1_1internal_1_1ExpectationBase}{ExpectationBase}} \{}
\DoxyCodeLine{878  \textcolor{keyword}{public}:}
\DoxyCodeLine{879   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structtesting_1_1internal_1_1Function}{Function<F>::ArgumentTuple}} ArgumentTuple;}
\DoxyCodeLine{880   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structtesting_1_1internal_1_1Function}{Function<F>::ArgumentMatcherTuple}} ArgumentMatcherTuple;}
\DoxyCodeLine{881   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structtesting_1_1internal_1_1Function}{Function<F>::Result}} Result;}
\DoxyCodeLine{882 }
\DoxyCodeLine{883   \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation}}(\mbox{\hyperlink{classtesting_1_1internal_1_1FunctionMockerBase}{FunctionMockerBase<F>}}* owner,}
\DoxyCodeLine{884                    \textcolor{keyword}{const} \textcolor{keywordtype}{char}* a\_file, \textcolor{keywordtype}{int} a\_line, \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& a\_source\_text,}
\DoxyCodeLine{885                    \textcolor{keyword}{const} ArgumentMatcherTuple\& m)}
\DoxyCodeLine{886       : \mbox{\hyperlink{classtesting_1_1internal_1_1ExpectationBase}{ExpectationBase}}(a\_file, a\_line, a\_source\_text),}
\DoxyCodeLine{887         owner\_(owner),}
\DoxyCodeLine{888         matchers\_(m),}
\DoxyCodeLine{889         \textcolor{comment}{// By default, extra\_matcher\_ should match anything.  However,}}
\DoxyCodeLine{890         \textcolor{comment}{// we cannot initialize it with \_ as that triggers a compiler}}
\DoxyCodeLine{891         \textcolor{comment}{// bug in Symbian's C++ compiler (cannot decide between two}}
\DoxyCodeLine{892         \textcolor{comment}{// overloaded constructors of Matcher<const ArgumentTuple\&>).}}
\DoxyCodeLine{893         extra\_matcher\_(A<const ArgumentTuple\&>()),}
\DoxyCodeLine{894         repeated\_action\_(DoDefault()) \{\}}
\DoxyCodeLine{895 }
\DoxyCodeLine{896   \textcolor{keyword}{virtual} \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{\string~TypedExpectation}}() \{}
\DoxyCodeLine{897     \textcolor{comment}{// Check the validity of the action count if it hasn't been done}}
\DoxyCodeLine{898     \textcolor{comment}{// yet (for example, if the expectation was never used).}}
\DoxyCodeLine{899     CheckActionCountIfNotDone();}
\DoxyCodeLine{900     \textcolor{keywordflow}{for} (UntypedActions::const\_iterator it = untyped\_actions\_.begin();}
\DoxyCodeLine{901          it != untyped\_actions\_.end(); ++it) \{}
\DoxyCodeLine{902       \textcolor{keyword}{delete} \textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }\mbox{\hyperlink{classtesting_1_1Action}{Action<F>}}*\textcolor{keyword}{>}(*it);}
\DoxyCodeLine{903     \}}
\DoxyCodeLine{904   \}}
\DoxyCodeLine{905 }
\DoxyCodeLine{906   \textcolor{comment}{// Implements the .With() clause.}}
\DoxyCodeLine{907   \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation}}\& With(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Matcher}{Matcher<const ArgumentTuple\&>}}\& m) \{}
\DoxyCodeLine{908     \textcolor{keywordflow}{if} (last\_clause\_ == kWith) \{}
\DoxyCodeLine{909       ExpectSpecProperty(\textcolor{keyword}{false},}
\DoxyCodeLine{910                          \textcolor{stringliteral}{"{}.With() cannot appear "{}}}
\DoxyCodeLine{911                          \textcolor{stringliteral}{"{}more than once in an EXPECT\_CALL()."{}});}
\DoxyCodeLine{912     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{913       ExpectSpecProperty(last\_clause\_ < kWith,}
\DoxyCodeLine{914                          \textcolor{stringliteral}{"{}.With() must be the first "{}}}
\DoxyCodeLine{915                          \textcolor{stringliteral}{"{}clause in an EXPECT\_CALL()."{}});}
\DoxyCodeLine{916     \}}
\DoxyCodeLine{917     last\_clause\_ = kWith;}
\DoxyCodeLine{918 }
\DoxyCodeLine{919     extra\_matcher\_ = m;}
\DoxyCodeLine{920     extra\_matcher\_specified\_ = \textcolor{keyword}{true};}
\DoxyCodeLine{921     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{922   \}}
\DoxyCodeLine{923 }
\DoxyCodeLine{924   \textcolor{comment}{// Implements the .Times() clause.}}
\DoxyCodeLine{925   \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation}}\& Times(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Cardinality}{Cardinality}}\& a\_cardinality) \{}
\DoxyCodeLine{926     ExpectationBase::UntypedTimes(a\_cardinality);}
\DoxyCodeLine{927     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{928   \}}
\DoxyCodeLine{929 }
\DoxyCodeLine{930   \textcolor{comment}{// Implements the .Times() clause.}}
\DoxyCodeLine{931   \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation}}\& Times(\textcolor{keywordtype}{int} n) \{}
\DoxyCodeLine{932     \textcolor{keywordflow}{return} Times(Exactly(n));}
\DoxyCodeLine{933   \}}
\DoxyCodeLine{934 }
\DoxyCodeLine{935   \textcolor{comment}{// Implements the .InSequence() clause.}}
\DoxyCodeLine{936   \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation}}\& \mbox{\hyperlink{classtesting_1_1InSequence}{InSequence}}(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Sequence}{Sequence}}\& s) \{}
\DoxyCodeLine{937     ExpectSpecProperty(last\_clause\_ <= kInSequence,}
\DoxyCodeLine{938                        \textcolor{stringliteral}{"{}.InSequence() cannot appear after .After(),"{}}}
\DoxyCodeLine{939                        \textcolor{stringliteral}{"{} .WillOnce(), .WillRepeatedly(), or "{}}}
\DoxyCodeLine{940                        \textcolor{stringliteral}{"{}.RetiresOnSaturation()."{}});}
\DoxyCodeLine{941     last\_clause\_ = kInSequence;}
\DoxyCodeLine{942 }
\DoxyCodeLine{943     s.AddExpectation(GetHandle());}
\DoxyCodeLine{944     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{945   \}}
\DoxyCodeLine{946   \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation}}\& \mbox{\hyperlink{classtesting_1_1InSequence}{InSequence}}(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Sequence}{Sequence}}\& s1, \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Sequence}{Sequence}}\& s2) \{}
\DoxyCodeLine{947     \textcolor{keywordflow}{return} \mbox{\hyperlink{classtesting_1_1InSequence}{InSequence}}(s1).InSequence(s2);}
\DoxyCodeLine{948   \}}
\DoxyCodeLine{949   \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation}}\& \mbox{\hyperlink{classtesting_1_1InSequence}{InSequence}}(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Sequence}{Sequence}}\& s1, \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Sequence}{Sequence}}\& s2,}
\DoxyCodeLine{950                                \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Sequence}{Sequence}}\& s3) \{}
\DoxyCodeLine{951     \textcolor{keywordflow}{return} \mbox{\hyperlink{classtesting_1_1InSequence}{InSequence}}(s1, s2).InSequence(s3);}
\DoxyCodeLine{952   \}}
\DoxyCodeLine{953   \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation}}\& \mbox{\hyperlink{classtesting_1_1InSequence}{InSequence}}(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Sequence}{Sequence}}\& s1, \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Sequence}{Sequence}}\& s2,}
\DoxyCodeLine{954                                \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Sequence}{Sequence}}\& s3, \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Sequence}{Sequence}}\& s4) \{}
\DoxyCodeLine{955     \textcolor{keywordflow}{return} \mbox{\hyperlink{classtesting_1_1InSequence}{InSequence}}(s1, s2, s3).InSequence(s4);}
\DoxyCodeLine{956   \}}
\DoxyCodeLine{957   \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation}}\& \mbox{\hyperlink{classtesting_1_1InSequence}{InSequence}}(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Sequence}{Sequence}}\& s1, \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Sequence}{Sequence}}\& s2,}
\DoxyCodeLine{958                                \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Sequence}{Sequence}}\& s3, \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Sequence}{Sequence}}\& s4,}
\DoxyCodeLine{959                                \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Sequence}{Sequence}}\& s5) \{}
\DoxyCodeLine{960     \textcolor{keywordflow}{return} \mbox{\hyperlink{classtesting_1_1InSequence}{InSequence}}(s1, s2, s3, s4).InSequence(s5);}
\DoxyCodeLine{961   \}}
\DoxyCodeLine{962 }
\DoxyCodeLine{963   \textcolor{comment}{// Implements that .After() clause.}}
\DoxyCodeLine{964   \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation}}\& After(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}\& s) \{}
\DoxyCodeLine{965     ExpectSpecProperty(last\_clause\_ <= kAfter,}
\DoxyCodeLine{966                        \textcolor{stringliteral}{"{}.After() cannot appear after .WillOnce(),"{}}}
\DoxyCodeLine{967                        \textcolor{stringliteral}{"{} .WillRepeatedly(), or "{}}}
\DoxyCodeLine{968                        \textcolor{stringliteral}{"{}.RetiresOnSaturation()."{}});}
\DoxyCodeLine{969     last\_clause\_ = kAfter;}
\DoxyCodeLine{970 }
\DoxyCodeLine{971     \textcolor{keywordflow}{for} (ExpectationSet::const\_iterator it = s.begin(); it != s.end(); ++it) \{}
\DoxyCodeLine{972       immediate\_prerequisites\_ += *it;}
\DoxyCodeLine{973     \}}
\DoxyCodeLine{974     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{975   \}}
\DoxyCodeLine{976   \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation}}\& After(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}\& s1, \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}\& s2) \{}
\DoxyCodeLine{977     \textcolor{keywordflow}{return} After(s1).After(s2);}
\DoxyCodeLine{978   \}}
\DoxyCodeLine{979   \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation}}\& After(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}\& s1, \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}\& s2,}
\DoxyCodeLine{980                           \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}\& s3) \{}
\DoxyCodeLine{981     \textcolor{keywordflow}{return} After(s1, s2).After(s3);}
\DoxyCodeLine{982   \}}
\DoxyCodeLine{983   \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation}}\& After(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}\& s1, \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}\& s2,}
\DoxyCodeLine{984                           \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}\& s3, \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}\& s4) \{}
\DoxyCodeLine{985     \textcolor{keywordflow}{return} After(s1, s2, s3).After(s4);}
\DoxyCodeLine{986   \}}
\DoxyCodeLine{987   \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation}}\& After(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}\& s1, \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}\& s2,}
\DoxyCodeLine{988                           \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}\& s3, \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}\& s4,}
\DoxyCodeLine{989                           \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}}\& s5) \{}
\DoxyCodeLine{990     \textcolor{keywordflow}{return} After(s1, s2, s3, s4).After(s5);}
\DoxyCodeLine{991   \}}
\DoxyCodeLine{992 }
\DoxyCodeLine{993   \textcolor{comment}{// Implements the .WillOnce() clause.}}
\DoxyCodeLine{994   \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation}}\& WillOnce(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Action}{Action<F>}}\& action) \{}
\DoxyCodeLine{995     ExpectSpecProperty(last\_clause\_ <= kWillOnce,}
\DoxyCodeLine{996                        \textcolor{stringliteral}{"{}.WillOnce() cannot appear after "{}}}
\DoxyCodeLine{997                        \textcolor{stringliteral}{"{}.WillRepeatedly() or .RetiresOnSaturation()."{}});}
\DoxyCodeLine{998     last\_clause\_ = kWillOnce;}
\DoxyCodeLine{999 }
\DoxyCodeLine{1000     untyped\_actions\_.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{classtesting_1_1Action}{Action<F>}}(action));}
\DoxyCodeLine{1001     \textcolor{keywordflow}{if} (!cardinality\_specified()) \{}
\DoxyCodeLine{1002       set\_cardinality(Exactly(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(untyped\_actions\_.size())));}
\DoxyCodeLine{1003     \}}
\DoxyCodeLine{1004     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{1005   \}}
\DoxyCodeLine{1006 }
\DoxyCodeLine{1007   \textcolor{comment}{// Implements the .WillRepeatedly() clause.}}
\DoxyCodeLine{1008   \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation}}\& WillRepeatedly(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Action}{Action<F>}}\& action) \{}
\DoxyCodeLine{1009     \textcolor{keywordflow}{if} (last\_clause\_ == kWillRepeatedly) \{}
\DoxyCodeLine{1010       ExpectSpecProperty(\textcolor{keyword}{false},}
\DoxyCodeLine{1011                          \textcolor{stringliteral}{"{}.WillRepeatedly() cannot appear "{}}}
\DoxyCodeLine{1012                          \textcolor{stringliteral}{"{}more than once in an EXPECT\_CALL()."{}});}
\DoxyCodeLine{1013     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{1014       ExpectSpecProperty(last\_clause\_ < kWillRepeatedly,}
\DoxyCodeLine{1015                          \textcolor{stringliteral}{"{}.WillRepeatedly() cannot appear "{}}}
\DoxyCodeLine{1016                          \textcolor{stringliteral}{"{}after .RetiresOnSaturation()."{}});}
\DoxyCodeLine{1017     \}}
\DoxyCodeLine{1018     last\_clause\_ = kWillRepeatedly;}
\DoxyCodeLine{1019     repeated\_action\_specified\_ = \textcolor{keyword}{true};}
\DoxyCodeLine{1020 }
\DoxyCodeLine{1021     repeated\_action\_ = action;}
\DoxyCodeLine{1022     \textcolor{keywordflow}{if} (!cardinality\_specified()) \{}
\DoxyCodeLine{1023       set\_cardinality(AtLeast(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(untyped\_actions\_.size())));}
\DoxyCodeLine{1024     \}}
\DoxyCodeLine{1025 }
\DoxyCodeLine{1026     \textcolor{comment}{// Now that no more action clauses can be specified, we check}}
\DoxyCodeLine{1027     \textcolor{comment}{// whether their count makes sense.}}
\DoxyCodeLine{1028     CheckActionCountIfNotDone();}
\DoxyCodeLine{1029     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{1030   \}}
\DoxyCodeLine{1031 }
\DoxyCodeLine{1032   \textcolor{comment}{// Implements the .RetiresOnSaturation() clause.}}
\DoxyCodeLine{1033   \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation}}\& RetiresOnSaturation() \{}
\DoxyCodeLine{1034     ExpectSpecProperty(last\_clause\_ < kRetiresOnSaturation,}
\DoxyCodeLine{1035                        \textcolor{stringliteral}{"{}.RetiresOnSaturation() cannot appear "{}}}
\DoxyCodeLine{1036                        \textcolor{stringliteral}{"{}more than once."{}});}
\DoxyCodeLine{1037     last\_clause\_ = kRetiresOnSaturation;}
\DoxyCodeLine{1038     retires\_on\_saturation\_ = \textcolor{keyword}{true};}
\DoxyCodeLine{1039 }
\DoxyCodeLine{1040     \textcolor{comment}{// Now that no more action clauses can be specified, we check}}
\DoxyCodeLine{1041     \textcolor{comment}{// whether their count makes sense.}}
\DoxyCodeLine{1042     CheckActionCountIfNotDone();}
\DoxyCodeLine{1043     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{1044   \}}
\DoxyCodeLine{1045 }
\DoxyCodeLine{1046   \textcolor{comment}{// Returns the matchers for the arguments as specified inside the}}
\DoxyCodeLine{1047   \textcolor{comment}{// EXPECT\_CALL() macro.}}
\DoxyCodeLine{1048   \textcolor{keyword}{const} ArgumentMatcherTuple\& matchers()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1049     \textcolor{keywordflow}{return} matchers\_;}
\DoxyCodeLine{1050   \}}
\DoxyCodeLine{1051 }
\DoxyCodeLine{1052   \textcolor{comment}{// Returns the matcher specified by the .With() clause.}}
\DoxyCodeLine{1053   \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Matcher}{Matcher<const ArgumentTuple\&>}}\& extra\_matcher()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1054     \textcolor{keywordflow}{return} extra\_matcher\_;}
\DoxyCodeLine{1055   \}}
\DoxyCodeLine{1056 }
\DoxyCodeLine{1057   \textcolor{comment}{// Returns the action specified by the .WillRepeatedly() clause.}}
\DoxyCodeLine{1058   \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Action}{Action<F>}}\& repeated\_action()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} repeated\_action\_; \}}
\DoxyCodeLine{1059 }
\DoxyCodeLine{1060   \textcolor{comment}{// If this mock method has an extra matcher (i.e. .With(matcher)),}}
\DoxyCodeLine{1061   \textcolor{comment}{// describes it to the ostream.}}
\DoxyCodeLine{1062   \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} MaybeDescribeExtraMatcherTo(::std::ostream* os) \{}
\DoxyCodeLine{1063     \textcolor{keywordflow}{if} (extra\_matcher\_specified\_) \{}
\DoxyCodeLine{1064       *os << \textcolor{stringliteral}{"{}    Expected args: "{}};}
\DoxyCodeLine{1065       extra\_matcher\_.DescribeTo(os);}
\DoxyCodeLine{1066       *os << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{1067     \}}
\DoxyCodeLine{1068   \}}
\DoxyCodeLine{1069 }
\DoxyCodeLine{1070  \textcolor{keyword}{private}:}
\DoxyCodeLine{1071   \textcolor{keyword}{template} <\textcolor{keyword}{typename} Function>}
\DoxyCodeLine{1072   \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1internal_1_1FunctionMockerBase}{FunctionMockerBase}};}
\DoxyCodeLine{1073 }
\DoxyCodeLine{1074   \textcolor{comment}{// Returns an Expectation object that references and co-\/owns this}}
\DoxyCodeLine{1075   \textcolor{comment}{// expectation.}}
\DoxyCodeLine{1076   \textcolor{keyword}{virtual} \mbox{\hyperlink{classtesting_1_1Expectation}{Expectation}} GetHandle() \{}
\DoxyCodeLine{1077     \textcolor{keywordflow}{return} owner\_-\/>GetHandleOf(\textcolor{keyword}{this});}
\DoxyCodeLine{1078   \}}
\DoxyCodeLine{1079 }
\DoxyCodeLine{1080   \textcolor{comment}{// The following methods will be called only after the EXPECT\_CALL()}}
\DoxyCodeLine{1081   \textcolor{comment}{// statement finishes and when the current thread holds}}
\DoxyCodeLine{1082   \textcolor{comment}{// g\_gmock\_mutex.}}
\DoxyCodeLine{1083 }
\DoxyCodeLine{1084   \textcolor{comment}{// Returns true iff this expectation matches the given arguments.}}
\DoxyCodeLine{1085   \textcolor{keywordtype}{bool} Matches(\textcolor{keyword}{const} ArgumentTuple\& args) \textcolor{keyword}{const}}
\DoxyCodeLine{1086       GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{1087     g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{1088     \textcolor{keywordflow}{return} TupleMatches(matchers\_, args) \&\& extra\_matcher\_.Matches(args);}
\DoxyCodeLine{1089   \}}
\DoxyCodeLine{1090 }
\DoxyCodeLine{1091   \textcolor{comment}{// Returns true iff this expectation should handle the given arguments.}}
\DoxyCodeLine{1092   \textcolor{keywordtype}{bool} ShouldHandleArguments(\textcolor{keyword}{const} ArgumentTuple\& args) \textcolor{keyword}{const}}
\DoxyCodeLine{1093       GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{1094     g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{1095 }
\DoxyCodeLine{1096     \textcolor{comment}{// In case the action count wasn't checked when the expectation}}
\DoxyCodeLine{1097     \textcolor{comment}{// was defined (e.g. if this expectation has no WillRepeatedly()}}
\DoxyCodeLine{1098     \textcolor{comment}{// or RetiresOnSaturation() clause), we check it when the}}
\DoxyCodeLine{1099     \textcolor{comment}{// expectation is used for the first time.}}
\DoxyCodeLine{1100     CheckActionCountIfNotDone();}
\DoxyCodeLine{1101     \textcolor{keywordflow}{return} !is\_retired() \&\& AllPrerequisitesAreSatisfied() \&\& Matches(args);}
\DoxyCodeLine{1102   \}}
\DoxyCodeLine{1103 }
\DoxyCodeLine{1104   \textcolor{comment}{// Describes the result of matching the arguments against this}}
\DoxyCodeLine{1105   \textcolor{comment}{// expectation to the given ostream.}}
\DoxyCodeLine{1106   \textcolor{keywordtype}{void} ExplainMatchResultTo(}
\DoxyCodeLine{1107       \textcolor{keyword}{const} ArgumentTuple\& args,}
\DoxyCodeLine{1108       ::std::ostream* os) \textcolor{keyword}{const}}
\DoxyCodeLine{1109           GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{1110     g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{1111 }
\DoxyCodeLine{1112     \textcolor{keywordflow}{if} (is\_retired()) \{}
\DoxyCodeLine{1113       *os << \textcolor{stringliteral}{"{}         Expected: the expectation is active\(\backslash\)n"{}}}
\DoxyCodeLine{1114           << \textcolor{stringliteral}{"{}           Actual: it is retired\(\backslash\)n"{}};}
\DoxyCodeLine{1115     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!Matches(args)) \{}
\DoxyCodeLine{1116       \textcolor{keywordflow}{if} (!TupleMatches(matchers\_, args)) \{}
\DoxyCodeLine{1117         ExplainMatchFailureTupleTo(matchers\_, args, os);}
\DoxyCodeLine{1118       \}}
\DoxyCodeLine{1119       \mbox{\hyperlink{classtesting_1_1StringMatchResultListener}{StringMatchResultListener}} listener;}
\DoxyCodeLine{1120       \textcolor{keywordflow}{if} (!extra\_matcher\_.MatchAndExplain(args, \&listener)) \{}
\DoxyCodeLine{1121         *os << \textcolor{stringliteral}{"{}    Expected args: "{}};}
\DoxyCodeLine{1122         extra\_matcher\_.DescribeTo(os);}
\DoxyCodeLine{1123         *os << \textcolor{stringliteral}{"{}\(\backslash\)n           Actual: don't match"{}};}
\DoxyCodeLine{1124 }
\DoxyCodeLine{1125         internal::PrintIfNotEmpty(listener.str(), os);}
\DoxyCodeLine{1126         *os << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{1127       \}}
\DoxyCodeLine{1128     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!AllPrerequisitesAreSatisfied()) \{}
\DoxyCodeLine{1129       *os << \textcolor{stringliteral}{"{}         Expected: all pre-\/requisites are satisfied\(\backslash\)n"{}}}
\DoxyCodeLine{1130           << \textcolor{stringliteral}{"{}           Actual: the following immediate pre-\/requisites "{}}}
\DoxyCodeLine{1131           << \textcolor{stringliteral}{"{}are not satisfied:\(\backslash\)n"{}};}
\DoxyCodeLine{1132       \mbox{\hyperlink{classtesting_1_1ExpectationSet}{ExpectationSet}} unsatisfied\_prereqs;}
\DoxyCodeLine{1133       FindUnsatisfiedPrerequisites(\&unsatisfied\_prereqs);}
\DoxyCodeLine{1134       \textcolor{keywordtype}{int} i = 0;}
\DoxyCodeLine{1135       \textcolor{keywordflow}{for} (ExpectationSet::const\_iterator it = unsatisfied\_prereqs.begin();}
\DoxyCodeLine{1136            it != unsatisfied\_prereqs.end(); ++it) \{}
\DoxyCodeLine{1137         it-\/>expectation\_base()-\/>DescribeLocationTo(os);}
\DoxyCodeLine{1138         *os << \textcolor{stringliteral}{"{}pre-\/requisite \#"{}} << i++ << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{1139       \}}
\DoxyCodeLine{1140       *os << \textcolor{stringliteral}{"{}                   (end of pre-\/requisites)\(\backslash\)n"{}};}
\DoxyCodeLine{1141     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{1142       \textcolor{comment}{// This line is here just for completeness' sake.  It will never}}
\DoxyCodeLine{1143       \textcolor{comment}{// be executed as currently the ExplainMatchResultTo() function}}
\DoxyCodeLine{1144       \textcolor{comment}{// is called only when the mock function call does NOT match the}}
\DoxyCodeLine{1145       \textcolor{comment}{// expectation.}}
\DoxyCodeLine{1146       *os << \textcolor{stringliteral}{"{}The call matches the expectation.\(\backslash\)n"{}};}
\DoxyCodeLine{1147     \}}
\DoxyCodeLine{1148   \}}
\DoxyCodeLine{1149 }
\DoxyCodeLine{1150   \textcolor{comment}{// Returns the action that should be taken for the current invocation.}}
\DoxyCodeLine{1151   \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Action}{Action<F>}}\& GetCurrentAction(}
\DoxyCodeLine{1152       \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1internal_1_1FunctionMockerBase}{FunctionMockerBase<F>}}* mocker,}
\DoxyCodeLine{1153       \textcolor{keyword}{const} ArgumentTuple\& args) \textcolor{keyword}{const}}
\DoxyCodeLine{1154           GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{1155     g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{1156     \textcolor{keyword}{const} \textcolor{keywordtype}{int} count = call\_count();}
\DoxyCodeLine{1157     Assert(count >= 1, \_\_FILE\_\_, \_\_LINE\_\_,}
\DoxyCodeLine{1158            \textcolor{stringliteral}{"{}call\_count() is <= 0 when GetCurrentAction() is "{}}}
\DoxyCodeLine{1159            \textcolor{stringliteral}{"{}called -\/ this should never happen."{}});}
\DoxyCodeLine{1160 }
\DoxyCodeLine{1161     \textcolor{keyword}{const} \textcolor{keywordtype}{int} action\_count = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(untyped\_actions\_.size());}
\DoxyCodeLine{1162     \textcolor{keywordflow}{if} (action\_count > 0 \&\& !repeated\_action\_specified\_ \&\&}
\DoxyCodeLine{1163         count > action\_count) \{}
\DoxyCodeLine{1164       \textcolor{comment}{// If there is at least one WillOnce() and no WillRepeatedly(),}}
\DoxyCodeLine{1165       \textcolor{comment}{// we warn the user when the WillOnce() clauses ran out.}}
\DoxyCodeLine{1166       ::std::stringstream ss;}
\DoxyCodeLine{1167       DescribeLocationTo(\&ss);}
\DoxyCodeLine{1168       ss << \textcolor{stringliteral}{"{}Actions ran out in "{}} << source\_text() << \textcolor{stringliteral}{"{}...\(\backslash\)n"{}}}
\DoxyCodeLine{1169          << \textcolor{stringliteral}{"{}Called "{}} << count << \textcolor{stringliteral}{"{} times, but only "{}}}
\DoxyCodeLine{1170          << action\_count << \textcolor{stringliteral}{"{} WillOnce()"{}}}
\DoxyCodeLine{1171          << (action\_count == 1 ? \textcolor{stringliteral}{"{} is"{}} : \textcolor{stringliteral}{"{}s are"{}}) << \textcolor{stringliteral}{"{} specified -\/ "{}};}
\DoxyCodeLine{1172       mocker-\/>DescribeDefaultActionTo(args, \&ss);}
\DoxyCodeLine{1173       Log(kWarning, ss.str(), 1);}
\DoxyCodeLine{1174     \}}
\DoxyCodeLine{1175 }
\DoxyCodeLine{1176     \textcolor{keywordflow}{return} count <= action\_count ?}
\DoxyCodeLine{1177         *\textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }\mbox{\hyperlink{classtesting_1_1Action}{Action<F>}}*\textcolor{keyword}{>}(untyped\_actions\_[count -\/ 1]) :}
\DoxyCodeLine{1178         repeated\_action();}
\DoxyCodeLine{1179   \}}
\DoxyCodeLine{1180 }
\DoxyCodeLine{1181   \textcolor{comment}{// Given the arguments of a mock function call, if the call will}}
\DoxyCodeLine{1182   \textcolor{comment}{// over-\/saturate this expectation, returns the default action;}}
\DoxyCodeLine{1183   \textcolor{comment}{// otherwise, returns the next action in this expectation.  Also}}
\DoxyCodeLine{1184   \textcolor{comment}{// describes *what* happened to 'what', and explains *why* Google}}
\DoxyCodeLine{1185   \textcolor{comment}{// Mock does it to 'why'.  This method is not const as it calls}}
\DoxyCodeLine{1186   \textcolor{comment}{// IncrementCallCount().  A return value of NULL means the default}}
\DoxyCodeLine{1187   \textcolor{comment}{// action.}}
\DoxyCodeLine{1188   \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Action}{Action<F>}}* GetActionForArguments(}
\DoxyCodeLine{1189       \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1internal_1_1FunctionMockerBase}{FunctionMockerBase<F>}}* mocker,}
\DoxyCodeLine{1190       \textcolor{keyword}{const} ArgumentTuple\& args,}
\DoxyCodeLine{1191       ::std::ostream* what,}
\DoxyCodeLine{1192       ::std::ostream* why)}
\DoxyCodeLine{1193           GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{1194     g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{1195     \textcolor{keywordflow}{if} (IsSaturated()) \{}
\DoxyCodeLine{1196       \textcolor{comment}{// We have an excessive call.}}
\DoxyCodeLine{1197       IncrementCallCount();}
\DoxyCodeLine{1198       *what << \textcolor{stringliteral}{"{}Mock function called more times than expected -\/ "{}};}
\DoxyCodeLine{1199       mocker-\/>DescribeDefaultActionTo(args, what);}
\DoxyCodeLine{1200       DescribeCallCountTo(why);}
\DoxyCodeLine{1201 }
\DoxyCodeLine{1202       \textcolor{comment}{// TODO(wan@google.com): allow the user to control whether}}
\DoxyCodeLine{1203       \textcolor{comment}{// unexpected calls should fail immediately or continue using a}}
\DoxyCodeLine{1204       \textcolor{comment}{// flag -\/-\/gmock\_unexpected\_calls\_are\_fatal.}}
\DoxyCodeLine{1205       \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{1206     \}}
\DoxyCodeLine{1207 }
\DoxyCodeLine{1208     IncrementCallCount();}
\DoxyCodeLine{1209     RetireAllPreRequisites();}
\DoxyCodeLine{1210 }
\DoxyCodeLine{1211     \textcolor{keywordflow}{if} (retires\_on\_saturation\_ \&\& IsSaturated()) \{}
\DoxyCodeLine{1212       Retire();}
\DoxyCodeLine{1213     \}}
\DoxyCodeLine{1214 }
\DoxyCodeLine{1215     \textcolor{comment}{// Must be done after IncrementCount()!}}
\DoxyCodeLine{1216     *what << \textcolor{stringliteral}{"{}Mock function call matches "{}} << source\_text() <<\textcolor{stringliteral}{"{}...\(\backslash\)n"{}};}
\DoxyCodeLine{1217     \textcolor{keywordflow}{return} \&(GetCurrentAction(mocker, args));}
\DoxyCodeLine{1218   \}}
\DoxyCodeLine{1219 }
\DoxyCodeLine{1220   \textcolor{comment}{// All the fields below won't change once the EXPECT\_CALL()}}
\DoxyCodeLine{1221   \textcolor{comment}{// statement finishes.}}
\DoxyCodeLine{1222   \mbox{\hyperlink{classtesting_1_1internal_1_1FunctionMockerBase}{FunctionMockerBase<F>}}* \textcolor{keyword}{const} owner\_;}
\DoxyCodeLine{1223   ArgumentMatcherTuple matchers\_;}
\DoxyCodeLine{1224   \mbox{\hyperlink{classtesting_1_1Matcher}{Matcher<const ArgumentTuple\&>}} extra\_matcher\_;}
\DoxyCodeLine{1225   \mbox{\hyperlink{classtesting_1_1Action}{Action<F>}} repeated\_action\_;}
\DoxyCodeLine{1226 }
\DoxyCodeLine{1227   GTEST\_DISALLOW\_COPY\_AND\_ASSIGN\_(\mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation}});}
\DoxyCodeLine{1228 \};  \textcolor{comment}{// class TypedExpectation}}
\DoxyCodeLine{1229 }
\DoxyCodeLine{1230 \textcolor{comment}{// A MockSpec object is used by ON\_CALL() or EXPECT\_CALL() for}}
\DoxyCodeLine{1231 \textcolor{comment}{// specifying the default behavior of, or expectation on, a mock}}
\DoxyCodeLine{1232 \textcolor{comment}{// function.}}
\DoxyCodeLine{1233 }
\DoxyCodeLine{1234 \textcolor{comment}{// Note: class MockSpec really belongs to the ::testing namespace.}}
\DoxyCodeLine{1235 \textcolor{comment}{// However if we define it in ::testing, MSVC will complain when}}
\DoxyCodeLine{1236 \textcolor{comment}{// classes in ::testing::internal declare it as a friend class}}
\DoxyCodeLine{1237 \textcolor{comment}{// template.  To workaround this compiler bug, we define MockSpec in}}
\DoxyCodeLine{1238 \textcolor{comment}{// ::testing::internal and import it into ::testing.}}
\DoxyCodeLine{1239 }
\DoxyCodeLine{1240 \textcolor{comment}{// Logs a message including file and line number information.}}
\DoxyCodeLine{1241 GTEST\_API\_ \textcolor{keywordtype}{void} LogWithLocation(testing::internal::LogSeverity severity,}
\DoxyCodeLine{1242                                 \textcolor{keyword}{const} \textcolor{keywordtype}{char}* file, \textcolor{keywordtype}{int} line,}
\DoxyCodeLine{1243                                 \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& message);}
\DoxyCodeLine{1244 }
\DoxyCodeLine{1245 \textcolor{keyword}{template} <\textcolor{keyword}{typename} F>}
\DoxyCodeLine{1246 \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1internal_1_1MockSpec}{MockSpec}} \{}
\DoxyCodeLine{1247  \textcolor{keyword}{public}:}
\DoxyCodeLine{1248   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structtesting_1_1internal_1_1Function}{internal::Function<F>::ArgumentTuple}} ArgumentTuple;}
\DoxyCodeLine{1249   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structtesting_1_1internal_1_1Function}{internal::Function<F>::ArgumentMatcherTuple}}}
\DoxyCodeLine{1250       ArgumentMatcherTuple;}
\DoxyCodeLine{1251 }
\DoxyCodeLine{1252   \textcolor{comment}{// Constructs a MockSpec object, given the function mocker object}}
\DoxyCodeLine{1253   \textcolor{comment}{// that the spec is associated with.}}
\DoxyCodeLine{1254   \textcolor{keyword}{explicit} \mbox{\hyperlink{classtesting_1_1internal_1_1MockSpec}{MockSpec}}(\mbox{\hyperlink{classtesting_1_1internal_1_1FunctionMockerBase}{internal::FunctionMockerBase<F>}}* function\_mocker)}
\DoxyCodeLine{1255       : function\_mocker\_(function\_mocker) \{\}}
\DoxyCodeLine{1256 }
\DoxyCodeLine{1257   \textcolor{comment}{// Adds a new default action spec to the function mocker and returns}}
\DoxyCodeLine{1258   \textcolor{comment}{// the newly created spec.}}
\DoxyCodeLine{1259   \mbox{\hyperlink{classtesting_1_1internal_1_1OnCallSpec}{internal::OnCallSpec<F>}}\& InternalDefaultActionSetAt(}
\DoxyCodeLine{1260       \textcolor{keyword}{const} \textcolor{keywordtype}{char}* file, \textcolor{keywordtype}{int} line, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* obj, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* call) \{}
\DoxyCodeLine{1261     LogWithLocation(internal::kInfo, file, line,}
\DoxyCodeLine{1262         \textcolor{keywordtype}{string}(\textcolor{stringliteral}{"{}ON\_CALL("{}}) + obj + \textcolor{stringliteral}{"{}, "{}} + call + \textcolor{stringliteral}{"{}) invoked"{}});}
\DoxyCodeLine{1263     \textcolor{keywordflow}{return} function\_mocker\_-\/>AddNewOnCallSpec(file, line, matchers\_);}
\DoxyCodeLine{1264   \}}
\DoxyCodeLine{1265 }
\DoxyCodeLine{1266   \textcolor{comment}{// Adds a new expectation spec to the function mocker and returns}}
\DoxyCodeLine{1267   \textcolor{comment}{// the newly created spec.}}
\DoxyCodeLine{1268   \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{internal::TypedExpectation<F>}}\& InternalExpectedAt(}
\DoxyCodeLine{1269       \textcolor{keyword}{const} \textcolor{keywordtype}{char}* file, \textcolor{keywordtype}{int} line, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* obj, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* call) \{}
\DoxyCodeLine{1270     \textcolor{keyword}{const} \textcolor{keywordtype}{string} source\_text(\textcolor{keywordtype}{string}(\textcolor{stringliteral}{"{}EXPECT\_CALL("{}}) + obj + \textcolor{stringliteral}{"{}, "{}} + call + \textcolor{stringliteral}{"{})"{}});}
\DoxyCodeLine{1271     LogWithLocation(internal::kInfo, file, line, source\_text + \textcolor{stringliteral}{"{} invoked"{}});}
\DoxyCodeLine{1272     \textcolor{keywordflow}{return} function\_mocker\_-\/>AddNewExpectation(}
\DoxyCodeLine{1273         file, line, source\_text, matchers\_);}
\DoxyCodeLine{1274   \}}
\DoxyCodeLine{1275 }
\DoxyCodeLine{1276  \textcolor{keyword}{private}:}
\DoxyCodeLine{1277   \textcolor{keyword}{template} <\textcolor{keyword}{typename} Function>}
\DoxyCodeLine{1278   \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1internal_1_1FunctionMocker}{internal::FunctionMocker}};}
\DoxyCodeLine{1279 }
\DoxyCodeLine{1280   \textcolor{keywordtype}{void} SetMatchers(\textcolor{keyword}{const} ArgumentMatcherTuple\& matchers) \{}
\DoxyCodeLine{1281     matchers\_ = matchers;}
\DoxyCodeLine{1282   \}}
\DoxyCodeLine{1283 }
\DoxyCodeLine{1284   \textcolor{comment}{// The function mocker that owns this spec.}}
\DoxyCodeLine{1285   \mbox{\hyperlink{classtesting_1_1internal_1_1FunctionMockerBase}{internal::FunctionMockerBase<F>}}* \textcolor{keyword}{const} function\_mocker\_;}
\DoxyCodeLine{1286   \textcolor{comment}{// The argument matchers specified in the spec.}}
\DoxyCodeLine{1287   ArgumentMatcherTuple matchers\_;}
\DoxyCodeLine{1288 }
\DoxyCodeLine{1289   GTEST\_DISALLOW\_ASSIGN\_(\mbox{\hyperlink{classtesting_1_1internal_1_1MockSpec}{MockSpec}});}
\DoxyCodeLine{1290 \};  \textcolor{comment}{// class MockSpec}}
\DoxyCodeLine{1291 }
\DoxyCodeLine{1292 \textcolor{comment}{// Wrapper type for generically holding an ordinary value or lvalue reference.}}
\DoxyCodeLine{1293 \textcolor{comment}{// If T is not a reference type, it must be copyable or movable.}}
\DoxyCodeLine{1294 \textcolor{comment}{// ReferenceOrValueWrapper<T> is movable, and will also be copyable unless}}
\DoxyCodeLine{1295 \textcolor{comment}{// T is a move-\/only value type (which means that it will always be copyable}}
\DoxyCodeLine{1296 \textcolor{comment}{// if the current platform does not support move semantics).}}
\DoxyCodeLine{1297 \textcolor{comment}{//}}
\DoxyCodeLine{1298 \textcolor{comment}{// The primary template defines handling for values, but function header}}
\DoxyCodeLine{1299 \textcolor{comment}{// comments describe the contract for the whole template (including}}
\DoxyCodeLine{1300 \textcolor{comment}{// specializations).}}
\DoxyCodeLine{1301 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{1302 \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1internal_1_1ReferenceOrValueWrapper}{ReferenceOrValueWrapper}} \{}
\DoxyCodeLine{1303  \textcolor{keyword}{public}:}
\DoxyCodeLine{1304   \textcolor{comment}{// Constructs a wrapper from the given value/reference.}}
\DoxyCodeLine{1305   \textcolor{keyword}{explicit} \mbox{\hyperlink{classtesting_1_1internal_1_1ReferenceOrValueWrapper}{ReferenceOrValueWrapper}}(T value)}
\DoxyCodeLine{1306       : value\_(::testing::internal::move(value)) \{}
\DoxyCodeLine{1307   \}}
\DoxyCodeLine{1308 }
\DoxyCodeLine{1309   \textcolor{comment}{// Unwraps and returns the underlying value/reference, exactly as}}
\DoxyCodeLine{1310   \textcolor{comment}{// originally passed. The behavior of calling this more than once on}}
\DoxyCodeLine{1311   \textcolor{comment}{// the same object is unspecified.}}
\DoxyCodeLine{1312   T Unwrap() \{ return ::testing::internal::move(value\_); \}}
\DoxyCodeLine{1313 }
\DoxyCodeLine{1314   \textcolor{comment}{// Provides nondestructive access to the underlying value/reference.}}
\DoxyCodeLine{1315   \textcolor{comment}{// Always returns a const reference (more precisely,}}
\DoxyCodeLine{1316   \textcolor{comment}{// const RemoveReference<T>\&). The behavior of calling this after}}
\DoxyCodeLine{1317   \textcolor{comment}{// calling Unwrap on the same object is unspecified.}}
\DoxyCodeLine{1318   \textcolor{keyword}{const} T\& Peek()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1319     \textcolor{keywordflow}{return} value\_;}
\DoxyCodeLine{1320   \}}
\DoxyCodeLine{1321 }
\DoxyCodeLine{1322  \textcolor{keyword}{private}:}
\DoxyCodeLine{1323   T value\_;}
\DoxyCodeLine{1324 \};}
\DoxyCodeLine{1325 }
\DoxyCodeLine{1326 \textcolor{comment}{// Specialization for lvalue reference types. See primary template}}
\DoxyCodeLine{1327 \textcolor{comment}{// for documentation.}}
\DoxyCodeLine{1328 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{1329 \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1internal_1_1ReferenceOrValueWrapper}{ReferenceOrValueWrapper}}<T\&> \{}
\DoxyCodeLine{1330  \textcolor{keyword}{public}:}
\DoxyCodeLine{1331   \textcolor{comment}{// Workaround for debatable pass-\/by-\/reference lint warning (c-\/library-\/team}}
\DoxyCodeLine{1332   \textcolor{comment}{// policy precludes NOLINT in this context)}}
\DoxyCodeLine{1333   \textcolor{keyword}{typedef} T\& reference;}
\DoxyCodeLine{1334   \textcolor{keyword}{explicit} \mbox{\hyperlink{classtesting_1_1internal_1_1ReferenceOrValueWrapper}{ReferenceOrValueWrapper}}(reference ref)}
\DoxyCodeLine{1335       : value\_ptr\_(\&ref) \{\}}
\DoxyCodeLine{1336   T\& Unwrap() \{ \textcolor{keywordflow}{return} *value\_ptr\_; \}}
\DoxyCodeLine{1337   \textcolor{keyword}{const} T\& Peek()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *value\_ptr\_; \}}
\DoxyCodeLine{1338 }
\DoxyCodeLine{1339  \textcolor{keyword}{private}:}
\DoxyCodeLine{1340   T* value\_ptr\_;}
\DoxyCodeLine{1341 \};}
\DoxyCodeLine{1342 }
\DoxyCodeLine{1343 \textcolor{comment}{// MSVC warns about using 'this' in base member initializer list, so}}
\DoxyCodeLine{1344 \textcolor{comment}{// we need to temporarily disable the warning.  We have to do it for}}
\DoxyCodeLine{1345 \textcolor{comment}{// the entire class to suppress the warning, even though it's about}}
\DoxyCodeLine{1346 \textcolor{comment}{// the constructor only.}}
\DoxyCodeLine{1347 }
\DoxyCodeLine{1348 \textcolor{preprocessor}{\#ifdef \_MSC\_VER}}
\DoxyCodeLine{1349 \textcolor{preprocessor}{\# pragma warning(push)          }\textcolor{comment}{// Saves the current warning state.}}
\DoxyCodeLine{1350 \textcolor{preprocessor}{\# pragma warning(disable:4355)  }\textcolor{comment}{// Temporarily disables warning 4355.}}
\DoxyCodeLine{1351 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// \_MSV\_VER}}
\DoxyCodeLine{1352 }
\DoxyCodeLine{1353 \textcolor{comment}{// C++ treats the void type specially.  For example, you cannot define}}
\DoxyCodeLine{1354 \textcolor{comment}{// a void-\/typed variable or pass a void value to a function.}}
\DoxyCodeLine{1355 \textcolor{comment}{// ActionResultHolder<T> holds a value of type T, where T must be a}}
\DoxyCodeLine{1356 \textcolor{comment}{// copyable type or void (T doesn't need to be default-\/constructable).}}
\DoxyCodeLine{1357 \textcolor{comment}{// It hides the syntactic difference between void and other types, and}}
\DoxyCodeLine{1358 \textcolor{comment}{// is used to unify the code for invoking both void-\/returning and}}
\DoxyCodeLine{1359 \textcolor{comment}{// non-\/void-\/returning mock functions.}}
\DoxyCodeLine{1360 }
\DoxyCodeLine{1361 \textcolor{comment}{// Untyped base class for ActionResultHolder<T>.}}
\DoxyCodeLine{1362 \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1internal_1_1UntypedActionResultHolderBase}{UntypedActionResultHolderBase}} \{}
\DoxyCodeLine{1363  \textcolor{keyword}{public}:}
\DoxyCodeLine{1364   \textcolor{keyword}{virtual} \mbox{\hyperlink{classtesting_1_1internal_1_1UntypedActionResultHolderBase}{\string~UntypedActionResultHolderBase}}() \{\}}
\DoxyCodeLine{1365 }
\DoxyCodeLine{1366   \textcolor{comment}{// Prints the held value as an action's result to os.}}
\DoxyCodeLine{1367   \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} PrintAsActionResult(::std::ostream* os) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{1368 \};}
\DoxyCodeLine{1369 }
\DoxyCodeLine{1370 \textcolor{comment}{// This generic definition is used when T is not void.}}
\DoxyCodeLine{1371 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{1372 \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1internal_1_1ActionResultHolder}{ActionResultHolder}} : \textcolor{keyword}{public} \mbox{\hyperlink{classtesting_1_1internal_1_1UntypedActionResultHolderBase}{UntypedActionResultHolderBase}} \{}
\DoxyCodeLine{1373  \textcolor{keyword}{public}:}
\DoxyCodeLine{1374   \textcolor{comment}{// Returns the held value. Must not be called more than once.}}
\DoxyCodeLine{1375   T Unwrap() \{}
\DoxyCodeLine{1376     \textcolor{keywordflow}{return} result\_.Unwrap();}
\DoxyCodeLine{1377   \}}
\DoxyCodeLine{1378 }
\DoxyCodeLine{1379   \textcolor{comment}{// Prints the held value as an action's result to os.}}
\DoxyCodeLine{1380   \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} PrintAsActionResult(::std::ostream* os)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1381     *os << \textcolor{stringliteral}{"{}\(\backslash\)n          Returns: "{}};}
\DoxyCodeLine{1382     \textcolor{comment}{// T may be a reference type, so we don't use UniversalPrint().}}
\DoxyCodeLine{1383     \mbox{\hyperlink{classtesting_1_1internal_1_1UniversalPrinter}{UniversalPrinter<T>::Print}}(result\_.Peek(), os);}
\DoxyCodeLine{1384   \}}
\DoxyCodeLine{1385 }
\DoxyCodeLine{1386   \textcolor{comment}{// Performs the given mock function's default action and returns the}}
\DoxyCodeLine{1387   \textcolor{comment}{// result in a new-\/ed ActionResultHolder.}}
\DoxyCodeLine{1388   \textcolor{keyword}{template} <\textcolor{keyword}{typename} F>}
\DoxyCodeLine{1389   \textcolor{keyword}{static} \mbox{\hyperlink{classtesting_1_1internal_1_1ActionResultHolder}{ActionResultHolder}}* PerformDefaultAction(}
\DoxyCodeLine{1390       \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1internal_1_1FunctionMockerBase}{FunctionMockerBase<F>}}* func\_mocker,}
\DoxyCodeLine{1391       \textcolor{keyword}{const} \textcolor{keyword}{typename} \mbox{\hyperlink{structtesting_1_1internal_1_1Function}{Function<F>::ArgumentTuple}}\& args,}
\DoxyCodeLine{1392       \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& call\_description) \{}
\DoxyCodeLine{1393     \textcolor{keywordflow}{return} \textcolor{keyword}{new} \mbox{\hyperlink{classtesting_1_1internal_1_1ActionResultHolder}{ActionResultHolder}}(\mbox{\hyperlink{classtesting_1_1internal_1_1ReferenceOrValueWrapper}{Wrapper}}(}
\DoxyCodeLine{1394         func\_mocker-\/>PerformDefaultAction(args, call\_description)));}
\DoxyCodeLine{1395   \}}
\DoxyCodeLine{1396 }
\DoxyCodeLine{1397   \textcolor{comment}{// Performs the given action and returns the result in a new-\/ed}}
\DoxyCodeLine{1398   \textcolor{comment}{// ActionResultHolder.}}
\DoxyCodeLine{1399   \textcolor{keyword}{template} <\textcolor{keyword}{typename} F>}
\DoxyCodeLine{1400   \textcolor{keyword}{static} \mbox{\hyperlink{classtesting_1_1internal_1_1ActionResultHolder}{ActionResultHolder}}*}
\DoxyCodeLine{1401   PerformAction(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Action}{Action<F>}}\& action,}
\DoxyCodeLine{1402                 \textcolor{keyword}{const} \textcolor{keyword}{typename} \mbox{\hyperlink{structtesting_1_1internal_1_1Function}{Function<F>::ArgumentTuple}}\& args) \{}
\DoxyCodeLine{1403     \textcolor{keywordflow}{return} \textcolor{keyword}{new} \mbox{\hyperlink{classtesting_1_1internal_1_1ActionResultHolder}{ActionResultHolder}}(\mbox{\hyperlink{classtesting_1_1internal_1_1ReferenceOrValueWrapper}{Wrapper}}(action.Perform(args)));}
\DoxyCodeLine{1404   \}}
\DoxyCodeLine{1405 }
\DoxyCodeLine{1406  \textcolor{keyword}{private}:}
\DoxyCodeLine{1407   \textcolor{keyword}{typedef} \mbox{\hyperlink{classtesting_1_1internal_1_1ReferenceOrValueWrapper}{ReferenceOrValueWrapper<T>}} \mbox{\hyperlink{classtesting_1_1internal_1_1ReferenceOrValueWrapper}{Wrapper}};}
\DoxyCodeLine{1408 }
\DoxyCodeLine{1409   \textcolor{keyword}{explicit} \mbox{\hyperlink{classtesting_1_1internal_1_1ActionResultHolder}{ActionResultHolder}}(\mbox{\hyperlink{classtesting_1_1internal_1_1ReferenceOrValueWrapper}{Wrapper}} result)}
\DoxyCodeLine{1410       : result\_(::testing::internal::move(result)) \{}
\DoxyCodeLine{1411   \}}
\DoxyCodeLine{1412 }
\DoxyCodeLine{1413   \mbox{\hyperlink{classtesting_1_1internal_1_1ReferenceOrValueWrapper}{Wrapper}} result\_;}
\DoxyCodeLine{1414 }
\DoxyCodeLine{1415   GTEST\_DISALLOW\_COPY\_AND\_ASSIGN\_(\mbox{\hyperlink{classtesting_1_1internal_1_1ActionResultHolder}{ActionResultHolder}});}
\DoxyCodeLine{1416 \};}
\DoxyCodeLine{1417 }
\DoxyCodeLine{1418 \textcolor{comment}{// Specialization for T = void.}}
\DoxyCodeLine{1419 \textcolor{keyword}{template} <>}
\DoxyCodeLine{1420 \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1internal_1_1ActionResultHolder}{ActionResultHolder}}<void> : \textcolor{keyword}{public} \mbox{\hyperlink{classtesting_1_1internal_1_1UntypedActionResultHolderBase}{UntypedActionResultHolderBase}} \{}
\DoxyCodeLine{1421  \textcolor{keyword}{public}:}
\DoxyCodeLine{1422   \textcolor{keywordtype}{void} Unwrap() \{ \}}
\DoxyCodeLine{1423 }
\DoxyCodeLine{1424   \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} PrintAsActionResult(::std::ostream* \textcolor{comment}{/* os */})\textcolor{keyword}{ const }\{\}}
\DoxyCodeLine{1425 }
\DoxyCodeLine{1426   \textcolor{comment}{// Performs the given mock function's default action and returns ownership}}
\DoxyCodeLine{1427   \textcolor{comment}{// of an empty ActionResultHolder*.}}
\DoxyCodeLine{1428   \textcolor{keyword}{template} <\textcolor{keyword}{typename} F>}
\DoxyCodeLine{1429   \textcolor{keyword}{static} \mbox{\hyperlink{classtesting_1_1internal_1_1ActionResultHolder}{ActionResultHolder}}* PerformDefaultAction(}
\DoxyCodeLine{1430       \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1internal_1_1FunctionMockerBase}{FunctionMockerBase<F>}}* func\_mocker,}
\DoxyCodeLine{1431       \textcolor{keyword}{const} \textcolor{keyword}{typename} \mbox{\hyperlink{structtesting_1_1internal_1_1Function}{Function<F>::ArgumentTuple}}\& args,}
\DoxyCodeLine{1432       \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& call\_description) \{}
\DoxyCodeLine{1433     func\_mocker-\/>PerformDefaultAction(args, call\_description);}
\DoxyCodeLine{1434     \textcolor{keywordflow}{return} \textcolor{keyword}{new} \mbox{\hyperlink{classtesting_1_1internal_1_1ActionResultHolder}{ActionResultHolder}};}
\DoxyCodeLine{1435   \}}
\DoxyCodeLine{1436 }
\DoxyCodeLine{1437   \textcolor{comment}{// Performs the given action and returns ownership of an empty}}
\DoxyCodeLine{1438   \textcolor{comment}{// ActionResultHolder*.}}
\DoxyCodeLine{1439   \textcolor{keyword}{template} <\textcolor{keyword}{typename} F>}
\DoxyCodeLine{1440   \textcolor{keyword}{static} \mbox{\hyperlink{classtesting_1_1internal_1_1ActionResultHolder}{ActionResultHolder}}* PerformAction(}
\DoxyCodeLine{1441       \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Action}{Action<F>}}\& action,}
\DoxyCodeLine{1442       \textcolor{keyword}{const} \textcolor{keyword}{typename} \mbox{\hyperlink{structtesting_1_1internal_1_1Function}{Function<F>::ArgumentTuple}}\& args) \{}
\DoxyCodeLine{1443     action.Perform(args);}
\DoxyCodeLine{1444     \textcolor{keywordflow}{return} \textcolor{keyword}{new} \mbox{\hyperlink{classtesting_1_1internal_1_1ActionResultHolder}{ActionResultHolder}};}
\DoxyCodeLine{1445   \}}
\DoxyCodeLine{1446 }
\DoxyCodeLine{1447  \textcolor{keyword}{private}:}
\DoxyCodeLine{1448   \mbox{\hyperlink{classtesting_1_1internal_1_1ActionResultHolder}{ActionResultHolder}}() \{\}}
\DoxyCodeLine{1449   GTEST\_DISALLOW\_COPY\_AND\_ASSIGN\_(\mbox{\hyperlink{classtesting_1_1internal_1_1ActionResultHolder}{ActionResultHolder}});}
\DoxyCodeLine{1450 \};}
\DoxyCodeLine{1451 }
\DoxyCodeLine{1452 \textcolor{comment}{// The base of the function mocker class for the given function type.}}
\DoxyCodeLine{1453 \textcolor{comment}{// We put the methods in this class instead of its child to avoid code}}
\DoxyCodeLine{1454 \textcolor{comment}{// bloat.}}
\DoxyCodeLine{1455 \textcolor{keyword}{template} <\textcolor{keyword}{typename} F>}
\DoxyCodeLine{1456 \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1internal_1_1FunctionMockerBase}{FunctionMockerBase}} : \textcolor{keyword}{public} \mbox{\hyperlink{classtesting_1_1internal_1_1UntypedFunctionMockerBase}{UntypedFunctionMockerBase}} \{}
\DoxyCodeLine{1457  \textcolor{keyword}{public}:}
\DoxyCodeLine{1458   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structtesting_1_1internal_1_1Function}{Function<F>::Result}} Result;}
\DoxyCodeLine{1459   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structtesting_1_1internal_1_1Function}{Function<F>::ArgumentTuple}} ArgumentTuple;}
\DoxyCodeLine{1460   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structtesting_1_1internal_1_1Function}{Function<F>::ArgumentMatcherTuple}} ArgumentMatcherTuple;}
\DoxyCodeLine{1461 }
\DoxyCodeLine{1462   \mbox{\hyperlink{classtesting_1_1internal_1_1FunctionMockerBase}{FunctionMockerBase}}() : current\_spec\_(\textcolor{keyword}{this}) \{\}}
\DoxyCodeLine{1463 }
\DoxyCodeLine{1464   \textcolor{comment}{// The destructor verifies that all expectations on this mock}}
\DoxyCodeLine{1465   \textcolor{comment}{// function have been satisfied.  If not, it will report Google Test}}
\DoxyCodeLine{1466   \textcolor{comment}{// non-\/fatal failures for the violations.}}
\DoxyCodeLine{1467   \textcolor{keyword}{virtual} \mbox{\hyperlink{classtesting_1_1internal_1_1FunctionMockerBase}{\string~FunctionMockerBase}}()}
\DoxyCodeLine{1468         GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{1469     \mbox{\hyperlink{classtesting_1_1internal_1_1GTestMutexLock}{MutexLock}} l(\&g\_gmock\_mutex);}
\DoxyCodeLine{1470     VerifyAndClearExpectationsLocked();}
\DoxyCodeLine{1471     Mock::UnregisterLocked(\textcolor{keyword}{this});}
\DoxyCodeLine{1472     ClearDefaultActionsLocked();}
\DoxyCodeLine{1473   \}}
\DoxyCodeLine{1474 }
\DoxyCodeLine{1475   \textcolor{comment}{// Returns the ON\_CALL spec that matches this mock function with the}}
\DoxyCodeLine{1476   \textcolor{comment}{// given arguments; returns NULL if no matching ON\_CALL is found.}}
\DoxyCodeLine{1477   \textcolor{comment}{// L = *}}
\DoxyCodeLine{1478   \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1internal_1_1OnCallSpec}{OnCallSpec<F>}}* FindOnCallSpec(}
\DoxyCodeLine{1479       \textcolor{keyword}{const} ArgumentTuple\& args)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1480     \textcolor{keywordflow}{for} (UntypedOnCallSpecs::const\_reverse\_iterator it}
\DoxyCodeLine{1481              = untyped\_on\_call\_specs\_.rbegin();}
\DoxyCodeLine{1482          it != untyped\_on\_call\_specs\_.rend(); ++it) \{}
\DoxyCodeLine{1483       \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1internal_1_1OnCallSpec}{OnCallSpec<F>}}* spec = \textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }\mbox{\hyperlink{classtesting_1_1internal_1_1OnCallSpec}{OnCallSpec<F>}}*\textcolor{keyword}{>}(*it);}
\DoxyCodeLine{1484       \textcolor{keywordflow}{if} (spec-\/>Matches(args))}
\DoxyCodeLine{1485         \textcolor{keywordflow}{return} spec;}
\DoxyCodeLine{1486     \}}
\DoxyCodeLine{1487 }
\DoxyCodeLine{1488     \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{1489   \}}
\DoxyCodeLine{1490 }
\DoxyCodeLine{1491   \textcolor{comment}{// Performs the default action of this mock function on the given}}
\DoxyCodeLine{1492   \textcolor{comment}{// arguments and returns the result. Asserts (or throws if}}
\DoxyCodeLine{1493   \textcolor{comment}{// exceptions are enabled) with a helpful call descrption if there}}
\DoxyCodeLine{1494   \textcolor{comment}{// is no valid return value. This method doesn't depend on the}}
\DoxyCodeLine{1495   \textcolor{comment}{// mutable state of this object, and thus can be called concurrently}}
\DoxyCodeLine{1496   \textcolor{comment}{// without locking.}}
\DoxyCodeLine{1497   \textcolor{comment}{// L = *}}
\DoxyCodeLine{1498   Result PerformDefaultAction(\textcolor{keyword}{const} ArgumentTuple\& args,}
\DoxyCodeLine{1499                               \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& call\_description)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1500     \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1internal_1_1OnCallSpec}{OnCallSpec<F>}}* \textcolor{keyword}{const} spec =}
\DoxyCodeLine{1501         this-\/>FindOnCallSpec(args);}
\DoxyCodeLine{1502     \textcolor{keywordflow}{if} (spec != NULL) \{}
\DoxyCodeLine{1503       \textcolor{keywordflow}{return} spec-\/>GetAction().Perform(args);}
\DoxyCodeLine{1504     \}}
\DoxyCodeLine{1505     \textcolor{keyword}{const} \textcolor{keywordtype}{string} message = call\_description +}
\DoxyCodeLine{1506         \textcolor{stringliteral}{"{}\(\backslash\)n    The mock function has no default action "{}}}
\DoxyCodeLine{1507         \textcolor{stringliteral}{"{}set, and its return type has no default value set."{}};}
\DoxyCodeLine{1508 \textcolor{preprocessor}{\#if GTEST\_HAS\_EXCEPTIONS}}
\DoxyCodeLine{1509     \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classtesting_1_1DefaultValue}{DefaultValue<Result>::Exists}}()) \{}
\DoxyCodeLine{1510       \textcolor{keywordflow}{throw} std::runtime\_error(message);}
\DoxyCodeLine{1511     \}}
\DoxyCodeLine{1512 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1513     Assert(\mbox{\hyperlink{classtesting_1_1DefaultValue}{DefaultValue<Result>::Exists}}(), \textcolor{stringliteral}{"{}"{}}, -\/1, message);}
\DoxyCodeLine{1514 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1515     \textcolor{keywordflow}{return} \mbox{\hyperlink{classtesting_1_1DefaultValue}{DefaultValue<Result>::Get}}();}
\DoxyCodeLine{1516   \}}
\DoxyCodeLine{1517 }
\DoxyCodeLine{1518   \textcolor{comment}{// Performs the default action with the given arguments and returns}}
\DoxyCodeLine{1519   \textcolor{comment}{// the action's result.  The call description string will be used in}}
\DoxyCodeLine{1520   \textcolor{comment}{// the error message to describe the call in the case the default}}
\DoxyCodeLine{1521   \textcolor{comment}{// action fails.  The caller is responsible for deleting the result.}}
\DoxyCodeLine{1522   \textcolor{comment}{// L = *}}
\DoxyCodeLine{1523   \textcolor{keyword}{virtual} \mbox{\hyperlink{classtesting_1_1internal_1_1UntypedActionResultHolderBase}{UntypedActionResultHolderBase}}* UntypedPerformDefaultAction(}
\DoxyCodeLine{1524       \textcolor{keyword}{const} \textcolor{keywordtype}{void}* untyped\_args,  \textcolor{comment}{// must point to an ArgumentTuple}}
\DoxyCodeLine{1525       \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& call\_description)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1526     \textcolor{keyword}{const} ArgumentTuple\& args =}
\DoxyCodeLine{1527         *\textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }ArgumentTuple*\textcolor{keyword}{>}(untyped\_args);}
\DoxyCodeLine{1528     \textcolor{keywordflow}{return} ResultHolder::PerformDefaultAction(\textcolor{keyword}{this}, args, call\_description);}
\DoxyCodeLine{1529   \}}
\DoxyCodeLine{1530 }
\DoxyCodeLine{1531   \textcolor{comment}{// Performs the given action with the given arguments and returns}}
\DoxyCodeLine{1532   \textcolor{comment}{// the action's result.  The caller is responsible for deleting the}}
\DoxyCodeLine{1533   \textcolor{comment}{// result.}}
\DoxyCodeLine{1534   \textcolor{comment}{// L = *}}
\DoxyCodeLine{1535   \textcolor{keyword}{virtual} \mbox{\hyperlink{classtesting_1_1internal_1_1UntypedActionResultHolderBase}{UntypedActionResultHolderBase}}* UntypedPerformAction(}
\DoxyCodeLine{1536       \textcolor{keyword}{const} \textcolor{keywordtype}{void}* untyped\_action, \textcolor{keyword}{const} \textcolor{keywordtype}{void}* untyped\_args)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1537     \textcolor{comment}{// Make a copy of the action before performing it, in case the}}
\DoxyCodeLine{1538     \textcolor{comment}{// action deletes the mock object (and thus deletes itself).}}
\DoxyCodeLine{1539     \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Action}{Action<F>}} action = *\textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }\mbox{\hyperlink{classtesting_1_1Action}{Action<F>}}*\textcolor{keyword}{>}(untyped\_action);}
\DoxyCodeLine{1540     \textcolor{keyword}{const} ArgumentTuple\& args =}
\DoxyCodeLine{1541         *\textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }ArgumentTuple*\textcolor{keyword}{>}(untyped\_args);}
\DoxyCodeLine{1542     \textcolor{keywordflow}{return} ResultHolder::PerformAction(action, args);}
\DoxyCodeLine{1543   \}}
\DoxyCodeLine{1544 }
\DoxyCodeLine{1545   \textcolor{comment}{// Implements UntypedFunctionMockerBase::ClearDefaultActionsLocked():}}
\DoxyCodeLine{1546   \textcolor{comment}{// clears the ON\_CALL()s set on this mock function.}}
\DoxyCodeLine{1547   \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} ClearDefaultActionsLocked()}
\DoxyCodeLine{1548       GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{1549     g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{1550 }
\DoxyCodeLine{1551     \textcolor{comment}{// Deleting our default actions may trigger other mock objects to be}}
\DoxyCodeLine{1552     \textcolor{comment}{// deleted, for example if an action contains a reference counted smart}}
\DoxyCodeLine{1553     \textcolor{comment}{// pointer to that mock object, and that is the last reference. So if we}}
\DoxyCodeLine{1554     \textcolor{comment}{// delete our actions within the context of the global mutex we may deadlock}}
\DoxyCodeLine{1555     \textcolor{comment}{// when this method is called again. Instead, make a copy of the set of}}
\DoxyCodeLine{1556     \textcolor{comment}{// actions to delete, clear our set within the mutex, and then delete the}}
\DoxyCodeLine{1557     \textcolor{comment}{// actions outside of the mutex.}}
\DoxyCodeLine{1558     UntypedOnCallSpecs specs\_to\_delete;}
\DoxyCodeLine{1559     untyped\_on\_call\_specs\_.swap(specs\_to\_delete);}
\DoxyCodeLine{1560 }
\DoxyCodeLine{1561     g\_gmock\_mutex.Unlock();}
\DoxyCodeLine{1562     \textcolor{keywordflow}{for} (UntypedOnCallSpecs::const\_iterator it =}
\DoxyCodeLine{1563              specs\_to\_delete.begin();}
\DoxyCodeLine{1564          it != specs\_to\_delete.end(); ++it) \{}
\DoxyCodeLine{1565       \textcolor{keyword}{delete} \textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }\mbox{\hyperlink{classtesting_1_1internal_1_1OnCallSpec}{OnCallSpec<F>}}*\textcolor{keyword}{>}(*it);}
\DoxyCodeLine{1566     \}}
\DoxyCodeLine{1567 }
\DoxyCodeLine{1568     \textcolor{comment}{// Lock the mutex again, since the caller expects it to be locked when we}}
\DoxyCodeLine{1569     \textcolor{comment}{// return.}}
\DoxyCodeLine{1570     g\_gmock\_mutex.Lock();}
\DoxyCodeLine{1571   \}}
\DoxyCodeLine{1572 }
\DoxyCodeLine{1573  \textcolor{keyword}{protected}:}
\DoxyCodeLine{1574   \textcolor{keyword}{template} <\textcolor{keyword}{typename} Function>}
\DoxyCodeLine{1575   \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1internal_1_1MockSpec}{MockSpec}};}
\DoxyCodeLine{1576 }
\DoxyCodeLine{1577   \textcolor{keyword}{typedef} \mbox{\hyperlink{classtesting_1_1internal_1_1ActionResultHolder}{ActionResultHolder<Result>}} \mbox{\hyperlink{classtesting_1_1internal_1_1ActionResultHolder}{ResultHolder}};}
\DoxyCodeLine{1578 }
\DoxyCodeLine{1579   \textcolor{comment}{// Returns the result of invoking this mock function with the given}}
\DoxyCodeLine{1580   \textcolor{comment}{// arguments.  This function can be safely called from multiple}}
\DoxyCodeLine{1581   \textcolor{comment}{// threads concurrently.}}
\DoxyCodeLine{1582   Result InvokeWith(\textcolor{keyword}{const} ArgumentTuple\& args)}
\DoxyCodeLine{1583         GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{1584     \mbox{\hyperlink{classtesting_1_1internal_1_1scoped__ptr}{scoped\_ptr<ResultHolder>}} holder(}
\DoxyCodeLine{1585         DownCast\_<ResultHolder*>(this-\/>UntypedInvokeWith(\&args)));}
\DoxyCodeLine{1586     \textcolor{keywordflow}{return} holder-\/>Unwrap();}
\DoxyCodeLine{1587   \}}
\DoxyCodeLine{1588 }
\DoxyCodeLine{1589   \textcolor{comment}{// Adds and returns a default action spec for this mock function.}}
\DoxyCodeLine{1590   \mbox{\hyperlink{classtesting_1_1internal_1_1OnCallSpec}{OnCallSpec<F>}}\& AddNewOnCallSpec(}
\DoxyCodeLine{1591       \textcolor{keyword}{const} \textcolor{keywordtype}{char}* file, \textcolor{keywordtype}{int} line,}
\DoxyCodeLine{1592       \textcolor{keyword}{const} ArgumentMatcherTuple\& m)}
\DoxyCodeLine{1593           GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{1594     Mock::RegisterUseByOnCallOrExpectCall(MockObject(), file, line);}
\DoxyCodeLine{1595     \mbox{\hyperlink{classtesting_1_1internal_1_1OnCallSpec}{OnCallSpec<F>}}* \textcolor{keyword}{const} on\_call\_spec = \textcolor{keyword}{new} \mbox{\hyperlink{classtesting_1_1internal_1_1OnCallSpec}{OnCallSpec<F>}}(file, line, m);}
\DoxyCodeLine{1596     untyped\_on\_call\_specs\_.push\_back(on\_call\_spec);}
\DoxyCodeLine{1597     \textcolor{keywordflow}{return} *on\_call\_spec;}
\DoxyCodeLine{1598   \}}
\DoxyCodeLine{1599 }
\DoxyCodeLine{1600   \textcolor{comment}{// Adds and returns an expectation spec for this mock function.}}
\DoxyCodeLine{1601   \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation<F>}}\& AddNewExpectation(}
\DoxyCodeLine{1602       \textcolor{keyword}{const} \textcolor{keywordtype}{char}* file,}
\DoxyCodeLine{1603       \textcolor{keywordtype}{int} line,}
\DoxyCodeLine{1604       \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& source\_text,}
\DoxyCodeLine{1605       \textcolor{keyword}{const} ArgumentMatcherTuple\& m)}
\DoxyCodeLine{1606           GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{1607     Mock::RegisterUseByOnCallOrExpectCall(MockObject(), file, line);}
\DoxyCodeLine{1608     \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation<F>}}* \textcolor{keyword}{const} expectation =}
\DoxyCodeLine{1609         \textcolor{keyword}{new} \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation<F>}}(\textcolor{keyword}{this}, file, line, source\_text, m);}
\DoxyCodeLine{1610     \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1internal_1_1linked__ptr}{linked\_ptr<ExpectationBase>}} untyped\_expectation(expectation);}
\DoxyCodeLine{1611     untyped\_expectations\_.push\_back(untyped\_expectation);}
\DoxyCodeLine{1612 }
\DoxyCodeLine{1613     \textcolor{comment}{// Adds this expectation into the implicit sequence if there is one.}}
\DoxyCodeLine{1614     \mbox{\hyperlink{classtesting_1_1Sequence}{Sequence}}* \textcolor{keyword}{const} implicit\_sequence = g\_gmock\_implicit\_sequence.get();}
\DoxyCodeLine{1615     \textcolor{keywordflow}{if} (implicit\_sequence != NULL) \{}
\DoxyCodeLine{1616       implicit\_sequence-\/>AddExpectation(\mbox{\hyperlink{classtesting_1_1Expectation}{Expectation}}(untyped\_expectation));}
\DoxyCodeLine{1617     \}}
\DoxyCodeLine{1618 }
\DoxyCodeLine{1619     \textcolor{keywordflow}{return} *expectation;}
\DoxyCodeLine{1620   \}}
\DoxyCodeLine{1621 }
\DoxyCodeLine{1622   \textcolor{comment}{// The current spec (either default action spec or expectation spec)}}
\DoxyCodeLine{1623   \textcolor{comment}{// being described on this function mocker.}}
\DoxyCodeLine{1624   \mbox{\hyperlink{classtesting_1_1internal_1_1MockSpec}{MockSpec<F>}}\& current\_spec() \{ \textcolor{keywordflow}{return} current\_spec\_; \}}
\DoxyCodeLine{1625 }
\DoxyCodeLine{1626  \textcolor{keyword}{private}:}
\DoxyCodeLine{1627   \textcolor{keyword}{template} <\textcolor{keyword}{typename} Func> \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation}};}
\DoxyCodeLine{1628 }
\DoxyCodeLine{1629   \textcolor{comment}{// Some utilities needed for implementing UntypedInvokeWith().}}
\DoxyCodeLine{1630 }
\DoxyCodeLine{1631   \textcolor{comment}{// Describes what default action will be performed for the given}}
\DoxyCodeLine{1632   \textcolor{comment}{// arguments.}}
\DoxyCodeLine{1633   \textcolor{comment}{// L = *}}
\DoxyCodeLine{1634   \textcolor{keywordtype}{void} DescribeDefaultActionTo(\textcolor{keyword}{const} ArgumentTuple\& args,}
\DoxyCodeLine{1635                                ::std::ostream* os)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1636     \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1internal_1_1OnCallSpec}{OnCallSpec<F>}}* \textcolor{keyword}{const} spec = FindOnCallSpec(args);}
\DoxyCodeLine{1637 }
\DoxyCodeLine{1638     \textcolor{keywordflow}{if} (spec == NULL) \{}
\DoxyCodeLine{1639       *os << (\mbox{\hyperlink{structtesting_1_1internal_1_1type__equals}{internal::type\_equals<Result, void>::value}} ?}
\DoxyCodeLine{1640               \textcolor{stringliteral}{"{}returning directly.\(\backslash\)n"{}} :}
\DoxyCodeLine{1641               \textcolor{stringliteral}{"{}returning default value.\(\backslash\)n"{}});}
\DoxyCodeLine{1642     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{1643       *os << \textcolor{stringliteral}{"{}taking default action specified at:\(\backslash\)n"{}}}
\DoxyCodeLine{1644           << FormatFileLocation(spec-\/>file(), spec-\/>line()) << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{1645     \}}
\DoxyCodeLine{1646   \}}
\DoxyCodeLine{1647 }
\DoxyCodeLine{1648   \textcolor{comment}{// Writes a message that the call is uninteresting (i.e. neither}}
\DoxyCodeLine{1649   \textcolor{comment}{// explicitly expected nor explicitly unexpected) to the given}}
\DoxyCodeLine{1650   \textcolor{comment}{// ostream.}}
\DoxyCodeLine{1651   \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} UntypedDescribeUninterestingCall(}
\DoxyCodeLine{1652       \textcolor{keyword}{const} \textcolor{keywordtype}{void}* untyped\_args,}
\DoxyCodeLine{1653       ::std::ostream* os) \textcolor{keyword}{const}}
\DoxyCodeLine{1654           GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{1655     \textcolor{keyword}{const} ArgumentTuple\& args =}
\DoxyCodeLine{1656         *\textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }ArgumentTuple*\textcolor{keyword}{>}(untyped\_args);}
\DoxyCodeLine{1657     *os << \textcolor{stringliteral}{"{}Uninteresting mock function call -\/ "{}};}
\DoxyCodeLine{1658     DescribeDefaultActionTo(args, os);}
\DoxyCodeLine{1659     *os << \textcolor{stringliteral}{"{}    Function call: "{}} << Name();}
\DoxyCodeLine{1660     UniversalPrint(args, os);}
\DoxyCodeLine{1661   \}}
\DoxyCodeLine{1662 }
\DoxyCodeLine{1663   \textcolor{comment}{// Returns the expectation that matches the given function arguments}}
\DoxyCodeLine{1664   \textcolor{comment}{// (or NULL is there's no match); when a match is found,}}
\DoxyCodeLine{1665   \textcolor{comment}{// untyped\_action is set to point to the action that should be}}
\DoxyCodeLine{1666   \textcolor{comment}{// performed (or NULL if the action is "{}do default"{}), and}}
\DoxyCodeLine{1667   \textcolor{comment}{// is\_excessive is modified to indicate whether the call exceeds the}}
\DoxyCodeLine{1668   \textcolor{comment}{// expected number.}}
\DoxyCodeLine{1669   \textcolor{comment}{//}}
\DoxyCodeLine{1670   \textcolor{comment}{// Critical section: We must find the matching expectation and the}}
\DoxyCodeLine{1671   \textcolor{comment}{// corresponding action that needs to be taken in an ATOMIC}}
\DoxyCodeLine{1672   \textcolor{comment}{// transaction.  Otherwise another thread may call this mock}}
\DoxyCodeLine{1673   \textcolor{comment}{// method in the middle and mess up the state.}}
\DoxyCodeLine{1674   \textcolor{comment}{//}}
\DoxyCodeLine{1675   \textcolor{comment}{// However, performing the action has to be left out of the critical}}
\DoxyCodeLine{1676   \textcolor{comment}{// section.  The reason is that we have no control on what the}}
\DoxyCodeLine{1677   \textcolor{comment}{// action does (it can invoke an arbitrary user function or even a}}
\DoxyCodeLine{1678   \textcolor{comment}{// mock function) and excessive locking could cause a dead lock.}}
\DoxyCodeLine{1679   \textcolor{keyword}{virtual} \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1internal_1_1ExpectationBase}{ExpectationBase}}* UntypedFindMatchingExpectation(}
\DoxyCodeLine{1680       \textcolor{keyword}{const} \textcolor{keywordtype}{void}* untyped\_args,}
\DoxyCodeLine{1681       \textcolor{keyword}{const} \textcolor{keywordtype}{void}** untyped\_action, \textcolor{keywordtype}{bool}* is\_excessive,}
\DoxyCodeLine{1682       ::std::ostream* what, ::std::ostream* why)}
\DoxyCodeLine{1683           GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{1684     \textcolor{keyword}{const} ArgumentTuple\& args =}
\DoxyCodeLine{1685         *\textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }ArgumentTuple*\textcolor{keyword}{>}(untyped\_args);}
\DoxyCodeLine{1686     \mbox{\hyperlink{classtesting_1_1internal_1_1GTestMutexLock}{MutexLock}} l(\&g\_gmock\_mutex);}
\DoxyCodeLine{1687     \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation<F>}}* exp = this-\/>FindMatchingExpectationLocked(args);}
\DoxyCodeLine{1688     \textcolor{keywordflow}{if} (exp == NULL) \{  \textcolor{comment}{// A match wasn't found.}}
\DoxyCodeLine{1689       this-\/>FormatUnexpectedCallMessageLocked(args, what, why);}
\DoxyCodeLine{1690       \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{1691     \}}
\DoxyCodeLine{1692 }
\DoxyCodeLine{1693     \textcolor{comment}{// This line must be done before calling GetActionForArguments(),}}
\DoxyCodeLine{1694     \textcolor{comment}{// which will increment the call count for *exp and thus affect}}
\DoxyCodeLine{1695     \textcolor{comment}{// its saturation status.}}
\DoxyCodeLine{1696     *is\_excessive = exp-\/>IsSaturated();}
\DoxyCodeLine{1697     \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Action}{Action<F>}}* action = exp-\/>GetActionForArguments(\textcolor{keyword}{this}, args, what, why);}
\DoxyCodeLine{1698     \textcolor{keywordflow}{if} (action != NULL \&\& action-\/>IsDoDefault())}
\DoxyCodeLine{1699       action = NULL;  \textcolor{comment}{// Normalize "{}do default"{} to NULL.}}
\DoxyCodeLine{1700     *untyped\_action = action;}
\DoxyCodeLine{1701     \textcolor{keywordflow}{return} exp;}
\DoxyCodeLine{1702   \}}
\DoxyCodeLine{1703 }
\DoxyCodeLine{1704   \textcolor{comment}{// Prints the given function arguments to the ostream.}}
\DoxyCodeLine{1705   \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} UntypedPrintArgs(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* untyped\_args,}
\DoxyCodeLine{1706                                 ::std::ostream* os)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1707     \textcolor{keyword}{const} ArgumentTuple\& args =}
\DoxyCodeLine{1708         *\textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }ArgumentTuple*\textcolor{keyword}{>}(untyped\_args);}
\DoxyCodeLine{1709     UniversalPrint(args, os);}
\DoxyCodeLine{1710   \}}
\DoxyCodeLine{1711 }
\DoxyCodeLine{1712   \textcolor{comment}{// Returns the expectation that matches the arguments, or NULL if no}}
\DoxyCodeLine{1713   \textcolor{comment}{// expectation matches them.}}
\DoxyCodeLine{1714   \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation<F>}}* FindMatchingExpectationLocked(}
\DoxyCodeLine{1715       \textcolor{keyword}{const} ArgumentTuple\& args) \textcolor{keyword}{const}}
\DoxyCodeLine{1716           GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{1717     g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{1718     \textcolor{keywordflow}{for} (\textcolor{keyword}{typename} UntypedExpectations::const\_reverse\_iterator it =}
\DoxyCodeLine{1719              untyped\_expectations\_.rbegin();}
\DoxyCodeLine{1720          it != untyped\_expectations\_.rend(); ++it) \{}
\DoxyCodeLine{1721       \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation<F>}}* \textcolor{keyword}{const} exp =}
\DoxyCodeLine{1722           \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation<F>}}*\textcolor{keyword}{>}(it-\/>get());}
\DoxyCodeLine{1723       \textcolor{keywordflow}{if} (exp-\/>ShouldHandleArguments(args)) \{}
\DoxyCodeLine{1724         \textcolor{keywordflow}{return} exp;}
\DoxyCodeLine{1725       \}}
\DoxyCodeLine{1726     \}}
\DoxyCodeLine{1727     \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{1728   \}}
\DoxyCodeLine{1729 }
\DoxyCodeLine{1730   \textcolor{comment}{// Returns a message that the arguments don't match any expectation.}}
\DoxyCodeLine{1731   \textcolor{keywordtype}{void} FormatUnexpectedCallMessageLocked(}
\DoxyCodeLine{1732       \textcolor{keyword}{const} ArgumentTuple\& args,}
\DoxyCodeLine{1733       ::std::ostream* os,}
\DoxyCodeLine{1734       ::std::ostream* why) \textcolor{keyword}{const}}
\DoxyCodeLine{1735           GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{1736     g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{1737     *os << \textcolor{stringliteral}{"{}\(\backslash\)nUnexpected mock function call -\/ "{}};}
\DoxyCodeLine{1738     DescribeDefaultActionTo(args, os);}
\DoxyCodeLine{1739     PrintTriedExpectationsLocked(args, why);}
\DoxyCodeLine{1740   \}}
\DoxyCodeLine{1741 }
\DoxyCodeLine{1742   \textcolor{comment}{// Prints a list of expectations that have been tried against the}}
\DoxyCodeLine{1743   \textcolor{comment}{// current mock function call.}}
\DoxyCodeLine{1744   \textcolor{keywordtype}{void} PrintTriedExpectationsLocked(}
\DoxyCodeLine{1745       \textcolor{keyword}{const} ArgumentTuple\& args,}
\DoxyCodeLine{1746       ::std::ostream* why) \textcolor{keyword}{const}}
\DoxyCodeLine{1747           GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex) \{}
\DoxyCodeLine{1748     g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{1749     \textcolor{keyword}{const} \textcolor{keywordtype}{int} count = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(untyped\_expectations\_.size());}
\DoxyCodeLine{1750     *why << \textcolor{stringliteral}{"{}Google Mock tried the following "{}} << count << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{1751          << (count == 1 ? \textcolor{stringliteral}{"{}expectation, but it didn't match"{}} :}
\DoxyCodeLine{1752              \textcolor{stringliteral}{"{}expectations, but none matched"{}})}
\DoxyCodeLine{1753          << \textcolor{stringliteral}{"{}:\(\backslash\)n"{}};}
\DoxyCodeLine{1754     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < count; i++) \{}
\DoxyCodeLine{1755       \mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation<F>}}* \textcolor{keyword}{const} expectation =}
\DoxyCodeLine{1756           \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classtesting_1_1internal_1_1TypedExpectation}{TypedExpectation<F>}}*\textcolor{keyword}{>}(untyped\_expectations\_[i].get());}
\DoxyCodeLine{1757       *why << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{1758       expectation-\/>DescribeLocationTo(why);}
\DoxyCodeLine{1759       \textcolor{keywordflow}{if} (count > 1) \{}
\DoxyCodeLine{1760         *why << \textcolor{stringliteral}{"{}tried expectation \#"{}} << i << \textcolor{stringliteral}{"{}: "{}};}
\DoxyCodeLine{1761       \}}
\DoxyCodeLine{1762       *why << expectation-\/>source\_text() << \textcolor{stringliteral}{"{}...\(\backslash\)n"{}};}
\DoxyCodeLine{1763       expectation-\/>ExplainMatchResultTo(args, why);}
\DoxyCodeLine{1764       expectation-\/>DescribeCallCountTo(why);}
\DoxyCodeLine{1765     \}}
\DoxyCodeLine{1766   \}}
\DoxyCodeLine{1767 }
\DoxyCodeLine{1768   \textcolor{comment}{// The current spec (either default action spec or expectation spec)}}
\DoxyCodeLine{1769   \textcolor{comment}{// being described on this function mocker.}}
\DoxyCodeLine{1770   \mbox{\hyperlink{classtesting_1_1internal_1_1MockSpec}{MockSpec<F>}} current\_spec\_;}
\DoxyCodeLine{1771 }
\DoxyCodeLine{1772   \textcolor{comment}{// There is no generally useful and implementable semantics of}}
\DoxyCodeLine{1773   \textcolor{comment}{// copying a mock object, so copying a mock is usually a user error.}}
\DoxyCodeLine{1774   \textcolor{comment}{// Thus we disallow copying function mockers.  If the user really}}
\DoxyCodeLine{1775   \textcolor{comment}{// wants to copy a mock object, he should implement his own copy}}
\DoxyCodeLine{1776   \textcolor{comment}{// operation, for example:}}
\DoxyCodeLine{1777   \textcolor{comment}{//}}
\DoxyCodeLine{1778   \textcolor{comment}{//   class MockFoo : public Foo \{}}
\DoxyCodeLine{1779   \textcolor{comment}{//    public:}}
\DoxyCodeLine{1780   \textcolor{comment}{//     // Defines a copy constructor explicitly.}}
\DoxyCodeLine{1781   \textcolor{comment}{//     MockFoo(const MockFoo\& src) \{\}}}
\DoxyCodeLine{1782   \textcolor{comment}{//     ...}}
\DoxyCodeLine{1783   \textcolor{comment}{//   \};}}
\DoxyCodeLine{1784   GTEST\_DISALLOW\_COPY\_AND\_ASSIGN\_(\mbox{\hyperlink{classtesting_1_1internal_1_1FunctionMockerBase}{FunctionMockerBase}});}
\DoxyCodeLine{1785 \};  \textcolor{comment}{// class FunctionMockerBase}}
\DoxyCodeLine{1786 }
\DoxyCodeLine{1787 \textcolor{preprocessor}{\#ifdef \_MSC\_VER}}
\DoxyCodeLine{1788 \textcolor{preprocessor}{\# pragma warning(pop)  }\textcolor{comment}{// Restores the warning state.}}
\DoxyCodeLine{1789 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// \_MSV\_VER}}
\DoxyCodeLine{1790 }
\DoxyCodeLine{1791 \textcolor{comment}{// Implements methods of FunctionMockerBase.}}
\DoxyCodeLine{1792 }
\DoxyCodeLine{1793 \textcolor{comment}{// Verifies that all expectations on this mock function have been}}
\DoxyCodeLine{1794 \textcolor{comment}{// satisfied.  Reports one or more Google Test non-\/fatal failures and}}
\DoxyCodeLine{1795 \textcolor{comment}{// returns false if not.}}
\DoxyCodeLine{1796 }
\DoxyCodeLine{1797 \textcolor{comment}{// Reports an uninteresting call (whose description is in msg) in the}}
\DoxyCodeLine{1798 \textcolor{comment}{// manner specified by 'reaction'.}}
\DoxyCodeLine{1799 \textcolor{keywordtype}{void} ReportUninterestingCall(CallReaction reaction, \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& msg);}
\DoxyCodeLine{1800 }
\DoxyCodeLine{1801 \}  \textcolor{comment}{// namespace internal}}
\DoxyCodeLine{1802 }
\DoxyCodeLine{1803 \textcolor{comment}{// The style guide prohibits "{}using"{} statements in a namespace scope}}
\DoxyCodeLine{1804 \textcolor{comment}{// inside a header file.  However, the MockSpec class template is}}
\DoxyCodeLine{1805 \textcolor{comment}{// meant to be defined in the ::testing namespace.  The following line}}
\DoxyCodeLine{1806 \textcolor{comment}{// is just a trick for working around a bug in MSVC 8.0, which cannot}}
\DoxyCodeLine{1807 \textcolor{comment}{// handle it if we define MockSpec in ::testing.}}
\DoxyCodeLine{1808 \textcolor{keyword}{using} \mbox{\hyperlink{classtesting_1_1internal_1_1MockSpec}{internal::MockSpec}};}
\DoxyCodeLine{1809 }
\DoxyCodeLine{1810 \textcolor{comment}{// Const(x) is a convenient function for obtaining a const reference}}
\DoxyCodeLine{1811 \textcolor{comment}{// to x.  This is useful for setting expectations on an overloaded}}
\DoxyCodeLine{1812 \textcolor{comment}{// const mock method, e.g.}}
\DoxyCodeLine{1813 \textcolor{comment}{//}}
\DoxyCodeLine{1814 \textcolor{comment}{//   class MockFoo : public FooInterface \{}}
\DoxyCodeLine{1815 \textcolor{comment}{//    public:}}
\DoxyCodeLine{1816 \textcolor{comment}{//     MOCK\_METHOD0(Bar, int());}}
\DoxyCodeLine{1817 \textcolor{comment}{//     MOCK\_CONST\_METHOD0(Bar, int\&());}}
\DoxyCodeLine{1818 \textcolor{comment}{//   \};}}
\DoxyCodeLine{1819 \textcolor{comment}{//}}
\DoxyCodeLine{1820 \textcolor{comment}{//   MockFoo foo;}}
\DoxyCodeLine{1821 \textcolor{comment}{//   // Expects a call to non-\/const MockFoo::Bar().}}
\DoxyCodeLine{1822 \textcolor{comment}{//   EXPECT\_CALL(foo, Bar());}}
\DoxyCodeLine{1823 \textcolor{comment}{//   // Expects a call to const MockFoo::Bar().}}
\DoxyCodeLine{1824 \textcolor{comment}{//   EXPECT\_CALL(Const(foo), Bar());}}
\DoxyCodeLine{1825 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{1826 \textcolor{keyword}{inline} \textcolor{keyword}{const} T\& Const(\textcolor{keyword}{const} T\& x) \{ \textcolor{keywordflow}{return} x; \}}
\DoxyCodeLine{1827 }
\DoxyCodeLine{1828 \textcolor{comment}{// Constructs an Expectation object that references and co-\/owns exp.}}
\DoxyCodeLine{1829 \textcolor{keyword}{inline} Expectation::Expectation(internal::ExpectationBase\& exp)  \textcolor{comment}{// NOLINT}}
\DoxyCodeLine{1830     : expectation\_base\_(exp.GetHandle().expectation\_base()) \{\}}
\DoxyCodeLine{1831 }
\DoxyCodeLine{1832 \}  \textcolor{comment}{// namespace testing}}
\DoxyCodeLine{1833 }
\DoxyCodeLine{1834 \textcolor{comment}{// A separate macro is required to avoid compile errors when the name}}
\DoxyCodeLine{1835 \textcolor{comment}{// of the method used in call is a result of macro expansion.}}
\DoxyCodeLine{1836 \textcolor{comment}{// See CompilesWithMethodNameExpandedFromMacro tests in}}
\DoxyCodeLine{1837 \textcolor{comment}{// internal/gmock-\/spec-\/builders\_test.cc for more details.}}
\DoxyCodeLine{1838 \textcolor{preprocessor}{\#define GMOCK\_ON\_CALL\_IMPL\_(obj, call) \(\backslash\)}}
\DoxyCodeLine{1839 \textcolor{preprocessor}{    ((obj).gmock\_\#\#call).InternalDefaultActionSetAt(\_\_FILE\_\_, \_\_LINE\_\_, \(\backslash\)}}
\DoxyCodeLine{1840 \textcolor{preprocessor}{                                                    \#obj, \#call)}}
\DoxyCodeLine{1841 \textcolor{preprocessor}{\#define ON\_CALL(obj, call) GMOCK\_ON\_CALL\_IMPL\_(obj, call)}}
\DoxyCodeLine{1842 }
\DoxyCodeLine{1843 \textcolor{preprocessor}{\#define GMOCK\_EXPECT\_CALL\_IMPL\_(obj, call) \(\backslash\)}}
\DoxyCodeLine{1844 \textcolor{preprocessor}{    ((obj).gmock\_\#\#call).InternalExpectedAt(\_\_FILE\_\_, \_\_LINE\_\_, \#obj, \#call)}}
\DoxyCodeLine{1845 \textcolor{preprocessor}{\#define EXPECT\_CALL(obj, call) GMOCK\_EXPECT\_CALL\_IMPL\_(obj, call)}}
\DoxyCodeLine{1846 }
\DoxyCodeLine{1847 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// GMOCK\_INCLUDE\_GMOCK\_GMOCK\_SPEC\_BUILDERS\_H\_}}

\end{DoxyCode}
