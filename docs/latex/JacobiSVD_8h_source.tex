\hypertarget{JacobiSVD_8h_source}{}\doxysection{Jacobi\+SVD.\+h}
\label{JacobiSVD_8h_source}\index{include/Eigen/src/SVD/JacobiSVD.h@{include/Eigen/src/SVD/JacobiSVD.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}}
\DoxyCodeLine{2 \textcolor{comment}{// for linear algebra.}}
\DoxyCodeLine{3 \textcolor{comment}{//}}
\DoxyCodeLine{4 \textcolor{comment}{// Copyright (C) 2009-\/2010 Benoit Jacob <jacob.benoit.1@gmail.com>}}
\DoxyCodeLine{5 \textcolor{comment}{// Copyright (C) 2013-\/2014 Gael Guennebaud <gael.guennebaud@inria.fr>}}
\DoxyCodeLine{6 \textcolor{comment}{//}}
\DoxyCodeLine{7 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}}
\DoxyCodeLine{8 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}}
\DoxyCodeLine{9 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{preprocessor}{\#ifndef EIGEN\_JACOBISVD\_H}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#define EIGEN\_JACOBISVD\_H}}
\DoxyCodeLine{13 }
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include "{}./InternalHeaderCheck.h"{}}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceEigen}{Eigen}} \{ }
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{keyword}{namespace }internal \{}
\DoxyCodeLine{19 \textcolor{comment}{// forward declaration (needed by ICC)}}
\DoxyCodeLine{20 \textcolor{comment}{// the empty body is required by MSVC}}
\DoxyCodeLine{21 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keywordtype}{int} QRPreconditioner,}
\DoxyCodeLine{22          \textcolor{keywordtype}{bool} IsComplex = NumTraits<typename MatrixType::Scalar>::IsComplex>}
\DoxyCodeLine{23 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real}{svd\_precondition\_2x2\_block\_to\_be\_real}} \{\};}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{comment}{/*** QR preconditioners (R-\/SVD)}}
\DoxyCodeLine{26 \textcolor{comment}{ ***}}
\DoxyCodeLine{27 \textcolor{comment}{ *** Their role is to reduce the problem of computing the SVD to the case of a square matrix.}}
\DoxyCodeLine{28 \textcolor{comment}{ *** This approach, known as R-\/SVD, is an optimization for rectangular-\/enough matrices, and is a requirement for}}
\DoxyCodeLine{29 \textcolor{comment}{ *** JacobiSVD which by itself is only able to work on square matrices.}}
\DoxyCodeLine{30 \textcolor{comment}{ ***/}}
\DoxyCodeLine{31 }
\DoxyCodeLine{32 \textcolor{keyword}{enum} \{ PreconditionIfMoreColsThanRows, PreconditionIfMoreRowsThanCols \};}
\DoxyCodeLine{33 }
\DoxyCodeLine{34 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keywordtype}{int} QRPreconditioner, \textcolor{keywordtype}{int} Case>}
\DoxyCodeLine{35 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1qr__preconditioner__should__do__anything}{qr\_preconditioner\_should\_do\_anything}}}
\DoxyCodeLine{36 \{}
\DoxyCodeLine{37   \textcolor{keyword}{enum} \{ a = MatrixType::RowsAtCompileTime != \mbox{\hyperlink{namespaceEigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}} \&\&}
\DoxyCodeLine{38              MatrixType::ColsAtCompileTime != \mbox{\hyperlink{namespaceEigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}} \&\&}
\DoxyCodeLine{39              MatrixType::ColsAtCompileTime <= MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{40          b = MatrixType::RowsAtCompileTime != \mbox{\hyperlink{namespaceEigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}} \&\&}
\DoxyCodeLine{41              MatrixType::ColsAtCompileTime != \mbox{\hyperlink{namespaceEigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}} \&\&}
\DoxyCodeLine{42              MatrixType::RowsAtCompileTime <= MatrixType::ColsAtCompileTime,}
\DoxyCodeLine{43          ret = !( (QRPreconditioner == \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56ea2e95bc818f975b19def01e93d240dece}{NoQRPreconditioner}}) ||}
\DoxyCodeLine{44                   (Case == PreconditionIfMoreColsThanRows \&\& \textcolor{keywordtype}{bool}(a)) ||}
\DoxyCodeLine{45                   (Case == PreconditionIfMoreRowsThanCols \&\& \textcolor{keywordtype}{bool}(b)) )}
\DoxyCodeLine{46   \};}
\DoxyCodeLine{47 \};}
\DoxyCodeLine{48 }
\DoxyCodeLine{49 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keywordtype}{int} QRPreconditioner, \textcolor{keywordtype}{int} Case,}
\DoxyCodeLine{50          \textcolor{keywordtype}{bool} DoAnything = \mbox{\hyperlink{structEigen_1_1internal_1_1qr__preconditioner__should__do__anything}{qr\_preconditioner\_should\_do\_anything<MatrixType, QRPreconditioner, Case>::ret}}}
\DoxyCodeLine{51 > \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}} \{\};}
\DoxyCodeLine{52 }
\DoxyCodeLine{53 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keywordtype}{int} QRPreconditioner, \textcolor{keywordtype}{int} Case>}
\DoxyCodeLine{54 \textcolor{keyword}{class }\mbox{\hyperlink{structEigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}<MatrixType, QRPreconditioner, Case, false>}
\DoxyCodeLine{55 \{}
\DoxyCodeLine{56 \textcolor{keyword}{public}:}
\DoxyCodeLine{57   \textcolor{keywordtype}{void} allocate(\textcolor{keyword}{const} \mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD<MatrixType, QRPreconditioner>}}\&) \{\}}
\DoxyCodeLine{58   \textcolor{keywordtype}{bool} run(\mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD<MatrixType, QRPreconditioner>}}\&, \textcolor{keyword}{const} MatrixType\&)}
\DoxyCodeLine{59   \{}
\DoxyCodeLine{60     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{61   \}}
\DoxyCodeLine{62 \};}
\DoxyCodeLine{63 }
\DoxyCodeLine{64 \textcolor{comment}{/*** preconditioner using FullPivHouseholderQR ***/}}
\DoxyCodeLine{65 }
\DoxyCodeLine{66 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>}
\DoxyCodeLine{67 \textcolor{keyword}{class }\mbox{\hyperlink{structEigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}<MatrixType, \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56eabd745dcaff7019c5f918c68809e5ea50}{FullPivHouseholderQRPreconditioner}}, PreconditionIfMoreRowsThanCols, true>}
\DoxyCodeLine{68 \{}
\DoxyCodeLine{69 \textcolor{keyword}{public}:}
\DoxyCodeLine{70   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Scalar Scalar;}
\DoxyCodeLine{71   \textcolor{keyword}{enum}}
\DoxyCodeLine{72   \{}
\DoxyCodeLine{73     RowsAtCompileTime = MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{74     MaxRowsAtCompileTime = MatrixType::MaxRowsAtCompileTime}
\DoxyCodeLine{75   \};}
\DoxyCodeLine{76   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix<Scalar, 1, RowsAtCompileTime, RowMajor, 1, MaxRowsAtCompileTime>}} \mbox{\hyperlink{classEigen_1_1Matrix}{WorkspaceType}};}
\DoxyCodeLine{77 }
\DoxyCodeLine{78   \textcolor{keywordtype}{void} allocate(\textcolor{keyword}{const} \mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD<MatrixType, FullPivHouseholderQRPreconditioner>}}\& svd)}
\DoxyCodeLine{79   \{}
\DoxyCodeLine{80     \textcolor{keywordflow}{if} (svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}() != m\_qr.rows() || svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}() != m\_qr.cols())}
\DoxyCodeLine{81     \{}
\DoxyCodeLine{82       m\_qr.\string~QRType();}
\DoxyCodeLine{83       ::new (\&m\_qr) \mbox{\hyperlink{classEigen_1_1FullPivHouseholderQR}{QRType}}(svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}(), svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}());}
\DoxyCodeLine{84     \}}
\DoxyCodeLine{85     \textcolor{keywordflow}{if} (svd.m\_computeFullU) m\_workspace.resize(svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}());}
\DoxyCodeLine{86   \}}
\DoxyCodeLine{87 }
\DoxyCodeLine{88   \textcolor{keywordtype}{bool} run(\mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD<MatrixType, FullPivHouseholderQRPreconditioner>}}\& svd, \textcolor{keyword}{const} MatrixType\& matrix)}
\DoxyCodeLine{89   \{}
\DoxyCodeLine{90     \textcolor{keywordflow}{if}(matrix.rows() > matrix.cols())}
\DoxyCodeLine{91     \{}
\DoxyCodeLine{92       m\_qr.compute(matrix);}
\DoxyCodeLine{93       svd.m\_workMatrix = m\_qr.matrixQR().block(0,0,matrix.cols(),matrix.cols()).template triangularView<Upper>();}
\DoxyCodeLine{94       \textcolor{keywordflow}{if}(svd.m\_computeFullU) m\_qr.matrixQ().evalTo(svd.m\_matrixU, m\_workspace);}
\DoxyCodeLine{95       \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{classEigen_1_1SVDBase_a5f12efcb791eb007d4a4890ac5255ac4}{computeV}}()) svd.m\_matrixV = m\_qr.colsPermutation();}
\DoxyCodeLine{96       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{97     \}}
\DoxyCodeLine{98     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{99   \}}
\DoxyCodeLine{100 \textcolor{keyword}{private}:}
\DoxyCodeLine{101   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1FullPivHouseholderQR}{FullPivHouseholderQR<MatrixType>}} \mbox{\hyperlink{classEigen_1_1FullPivHouseholderQR}{QRType}};}
\DoxyCodeLine{102   \mbox{\hyperlink{classEigen_1_1FullPivHouseholderQR}{QRType}} m\_qr;}
\DoxyCodeLine{103   \mbox{\hyperlink{classEigen_1_1Matrix}{WorkspaceType}} m\_workspace;}
\DoxyCodeLine{104 \};}
\DoxyCodeLine{105 }
\DoxyCodeLine{106 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>}
\DoxyCodeLine{107 \textcolor{keyword}{class }\mbox{\hyperlink{structEigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}<MatrixType, \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56eabd745dcaff7019c5f918c68809e5ea50}{FullPivHouseholderQRPreconditioner}}, PreconditionIfMoreColsThanRows, true>}
\DoxyCodeLine{108 \{}
\DoxyCodeLine{109 \textcolor{keyword}{public}:}
\DoxyCodeLine{110   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Scalar Scalar;}
\DoxyCodeLine{111   \textcolor{keyword}{enum}}
\DoxyCodeLine{112   \{}
\DoxyCodeLine{113     RowsAtCompileTime = MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{114     ColsAtCompileTime = MatrixType::ColsAtCompileTime,}
\DoxyCodeLine{115     MaxRowsAtCompileTime = MatrixType::MaxRowsAtCompileTime,}
\DoxyCodeLine{116     MaxColsAtCompileTime = MatrixType::MaxColsAtCompileTime,}
\DoxyCodeLine{117     Options = MatrixType::Options}
\DoxyCodeLine{118   \};}
\DoxyCodeLine{119 }
\DoxyCodeLine{120   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{classEigen_1_1internal_1_1make__proper__matrix__type}{internal::make\_proper\_matrix\_type}}<}
\DoxyCodeLine{121     Scalar, ColsAtCompileTime, RowsAtCompileTime, Options, MaxColsAtCompileTime, MaxRowsAtCompileTime}
\DoxyCodeLine{122   >::type \mbox{\hyperlink{classEigen_1_1Matrix}{TransposeTypeWithSameStorageOrder}};}
\DoxyCodeLine{123 }
\DoxyCodeLine{124   \textcolor{keywordtype}{void} allocate(\textcolor{keyword}{const} \mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD<MatrixType, FullPivHouseholderQRPreconditioner>}}\& svd)}
\DoxyCodeLine{125   \{}
\DoxyCodeLine{126     \textcolor{keywordflow}{if} (svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}() != m\_qr.rows() || svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}() != m\_qr.cols())}
\DoxyCodeLine{127     \{}
\DoxyCodeLine{128       m\_qr.\string~QRType();}
\DoxyCodeLine{129       ::new (\&m\_qr) \mbox{\hyperlink{classEigen_1_1FullPivHouseholderQR}{QRType}}(svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}(), svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}());}
\DoxyCodeLine{130     \}}
\DoxyCodeLine{131     m\_adjoint.resize(svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}(), svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}());}
\DoxyCodeLine{132     \textcolor{keywordflow}{if} (svd.m\_computeFullV) m\_workspace.resize(svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}());}
\DoxyCodeLine{133   \}}
\DoxyCodeLine{134 }
\DoxyCodeLine{135   \textcolor{keywordtype}{bool} run(\mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD<MatrixType, FullPivHouseholderQRPreconditioner>}}\& svd, \textcolor{keyword}{const} MatrixType\& matrix)}
\DoxyCodeLine{136   \{}
\DoxyCodeLine{137     \textcolor{keywordflow}{if}(matrix.cols() > matrix.rows())}
\DoxyCodeLine{138     \{}
\DoxyCodeLine{139       m\_adjoint = matrix.adjoint();}
\DoxyCodeLine{140       m\_qr.compute(m\_adjoint);}
\DoxyCodeLine{141       svd.m\_workMatrix = m\_qr.matrixQR().block(0,0,matrix.rows(),matrix.rows()).template triangularView<Upper>().adjoint();}
\DoxyCodeLine{142       \textcolor{keywordflow}{if}(svd.m\_computeFullV) m\_qr.matrixQ().evalTo(svd.m\_matrixV, m\_workspace);}
\DoxyCodeLine{143       \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{classEigen_1_1SVDBase_a705a7c2709e1624ccc19aa748a78d473}{computeU}}()) svd.m\_matrixU = m\_qr.colsPermutation();}
\DoxyCodeLine{144       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{145     \}}
\DoxyCodeLine{146     \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{147   \}}
\DoxyCodeLine{148 \textcolor{keyword}{private}:}
\DoxyCodeLine{149   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1FullPivHouseholderQR}{FullPivHouseholderQR<TransposeTypeWithSameStorageOrder>}} \mbox{\hyperlink{classEigen_1_1FullPivHouseholderQR}{QRType}};}
\DoxyCodeLine{150   \mbox{\hyperlink{classEigen_1_1FullPivHouseholderQR}{QRType}} m\_qr;}
\DoxyCodeLine{151   \mbox{\hyperlink{classEigen_1_1Matrix}{TransposeTypeWithSameStorageOrder}} m\_adjoint;}
\DoxyCodeLine{152   \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{internal::plain\_row\_type<MatrixType>::type}} m\_workspace;}
\DoxyCodeLine{153 \};}
\DoxyCodeLine{154 }
\DoxyCodeLine{155 \textcolor{comment}{/*** preconditioner using ColPivHouseholderQR ***/}}
\DoxyCodeLine{156 }
\DoxyCodeLine{157 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>}
\DoxyCodeLine{158 \textcolor{keyword}{class }\mbox{\hyperlink{structEigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}<MatrixType, \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56eabd2e2f4875c5b4b6e602a433d90c4e5e}{ColPivHouseholderQRPreconditioner}}, PreconditionIfMoreRowsThanCols, true>}
\DoxyCodeLine{159 \{}
\DoxyCodeLine{160 \textcolor{keyword}{public}:}
\DoxyCodeLine{161   \textcolor{keywordtype}{void} allocate(\textcolor{keyword}{const} \mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD<MatrixType, ColPivHouseholderQRPreconditioner>}}\& svd)}
\DoxyCodeLine{162   \{}
\DoxyCodeLine{163     \textcolor{keywordflow}{if} (svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}() != m\_qr.rows() || svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}() != m\_qr.cols())}
\DoxyCodeLine{164     \{}
\DoxyCodeLine{165       m\_qr.\string~QRType();}
\DoxyCodeLine{166       ::new (\&m\_qr) \mbox{\hyperlink{classEigen_1_1ColPivHouseholderQR}{QRType}}(svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}(), svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}());}
\DoxyCodeLine{167     \}}
\DoxyCodeLine{168     \textcolor{keywordflow}{if} (svd.m\_computeFullU) m\_workspace.resize(svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}());}
\DoxyCodeLine{169     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (svd.m\_computeThinU) m\_workspace.resize(svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}());}
\DoxyCodeLine{170   \}}
\DoxyCodeLine{171 }
\DoxyCodeLine{172   \textcolor{keywordtype}{bool} run(\mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD<MatrixType, ColPivHouseholderQRPreconditioner>}}\& svd, \textcolor{keyword}{const} MatrixType\& matrix)}
\DoxyCodeLine{173   \{}
\DoxyCodeLine{174     \textcolor{keywordflow}{if}(matrix.rows() > matrix.cols())}
\DoxyCodeLine{175     \{}
\DoxyCodeLine{176       m\_qr.compute(matrix);}
\DoxyCodeLine{177       svd.m\_workMatrix = m\_qr.matrixQR().block(0,0,matrix.cols(),matrix.cols()).template triangularView<Upper>();}
\DoxyCodeLine{178       \textcolor{keywordflow}{if}(svd.m\_computeFullU) m\_qr.householderQ().evalTo(svd.m\_matrixU, m\_workspace);}
\DoxyCodeLine{179       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(svd.m\_computeThinU)}
\DoxyCodeLine{180       \{}
\DoxyCodeLine{181         svd.m\_matrixU.setIdentity(matrix.rows(), matrix.cols());}
\DoxyCodeLine{182         m\_qr.householderQ().applyThisOnTheLeft(svd.m\_matrixU, m\_workspace);}
\DoxyCodeLine{183       \}}
\DoxyCodeLine{184       \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{classEigen_1_1SVDBase_a5f12efcb791eb007d4a4890ac5255ac4}{computeV}}()) svd.m\_matrixV = m\_qr.colsPermutation();}
\DoxyCodeLine{185       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{186     \}}
\DoxyCodeLine{187     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{188   \}}
\DoxyCodeLine{189 }
\DoxyCodeLine{190 \textcolor{keyword}{private}:}
\DoxyCodeLine{191   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1ColPivHouseholderQR}{ColPivHouseholderQR<MatrixType>}} \mbox{\hyperlink{classEigen_1_1ColPivHouseholderQR}{QRType}};}
\DoxyCodeLine{192   \mbox{\hyperlink{classEigen_1_1ColPivHouseholderQR}{QRType}} m\_qr;}
\DoxyCodeLine{193   \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{internal::plain\_col\_type<MatrixType>::type}} m\_workspace;}
\DoxyCodeLine{194 \};}
\DoxyCodeLine{195 }
\DoxyCodeLine{196 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>}
\DoxyCodeLine{197 \textcolor{keyword}{class }\mbox{\hyperlink{structEigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}<MatrixType, \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56eabd2e2f4875c5b4b6e602a433d90c4e5e}{ColPivHouseholderQRPreconditioner}}, PreconditionIfMoreColsThanRows, true>}
\DoxyCodeLine{198 \{}
\DoxyCodeLine{199 \textcolor{keyword}{public}:}
\DoxyCodeLine{200   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Scalar Scalar;}
\DoxyCodeLine{201   \textcolor{keyword}{enum}}
\DoxyCodeLine{202   \{}
\DoxyCodeLine{203     RowsAtCompileTime = MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{204     ColsAtCompileTime = MatrixType::ColsAtCompileTime,}
\DoxyCodeLine{205     MaxRowsAtCompileTime = MatrixType::MaxRowsAtCompileTime,}
\DoxyCodeLine{206     MaxColsAtCompileTime = MatrixType::MaxColsAtCompileTime,}
\DoxyCodeLine{207     Options = MatrixType::Options}
\DoxyCodeLine{208   \};}
\DoxyCodeLine{209 }
\DoxyCodeLine{210   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{classEigen_1_1internal_1_1make__proper__matrix__type}{internal::make\_proper\_matrix\_type}}<}
\DoxyCodeLine{211     Scalar, ColsAtCompileTime, RowsAtCompileTime, Options, MaxColsAtCompileTime, MaxRowsAtCompileTime}
\DoxyCodeLine{212   >::type \mbox{\hyperlink{classEigen_1_1Matrix}{TransposeTypeWithSameStorageOrder}};}
\DoxyCodeLine{213 }
\DoxyCodeLine{214   \textcolor{keywordtype}{void} allocate(\textcolor{keyword}{const} \mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD<MatrixType, ColPivHouseholderQRPreconditioner>}}\& svd)}
\DoxyCodeLine{215   \{}
\DoxyCodeLine{216     \textcolor{keywordflow}{if} (svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}() != m\_qr.rows() || svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}() != m\_qr.cols())}
\DoxyCodeLine{217     \{}
\DoxyCodeLine{218       m\_qr.\string~QRType();}
\DoxyCodeLine{219       ::new (\&m\_qr) \mbox{\hyperlink{classEigen_1_1ColPivHouseholderQR}{QRType}}(svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}(), svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}());}
\DoxyCodeLine{220     \}}
\DoxyCodeLine{221     \textcolor{keywordflow}{if} (svd.m\_computeFullV) m\_workspace.resize(svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}());}
\DoxyCodeLine{222     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (svd.m\_computeThinV) m\_workspace.resize(svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}());}
\DoxyCodeLine{223     m\_adjoint.resize(svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}(), svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}());}
\DoxyCodeLine{224   \}}
\DoxyCodeLine{225 }
\DoxyCodeLine{226   \textcolor{keywordtype}{bool} run(\mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD<MatrixType, ColPivHouseholderQRPreconditioner>}}\& svd, \textcolor{keyword}{const} MatrixType\& matrix)}
\DoxyCodeLine{227   \{}
\DoxyCodeLine{228     \textcolor{keywordflow}{if}(matrix.cols() > matrix.rows())}
\DoxyCodeLine{229     \{}
\DoxyCodeLine{230       m\_adjoint = matrix.adjoint();}
\DoxyCodeLine{231       m\_qr.compute(m\_adjoint);}
\DoxyCodeLine{232 }
\DoxyCodeLine{233       svd.m\_workMatrix = m\_qr.matrixQR().block(0,0,matrix.rows(),matrix.rows()).template triangularView<Upper>().adjoint();}
\DoxyCodeLine{234       \textcolor{keywordflow}{if}(svd.m\_computeFullV) m\_qr.householderQ().evalTo(svd.m\_matrixV, m\_workspace);}
\DoxyCodeLine{235       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(svd.m\_computeThinV)}
\DoxyCodeLine{236       \{}
\DoxyCodeLine{237         svd.m\_matrixV.setIdentity(matrix.cols(), matrix.rows());}
\DoxyCodeLine{238         m\_qr.householderQ().applyThisOnTheLeft(svd.m\_matrixV, m\_workspace);}
\DoxyCodeLine{239       \}}
\DoxyCodeLine{240       \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{classEigen_1_1SVDBase_a705a7c2709e1624ccc19aa748a78d473}{computeU}}()) svd.m\_matrixU = m\_qr.colsPermutation();}
\DoxyCodeLine{241       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{242     \}}
\DoxyCodeLine{243     \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{244   \}}
\DoxyCodeLine{245 }
\DoxyCodeLine{246 \textcolor{keyword}{private}:}
\DoxyCodeLine{247   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1ColPivHouseholderQR}{ColPivHouseholderQR<TransposeTypeWithSameStorageOrder>}} \mbox{\hyperlink{classEigen_1_1ColPivHouseholderQR}{QRType}};}
\DoxyCodeLine{248   \mbox{\hyperlink{classEigen_1_1ColPivHouseholderQR}{QRType}} m\_qr;}
\DoxyCodeLine{249   \mbox{\hyperlink{classEigen_1_1Matrix}{TransposeTypeWithSameStorageOrder}} m\_adjoint;}
\DoxyCodeLine{250   \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{internal::plain\_row\_type<MatrixType>::type}} m\_workspace;}
\DoxyCodeLine{251 \};}
\DoxyCodeLine{252 }
\DoxyCodeLine{253 \textcolor{comment}{/*** preconditioner using HouseholderQR ***/}}
\DoxyCodeLine{254 }
\DoxyCodeLine{255 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>}
\DoxyCodeLine{256 \textcolor{keyword}{class }\mbox{\hyperlink{structEigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}<MatrixType, \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56ea9c660eb3336bf8c77ce9d081ca07cbdd}{HouseholderQRPreconditioner}}, PreconditionIfMoreRowsThanCols, true>}
\DoxyCodeLine{257 \{}
\DoxyCodeLine{258 \textcolor{keyword}{public}:}
\DoxyCodeLine{259   \textcolor{keywordtype}{void} allocate(\textcolor{keyword}{const} \mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD<MatrixType, HouseholderQRPreconditioner>}}\& svd)}
\DoxyCodeLine{260   \{}
\DoxyCodeLine{261     \textcolor{keywordflow}{if} (svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}() != m\_qr.rows() || svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}() != m\_qr.cols())}
\DoxyCodeLine{262     \{}
\DoxyCodeLine{263       m\_qr.\string~QRType();}
\DoxyCodeLine{264       ::new (\&m\_qr) \mbox{\hyperlink{classEigen_1_1HouseholderQR}{QRType}}(svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}(), svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}());}
\DoxyCodeLine{265     \}}
\DoxyCodeLine{266     \textcolor{keywordflow}{if} (svd.m\_computeFullU) m\_workspace.resize(svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}());}
\DoxyCodeLine{267     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (svd.m\_computeThinU) m\_workspace.resize(svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}());}
\DoxyCodeLine{268   \}}
\DoxyCodeLine{269 }
\DoxyCodeLine{270   \textcolor{keywordtype}{bool} run(\mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD<MatrixType, HouseholderQRPreconditioner>}}\& svd, \textcolor{keyword}{const} MatrixType\& matrix)}
\DoxyCodeLine{271   \{}
\DoxyCodeLine{272     \textcolor{keywordflow}{if}(matrix.rows() > matrix.cols())}
\DoxyCodeLine{273     \{}
\DoxyCodeLine{274       m\_qr.compute(matrix);}
\DoxyCodeLine{275       svd.m\_workMatrix = m\_qr.matrixQR().block(0,0,matrix.cols(),matrix.cols()).template triangularView<Upper>();}
\DoxyCodeLine{276       \textcolor{keywordflow}{if}(svd.m\_computeFullU) m\_qr.householderQ().evalTo(svd.m\_matrixU, m\_workspace);}
\DoxyCodeLine{277       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(svd.m\_computeThinU)}
\DoxyCodeLine{278       \{}
\DoxyCodeLine{279         svd.m\_matrixU.setIdentity(matrix.rows(), matrix.cols());}
\DoxyCodeLine{280         m\_qr.householderQ().applyThisOnTheLeft(svd.m\_matrixU, m\_workspace);}
\DoxyCodeLine{281       \}}
\DoxyCodeLine{282       \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{classEigen_1_1SVDBase_a5f12efcb791eb007d4a4890ac5255ac4}{computeV}}()) svd.m\_matrixV.setIdentity(matrix.cols(), matrix.cols());}
\DoxyCodeLine{283       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{284     \}}
\DoxyCodeLine{285     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{286   \}}
\DoxyCodeLine{287 \textcolor{keyword}{private}:}
\DoxyCodeLine{288   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1HouseholderQR}{HouseholderQR<MatrixType>}} \mbox{\hyperlink{classEigen_1_1HouseholderQR}{QRType}};}
\DoxyCodeLine{289   \mbox{\hyperlink{classEigen_1_1HouseholderQR}{QRType}} m\_qr;}
\DoxyCodeLine{290   \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{internal::plain\_col\_type<MatrixType>::type}} m\_workspace;}
\DoxyCodeLine{291 \};}
\DoxyCodeLine{292 }
\DoxyCodeLine{293 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>}
\DoxyCodeLine{294 \textcolor{keyword}{class }\mbox{\hyperlink{structEigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}<MatrixType, \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56ea9c660eb3336bf8c77ce9d081ca07cbdd}{HouseholderQRPreconditioner}}, PreconditionIfMoreColsThanRows, true>}
\DoxyCodeLine{295 \{}
\DoxyCodeLine{296 \textcolor{keyword}{public}:}
\DoxyCodeLine{297   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Scalar Scalar;}
\DoxyCodeLine{298   \textcolor{keyword}{enum}}
\DoxyCodeLine{299   \{}
\DoxyCodeLine{300     RowsAtCompileTime = MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{301     ColsAtCompileTime = MatrixType::ColsAtCompileTime,}
\DoxyCodeLine{302     MaxRowsAtCompileTime = MatrixType::MaxRowsAtCompileTime,}
\DoxyCodeLine{303     MaxColsAtCompileTime = MatrixType::MaxColsAtCompileTime,}
\DoxyCodeLine{304     Options = MatrixType::Options}
\DoxyCodeLine{305   \};}
\DoxyCodeLine{306 }
\DoxyCodeLine{307   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{classEigen_1_1internal_1_1make__proper__matrix__type}{internal::make\_proper\_matrix\_type}}<}
\DoxyCodeLine{308     Scalar, ColsAtCompileTime, RowsAtCompileTime, Options, MaxColsAtCompileTime, MaxRowsAtCompileTime}
\DoxyCodeLine{309   >::type \mbox{\hyperlink{classEigen_1_1Matrix}{TransposeTypeWithSameStorageOrder}};}
\DoxyCodeLine{310 }
\DoxyCodeLine{311   \textcolor{keywordtype}{void} allocate(\textcolor{keyword}{const} \mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD<MatrixType, HouseholderQRPreconditioner>}}\& svd)}
\DoxyCodeLine{312   \{}
\DoxyCodeLine{313     \textcolor{keywordflow}{if} (svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}() != m\_qr.rows() || svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}() != m\_qr.cols())}
\DoxyCodeLine{314     \{}
\DoxyCodeLine{315       m\_qr.\string~QRType();}
\DoxyCodeLine{316       ::new (\&m\_qr) \mbox{\hyperlink{classEigen_1_1HouseholderQR}{QRType}}(svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}(), svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}());}
\DoxyCodeLine{317     \}}
\DoxyCodeLine{318     \textcolor{keywordflow}{if} (svd.m\_computeFullV) m\_workspace.resize(svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}());}
\DoxyCodeLine{319     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (svd.m\_computeThinV) m\_workspace.resize(svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}());}
\DoxyCodeLine{320     m\_adjoint.resize(svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}(), svd.\mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}());}
\DoxyCodeLine{321   \}}
\DoxyCodeLine{322 }
\DoxyCodeLine{323   \textcolor{keywordtype}{bool} run(\mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD<MatrixType, HouseholderQRPreconditioner>}}\& svd, \textcolor{keyword}{const} MatrixType\& matrix)}
\DoxyCodeLine{324   \{}
\DoxyCodeLine{325     \textcolor{keywordflow}{if}(matrix.cols() > matrix.rows())}
\DoxyCodeLine{326     \{}
\DoxyCodeLine{327       m\_adjoint = matrix.adjoint();}
\DoxyCodeLine{328       m\_qr.compute(m\_adjoint);}
\DoxyCodeLine{329 }
\DoxyCodeLine{330       svd.m\_workMatrix = m\_qr.matrixQR().block(0,0,matrix.rows(),matrix.rows()).template triangularView<Upper>().adjoint();}
\DoxyCodeLine{331       \textcolor{keywordflow}{if}(svd.m\_computeFullV) m\_qr.householderQ().evalTo(svd.m\_matrixV, m\_workspace);}
\DoxyCodeLine{332       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(svd.m\_computeThinV)}
\DoxyCodeLine{333       \{}
\DoxyCodeLine{334         svd.m\_matrixV.setIdentity(matrix.cols(), matrix.rows());}
\DoxyCodeLine{335         m\_qr.householderQ().applyThisOnTheLeft(svd.m\_matrixV, m\_workspace);}
\DoxyCodeLine{336       \}}
\DoxyCodeLine{337       \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{classEigen_1_1SVDBase_a705a7c2709e1624ccc19aa748a78d473}{computeU}}()) svd.m\_matrixU.setIdentity(matrix.rows(), matrix.rows());}
\DoxyCodeLine{338       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{339     \}}
\DoxyCodeLine{340     \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{341   \}}
\DoxyCodeLine{342 }
\DoxyCodeLine{343 \textcolor{keyword}{private}:}
\DoxyCodeLine{344   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1HouseholderQR}{HouseholderQR<TransposeTypeWithSameStorageOrder>}} \mbox{\hyperlink{classEigen_1_1HouseholderQR}{QRType}};}
\DoxyCodeLine{345   \mbox{\hyperlink{classEigen_1_1HouseholderQR}{QRType}} m\_qr;}
\DoxyCodeLine{346   \mbox{\hyperlink{classEigen_1_1Matrix}{TransposeTypeWithSameStorageOrder}} m\_adjoint;}
\DoxyCodeLine{347   \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{internal::plain\_row\_type<MatrixType>::type}} m\_workspace;}
\DoxyCodeLine{348 \};}
\DoxyCodeLine{349 }
\DoxyCodeLine{350 \textcolor{comment}{/*** 2x2 SVD implementation}}
\DoxyCodeLine{351 \textcolor{comment}{ ***}}
\DoxyCodeLine{352 \textcolor{comment}{ *** JacobiSVD consists in performing a series of 2x2 SVD subproblems}}
\DoxyCodeLine{353 \textcolor{comment}{ ***/}}
\DoxyCodeLine{354 }
\DoxyCodeLine{355 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keywordtype}{int} QRPreconditioner>}
\DoxyCodeLine{356 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real}{svd\_precondition\_2x2\_block\_to\_be\_real}}<MatrixType, QRPreconditioner, false>}
\DoxyCodeLine{357 \{}
\DoxyCodeLine{358   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD<MatrixType, QRPreconditioner>}} \mbox{\hyperlink{classEigen_1_1JacobiSVD}{SVD}};}
\DoxyCodeLine{359   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::RealScalar RealScalar;}
\DoxyCodeLine{360   \textcolor{keyword}{static} \textcolor{keywordtype}{bool} run(\textcolor{keyword}{typename} \mbox{\hyperlink{classEigen_1_1Matrix}{SVD::WorkMatrixType}}\&, \mbox{\hyperlink{classEigen_1_1JacobiSVD}{SVD}}\&, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}, RealScalar\&) \{ \textcolor{keywordflow}{return} \textcolor{keyword}{true}; \}}
\DoxyCodeLine{361 \};}
\DoxyCodeLine{362 }
\DoxyCodeLine{363 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keywordtype}{int} QRPreconditioner>}
\DoxyCodeLine{364 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real}{svd\_precondition\_2x2\_block\_to\_be\_real}}<MatrixType, QRPreconditioner, true>}
\DoxyCodeLine{365 \{}
\DoxyCodeLine{366   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD<MatrixType, QRPreconditioner>}} \mbox{\hyperlink{classEigen_1_1JacobiSVD}{SVD}};}
\DoxyCodeLine{367   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Scalar Scalar;}
\DoxyCodeLine{368   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::RealScalar RealScalar;}
\DoxyCodeLine{369   \textcolor{keyword}{static} \textcolor{keywordtype}{bool} run(\textcolor{keyword}{typename} \mbox{\hyperlink{classEigen_1_1Matrix}{SVD::WorkMatrixType}}\& work\_matrix, \mbox{\hyperlink{classEigen_1_1JacobiSVD}{SVD}}\& svd, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} p, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} q, RealScalar\& maxDiagEntry)}
\DoxyCodeLine{370   \{}
\DoxyCodeLine{371     \textcolor{keyword}{using} std::sqrt;}
\DoxyCodeLine{372     \textcolor{keyword}{using} std::abs;}
\DoxyCodeLine{373     \mbox{\hyperlink{classEigen_1_1DenseBase_a5feed465b3a8e60c47e73ecce83e39a2}{Scalar}} z;}
\DoxyCodeLine{374     \mbox{\hyperlink{classEigen_1_1JacobiRotation}{JacobiRotation<Scalar>}} rot;}
\DoxyCodeLine{375     RealScalar n = sqrt(numext::abs2(work\_matrix.coeff(p,p)) + numext::abs2(work\_matrix.coeff(q,p)));}
\DoxyCodeLine{376 }
\DoxyCodeLine{377     \textcolor{keyword}{const} RealScalar considerAsZero = (std::numeric\_limits<RealScalar>::min)();}
\DoxyCodeLine{378     \textcolor{keyword}{const} RealScalar precision = \mbox{\hyperlink{structEigen_1_1NumTraits}{NumTraits<Scalar>::epsilon}}();}
\DoxyCodeLine{379 }
\DoxyCodeLine{380     \textcolor{keywordflow}{if}(n==0)}
\DoxyCodeLine{381     \{}
\DoxyCodeLine{382       \textcolor{comment}{// make sure first column is zero}}
\DoxyCodeLine{383       work\_matrix.coeffRef(p,p) = work\_matrix.coeffRef(q,p) = \mbox{\hyperlink{classEigen_1_1DenseBase_a5feed465b3a8e60c47e73ecce83e39a2}{Scalar}}(0);}
\DoxyCodeLine{384 }
\DoxyCodeLine{385       \textcolor{keywordflow}{if}(abs(numext::imag(work\_matrix.coeff(p,q)))>considerAsZero)}
\DoxyCodeLine{386       \{}
\DoxyCodeLine{387         \textcolor{comment}{// work\_matrix.coeff(p,q) can be zero if work\_matrix.coeff(q,p) is not zero but small enough to underflow when computing n}}
\DoxyCodeLine{388         z = abs(work\_matrix.coeff(p,q)) / work\_matrix.coeff(p,q);}
\DoxyCodeLine{389         work\_matrix.row(p) *= z;}
\DoxyCodeLine{390         \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{classEigen_1_1SVDBase_a705a7c2709e1624ccc19aa748a78d473}{computeU}}()) svd.m\_matrixU.col(p) *= conj(z);}
\DoxyCodeLine{391       \}}
\DoxyCodeLine{392       \textcolor{keywordflow}{if}(abs(numext::imag(work\_matrix.coeff(q,q)))>considerAsZero)}
\DoxyCodeLine{393       \{}
\DoxyCodeLine{394         z = abs(work\_matrix.coeff(q,q)) / work\_matrix.coeff(q,q);}
\DoxyCodeLine{395         work\_matrix.row(q) *= z;}
\DoxyCodeLine{396         \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{classEigen_1_1SVDBase_a705a7c2709e1624ccc19aa748a78d473}{computeU}}()) svd.m\_matrixU.col(q) *= conj(z);}
\DoxyCodeLine{397       \}}
\DoxyCodeLine{398       \textcolor{comment}{// otherwise the second row is already zero, so we have nothing to do.}}
\DoxyCodeLine{399     \}}
\DoxyCodeLine{400     \textcolor{keywordflow}{else}}
\DoxyCodeLine{401     \{}
\DoxyCodeLine{402       rot.c() = conj(work\_matrix.coeff(p,p)) / n;}
\DoxyCodeLine{403       rot.s() = work\_matrix.coeff(q,p) / n;}
\DoxyCodeLine{404       work\_matrix.applyOnTheLeft(p,q,rot);}
\DoxyCodeLine{405       \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{classEigen_1_1SVDBase_a705a7c2709e1624ccc19aa748a78d473}{computeU}}()) svd.m\_matrixU.applyOnTheRight(p,q,rot.\mbox{\hyperlink{classEigen_1_1JacobiRotation_aaca0173b23a021238ab2a5f0d0003dfd}{adjoint}}());}
\DoxyCodeLine{406       \textcolor{keywordflow}{if}(abs(numext::imag(work\_matrix.coeff(p,q)))>considerAsZero)}
\DoxyCodeLine{407       \{}
\DoxyCodeLine{408         z = abs(work\_matrix.coeff(p,q)) / work\_matrix.coeff(p,q);}
\DoxyCodeLine{409         work\_matrix.col(q) *= z;}
\DoxyCodeLine{410         \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{classEigen_1_1SVDBase_a5f12efcb791eb007d4a4890ac5255ac4}{computeV}}()) svd.m\_matrixV.col(q) *= z;}
\DoxyCodeLine{411       \}}
\DoxyCodeLine{412       \textcolor{keywordflow}{if}(abs(numext::imag(work\_matrix.coeff(q,q)))>considerAsZero)}
\DoxyCodeLine{413       \{}
\DoxyCodeLine{414         z = abs(work\_matrix.coeff(q,q)) / work\_matrix.coeff(q,q);}
\DoxyCodeLine{415         work\_matrix.row(q) *= z;}
\DoxyCodeLine{416         \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{classEigen_1_1SVDBase_a705a7c2709e1624ccc19aa748a78d473}{computeU}}()) svd.m\_matrixU.col(q) *= conj(z);}
\DoxyCodeLine{417       \}}
\DoxyCodeLine{418     \}}
\DoxyCodeLine{419 }
\DoxyCodeLine{420     \textcolor{comment}{// update largest diagonal entry}}
\DoxyCodeLine{421     maxDiagEntry = numext::maxi<RealScalar>(maxDiagEntry,numext::maxi<RealScalar>(abs(work\_matrix.coeff(p,p)), abs(work\_matrix.coeff(q,q))));}
\DoxyCodeLine{422     \textcolor{comment}{// and check whether the 2x2 block is already diagonal}}
\DoxyCodeLine{423     RealScalar threshold = numext::maxi<RealScalar>(considerAsZero, precision * maxDiagEntry);}
\DoxyCodeLine{424     \textcolor{keywordflow}{return} abs(work\_matrix.coeff(p,q))>threshold || abs(work\_matrix.coeff(q,p)) > threshold;}
\DoxyCodeLine{425   \}}
\DoxyCodeLine{426 \};}
\DoxyCodeLine{427 }
\DoxyCodeLine{428 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType\_, \textcolor{keywordtype}{int} QRPreconditioner>}
\DoxyCodeLine{429 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}<\mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD}}<MatrixType\_,QRPreconditioner> >}
\DoxyCodeLine{430         : \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}<MatrixType\_>}
\DoxyCodeLine{431 \{}
\DoxyCodeLine{432   \textcolor{keyword}{typedef} MatrixType\_ MatrixType;}
\DoxyCodeLine{433 \};}
\DoxyCodeLine{434 }
\DoxyCodeLine{435 \} \textcolor{comment}{// end namespace internal}}
\DoxyCodeLine{436 }
\DoxyCodeLine{490 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType\_, \textcolor{keywordtype}{int} QRPreconditioner> \textcolor{keyword}{class }\mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD}}}
\DoxyCodeLine{491  : \textcolor{keyword}{public} \mbox{\hyperlink{classEigen_1_1SVDBase}{SVDBase}}<JacobiSVD<MatrixType\_,QRPreconditioner> >}
\DoxyCodeLine{492 \{}
\DoxyCodeLine{493     \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1SVDBase}{SVDBase<JacobiSVD>}} \mbox{\hyperlink{structEigen_1_1EigenBase}{Base}};}
\DoxyCodeLine{494   \textcolor{keyword}{public}:}
\DoxyCodeLine{495 }
\DoxyCodeLine{496     \textcolor{keyword}{typedef} MatrixType\_ MatrixType;}
\DoxyCodeLine{497     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Scalar Scalar;}
\DoxyCodeLine{498     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} NumTraits<typename MatrixType::Scalar>::Real RealScalar;}
\DoxyCodeLine{499     \textcolor{keyword}{enum} \{}
\DoxyCodeLine{500       RowsAtCompileTime = MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{501       ColsAtCompileTime = MatrixType::ColsAtCompileTime,}
\DoxyCodeLine{502       DiagSizeAtCompileTime = EIGEN\_SIZE\_MIN\_PREFER\_DYNAMIC(RowsAtCompileTime,ColsAtCompileTime),}
\DoxyCodeLine{503       MaxRowsAtCompileTime = MatrixType::MaxRowsAtCompileTime,}
\DoxyCodeLine{504       MaxColsAtCompileTime = MatrixType::MaxColsAtCompileTime,}
\DoxyCodeLine{505       MaxDiagSizeAtCompileTime = EIGEN\_SIZE\_MIN\_PREFER\_FIXED(MaxRowsAtCompileTime,MaxColsAtCompileTime),}
\DoxyCodeLine{506       MatrixOptions = MatrixType::Options}
\DoxyCodeLine{507     \};}
\DoxyCodeLine{508 }
\DoxyCodeLine{509     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} Base::MatrixUType MatrixUType;}
\DoxyCodeLine{510     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} Base::MatrixVType MatrixVType;}
\DoxyCodeLine{511     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} Base::SingularValuesType SingularValuesType;}
\DoxyCodeLine{512     }
\DoxyCodeLine{513     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{internal::plain\_row\_type<MatrixType>::type}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RowType}};}
\DoxyCodeLine{514     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{internal::plain\_col\_type<MatrixType>::type}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ColType}};}
\DoxyCodeLine{515     \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix}}<Scalar, DiagSizeAtCompileTime, DiagSizeAtCompileTime,}
\DoxyCodeLine{516                    MatrixOptions, MaxDiagSizeAtCompileTime, MaxDiagSizeAtCompileTime>}
\DoxyCodeLine{517             \mbox{\hyperlink{classEigen_1_1Matrix}{WorkMatrixType}};}
\DoxyCodeLine{518 }
\DoxyCodeLine{524     \mbox{\hyperlink{classEigen_1_1JacobiSVD_ae37a9d883232f608766435d09044cd6d}{JacobiSVD}}()}
\DoxyCodeLine{525     \{\}}
\DoxyCodeLine{526 }
\DoxyCodeLine{527 }
\DoxyCodeLine{534     \mbox{\hyperlink{classEigen_1_1JacobiSVD_a7a81e8e2879f6ccd03daac713aa2cad6}{JacobiSVD}}(\mbox{\hyperlink{structEigen_1_1EigenBase_a554f30542cc2316add4b1ea0a492ff02}{Index}} \mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}, \mbox{\hyperlink{structEigen_1_1EigenBase_a554f30542cc2316add4b1ea0a492ff02}{Index}} \mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} computationOptions = 0)}
\DoxyCodeLine{535     \{}
\DoxyCodeLine{536       allocate(\mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}, \mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}, computationOptions);}
\DoxyCodeLine{537     \}}
\DoxyCodeLine{538 }
\DoxyCodeLine{549     \textcolor{keyword}{explicit} \mbox{\hyperlink{classEigen_1_1JacobiSVD_afd9ba810cb2e5a8b1450163739367ab2}{JacobiSVD}}(\textcolor{keyword}{const} MatrixType\& matrix, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} computationOptions = 0)}
\DoxyCodeLine{550     \{}
\DoxyCodeLine{551       \mbox{\hyperlink{classEigen_1_1JacobiSVD_a5dab376cc86cf0d36674bcdad4af3f5a}{compute}}(matrix, computationOptions);}
\DoxyCodeLine{552     \}}
\DoxyCodeLine{553 }
\DoxyCodeLine{564     \mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD}}\& \mbox{\hyperlink{classEigen_1_1JacobiSVD_a5dab376cc86cf0d36674bcdad4af3f5a}{compute}}(\textcolor{keyword}{const} MatrixType\& matrix, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} computationOptions);}
\DoxyCodeLine{565 }
\DoxyCodeLine{572     \mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD}}\& \mbox{\hyperlink{classEigen_1_1JacobiSVD_ac57c71c8cc099d24faa447f4508b533c}{compute}}(\textcolor{keyword}{const} MatrixType\& matrix)}
\DoxyCodeLine{573     \{}
\DoxyCodeLine{574       \textcolor{keywordflow}{return} \mbox{\hyperlink{classEigen_1_1JacobiSVD_a5dab376cc86cf0d36674bcdad4af3f5a}{compute}}(matrix, m\_computationOptions);}
\DoxyCodeLine{575     \}}
\DoxyCodeLine{576 }
\DoxyCodeLine{577     \textcolor{keyword}{using} \mbox{\hyperlink{classEigen_1_1SVDBase_a705a7c2709e1624ccc19aa748a78d473}{Base::computeU}};}
\DoxyCodeLine{578     \textcolor{keyword}{using} \mbox{\hyperlink{classEigen_1_1SVDBase_a5f12efcb791eb007d4a4890ac5255ac4}{Base::computeV}};}
\DoxyCodeLine{579     \textcolor{keyword}{using} Base::rows;}
\DoxyCodeLine{580     \textcolor{keyword}{using} Base::cols;}
\DoxyCodeLine{581     \textcolor{keyword}{using} \mbox{\hyperlink{classEigen_1_1SVDBase_a30b89e24f42f1692079eea31b361d26a}{Base::rank}};}
\DoxyCodeLine{582 }
\DoxyCodeLine{583   \textcolor{keyword}{private}:}
\DoxyCodeLine{584     \textcolor{keywordtype}{void} allocate(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} \mbox{\hyperlink{classEigen_1_1JacobiSVD_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} \mbox{\hyperlink{classEigen_1_1JacobiSVD_a50c19c45f15acdfe1cb66ab5e879b8e3}{cols}}, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} computationOptions);}
\DoxyCodeLine{585 }
\DoxyCodeLine{586   \textcolor{keyword}{protected}:}
\DoxyCodeLine{587     \textcolor{keyword}{using} Base::m\_matrixU;}
\DoxyCodeLine{588     \textcolor{keyword}{using} Base::m\_matrixV;}
\DoxyCodeLine{589     \textcolor{keyword}{using} Base::m\_singularValues;}
\DoxyCodeLine{590     \textcolor{keyword}{using} Base::m\_info;}
\DoxyCodeLine{591     \textcolor{keyword}{using} Base::m\_isInitialized;}
\DoxyCodeLine{592     \textcolor{keyword}{using} Base::m\_isAllocated;}
\DoxyCodeLine{593     \textcolor{keyword}{using} Base::m\_usePrescribedThreshold;}
\DoxyCodeLine{594     \textcolor{keyword}{using} Base::m\_computeFullU;}
\DoxyCodeLine{595     \textcolor{keyword}{using} Base::m\_computeThinU;}
\DoxyCodeLine{596     \textcolor{keyword}{using} Base::m\_computeFullV;}
\DoxyCodeLine{597     \textcolor{keyword}{using} Base::m\_computeThinV;}
\DoxyCodeLine{598     \textcolor{keyword}{using} Base::m\_computationOptions;}
\DoxyCodeLine{599     \textcolor{keyword}{using} Base::m\_nonzeroSingularValues;}
\DoxyCodeLine{600     \textcolor{keyword}{using} Base::m\_rows;}
\DoxyCodeLine{601     \textcolor{keyword}{using} Base::m\_cols;}
\DoxyCodeLine{602     \textcolor{keyword}{using} Base::m\_diagSize;}
\DoxyCodeLine{603     \textcolor{keyword}{using} Base::m\_prescribedThreshold;}
\DoxyCodeLine{604     WorkMatrixType m\_workMatrix;}
\DoxyCodeLine{605 }
\DoxyCodeLine{606     \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType\_\_, \textcolor{keywordtype}{int} QRPreconditioner\_, \textcolor{keywordtype}{bool} IsComplex\_>}
\DoxyCodeLine{607     \textcolor{keyword}{friend} \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real}{internal::svd\_precondition\_2x2\_block\_to\_be\_real}};}
\DoxyCodeLine{608     \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType\_\_, \textcolor{keywordtype}{int} QRPreconditioner\_, \textcolor{keywordtype}{int} Case\_, \textcolor{keywordtype}{bool} DoAnything\_>}
\DoxyCodeLine{609     \textcolor{keyword}{friend} \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1qr__preconditioner__impl}{internal::qr\_preconditioner\_impl}};}
\DoxyCodeLine{610 }
\DoxyCodeLine{611     \mbox{\hyperlink{structEigen_1_1internal_1_1qr__preconditioner__impl}{internal::qr\_preconditioner\_impl<MatrixType, QRPreconditioner, internal::PreconditionIfMoreColsThanRows>}} m\_qr\_precond\_morecols;}
\DoxyCodeLine{612     \mbox{\hyperlink{structEigen_1_1internal_1_1qr__preconditioner__impl}{internal::qr\_preconditioner\_impl<MatrixType, QRPreconditioner, internal::PreconditionIfMoreRowsThanCols>}} m\_qr\_precond\_morerows;}
\DoxyCodeLine{613     MatrixType m\_scaledMatrix;}
\DoxyCodeLine{614 \};}
\DoxyCodeLine{615 }
\DoxyCodeLine{616 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keywordtype}{int} QRPreconditioner>}
\DoxyCodeLine{617 \textcolor{keywordtype}{void} JacobiSVD<MatrixType, QRPreconditioner>::allocate(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Eigen::Index}} rows, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Eigen::Index}} cols, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} computationOptions)}
\DoxyCodeLine{618 \{}
\DoxyCodeLine{619   eigen\_assert(rows >= 0 \&\& cols >= 0);}
\DoxyCodeLine{620 }
\DoxyCodeLine{621   \textcolor{keywordflow}{if} (m\_isAllocated \&\&}
\DoxyCodeLine{622       rows == m\_rows \&\&}
\DoxyCodeLine{623       cols == m\_cols \&\&}
\DoxyCodeLine{624       computationOptions == m\_computationOptions)}
\DoxyCodeLine{625   \{}
\DoxyCodeLine{626     \textcolor{keywordflow}{return};}
\DoxyCodeLine{627   \}}
\DoxyCodeLine{628 }
\DoxyCodeLine{629   m\_rows = rows;}
\DoxyCodeLine{630   m\_cols = cols;}
\DoxyCodeLine{631   m\_info = \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf}{Success}};}
\DoxyCodeLine{632   m\_isInitialized = \textcolor{keyword}{false};}
\DoxyCodeLine{633   m\_isAllocated = \textcolor{keyword}{true};}
\DoxyCodeLine{634   m\_computationOptions = computationOptions;}
\DoxyCodeLine{635   m\_computeFullU = (computationOptions \& \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a9fa9302d510cee20c26311154937e23f}{ComputeFullU}}) != 0;}
\DoxyCodeLine{636   m\_computeThinU = (computationOptions \& \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9aa7fb4e98834788d0b1b0f2b8467d2527}{ComputeThinU}}) != 0;}
\DoxyCodeLine{637   m\_computeFullV = (computationOptions \& \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a36581f7c662f7def31efd500c284f930}{ComputeFullV}}) != 0;}
\DoxyCodeLine{638   m\_computeThinV = (computationOptions \& \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a540036417bfecf2e791a70948c227f47}{ComputeThinV}}) != 0;}
\DoxyCodeLine{639   eigen\_assert(!(m\_computeFullU \&\& m\_computeThinU) \&\& \textcolor{stringliteral}{"{}JacobiSVD: you can't ask for both full and thin U"{}});}
\DoxyCodeLine{640   eigen\_assert(!(m\_computeFullV \&\& m\_computeThinV) \&\& \textcolor{stringliteral}{"{}JacobiSVD: you can't ask for both full and thin V"{}});}
\DoxyCodeLine{641   eigen\_assert(EIGEN\_IMPLIES(m\_computeThinU || m\_computeThinV, MatrixType::ColsAtCompileTime==\mbox{\hyperlink{namespaceEigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}}) \&\&}
\DoxyCodeLine{642               \textcolor{stringliteral}{"{}JacobiSVD: thin U and V are only available when your matrix has a dynamic number of columns."{}});}
\DoxyCodeLine{643   \textcolor{keywordflow}{if} (QRPreconditioner == \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56eabd745dcaff7019c5f918c68809e5ea50}{FullPivHouseholderQRPreconditioner}})}
\DoxyCodeLine{644   \{}
\DoxyCodeLine{645       eigen\_assert(!(m\_computeThinU || m\_computeThinV) \&\&}
\DoxyCodeLine{646               \textcolor{stringliteral}{"{}JacobiSVD: can't compute thin U or thin V with the FullPivHouseholderQR preconditioner. "{}}}
\DoxyCodeLine{647               \textcolor{stringliteral}{"{}Use the ColPivHouseholderQR preconditioner instead."{}});}
\DoxyCodeLine{648   \}}
\DoxyCodeLine{649   m\_diagSize = (std::min)(m\_rows, m\_cols);}
\DoxyCodeLine{650   m\_singularValues.resize(m\_diagSize);}
\DoxyCodeLine{651   \textcolor{keywordflow}{if}(RowsAtCompileTime==\mbox{\hyperlink{namespaceEigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}})}
\DoxyCodeLine{652     m\_matrixU.resize(m\_rows, m\_computeFullU ? m\_rows}
\DoxyCodeLine{653                             : m\_computeThinU ? m\_diagSize}
\DoxyCodeLine{654                             : 0);}
\DoxyCodeLine{655   \textcolor{keywordflow}{if}(ColsAtCompileTime==\mbox{\hyperlink{namespaceEigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}})}
\DoxyCodeLine{656     m\_matrixV.resize(m\_cols, m\_computeFullV ? m\_cols}
\DoxyCodeLine{657                             : m\_computeThinV ? m\_diagSize}
\DoxyCodeLine{658                             : 0);}
\DoxyCodeLine{659   m\_workMatrix.resize(m\_diagSize, m\_diagSize);}
\DoxyCodeLine{660   }
\DoxyCodeLine{661   \textcolor{keywordflow}{if}(m\_cols>m\_rows)   m\_qr\_precond\_morecols.allocate(*\textcolor{keyword}{this});}
\DoxyCodeLine{662   \textcolor{keywordflow}{if}(m\_rows>m\_cols)   m\_qr\_precond\_morerows.allocate(*\textcolor{keyword}{this});}
\DoxyCodeLine{663   \textcolor{keywordflow}{if}(m\_rows!=m\_cols)  m\_scaledMatrix.resize(rows,cols);}
\DoxyCodeLine{664 \}}
\DoxyCodeLine{665 }
\DoxyCodeLine{666 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keywordtype}{int} QRPreconditioner>}
\DoxyCodeLine{667 JacobiSVD<MatrixType, QRPreconditioner>\&}
\DoxyCodeLine{668 \mbox{\hyperlink{classEigen_1_1JacobiSVD_a5dab376cc86cf0d36674bcdad4af3f5a}{JacobiSVD<MatrixType, QRPreconditioner>::compute}}(\textcolor{keyword}{const} MatrixType\& matrix, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} computationOptions)}
\DoxyCodeLine{669 \{}
\DoxyCodeLine{670   \textcolor{keyword}{using} std::abs;}
\DoxyCodeLine{671   allocate(matrix.rows(), matrix.cols(), computationOptions);}
\DoxyCodeLine{672 }
\DoxyCodeLine{673   \textcolor{comment}{// currently we stop when we reach precision 2*epsilon as the last bit of precision can require an unreasonable number of iterations,}}
\DoxyCodeLine{674   \textcolor{comment}{// only worsening the precision of U and V as we accumulate more rotations}}
\DoxyCodeLine{675   \textcolor{keyword}{const} RealScalar precision = RealScalar(2) * \mbox{\hyperlink{structEigen_1_1NumTraits}{NumTraits<Scalar>::epsilon}}();}
\DoxyCodeLine{676 }
\DoxyCodeLine{677   \textcolor{comment}{// limit for denormal numbers to be considered zero in order to avoid infinite loops (see bug 286)}}
\DoxyCodeLine{678   \textcolor{keyword}{const} RealScalar considerAsZero = (std::numeric\_limits<RealScalar>::min)();}
\DoxyCodeLine{679 }
\DoxyCodeLine{680   \textcolor{comment}{// Scaling factor to reduce over/under-\/flows}}
\DoxyCodeLine{681   RealScalar scale = matrix.cwiseAbs().template maxCoeff<PropagateNaN>();}
\DoxyCodeLine{682   \textcolor{keywordflow}{if} (!(numext::isfinite)(scale)) \{}
\DoxyCodeLine{683     m\_isInitialized = \textcolor{keyword}{true};}
\DoxyCodeLine{684     m\_info = \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea580b2a3cafe585691e789f768fb729bf}{InvalidInput}};}
\DoxyCodeLine{685     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{686   \}}
\DoxyCodeLine{687   \textcolor{keywordflow}{if}(scale==RealScalar(0)) scale = RealScalar(1);}
\DoxyCodeLine{688   }
\DoxyCodeLine{689 \textcolor{comment}{  /*** step 1. The R-\/SVD step: we use a QR decomposition to reduce to the case of a square matrix */}}
\DoxyCodeLine{690 }
\DoxyCodeLine{691   \textcolor{keywordflow}{if}(m\_rows!=m\_cols)}
\DoxyCodeLine{692   \{}
\DoxyCodeLine{693     m\_scaledMatrix = matrix / scale;}
\DoxyCodeLine{694     m\_qr\_precond\_morecols.run(*\textcolor{keyword}{this}, m\_scaledMatrix);}
\DoxyCodeLine{695     m\_qr\_precond\_morerows.run(*\textcolor{keyword}{this}, m\_scaledMatrix);}
\DoxyCodeLine{696   \}}
\DoxyCodeLine{697   \textcolor{keywordflow}{else}}
\DoxyCodeLine{698   \{}
\DoxyCodeLine{699     m\_workMatrix = matrix.block(0,0,m\_diagSize,m\_diagSize) / scale;}
\DoxyCodeLine{700     \textcolor{keywordflow}{if}(m\_computeFullU) m\_matrixU.setIdentity(m\_rows,m\_rows);}
\DoxyCodeLine{701     \textcolor{keywordflow}{if}(m\_computeThinU) m\_matrixU.setIdentity(m\_rows,m\_diagSize);}
\DoxyCodeLine{702     \textcolor{keywordflow}{if}(m\_computeFullV) m\_matrixV.setIdentity(m\_cols,m\_cols);}
\DoxyCodeLine{703     \textcolor{keywordflow}{if}(m\_computeThinV) m\_matrixV.setIdentity(m\_cols, m\_diagSize);}
\DoxyCodeLine{704   \}}
\DoxyCodeLine{705 }
\DoxyCodeLine{706 \textcolor{comment}{  /*** step 2. The main Jacobi SVD iteration. ***/}}
\DoxyCodeLine{707   RealScalar maxDiagEntry = m\_workMatrix.cwiseAbs().diagonal().maxCoeff();}
\DoxyCodeLine{708 }
\DoxyCodeLine{709   \textcolor{keywordtype}{bool} finished = \textcolor{keyword}{false};}
\DoxyCodeLine{710   \textcolor{keywordflow}{while}(!finished)}
\DoxyCodeLine{711   \{}
\DoxyCodeLine{712     finished = \textcolor{keyword}{true};}
\DoxyCodeLine{713 }
\DoxyCodeLine{714     \textcolor{comment}{// do a sweep: for all index pairs (p,q), perform SVD of the corresponding 2x2 sub-\/matrix}}
\DoxyCodeLine{715 }
\DoxyCodeLine{716     \textcolor{keywordflow}{for}(\mbox{\hyperlink{structEigen_1_1EigenBase_a554f30542cc2316add4b1ea0a492ff02}{Index}} p = 1; p < m\_diagSize; ++p)}
\DoxyCodeLine{717     \{}
\DoxyCodeLine{718       \textcolor{keywordflow}{for}(\mbox{\hyperlink{structEigen_1_1EigenBase_a554f30542cc2316add4b1ea0a492ff02}{Index}} q = 0; q < p; ++q)}
\DoxyCodeLine{719       \{}
\DoxyCodeLine{720         \textcolor{comment}{// if this 2x2 sub-\/matrix is not diagonal already...}}
\DoxyCodeLine{721         \textcolor{comment}{// notice that this comparison will evaluate to false if any NaN is involved, ensuring that NaN's don't}}
\DoxyCodeLine{722         \textcolor{comment}{// keep us iterating forever. Similarly, small denormal numbers are considered zero.}}
\DoxyCodeLine{723         RealScalar threshold = numext::maxi<RealScalar>(considerAsZero, precision * maxDiagEntry);}
\DoxyCodeLine{724         \textcolor{keywordflow}{if}(abs(m\_workMatrix.coeff(p,q))>threshold || abs(m\_workMatrix.coeff(q,p)) > threshold)}
\DoxyCodeLine{725         \{}
\DoxyCodeLine{726           finished = \textcolor{keyword}{false};}
\DoxyCodeLine{727           \textcolor{comment}{// perform SVD decomposition of 2x2 sub-\/matrix corresponding to indices p,q to make it diagonal}}
\DoxyCodeLine{728           \textcolor{comment}{// the complex to real operation returns true if the updated 2x2 block is not already diagonal}}
\DoxyCodeLine{729           \textcolor{keywordflow}{if}(\mbox{\hyperlink{structEigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real}{internal::svd\_precondition\_2x2\_block\_to\_be\_real<MatrixType, QRPreconditioner>::run}}(m\_workMatrix, *\textcolor{keyword}{this}, p, q, maxDiagEntry))}
\DoxyCodeLine{730           \{}
\DoxyCodeLine{731             \mbox{\hyperlink{classEigen_1_1JacobiRotation}{JacobiRotation<RealScalar>}} j\_left, j\_right;}
\DoxyCodeLine{732             internal::real\_2x2\_jacobi\_svd(m\_workMatrix, p, q, \&j\_left, \&j\_right);}
\DoxyCodeLine{733 }
\DoxyCodeLine{734             \textcolor{comment}{// accumulate resulting Jacobi rotations}}
\DoxyCodeLine{735             m\_workMatrix.applyOnTheLeft(p,q,j\_left);}
\DoxyCodeLine{736             \textcolor{keywordflow}{if}(computeU()) m\_matrixU.applyOnTheRight(p,q,j\_left.\mbox{\hyperlink{classEigen_1_1JacobiRotation_a3ad513485f7426761ab80fc845f9946e}{transpose}}());}
\DoxyCodeLine{737 }
\DoxyCodeLine{738             m\_workMatrix.applyOnTheRight(p,q,j\_right);}
\DoxyCodeLine{739             \textcolor{keywordflow}{if}(computeV()) m\_matrixV.applyOnTheRight(p,q,j\_right);}
\DoxyCodeLine{740 }
\DoxyCodeLine{741             \textcolor{comment}{// keep track of the largest diagonal coefficient}}
\DoxyCodeLine{742             maxDiagEntry = numext::maxi<RealScalar>(maxDiagEntry,numext::maxi<RealScalar>(abs(m\_workMatrix.coeff(p,p)), abs(m\_workMatrix.coeff(q,q))));}
\DoxyCodeLine{743           \}}
\DoxyCodeLine{744         \}}
\DoxyCodeLine{745       \}}
\DoxyCodeLine{746     \}}
\DoxyCodeLine{747   \}}
\DoxyCodeLine{748 }
\DoxyCodeLine{749 \textcolor{comment}{  /*** step 3. The work matrix is now diagonal, so ensure it's positive so its diagonal entries are the singular values ***/}}
\DoxyCodeLine{750 }
\DoxyCodeLine{751   \textcolor{keywordflow}{for}(\mbox{\hyperlink{structEigen_1_1EigenBase_a554f30542cc2316add4b1ea0a492ff02}{Index}} i = 0; i < m\_diagSize; ++i)}
\DoxyCodeLine{752   \{}
\DoxyCodeLine{753     \textcolor{comment}{// For a complex matrix, some diagonal coefficients might note have been}}
\DoxyCodeLine{754     \textcolor{comment}{// treated by svd\_precondition\_2x2\_block\_to\_be\_real, and the imaginary part}}
\DoxyCodeLine{755     \textcolor{comment}{// of some diagonal entry might not be null.}}
\DoxyCodeLine{756     \textcolor{keywordflow}{if}(\mbox{\hyperlink{structEigen_1_1NumTraits}{NumTraits<Scalar>::IsComplex}} \&\& abs(numext::imag(m\_workMatrix.coeff(i,i)))>considerAsZero)}
\DoxyCodeLine{757     \{}
\DoxyCodeLine{758       RealScalar a = abs(m\_workMatrix.coeff(i,i));}
\DoxyCodeLine{759       m\_singularValues.coeffRef(i) = abs(a);}
\DoxyCodeLine{760       \textcolor{keywordflow}{if}(computeU()) m\_matrixU.col(i) *= m\_workMatrix.coeff(i,i)/a;}
\DoxyCodeLine{761     \}}
\DoxyCodeLine{762     \textcolor{keywordflow}{else}}
\DoxyCodeLine{763     \{}
\DoxyCodeLine{764       \textcolor{comment}{// m\_workMatrix.coeff(i,i) is already real, no difficulty:}}
\DoxyCodeLine{765       RealScalar a = numext::real(m\_workMatrix.coeff(i,i));}
\DoxyCodeLine{766       m\_singularValues.coeffRef(i) = abs(a);}
\DoxyCodeLine{767       \textcolor{keywordflow}{if}(computeU() \&\& (a<RealScalar(0))) m\_matrixU.col(i) = -\/m\_matrixU.col(i);}
\DoxyCodeLine{768     \}}
\DoxyCodeLine{769   \}}
\DoxyCodeLine{770   }
\DoxyCodeLine{771   m\_singularValues *= scale;}
\DoxyCodeLine{772 }
\DoxyCodeLine{773 \textcolor{comment}{  /*** step 4. Sort singular values in descending order and compute the number of nonzero singular values ***/}}
\DoxyCodeLine{774 }
\DoxyCodeLine{775   m\_nonzeroSingularValues = m\_diagSize;}
\DoxyCodeLine{776   \textcolor{keywordflow}{for}(\mbox{\hyperlink{structEigen_1_1EigenBase_a554f30542cc2316add4b1ea0a492ff02}{Index}} i = 0; i < m\_diagSize; i++)}
\DoxyCodeLine{777   \{}
\DoxyCodeLine{778     \mbox{\hyperlink{structEigen_1_1EigenBase_a554f30542cc2316add4b1ea0a492ff02}{Index}} pos;}
\DoxyCodeLine{779     RealScalar maxRemainingSingularValue = m\_singularValues.tail(m\_diagSize-\/i).maxCoeff(\&pos);}
\DoxyCodeLine{780     \textcolor{keywordflow}{if}(maxRemainingSingularValue == RealScalar(0))}
\DoxyCodeLine{781     \{}
\DoxyCodeLine{782       m\_nonzeroSingularValues = i;}
\DoxyCodeLine{783       \textcolor{keywordflow}{break};}
\DoxyCodeLine{784     \}}
\DoxyCodeLine{785     \textcolor{keywordflow}{if}(pos)}
\DoxyCodeLine{786     \{}
\DoxyCodeLine{787       pos += i;}
\DoxyCodeLine{788       std::swap(m\_singularValues.coeffRef(i), m\_singularValues.coeffRef(pos));}
\DoxyCodeLine{789       \textcolor{keywordflow}{if}(computeU()) m\_matrixU.col(pos).swap(m\_matrixU.col(i));}
\DoxyCodeLine{790       \textcolor{keywordflow}{if}(computeV()) m\_matrixV.col(pos).swap(m\_matrixV.col(i));}
\DoxyCodeLine{791     \}}
\DoxyCodeLine{792   \}}
\DoxyCodeLine{793 }
\DoxyCodeLine{794   m\_isInitialized = \textcolor{keyword}{true};}
\DoxyCodeLine{795   \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{796 \}}
\DoxyCodeLine{797 }
\DoxyCodeLine{805 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>}
\DoxyCodeLine{806 \mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD<typename MatrixBase<Derived>::PlainObject}}>}
\DoxyCodeLine{807 \mbox{\hyperlink{classEigen_1_1MatrixBase_a5745dca9c54390633b434e54a1d1eedd}{MatrixBase<Derived>::jacobiSvd}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} computationOptions)\textcolor{keyword}{ const}}
\DoxyCodeLine{808 \textcolor{keyword}{}\{}
\DoxyCodeLine{809   \textcolor{keywordflow}{return} \mbox{\hyperlink{classEigen_1_1JacobiSVD}{JacobiSVD<PlainObject>}}(*\textcolor{keyword}{this}, computationOptions);}
\DoxyCodeLine{810 \}}
\DoxyCodeLine{811 }
\DoxyCodeLine{812 \} \textcolor{comment}{// end namespace Eigen}}
\DoxyCodeLine{813 }
\DoxyCodeLine{814 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// EIGEN\_JACOBISVD\_H}}

\end{DoxyCode}
