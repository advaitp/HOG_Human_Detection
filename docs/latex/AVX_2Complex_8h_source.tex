\hypertarget{AVX_2Complex_8h_source}{}\doxysection{Complex.\+h}
\label{AVX_2Complex_8h_source}\index{include/Eigen/src/Core/arch/AVX/Complex.h@{include/Eigen/src/Core/arch/AVX/Complex.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}}
\DoxyCodeLine{2 \textcolor{comment}{// for linear algebra.}}
\DoxyCodeLine{3 \textcolor{comment}{//}}
\DoxyCodeLine{4 \textcolor{comment}{// Copyright (C) 2014 Benoit Steiner (benoit.steiner.goog@gmail.com)}}
\DoxyCodeLine{5 \textcolor{comment}{//}}
\DoxyCodeLine{6 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}}
\DoxyCodeLine{7 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}}
\DoxyCodeLine{8 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{preprocessor}{\#ifndef EIGEN\_COMPLEX\_AVX\_H}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#define EIGEN\_COMPLEX\_AVX\_H}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include "{}../../InternalHeaderCheck.h"{}}}
\DoxyCodeLine{14 }
\DoxyCodeLine{15 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceEigen}{Eigen}} \{}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{keyword}{namespace }internal \{}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ float -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{20 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1Packet4cf}{Packet4cf}}}
\DoxyCodeLine{21 \{}
\DoxyCodeLine{22   EIGEN\_STRONG\_INLINE \mbox{\hyperlink{structEigen_1_1internal_1_1Packet4cf}{Packet4cf}}() \{\}}
\DoxyCodeLine{23   EIGEN\_STRONG\_INLINE \textcolor{keyword}{explicit} \mbox{\hyperlink{structEigen_1_1internal_1_1Packet4cf}{Packet4cf}}(\textcolor{keyword}{const} \_\_m256\& a) : v(a) \{\}}
\DoxyCodeLine{24   \_\_m256  v;}
\DoxyCodeLine{25 \};}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{preprocessor}{\#ifndef EIGEN\_VECTORIZE\_AVX512}}
\DoxyCodeLine{28 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1packet__traits}{packet\_traits}}<std::complex<float> >  : \mbox{\hyperlink{structEigen_1_1internal_1_1default__packet__traits}{default\_packet\_traits}}}
\DoxyCodeLine{29 \{}
\DoxyCodeLine{30   \textcolor{keyword}{typedef} \mbox{\hyperlink{structEigen_1_1internal_1_1Packet4cf}{Packet4cf}} type;}
\DoxyCodeLine{31   \textcolor{keyword}{typedef} \mbox{\hyperlink{structEigen_1_1internal_1_1Packet2cf}{Packet2cf}} \mbox{\hyperlink{structEigen_1_1half}{half}};}
\DoxyCodeLine{32   \textcolor{keyword}{enum} \{}
\DoxyCodeLine{33     Vectorizable = 1,}
\DoxyCodeLine{34     AlignedOnScalar = 1,}
\DoxyCodeLine{35     size = 4,}
\DoxyCodeLine{36     HasHalfPacket = 1,}
\DoxyCodeLine{37 }
\DoxyCodeLine{38     HasAdd    = 1,}
\DoxyCodeLine{39     HasSub    = 1,}
\DoxyCodeLine{40     HasMul    = 1,}
\DoxyCodeLine{41     HasDiv    = 1,}
\DoxyCodeLine{42     HasNegate = 1,}
\DoxyCodeLine{43     HasSqrt   = 1,}
\DoxyCodeLine{44     HasAbs    = 0,}
\DoxyCodeLine{45     HasAbs2   = 0,}
\DoxyCodeLine{46     HasMin    = 0,}
\DoxyCodeLine{47     HasMax    = 0,}
\DoxyCodeLine{48     HasSetLinear = 0}
\DoxyCodeLine{49   \};}
\DoxyCodeLine{50 \};}
\DoxyCodeLine{51 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{52 }
\DoxyCodeLine{53 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits}}<\mbox{\hyperlink{structEigen_1_1internal_1_1Packet4cf}{Packet4cf}}> \{}
\DoxyCodeLine{54   \textcolor{keyword}{typedef} std::complex<float> type;}
\DoxyCodeLine{55   \textcolor{keyword}{typedef} \mbox{\hyperlink{structEigen_1_1internal_1_1Packet2cf}{Packet2cf}} \mbox{\hyperlink{structEigen_1_1internal_1_1Packet2cf}{half}};}
\DoxyCodeLine{56   \textcolor{keyword}{typedef} Packet8f as\_real;}
\DoxyCodeLine{57   \textcolor{keyword}{enum} \{}
\DoxyCodeLine{58     size=4,}
\DoxyCodeLine{59     alignment=\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a8a380b1cd0c3e5a6cceac06f8235157a}{Aligned32}},}
\DoxyCodeLine{60     vectorizable=\textcolor{keyword}{true},}
\DoxyCodeLine{61     masked\_load\_available=\textcolor{keyword}{false},}
\DoxyCodeLine{62     masked\_store\_available=\textcolor{keyword}{false}}
\DoxyCodeLine{63   \};}
\DoxyCodeLine{64 \};}
\DoxyCodeLine{65 }
\DoxyCodeLine{66 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \mbox{\hyperlink{structEigen_1_1internal_1_1Packet4cf}{Packet4cf}} padd<Packet4cf>(\textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1internal_1_1Packet4cf}{Packet4cf}}\& a, \textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1internal_1_1Packet4cf}{Packet4cf}}\& b) \{ \textcolor{keywordflow}{return} \mbox{\hyperlink{structEigen_1_1internal_1_1Packet4cf}{Packet4cf}}(\_mm256\_add\_ps(a.v,b.v)); \}}
\DoxyCodeLine{67 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet4cf psub<Packet4cf>(\textcolor{keyword}{const} Packet4cf\& a, \textcolor{keyword}{const} Packet4cf\& b) \{ \textcolor{keywordflow}{return} Packet4cf(\_mm256\_sub\_ps(a.v,b.v)); \}}
\DoxyCodeLine{68 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet4cf pnegate(\textcolor{keyword}{const} Packet4cf\& a)}
\DoxyCodeLine{69 \{}
\DoxyCodeLine{70   \textcolor{keywordflow}{return} Packet4cf(pnegate(a.v));}
\DoxyCodeLine{71 \}}
\DoxyCodeLine{72 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet4cf pconj(\textcolor{keyword}{const} Packet4cf\& a)}
\DoxyCodeLine{73 \{}
\DoxyCodeLine{74   \textcolor{keyword}{const} \_\_m256 mask = \_mm256\_castsi256\_ps(\_mm256\_setr\_epi32(0x00000000,0x80000000,0x00000000,0x80000000,0x00000000,0x80000000,0x00000000,0x80000000));}
\DoxyCodeLine{75   \textcolor{keywordflow}{return} Packet4cf(\_mm256\_xor\_ps(a.v,mask));}
\DoxyCodeLine{76 \}}
\DoxyCodeLine{77 }
\DoxyCodeLine{78 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet4cf pmul<Packet4cf>(\textcolor{keyword}{const} Packet4cf\& a, \textcolor{keyword}{const} Packet4cf\& b)}
\DoxyCodeLine{79 \{}
\DoxyCodeLine{80   \_\_m256 tmp1 = \_mm256\_mul\_ps(\_mm256\_moveldup\_ps(a.v), b.v);}
\DoxyCodeLine{81   \_\_m256 tmp2 = \_mm256\_mul\_ps(\_mm256\_movehdup\_ps(a.v), \_mm256\_permute\_ps(b.v, \_MM\_SHUFFLE(2,3,0,1)));}
\DoxyCodeLine{82   \_\_m256 result = \_mm256\_addsub\_ps(tmp1, tmp2);}
\DoxyCodeLine{83   \textcolor{keywordflow}{return} Packet4cf(result);}
\DoxyCodeLine{84 \}}
\DoxyCodeLine{85 }
\DoxyCodeLine{86 \textcolor{keyword}{template} <>}
\DoxyCodeLine{87 EIGEN\_STRONG\_INLINE Packet4cf pcmp\_eq(\textcolor{keyword}{const} Packet4cf\& a, \textcolor{keyword}{const} Packet4cf\& b) \{}
\DoxyCodeLine{88   \_\_m256 eq = \_mm256\_cmp\_ps(a.v, b.v, \_CMP\_EQ\_OQ);}
\DoxyCodeLine{89   \textcolor{keywordflow}{return} Packet4cf(\_mm256\_and\_ps(eq, \_mm256\_permute\_ps(eq, 0xb1)));}
\DoxyCodeLine{90 \}}
\DoxyCodeLine{91 }
\DoxyCodeLine{92 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet4cf ptrue<Packet4cf>(\textcolor{keyword}{const} Packet4cf\& a) \{ \textcolor{keywordflow}{return} Packet4cf(ptrue(Packet8f(a.v))); \}}
\DoxyCodeLine{93 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet4cf pand   <Packet4cf>(\textcolor{keyword}{const} Packet4cf\& a, \textcolor{keyword}{const} Packet4cf\& b) \{ \textcolor{keywordflow}{return} Packet4cf(\_mm256\_and\_ps(a.v,b.v)); \}}
\DoxyCodeLine{94 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet4cf por    <Packet4cf>(\textcolor{keyword}{const} Packet4cf\& a, \textcolor{keyword}{const} Packet4cf\& b) \{ \textcolor{keywordflow}{return} Packet4cf(\_mm256\_or\_ps(a.v,b.v)); \}}
\DoxyCodeLine{95 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet4cf pxor   <Packet4cf>(\textcolor{keyword}{const} Packet4cf\& a, \textcolor{keyword}{const} Packet4cf\& b) \{ \textcolor{keywordflow}{return} Packet4cf(\_mm256\_xor\_ps(a.v,b.v)); \}}
\DoxyCodeLine{96 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet4cf pandnot<Packet4cf>(\textcolor{keyword}{const} Packet4cf\& a, \textcolor{keyword}{const} Packet4cf\& b) \{ \textcolor{keywordflow}{return} Packet4cf(\_mm256\_andnot\_ps(b.v,a.v)); \}}
\DoxyCodeLine{97 }
\DoxyCodeLine{98 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet4cf pload <Packet4cf>(\textcolor{keyword}{const} std::complex<float>* from) \{ EIGEN\_DEBUG\_ALIGNED\_LOAD \textcolor{keywordflow}{return} Packet4cf(pload<Packet8f>(\&numext::real\_ref(*from))); \}}
\DoxyCodeLine{99 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet4cf ploadu<Packet4cf>(\textcolor{keyword}{const} std::complex<float>* from) \{ EIGEN\_DEBUG\_UNALIGNED\_LOAD \textcolor{keywordflow}{return} Packet4cf(ploadu<Packet8f>(\&numext::real\_ref(*from))); \}}
\DoxyCodeLine{100 }
\DoxyCodeLine{101 }
\DoxyCodeLine{102 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet4cf pset1<Packet4cf>(\textcolor{keyword}{const} std::complex<float>\& from)}
\DoxyCodeLine{103 \{}
\DoxyCodeLine{104   \textcolor{keyword}{const} \textcolor{keywordtype}{float} re = std::real(from);}
\DoxyCodeLine{105   \textcolor{keyword}{const} \textcolor{keywordtype}{float} im = std::imag(from);}
\DoxyCodeLine{106   \textcolor{keywordflow}{return} Packet4cf(\_mm256\_set\_ps(im, re, im, re, im, re, im, re));}
\DoxyCodeLine{107 \}}
\DoxyCodeLine{108 }
\DoxyCodeLine{109 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet4cf ploaddup<Packet4cf>(\textcolor{keyword}{const} std::complex<float>* from)}
\DoxyCodeLine{110 \{}
\DoxyCodeLine{111   \textcolor{comment}{// FIXME The following might be optimized using \_mm256\_movedup\_pd}}
\DoxyCodeLine{112   Packet2cf a = ploaddup<Packet2cf>(from);}
\DoxyCodeLine{113   Packet2cf b = ploaddup<Packet2cf>(from+1);}
\DoxyCodeLine{114   \textcolor{keywordflow}{return}  Packet4cf(\_mm256\_insertf128\_ps(\_mm256\_castps128\_ps256(a.v), b.v, 1));}
\DoxyCodeLine{115 \}}
\DoxyCodeLine{116 }
\DoxyCodeLine{117 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} pstore <std::complex<float> >(std::complex<float>* to, \textcolor{keyword}{const} Packet4cf\& from) \{ EIGEN\_DEBUG\_ALIGNED\_STORE pstore(\&numext::real\_ref(*to), from.v); \}}
\DoxyCodeLine{118 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} pstoreu<std::complex<float> >(std::complex<float>* to, \textcolor{keyword}{const} Packet4cf\& from) \{ EIGEN\_DEBUG\_UNALIGNED\_STORE pstoreu(\&numext::real\_ref(*to), from.v); \}}
\DoxyCodeLine{119 }
\DoxyCodeLine{120 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} Packet4cf pgather<std::complex<float>, Packet4cf>(\textcolor{keyword}{const} std::complex<float>* from, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} stride)}
\DoxyCodeLine{121 \{}
\DoxyCodeLine{122   \textcolor{keywordflow}{return} Packet4cf(\_mm256\_set\_ps(std::imag(from[3*stride]), std::real(from[3*stride]),}
\DoxyCodeLine{123                                  std::imag(from[2*stride]), std::real(from[2*stride]),}
\DoxyCodeLine{124                                  std::imag(from[1*stride]), std::real(from[1*stride]),}
\DoxyCodeLine{125                                  std::imag(from[0*stride]), std::real(from[0*stride])));}
\DoxyCodeLine{126 \}}
\DoxyCodeLine{127 }
\DoxyCodeLine{128 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{void} pscatter<std::complex<float>, Packet4cf>(std::complex<float>* to, \textcolor{keyword}{const} Packet4cf\& from, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} stride)}
\DoxyCodeLine{129 \{}
\DoxyCodeLine{130   \_\_m128 low = \_mm256\_extractf128\_ps(from.v, 0);}
\DoxyCodeLine{131   to[stride*0] = std::complex<float>(\_mm\_cvtss\_f32(\_mm\_shuffle\_ps(low, low, 0)),}
\DoxyCodeLine{132                                      \_mm\_cvtss\_f32(\_mm\_shuffle\_ps(low, low, 1)));}
\DoxyCodeLine{133   to[stride*1] = std::complex<float>(\_mm\_cvtss\_f32(\_mm\_shuffle\_ps(low, low, 2)),}
\DoxyCodeLine{134                                      \_mm\_cvtss\_f32(\_mm\_shuffle\_ps(low, low, 3)));}
\DoxyCodeLine{135 }
\DoxyCodeLine{136   \_\_m128 high = \_mm256\_extractf128\_ps(from.v, 1);}
\DoxyCodeLine{137   to[stride*2] = std::complex<float>(\_mm\_cvtss\_f32(\_mm\_shuffle\_ps(high, high, 0)),}
\DoxyCodeLine{138                                      \_mm\_cvtss\_f32(\_mm\_shuffle\_ps(high, high, 1)));}
\DoxyCodeLine{139   to[stride*3] = std::complex<float>(\_mm\_cvtss\_f32(\_mm\_shuffle\_ps(high, high, 2)),}
\DoxyCodeLine{140                                      \_mm\_cvtss\_f32(\_mm\_shuffle\_ps(high, high, 3)));}
\DoxyCodeLine{141 }
\DoxyCodeLine{142 \}}
\DoxyCodeLine{143 }
\DoxyCodeLine{144 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE std::complex<float>  pfirst<Packet4cf>(\textcolor{keyword}{const} Packet4cf\& a)}
\DoxyCodeLine{145 \{}
\DoxyCodeLine{146   \textcolor{keywordflow}{return} pfirst(Packet2cf(\_mm256\_castps256\_ps128(a.v)));}
\DoxyCodeLine{147 \}}
\DoxyCodeLine{148 }
\DoxyCodeLine{149 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet4cf preverse(\textcolor{keyword}{const} Packet4cf\& a) \{}
\DoxyCodeLine{150   \_\_m128 low  = \_mm256\_extractf128\_ps(a.v, 0);}
\DoxyCodeLine{151   \_\_m128 high = \_mm256\_extractf128\_ps(a.v, 1);}
\DoxyCodeLine{152   \_\_m128d lowd  = \_mm\_castps\_pd(low);}
\DoxyCodeLine{153   \_\_m128d highd = \_mm\_castps\_pd(high);}
\DoxyCodeLine{154   low  = \_mm\_castpd\_ps(\_mm\_shuffle\_pd(lowd,lowd,0x1));}
\DoxyCodeLine{155   high = \_mm\_castpd\_ps(\_mm\_shuffle\_pd(highd,highd,0x1));}
\DoxyCodeLine{156   \_\_m256 result = \_mm256\_setzero\_ps();}
\DoxyCodeLine{157   result = \_mm256\_insertf128\_ps(result, low, 1);}
\DoxyCodeLine{158   result = \_mm256\_insertf128\_ps(result, high, 0);}
\DoxyCodeLine{159   \textcolor{keywordflow}{return} Packet4cf(result);}
\DoxyCodeLine{160 \}}
\DoxyCodeLine{161 }
\DoxyCodeLine{162 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE std::complex<float> predux<Packet4cf>(\textcolor{keyword}{const} Packet4cf\& a)}
\DoxyCodeLine{163 \{}
\DoxyCodeLine{164   \textcolor{keywordflow}{return} predux(padd(Packet2cf(\_mm256\_extractf128\_ps(a.v,0)),}
\DoxyCodeLine{165                      Packet2cf(\_mm256\_extractf128\_ps(a.v,1))));}
\DoxyCodeLine{166 \}}
\DoxyCodeLine{167 }
\DoxyCodeLine{168 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE std::complex<float> predux\_mul<Packet4cf>(\textcolor{keyword}{const} Packet4cf\& a)}
\DoxyCodeLine{169 \{}
\DoxyCodeLine{170   \textcolor{keywordflow}{return} predux\_mul(pmul(Packet2cf(\_mm256\_extractf128\_ps(a.v, 0)),}
\DoxyCodeLine{171                          Packet2cf(\_mm256\_extractf128\_ps(a.v, 1))));}
\DoxyCodeLine{172 \}}
\DoxyCodeLine{173 }
\DoxyCodeLine{174 }
\DoxyCodeLine{175 EIGEN\_MAKE\_CONJ\_HELPER\_CPLX\_REAL(Packet4cf,Packet8f)}
\DoxyCodeLine{176 }
\DoxyCodeLine{177 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet4cf pdiv<Packet4cf>(\textcolor{keyword}{const} Packet4cf\& a, \textcolor{keyword}{const} Packet4cf\& b)}
\DoxyCodeLine{178 \{}
\DoxyCodeLine{179   \textcolor{keywordflow}{return} pdiv\_complex(a, b);}
\DoxyCodeLine{180 \}}
\DoxyCodeLine{181 }
\DoxyCodeLine{182 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet4cf pcplxflip<Packet4cf>(\textcolor{keyword}{const} Packet4cf\& x)}
\DoxyCodeLine{183 \{}
\DoxyCodeLine{184   \textcolor{keywordflow}{return} Packet4cf(\_mm256\_shuffle\_ps(x.v, x.v, \_MM\_SHUFFLE(2, 3, 0 ,1)));}
\DoxyCodeLine{185 \}}
\DoxyCodeLine{186 }
\DoxyCodeLine{187 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ double -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{188 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1Packet2cd}{Packet2cd}}}
\DoxyCodeLine{189 \{}
\DoxyCodeLine{190   EIGEN\_STRONG\_INLINE \mbox{\hyperlink{structEigen_1_1internal_1_1Packet2cd}{Packet2cd}}() \{\}}
\DoxyCodeLine{191   EIGEN\_STRONG\_INLINE \textcolor{keyword}{explicit} \mbox{\hyperlink{structEigen_1_1internal_1_1Packet2cd}{Packet2cd}}(\textcolor{keyword}{const} \_\_m256d\& a) : v(a) \{\}}
\DoxyCodeLine{192   \_\_m256d  v;}
\DoxyCodeLine{193 \};}
\DoxyCodeLine{194 }
\DoxyCodeLine{195 \textcolor{preprocessor}{\#ifndef EIGEN\_VECTORIZE\_AVX512}}
\DoxyCodeLine{196 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1packet__traits}{packet\_traits}}<std::complex<double> >  : \mbox{\hyperlink{structEigen_1_1internal_1_1default__packet__traits}{default\_packet\_traits}}}
\DoxyCodeLine{197 \{}
\DoxyCodeLine{198   \textcolor{keyword}{typedef} \mbox{\hyperlink{structEigen_1_1internal_1_1Packet2cd}{Packet2cd}} \mbox{\hyperlink{structEigen_1_1internal_1_1Packet2cd}{type}};}
\DoxyCodeLine{199   \textcolor{keyword}{typedef} \mbox{\hyperlink{structEigen_1_1internal_1_1Packet1cd}{Packet1cd}} \mbox{\hyperlink{structEigen_1_1internal_1_1Packet1cd}{half}};}
\DoxyCodeLine{200   \textcolor{keyword}{enum} \{}
\DoxyCodeLine{201     Vectorizable = 1,}
\DoxyCodeLine{202     AlignedOnScalar = 0,}
\DoxyCodeLine{203     size = 2,}
\DoxyCodeLine{204     HasHalfPacket = 1,}
\DoxyCodeLine{205 }
\DoxyCodeLine{206     HasAdd    = 1,}
\DoxyCodeLine{207     HasSub    = 1,}
\DoxyCodeLine{208     HasMul    = 1,}
\DoxyCodeLine{209     HasDiv    = 1,}
\DoxyCodeLine{210     HasNegate = 1,}
\DoxyCodeLine{211     HasSqrt   = 1,}
\DoxyCodeLine{212     HasAbs    = 0,}
\DoxyCodeLine{213     HasAbs2   = 0,}
\DoxyCodeLine{214     HasMin    = 0,}
\DoxyCodeLine{215     HasMax    = 0,}
\DoxyCodeLine{216     HasSetLinear = 0}
\DoxyCodeLine{217   \};}
\DoxyCodeLine{218 \};}
\DoxyCodeLine{219 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{220 }
\DoxyCodeLine{221 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits}}<\mbox{\hyperlink{structEigen_1_1internal_1_1Packet2cd}{Packet2cd}}> \{}
\DoxyCodeLine{222   \textcolor{keyword}{typedef} std::complex<double> type;}
\DoxyCodeLine{223   \textcolor{keyword}{typedef} \mbox{\hyperlink{structEigen_1_1internal_1_1Packet1cd}{Packet1cd}} \mbox{\hyperlink{structEigen_1_1internal_1_1Packet1cd}{half}};}
\DoxyCodeLine{224   \textcolor{keyword}{typedef} Packet4d as\_real;}
\DoxyCodeLine{225   \textcolor{keyword}{enum} \{}
\DoxyCodeLine{226     size=2,}
\DoxyCodeLine{227     alignment=\mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a8a380b1cd0c3e5a6cceac06f8235157a}{Aligned32}},}
\DoxyCodeLine{228     vectorizable=\textcolor{keyword}{true},}
\DoxyCodeLine{229     masked\_load\_available=\textcolor{keyword}{false},}
\DoxyCodeLine{230     masked\_store\_available=\textcolor{keyword}{false}}
\DoxyCodeLine{231   \};}
\DoxyCodeLine{232 \};}
\DoxyCodeLine{233 }
\DoxyCodeLine{234 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \mbox{\hyperlink{structEigen_1_1internal_1_1Packet2cd}{Packet2cd}} padd<Packet2cd>(\textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1internal_1_1Packet2cd}{Packet2cd}}\& a, \textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1internal_1_1Packet2cd}{Packet2cd}}\& b) \{ \textcolor{keywordflow}{return} \mbox{\hyperlink{structEigen_1_1internal_1_1Packet2cd}{Packet2cd}}(\_mm256\_add\_pd(a.v,b.v)); \}}
\DoxyCodeLine{235 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet2cd psub<Packet2cd>(\textcolor{keyword}{const} Packet2cd\& a, \textcolor{keyword}{const} Packet2cd\& b) \{ \textcolor{keywordflow}{return} Packet2cd(\_mm256\_sub\_pd(a.v,b.v)); \}}
\DoxyCodeLine{236 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet2cd pnegate(\textcolor{keyword}{const} Packet2cd\& a) \{ \textcolor{keywordflow}{return} Packet2cd(pnegate(a.v)); \}}
\DoxyCodeLine{237 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet2cd pconj(\textcolor{keyword}{const} Packet2cd\& a)}
\DoxyCodeLine{238 \{}
\DoxyCodeLine{239   \textcolor{keyword}{const} \_\_m256d mask = \_mm256\_castsi256\_pd(\_mm256\_set\_epi32(0x80000000,0x0,0x0,0x0,0x80000000,0x0,0x0,0x0));}
\DoxyCodeLine{240   \textcolor{keywordflow}{return} Packet2cd(\_mm256\_xor\_pd(a.v,mask));}
\DoxyCodeLine{241 \}}
\DoxyCodeLine{242 }
\DoxyCodeLine{243 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet2cd pmul<Packet2cd>(\textcolor{keyword}{const} Packet2cd\& a, \textcolor{keyword}{const} Packet2cd\& b)}
\DoxyCodeLine{244 \{}
\DoxyCodeLine{245   \_\_m256d tmp1 = \_mm256\_shuffle\_pd(a.v,a.v,0x0);}
\DoxyCodeLine{246   \_\_m256d even = \_mm256\_mul\_pd(tmp1, b.v);}
\DoxyCodeLine{247   \_\_m256d tmp2 = \_mm256\_shuffle\_pd(a.v,a.v,0xF);}
\DoxyCodeLine{248   \_\_m256d tmp3 = \_mm256\_shuffle\_pd(b.v,b.v,0x5);}
\DoxyCodeLine{249   \_\_m256d odd  = \_mm256\_mul\_pd(tmp2, tmp3);}
\DoxyCodeLine{250   \textcolor{keywordflow}{return} Packet2cd(\_mm256\_addsub\_pd(even, odd));}
\DoxyCodeLine{251 \}}
\DoxyCodeLine{252 }
\DoxyCodeLine{253 \textcolor{keyword}{template} <>}
\DoxyCodeLine{254 EIGEN\_STRONG\_INLINE Packet2cd pcmp\_eq(\textcolor{keyword}{const} Packet2cd\& a, \textcolor{keyword}{const} Packet2cd\& b) \{}
\DoxyCodeLine{255   \_\_m256d eq = \_mm256\_cmp\_pd(a.v, b.v, \_CMP\_EQ\_OQ);}
\DoxyCodeLine{256   \textcolor{keywordflow}{return} Packet2cd(pand(eq, \_mm256\_permute\_pd(eq, 0x5)));}
\DoxyCodeLine{257 \}}
\DoxyCodeLine{258 }
\DoxyCodeLine{259 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet2cd ptrue<Packet2cd>(\textcolor{keyword}{const} Packet2cd\& a) \{ \textcolor{keywordflow}{return} Packet2cd(ptrue(Packet4d(a.v))); \}}
\DoxyCodeLine{260 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet2cd pand   <Packet2cd>(\textcolor{keyword}{const} Packet2cd\& a, \textcolor{keyword}{const} Packet2cd\& b) \{ \textcolor{keywordflow}{return} Packet2cd(\_mm256\_and\_pd(a.v,b.v)); \}}
\DoxyCodeLine{261 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet2cd por    <Packet2cd>(\textcolor{keyword}{const} Packet2cd\& a, \textcolor{keyword}{const} Packet2cd\& b) \{ \textcolor{keywordflow}{return} Packet2cd(\_mm256\_or\_pd(a.v,b.v)); \}}
\DoxyCodeLine{262 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet2cd pxor   <Packet2cd>(\textcolor{keyword}{const} Packet2cd\& a, \textcolor{keyword}{const} Packet2cd\& b) \{ \textcolor{keywordflow}{return} Packet2cd(\_mm256\_xor\_pd(a.v,b.v)); \}}
\DoxyCodeLine{263 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet2cd pandnot<Packet2cd>(\textcolor{keyword}{const} Packet2cd\& a, \textcolor{keyword}{const} Packet2cd\& b) \{ \textcolor{keywordflow}{return} Packet2cd(\_mm256\_andnot\_pd(b.v,a.v)); \}}
\DoxyCodeLine{264 }
\DoxyCodeLine{265 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet2cd pload <Packet2cd>(\textcolor{keyword}{const} std::complex<double>* from)}
\DoxyCodeLine{266 \{ EIGEN\_DEBUG\_ALIGNED\_LOAD \textcolor{keywordflow}{return} Packet2cd(pload<Packet4d>((\textcolor{keyword}{const} \textcolor{keywordtype}{double}*)from)); \}}
\DoxyCodeLine{267 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet2cd ploadu<Packet2cd>(\textcolor{keyword}{const} std::complex<double>* from)}
\DoxyCodeLine{268 \{ EIGEN\_DEBUG\_UNALIGNED\_LOAD \textcolor{keywordflow}{return} Packet2cd(ploadu<Packet4d>((\textcolor{keyword}{const} \textcolor{keywordtype}{double}*)from)); \}}
\DoxyCodeLine{269 }
\DoxyCodeLine{270 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet2cd pset1<Packet2cd>(\textcolor{keyword}{const} std::complex<double>\& from)}
\DoxyCodeLine{271 \{}
\DoxyCodeLine{272   \textcolor{comment}{// in case casting to a \_\_m128d* is really not safe, then we can still fallback to this version: (much slower though)}}
\DoxyCodeLine{273 \textcolor{comment}{//   return Packet2cd(\_mm256\_loadu2\_m128d((const double*)\&from,(const double*)\&from));}}
\DoxyCodeLine{274     \textcolor{keywordflow}{return} Packet2cd(\_mm256\_broadcast\_pd((\textcolor{keyword}{const} \_\_m128d*)(\textcolor{keyword}{const} \textcolor{keywordtype}{void}*)\&from));}
\DoxyCodeLine{275 \}}
\DoxyCodeLine{276 }
\DoxyCodeLine{277 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet2cd ploaddup<Packet2cd>(\textcolor{keyword}{const} std::complex<double>* from) \{ \textcolor{keywordflow}{return} pset1<Packet2cd>(*from); \}}
\DoxyCodeLine{278 }
\DoxyCodeLine{279 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} pstore <std::complex<double> >(std::complex<double> *   to, \textcolor{keyword}{const} Packet2cd\& from) \{ EIGEN\_DEBUG\_ALIGNED\_STORE pstore((\textcolor{keywordtype}{double}*)to, from.v); \}}
\DoxyCodeLine{280 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} pstoreu<std::complex<double> >(std::complex<double> *   to, \textcolor{keyword}{const} Packet2cd\& from) \{ EIGEN\_DEBUG\_UNALIGNED\_STORE pstoreu((\textcolor{keywordtype}{double}*)to, from.v); \}}
\DoxyCodeLine{281 }
\DoxyCodeLine{282 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} Packet2cd pgather<std::complex<double>, Packet2cd>(\textcolor{keyword}{const} std::complex<double>* from, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} stride)}
\DoxyCodeLine{283 \{}
\DoxyCodeLine{284   \textcolor{keywordflow}{return} Packet2cd(\_mm256\_set\_pd(std::imag(from[1*stride]), std::real(from[1*stride]),}
\DoxyCodeLine{285                  std::imag(from[0*stride]), std::real(from[0*stride])));}
\DoxyCodeLine{286 \}}
\DoxyCodeLine{287 }
\DoxyCodeLine{288 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{void} pscatter<std::complex<double>, Packet2cd>(std::complex<double>* to, \textcolor{keyword}{const} Packet2cd\& from, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} stride)}
\DoxyCodeLine{289 \{}
\DoxyCodeLine{290   \_\_m128d low = \_mm256\_extractf128\_pd(from.v, 0);}
\DoxyCodeLine{291   to[stride*0] = std::complex<double>(\_mm\_cvtsd\_f64(low), \_mm\_cvtsd\_f64(\_mm\_shuffle\_pd(low, low, 1)));}
\DoxyCodeLine{292   \_\_m128d high = \_mm256\_extractf128\_pd(from.v, 1);}
\DoxyCodeLine{293   to[stride*1] = std::complex<double>(\_mm\_cvtsd\_f64(high), \_mm\_cvtsd\_f64(\_mm\_shuffle\_pd(high, high, 1)));}
\DoxyCodeLine{294 \}}
\DoxyCodeLine{295 }
\DoxyCodeLine{296 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE std::complex<double> pfirst<Packet2cd>(\textcolor{keyword}{const} Packet2cd\& a)}
\DoxyCodeLine{297 \{}
\DoxyCodeLine{298   \_\_m128d low = \_mm256\_extractf128\_pd(a.v, 0);}
\DoxyCodeLine{299   EIGEN\_ALIGN16 \textcolor{keywordtype}{double} res[2];}
\DoxyCodeLine{300   \_mm\_store\_pd(res, low);}
\DoxyCodeLine{301   \textcolor{keywordflow}{return} std::complex<double>(res[0],res[1]);}
\DoxyCodeLine{302 \}}
\DoxyCodeLine{303 }
\DoxyCodeLine{304 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet2cd preverse(\textcolor{keyword}{const} Packet2cd\& a) \{}
\DoxyCodeLine{305   \_\_m256d result = \_mm256\_permute2f128\_pd(a.v, a.v, 1);}
\DoxyCodeLine{306   \textcolor{keywordflow}{return} Packet2cd(result);}
\DoxyCodeLine{307 \}}
\DoxyCodeLine{308 }
\DoxyCodeLine{309 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE std::complex<double> predux<Packet2cd>(\textcolor{keyword}{const} Packet2cd\& a)}
\DoxyCodeLine{310 \{}
\DoxyCodeLine{311   \textcolor{keywordflow}{return} predux(padd(Packet1cd(\_mm256\_extractf128\_pd(a.v,0)),}
\DoxyCodeLine{312                      Packet1cd(\_mm256\_extractf128\_pd(a.v,1))));}
\DoxyCodeLine{313 \}}
\DoxyCodeLine{314 }
\DoxyCodeLine{315 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE std::complex<double> predux\_mul<Packet2cd>(\textcolor{keyword}{const} Packet2cd\& a)}
\DoxyCodeLine{316 \{}
\DoxyCodeLine{317   \textcolor{keywordflow}{return} predux(pmul(Packet1cd(\_mm256\_extractf128\_pd(a.v,0)),}
\DoxyCodeLine{318                      Packet1cd(\_mm256\_extractf128\_pd(a.v,1))));}
\DoxyCodeLine{319 \}}
\DoxyCodeLine{320 }
\DoxyCodeLine{321 EIGEN\_MAKE\_CONJ\_HELPER\_CPLX\_REAL(Packet2cd,Packet4d)}
\DoxyCodeLine{322 }
\DoxyCodeLine{323 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet2cd pdiv<Packet2cd>(\textcolor{keyword}{const} Packet2cd\& a, \textcolor{keyword}{const} Packet2cd\& b)}
\DoxyCodeLine{324 \{}
\DoxyCodeLine{325   \textcolor{keywordflow}{return} pdiv\_complex(a, b);}
\DoxyCodeLine{326 \}}
\DoxyCodeLine{327 }
\DoxyCodeLine{328 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet2cd pcplxflip<Packet2cd>(\textcolor{keyword}{const} Packet2cd\& x)}
\DoxyCodeLine{329 \{}
\DoxyCodeLine{330   \textcolor{keywordflow}{return} Packet2cd(\_mm256\_shuffle\_pd(x.v, x.v, 0x5));}
\DoxyCodeLine{331 \}}
\DoxyCodeLine{332 }
\DoxyCodeLine{333 EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{334 ptranspose(PacketBlock<Packet4cf,4>\& kernel) \{}
\DoxyCodeLine{335   \_\_m256d P0 = \_mm256\_castps\_pd(kernel.packet[0].v);}
\DoxyCodeLine{336   \_\_m256d P1 = \_mm256\_castps\_pd(kernel.packet[1].v);}
\DoxyCodeLine{337   \_\_m256d P2 = \_mm256\_castps\_pd(kernel.packet[2].v);}
\DoxyCodeLine{338   \_\_m256d P3 = \_mm256\_castps\_pd(kernel.packet[3].v);}
\DoxyCodeLine{339 }
\DoxyCodeLine{340   \_\_m256d T0 = \_mm256\_shuffle\_pd(P0, P1, 15);}
\DoxyCodeLine{341   \_\_m256d T1 = \_mm256\_shuffle\_pd(P0, P1, 0);}
\DoxyCodeLine{342   \_\_m256d T2 = \_mm256\_shuffle\_pd(P2, P3, 15);}
\DoxyCodeLine{343   \_\_m256d T3 = \_mm256\_shuffle\_pd(P2, P3, 0);}
\DoxyCodeLine{344 }
\DoxyCodeLine{345   kernel.packet[1].v = \_mm256\_castpd\_ps(\_mm256\_permute2f128\_pd(T0, T2, 32));}
\DoxyCodeLine{346   kernel.packet[3].v = \_mm256\_castpd\_ps(\_mm256\_permute2f128\_pd(T0, T2, 49));}
\DoxyCodeLine{347   kernel.packet[0].v = \_mm256\_castpd\_ps(\_mm256\_permute2f128\_pd(T1, T3, 32));}
\DoxyCodeLine{348   kernel.packet[2].v = \_mm256\_castpd\_ps(\_mm256\_permute2f128\_pd(T1, T3, 49));}
\DoxyCodeLine{349 \}}
\DoxyCodeLine{350 }
\DoxyCodeLine{351 EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{352 ptranspose(PacketBlock<Packet2cd,2>\& kernel) \{}
\DoxyCodeLine{353   \_\_m256d tmp = \_mm256\_permute2f128\_pd(kernel.packet[0].v, kernel.packet[1].v, 0+(2<<4));}
\DoxyCodeLine{354   kernel.packet[1].v = \_mm256\_permute2f128\_pd(kernel.packet[0].v, kernel.packet[1].v, 1+(3<<4));}
\DoxyCodeLine{355  kernel.packet[0].v = tmp;}
\DoxyCodeLine{356 \}}
\DoxyCodeLine{357 }
\DoxyCodeLine{358 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet2cd psqrt<Packet2cd>(\textcolor{keyword}{const} Packet2cd\& a) \{}
\DoxyCodeLine{359   \textcolor{keywordflow}{return} psqrt\_complex<Packet2cd>(a);}
\DoxyCodeLine{360 \}}
\DoxyCodeLine{361 }
\DoxyCodeLine{362 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet4cf psqrt<Packet4cf>(\textcolor{keyword}{const} Packet4cf\& a) \{}
\DoxyCodeLine{363   \textcolor{keywordflow}{return} psqrt\_complex<Packet4cf>(a);}
\DoxyCodeLine{364 \}}
\DoxyCodeLine{365 }
\DoxyCodeLine{366 \} \textcolor{comment}{// end namespace internal}}
\DoxyCodeLine{367 }
\DoxyCodeLine{368 \} \textcolor{comment}{// end namespace Eigen}}
\DoxyCodeLine{369 }
\DoxyCodeLine{370 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// EIGEN\_COMPLEX\_AVX\_H}}

\end{DoxyCode}
