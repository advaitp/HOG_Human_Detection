\hypertarget{GeneralMatrixVector_8h_source}{}\doxysection{General\+Matrix\+Vector.\+h}
\label{GeneralMatrixVector_8h_source}\index{include/Eigen/src/Core/products/GeneralMatrixVector.h@{include/Eigen/src/Core/products/GeneralMatrixVector.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}}
\DoxyCodeLine{2 \textcolor{comment}{// for linear algebra.}}
\DoxyCodeLine{3 \textcolor{comment}{//}}
\DoxyCodeLine{4 \textcolor{comment}{// Copyright (C) 2008-\/2016 Gael Guennebaud <gael.guennebaud@inria.fr>}}
\DoxyCodeLine{5 \textcolor{comment}{//}}
\DoxyCodeLine{6 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}}
\DoxyCodeLine{7 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}}
\DoxyCodeLine{8 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{preprocessor}{\#ifndef EIGEN\_GENERAL\_MATRIX\_VECTOR\_H}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#define EIGEN\_GENERAL\_MATRIX\_VECTOR\_H}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include "{}../InternalHeaderCheck.h"{}}}
\DoxyCodeLine{14 }
\DoxyCodeLine{15 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceEigen}{Eigen}} \{}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{keyword}{namespace }internal \{}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{keyword}{enum} GEMVPacketSizeType \{}
\DoxyCodeLine{20   GEMVPacketFull = 0,}
\DoxyCodeLine{21   GEMVPacketHalf,}
\DoxyCodeLine{22   GEMVPacketQuarter}
\DoxyCodeLine{23 \};}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{keyword}{template} <\textcolor{keywordtype}{int} N, \textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2, \textcolor{keyword}{typename} T3>}
\DoxyCodeLine{26 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1gemv__packet__cond}{gemv\_packet\_cond}} \{ \textcolor{keyword}{typedef} T3 type; \};}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2, \textcolor{keyword}{typename} T3>}
\DoxyCodeLine{29 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1gemv__packet__cond}{gemv\_packet\_cond}}<GEMVPacketFull, T1, T2, T3> \{ \textcolor{keyword}{typedef} T1 type; \};}
\DoxyCodeLine{30 }
\DoxyCodeLine{31 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2, \textcolor{keyword}{typename} T3>}
\DoxyCodeLine{32 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1gemv__packet__cond}{gemv\_packet\_cond}}<GEMVPacketHalf, T1, T2, T3> \{ \textcolor{keyword}{typedef} T2 type; \};}
\DoxyCodeLine{33 }
\DoxyCodeLine{34 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsScalar, \textcolor{keyword}{typename} RhsScalar, \textcolor{keywordtype}{int} PacketSize\_=GEMVPacketFull>}
\DoxyCodeLine{35 \textcolor{keyword}{class }\mbox{\hyperlink{classEigen_1_1internal_1_1gemv__traits}{gemv\_traits}}}
\DoxyCodeLine{36 \{}
\DoxyCodeLine{37   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1ScalarBinaryOpTraits}{ScalarBinaryOpTraits<LhsScalar, RhsScalar>::ReturnType}} ResScalar;}
\DoxyCodeLine{38 }
\DoxyCodeLine{39 \textcolor{preprocessor}{\#define PACKET\_DECL\_COND\_PREFIX(prefix, name, packet\_size)                        \(\backslash\)}}
\DoxyCodeLine{40 \textcolor{preprocessor}{  typedef typename gemv\_packet\_cond<packet\_size,                                  \(\backslash\)}}
\DoxyCodeLine{41 \textcolor{preprocessor}{                                    typename packet\_traits<name \#\# Scalar>::type, \(\backslash\)}}
\DoxyCodeLine{42 \textcolor{preprocessor}{                                    typename packet\_traits<name \#\# Scalar>::half, \(\backslash\)}}
\DoxyCodeLine{43 \textcolor{preprocessor}{                                    typename unpacket\_traits<typename packet\_traits<name \#\# Scalar>::half>::half>::type \(\backslash\)}}
\DoxyCodeLine{44 \textcolor{preprocessor}{  prefix \#\# name \#\# Packet}}
\DoxyCodeLine{45 }
\DoxyCodeLine{46   PACKET\_DECL\_COND\_PREFIX(\_, Lhs, PacketSize\_);}
\DoxyCodeLine{47   PACKET\_DECL\_COND\_PREFIX(\_, Rhs, PacketSize\_);}
\DoxyCodeLine{48   PACKET\_DECL\_COND\_PREFIX(\_, Res, PacketSize\_);}
\DoxyCodeLine{49 \textcolor{preprocessor}{\#undef PACKET\_DECL\_COND\_PREFIX}}
\DoxyCodeLine{50 }
\DoxyCodeLine{51 \textcolor{keyword}{public}:}
\DoxyCodeLine{52   \textcolor{keyword}{enum} \{}
\DoxyCodeLine{53         Vectorizable = \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_LhsPacket>::vectorizable}} \&\&}
\DoxyCodeLine{54         \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_RhsPacket>::vectorizable}} \&\&}
\DoxyCodeLine{55         int(\mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_LhsPacket>::size}})==int(\mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_RhsPacket>::size}}),}
\DoxyCodeLine{56         LhsPacketSize = Vectorizable ? \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_LhsPacket>::size}} : 1,}
\DoxyCodeLine{57         RhsPacketSize = Vectorizable ? \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_RhsPacket>::size}} : 1,}
\DoxyCodeLine{58         ResPacketSize = Vectorizable ? \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits<\_ResPacket>::size}} : 1}
\DoxyCodeLine{59   \};}
\DoxyCodeLine{60 }
\DoxyCodeLine{61   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{conditional<Vectorizable,\_LhsPacket,LhsScalar>::type}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacket}};}
\DoxyCodeLine{62   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{conditional<Vectorizable,\_RhsPacket,RhsScalar>::type}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacket}};}
\DoxyCodeLine{63   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{conditional<Vectorizable,\_ResPacket,ResScalar>::type}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ResPacket}};}
\DoxyCodeLine{64 \};}
\DoxyCodeLine{65 }
\DoxyCodeLine{66 }
\DoxyCodeLine{67 \textcolor{comment}{/* Optimized col-\/major matrix * vector product:}}
\DoxyCodeLine{68 \textcolor{comment}{ * This algorithm processes the matrix per vertical panels,}}
\DoxyCodeLine{69 \textcolor{comment}{ * which are then processed horizontally per chunck of 8*PacketSize x 1 vertical segments.}}
\DoxyCodeLine{70 \textcolor{comment}{ *}}
\DoxyCodeLine{71 \textcolor{comment}{ * Mixing type logic: C += alpha * A * B}}
\DoxyCodeLine{72 \textcolor{comment}{ *  |  A  |  B  |alpha| comments}}
\DoxyCodeLine{73 \textcolor{comment}{ *  |real |cplx |cplx | no vectorization}}
\DoxyCodeLine{74 \textcolor{comment}{ *  |real |cplx |real | alpha is converted to a cplx when calling the run function, no vectorization}}
\DoxyCodeLine{75 \textcolor{comment}{ *  |cplx |real |cplx | invalid, the caller has to do tmp: = A * B; C += alpha*tmp}}
\DoxyCodeLine{76 \textcolor{comment}{ *  |cplx |real |real | optimal case, vectorization possible via real-\/cplx mul}}
\DoxyCodeLine{77 \textcolor{comment}{ *}}
\DoxyCodeLine{78 \textcolor{comment}{ * The same reasoning apply for the transposed case.}}
\DoxyCodeLine{79 \textcolor{comment}{ */}}
\DoxyCodeLine{80 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Index, \textcolor{keyword}{typename} LhsScalar, \textcolor{keyword}{typename} LhsMapper, \textcolor{keywordtype}{bool} ConjugateLhs, \textcolor{keyword}{typename} RhsScalar, \textcolor{keyword}{typename} RhsMapper, \textcolor{keywordtype}{bool} ConjugateRhs, \textcolor{keywordtype}{int} Version>}
\DoxyCodeLine{81 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1general__matrix__vector__product}{general\_matrix\_vector\_product}}<\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}},LhsScalar,LhsMapper,\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0103672ae41005ab03b4176c765afd62}{ColMajor}},ConjugateLhs,RhsScalar,RhsMapper,ConjugateRhs,Version>}
\DoxyCodeLine{82 \{}
\DoxyCodeLine{83   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1internal_1_1gemv__traits}{gemv\_traits<LhsScalar,RhsScalar>}} \mbox{\hyperlink{classEigen_1_1internal_1_1gemv__traits}{Traits}};}
\DoxyCodeLine{84   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1internal_1_1gemv__traits}{gemv\_traits<LhsScalar,RhsScalar,GEMVPacketHalf>}} \mbox{\hyperlink{classEigen_1_1internal_1_1gemv__traits}{HalfTraits}};}
\DoxyCodeLine{85   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1internal_1_1gemv__traits}{gemv\_traits<LhsScalar,RhsScalar,GEMVPacketQuarter>}} \mbox{\hyperlink{classEigen_1_1internal_1_1gemv__traits}{QuarterTraits}};}
\DoxyCodeLine{86 }
\DoxyCodeLine{87   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1ScalarBinaryOpTraits}{ScalarBinaryOpTraits<LhsScalar, RhsScalar>::ReturnType}} ResScalar;}
\DoxyCodeLine{88 }
\DoxyCodeLine{89   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{Traits::LhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacket}};}
\DoxyCodeLine{90   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{Traits::RhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacket}};}
\DoxyCodeLine{91   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{Traits::ResPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ResPacket}};}
\DoxyCodeLine{92 }
\DoxyCodeLine{93   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{HalfTraits::LhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacketHalf}};}
\DoxyCodeLine{94   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{HalfTraits::RhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacketHalf}};}
\DoxyCodeLine{95   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{HalfTraits::ResPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ResPacketHalf}};}
\DoxyCodeLine{96 }
\DoxyCodeLine{97   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{QuarterTraits::LhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacketQuarter}};}
\DoxyCodeLine{98   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{QuarterTraits::RhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacketQuarter}};}
\DoxyCodeLine{99   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{QuarterTraits::ResPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ResPacketQuarter}};}
\DoxyCodeLine{100 }
\DoxyCodeLine{101 EIGEN\_DEVICE\_FUNC EIGEN\_DONT\_INLINE \textcolor{keyword}{static} \textcolor{keywordtype}{void} run(}
\DoxyCodeLine{102   \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} rows, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} cols,}
\DoxyCodeLine{103   \textcolor{keyword}{const} LhsMapper\& lhs,}
\DoxyCodeLine{104   \textcolor{keyword}{const} RhsMapper\& rhs,}
\DoxyCodeLine{105         ResScalar* res, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} resIncr,}
\DoxyCodeLine{106   RhsScalar alpha);}
\DoxyCodeLine{107 \};}
\DoxyCodeLine{108 }
\DoxyCodeLine{109 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Index, \textcolor{keyword}{typename} LhsScalar, \textcolor{keyword}{typename} LhsMapper, \textcolor{keywordtype}{bool} ConjugateLhs, \textcolor{keyword}{typename} RhsScalar, \textcolor{keyword}{typename} RhsMapper, \textcolor{keywordtype}{bool} ConjugateRhs, \textcolor{keywordtype}{int} Version>}
\DoxyCodeLine{110 EIGEN\_DEVICE\_FUNC EIGEN\_DONT\_INLINE \textcolor{keywordtype}{void} \mbox{\hyperlink{structEigen_1_1internal_1_1general__matrix__vector__product}{general\_matrix\_vector\_product<Index,LhsScalar,LhsMapper,ColMajor,ConjugateLhs,RhsScalar,RhsMapper,ConjugateRhs,Version>::run}}(}
\DoxyCodeLine{111   \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} rows, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} cols,}
\DoxyCodeLine{112   \textcolor{keyword}{const} LhsMapper\& alhs,}
\DoxyCodeLine{113   \textcolor{keyword}{const} RhsMapper\& rhs,}
\DoxyCodeLine{114         ResScalar* res, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} resIncr,}
\DoxyCodeLine{115   RhsScalar alpha)}
\DoxyCodeLine{116 \{}
\DoxyCodeLine{117   EIGEN\_UNUSED\_VARIABLE(resIncr);}
\DoxyCodeLine{118   eigen\_internal\_assert(resIncr==1);}
\DoxyCodeLine{119 }
\DoxyCodeLine{120   \textcolor{comment}{// The following copy tells the compiler that lhs's attributes are not modified outside this function}}
\DoxyCodeLine{121   \textcolor{comment}{// This helps GCC to generate propoer code.}}
\DoxyCodeLine{122   LhsMapper lhs(alhs);}
\DoxyCodeLine{123 }
\DoxyCodeLine{124   \mbox{\hyperlink{structEigen_1_1internal_1_1conj__helper}{conj\_helper<LhsScalar,RhsScalar,ConjugateLhs,ConjugateRhs>}} cj;}
\DoxyCodeLine{125   \mbox{\hyperlink{structEigen_1_1internal_1_1conj__helper}{conj\_helper<LhsPacket,RhsPacket,ConjugateLhs,ConjugateRhs>}} pcj;}
\DoxyCodeLine{126   \mbox{\hyperlink{structEigen_1_1internal_1_1conj__helper}{conj\_helper<LhsPacketHalf,RhsPacketHalf,ConjugateLhs,ConjugateRhs>}} pcj\_half;}
\DoxyCodeLine{127   \mbox{\hyperlink{structEigen_1_1internal_1_1conj__helper}{conj\_helper<LhsPacketQuarter,RhsPacketQuarter,ConjugateLhs,ConjugateRhs>}} pcj\_quarter;}
\DoxyCodeLine{128 }
\DoxyCodeLine{129   \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} lhsStride = lhs.stride();}
\DoxyCodeLine{130   \textcolor{comment}{// TODO: for padded aligned inputs, we could enable aligned reads}}
\DoxyCodeLine{131   \textcolor{keyword}{enum} \{ LhsAlignment = \mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}},}
\DoxyCodeLine{132          ResPacketSize = Traits::ResPacketSize,}
\DoxyCodeLine{133          ResPacketSizeHalf = HalfTraits::ResPacketSize,}
\DoxyCodeLine{134          ResPacketSizeQuarter = QuarterTraits::ResPacketSize,}
\DoxyCodeLine{135          LhsPacketSize = Traits::LhsPacketSize,}
\DoxyCodeLine{136          HasHalf = (int)ResPacketSizeHalf < (\textcolor{keywordtype}{int})ResPacketSize,}
\DoxyCodeLine{137          HasQuarter = (int)ResPacketSizeQuarter < (\textcolor{keywordtype}{int})ResPacketSizeHalf}
\DoxyCodeLine{138   \};}
\DoxyCodeLine{139 }
\DoxyCodeLine{140   \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} n8 = rows-\/8*ResPacketSize+1;}
\DoxyCodeLine{141   \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} n4 = rows-\/4*ResPacketSize+1;}
\DoxyCodeLine{142   \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} n3 = rows-\/3*ResPacketSize+1;}
\DoxyCodeLine{143   \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} n2 = rows-\/2*ResPacketSize+1;}
\DoxyCodeLine{144   \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} n1 = rows-\/1*ResPacketSize+1;}
\DoxyCodeLine{145   \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} n\_half = rows-\/1*ResPacketSizeHalf+1;}
\DoxyCodeLine{146   \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} n\_quarter = rows-\/1*ResPacketSizeQuarter+1;}
\DoxyCodeLine{147 }
\DoxyCodeLine{148   \textcolor{comment}{// TODO: improve the following heuristic:}}
\DoxyCodeLine{149   \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} block\_cols = cols<128 ? cols : (lhsStride*\textcolor{keyword}{sizeof}(LhsScalar)<32000?16:4);}
\DoxyCodeLine{150   ResPacket palpha = pset1<ResPacket>(alpha);}
\DoxyCodeLine{151   ResPacketHalf palpha\_half = pset1<ResPacketHalf>(alpha);}
\DoxyCodeLine{152   ResPacketQuarter palpha\_quarter = pset1<ResPacketQuarter>(alpha);}
\DoxyCodeLine{153 }
\DoxyCodeLine{154   \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j2=0; j2<cols; j2+=block\_cols)}
\DoxyCodeLine{155   \{}
\DoxyCodeLine{156     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} jend = numext::mini(j2+block\_cols,cols);}
\DoxyCodeLine{157     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} i=0;}
\DoxyCodeLine{158     \textcolor{keywordflow}{for}(; i<n8; i+=ResPacketSize*8)}
\DoxyCodeLine{159     \{}
\DoxyCodeLine{160       ResPacket c0 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{161                 c1 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{162                 c2 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{163                 c3 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{164                 c4 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{165                 c5 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{166                 c6 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{167                 c7 = pset1<ResPacket>(ResScalar(0));}
\DoxyCodeLine{168 }
\DoxyCodeLine{169       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j=j2; j<jend; j+=1)}
\DoxyCodeLine{170       \{}
\DoxyCodeLine{171         RhsPacket b0 = pset1<RhsPacket>(rhs(j,0));}
\DoxyCodeLine{172         c0 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+LhsPacketSize*0,j),b0,c0);}
\DoxyCodeLine{173         c1 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+LhsPacketSize*1,j),b0,c1);}
\DoxyCodeLine{174         c2 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+LhsPacketSize*2,j),b0,c2);}
\DoxyCodeLine{175         c3 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+LhsPacketSize*3,j),b0,c3);}
\DoxyCodeLine{176         c4 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+LhsPacketSize*4,j),b0,c4);}
\DoxyCodeLine{177         c5 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+LhsPacketSize*5,j),b0,c5);}
\DoxyCodeLine{178         c6 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+LhsPacketSize*6,j),b0,c6);}
\DoxyCodeLine{179         c7 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+LhsPacketSize*7,j),b0,c7);}
\DoxyCodeLine{180       \}}
\DoxyCodeLine{181       pstoreu(res+i+ResPacketSize*0, pmadd(c0,palpha,ploadu<ResPacket>(res+i+ResPacketSize*0)));}
\DoxyCodeLine{182       pstoreu(res+i+ResPacketSize*1, pmadd(c1,palpha,ploadu<ResPacket>(res+i+ResPacketSize*1)));}
\DoxyCodeLine{183       pstoreu(res+i+ResPacketSize*2, pmadd(c2,palpha,ploadu<ResPacket>(res+i+ResPacketSize*2)));}
\DoxyCodeLine{184       pstoreu(res+i+ResPacketSize*3, pmadd(c3,palpha,ploadu<ResPacket>(res+i+ResPacketSize*3)));}
\DoxyCodeLine{185       pstoreu(res+i+ResPacketSize*4, pmadd(c4,palpha,ploadu<ResPacket>(res+i+ResPacketSize*4)));}
\DoxyCodeLine{186       pstoreu(res+i+ResPacketSize*5, pmadd(c5,palpha,ploadu<ResPacket>(res+i+ResPacketSize*5)));}
\DoxyCodeLine{187       pstoreu(res+i+ResPacketSize*6, pmadd(c6,palpha,ploadu<ResPacket>(res+i+ResPacketSize*6)));}
\DoxyCodeLine{188       pstoreu(res+i+ResPacketSize*7, pmadd(c7,palpha,ploadu<ResPacket>(res+i+ResPacketSize*7)));}
\DoxyCodeLine{189     \}}
\DoxyCodeLine{190     \textcolor{keywordflow}{if}(i<n4)}
\DoxyCodeLine{191     \{}
\DoxyCodeLine{192       ResPacket c0 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{193                 c1 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{194                 c2 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{195                 c3 = pset1<ResPacket>(ResScalar(0));}
\DoxyCodeLine{196 }
\DoxyCodeLine{197       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j=j2; j<jend; j+=1)}
\DoxyCodeLine{198       \{}
\DoxyCodeLine{199         RhsPacket b0 = pset1<RhsPacket>(rhs(j,0));}
\DoxyCodeLine{200         c0 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+LhsPacketSize*0,j),b0,c0);}
\DoxyCodeLine{201         c1 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+LhsPacketSize*1,j),b0,c1);}
\DoxyCodeLine{202         c2 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+LhsPacketSize*2,j),b0,c2);}
\DoxyCodeLine{203         c3 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+LhsPacketSize*3,j),b0,c3);}
\DoxyCodeLine{204       \}}
\DoxyCodeLine{205       pstoreu(res+i+ResPacketSize*0, pmadd(c0,palpha,ploadu<ResPacket>(res+i+ResPacketSize*0)));}
\DoxyCodeLine{206       pstoreu(res+i+ResPacketSize*1, pmadd(c1,palpha,ploadu<ResPacket>(res+i+ResPacketSize*1)));}
\DoxyCodeLine{207       pstoreu(res+i+ResPacketSize*2, pmadd(c2,palpha,ploadu<ResPacket>(res+i+ResPacketSize*2)));}
\DoxyCodeLine{208       pstoreu(res+i+ResPacketSize*3, pmadd(c3,palpha,ploadu<ResPacket>(res+i+ResPacketSize*3)));}
\DoxyCodeLine{209 }
\DoxyCodeLine{210       i+=ResPacketSize*4;}
\DoxyCodeLine{211     \}}
\DoxyCodeLine{212     \textcolor{keywordflow}{if}(i<n3)}
\DoxyCodeLine{213     \{}
\DoxyCodeLine{214       ResPacket c0 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{215                 c1 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{216                 c2 = pset1<ResPacket>(ResScalar(0));}
\DoxyCodeLine{217 }
\DoxyCodeLine{218       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j=j2; j<jend; j+=1)}
\DoxyCodeLine{219       \{}
\DoxyCodeLine{220         RhsPacket b0 = pset1<RhsPacket>(rhs(j,0));}
\DoxyCodeLine{221         c0 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+LhsPacketSize*0,j),b0,c0);}
\DoxyCodeLine{222         c1 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+LhsPacketSize*1,j),b0,c1);}
\DoxyCodeLine{223         c2 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+LhsPacketSize*2,j),b0,c2);}
\DoxyCodeLine{224       \}}
\DoxyCodeLine{225       pstoreu(res+i+ResPacketSize*0, pmadd(c0,palpha,ploadu<ResPacket>(res+i+ResPacketSize*0)));}
\DoxyCodeLine{226       pstoreu(res+i+ResPacketSize*1, pmadd(c1,palpha,ploadu<ResPacket>(res+i+ResPacketSize*1)));}
\DoxyCodeLine{227       pstoreu(res+i+ResPacketSize*2, pmadd(c2,palpha,ploadu<ResPacket>(res+i+ResPacketSize*2)));}
\DoxyCodeLine{228 }
\DoxyCodeLine{229       i+=ResPacketSize*3;}
\DoxyCodeLine{230     \}}
\DoxyCodeLine{231     \textcolor{keywordflow}{if}(i<n2)}
\DoxyCodeLine{232     \{}
\DoxyCodeLine{233       ResPacket c0 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{234                 c1 = pset1<ResPacket>(ResScalar(0));}
\DoxyCodeLine{235 }
\DoxyCodeLine{236       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j=j2; j<jend; j+=1)}
\DoxyCodeLine{237       \{}
\DoxyCodeLine{238         RhsPacket b0 = pset1<RhsPacket>(rhs(j,0));}
\DoxyCodeLine{239         c0 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+LhsPacketSize*0,j),b0,c0);}
\DoxyCodeLine{240         c1 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+LhsPacketSize*1,j),b0,c1);}
\DoxyCodeLine{241       \}}
\DoxyCodeLine{242       pstoreu(res+i+ResPacketSize*0, pmadd(c0,palpha,ploadu<ResPacket>(res+i+ResPacketSize*0)));}
\DoxyCodeLine{243       pstoreu(res+i+ResPacketSize*1, pmadd(c1,palpha,ploadu<ResPacket>(res+i+ResPacketSize*1)));}
\DoxyCodeLine{244       i+=ResPacketSize*2;}
\DoxyCodeLine{245     \}}
\DoxyCodeLine{246     \textcolor{keywordflow}{if}(i<n1)}
\DoxyCodeLine{247     \{}
\DoxyCodeLine{248       ResPacket c0 = pset1<ResPacket>(ResScalar(0));}
\DoxyCodeLine{249       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j=j2; j<jend; j+=1)}
\DoxyCodeLine{250       \{}
\DoxyCodeLine{251         RhsPacket b0 = pset1<RhsPacket>(rhs(j,0));}
\DoxyCodeLine{252         c0 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+0,j),b0,c0);}
\DoxyCodeLine{253       \}}
\DoxyCodeLine{254       pstoreu(res+i+ResPacketSize*0, pmadd(c0,palpha,ploadu<ResPacket>(res+i+ResPacketSize*0)));}
\DoxyCodeLine{255       i+=ResPacketSize;}
\DoxyCodeLine{256     \}}
\DoxyCodeLine{257     \textcolor{keywordflow}{if}(HasHalf \&\& i<n\_half)}
\DoxyCodeLine{258     \{}
\DoxyCodeLine{259       ResPacketHalf c0 = pset1<ResPacketHalf>(ResScalar(0));}
\DoxyCodeLine{260       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j=j2; j<jend; j+=1)}
\DoxyCodeLine{261       \{}
\DoxyCodeLine{262         RhsPacketHalf b0 = pset1<RhsPacketHalf>(rhs(j,0));}
\DoxyCodeLine{263         c0 = pcj\_half.pmadd(lhs.template load<LhsPacketHalf,LhsAlignment>(i+0,j),b0,c0);}
\DoxyCodeLine{264       \}}
\DoxyCodeLine{265       pstoreu(res+i+ResPacketSizeHalf*0, pmadd(c0,palpha\_half,ploadu<ResPacketHalf>(res+i+ResPacketSizeHalf*0)));}
\DoxyCodeLine{266       i+=ResPacketSizeHalf;}
\DoxyCodeLine{267     \}}
\DoxyCodeLine{268     \textcolor{keywordflow}{if}(HasQuarter \&\& i<n\_quarter)}
\DoxyCodeLine{269     \{}
\DoxyCodeLine{270       ResPacketQuarter c0 = pset1<ResPacketQuarter>(ResScalar(0));}
\DoxyCodeLine{271       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j=j2; j<jend; j+=1)}
\DoxyCodeLine{272       \{}
\DoxyCodeLine{273         RhsPacketQuarter b0 = pset1<RhsPacketQuarter>(rhs(j,0));}
\DoxyCodeLine{274         c0 = pcj\_quarter.pmadd(lhs.template load<LhsPacketQuarter,LhsAlignment>(i+0,j),b0,c0);}
\DoxyCodeLine{275       \}}
\DoxyCodeLine{276       pstoreu(res+i+ResPacketSizeQuarter*0, pmadd(c0,palpha\_quarter,ploadu<ResPacketQuarter>(res+i+ResPacketSizeQuarter*0)));}
\DoxyCodeLine{277       i+=ResPacketSizeQuarter;}
\DoxyCodeLine{278     \}}
\DoxyCodeLine{279     \textcolor{keywordflow}{for}(;i<rows;++i)}
\DoxyCodeLine{280     \{}
\DoxyCodeLine{281       ResScalar c0(0);}
\DoxyCodeLine{282       \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j=j2; j<jend; j+=1)}
\DoxyCodeLine{283         c0 += cj.pmul(lhs(i,j), rhs(j,0));}
\DoxyCodeLine{284       res[i] += alpha*c0;}
\DoxyCodeLine{285     \}}
\DoxyCodeLine{286   \}}
\DoxyCodeLine{287 \}}
\DoxyCodeLine{288 }
\DoxyCodeLine{289 \textcolor{comment}{/* Optimized row-\/major matrix * vector product:}}
\DoxyCodeLine{290 \textcolor{comment}{ * This algorithm processes 4 rows at once that allows to both reduce}}
\DoxyCodeLine{291 \textcolor{comment}{ * the number of load/stores of the result by a factor 4 and to reduce}}
\DoxyCodeLine{292 \textcolor{comment}{ * the instruction dependency. Moreover, we know that all bands have the}}
\DoxyCodeLine{293 \textcolor{comment}{ * same alignment pattern.}}
\DoxyCodeLine{294 \textcolor{comment}{ *}}
\DoxyCodeLine{295 \textcolor{comment}{ * Mixing type logic:}}
\DoxyCodeLine{296 \textcolor{comment}{ *  -\/ alpha is always a complex (or converted to a complex)}}
\DoxyCodeLine{297 \textcolor{comment}{ *  -\/ no vectorization}}
\DoxyCodeLine{298 \textcolor{comment}{ */}}
\DoxyCodeLine{299 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Index, \textcolor{keyword}{typename} LhsScalar, \textcolor{keyword}{typename} LhsMapper, \textcolor{keywordtype}{bool} ConjugateLhs, \textcolor{keyword}{typename} RhsScalar, \textcolor{keyword}{typename} RhsMapper, \textcolor{keywordtype}{bool} ConjugateRhs, \textcolor{keywordtype}{int} Version>}
\DoxyCodeLine{300 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1general__matrix__vector__product}{general\_matrix\_vector\_product}}<\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}},LhsScalar,LhsMapper,\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a77c993a8d9f6efe5c1159fb2ab07dd4f}{RowMajor}},ConjugateLhs,RhsScalar,RhsMapper,ConjugateRhs,Version>}
\DoxyCodeLine{301 \{}
\DoxyCodeLine{302   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1internal_1_1gemv__traits}{gemv\_traits<LhsScalar,RhsScalar>}} \mbox{\hyperlink{classEigen_1_1internal_1_1gemv__traits}{Traits}};}
\DoxyCodeLine{303   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1internal_1_1gemv__traits}{gemv\_traits<LhsScalar,RhsScalar,GEMVPacketHalf>}} \mbox{\hyperlink{classEigen_1_1internal_1_1gemv__traits}{HalfTraits}};}
\DoxyCodeLine{304   \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1internal_1_1gemv__traits}{gemv\_traits<LhsScalar,RhsScalar,GEMVPacketQuarter>}} \mbox{\hyperlink{classEigen_1_1internal_1_1gemv__traits}{QuarterTraits}};}
\DoxyCodeLine{305 }
\DoxyCodeLine{306   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1ScalarBinaryOpTraits}{ScalarBinaryOpTraits<LhsScalar, RhsScalar>::ReturnType}} ResScalar;}
\DoxyCodeLine{307 }
\DoxyCodeLine{308   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{Traits::LhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacket}};}
\DoxyCodeLine{309   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{Traits::RhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacket}};}
\DoxyCodeLine{310   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{Traits::ResPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ResPacket}};}
\DoxyCodeLine{311 }
\DoxyCodeLine{312   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{HalfTraits::LhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacketHalf}};}
\DoxyCodeLine{313   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{HalfTraits::RhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacketHalf}};}
\DoxyCodeLine{314   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{HalfTraits::ResPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ResPacketHalf}};}
\DoxyCodeLine{315 }
\DoxyCodeLine{316   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{QuarterTraits::LhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{LhsPacketQuarter}};}
\DoxyCodeLine{317   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{QuarterTraits::RhsPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{RhsPacketQuarter}};}
\DoxyCodeLine{318   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{QuarterTraits::ResPacket}} \mbox{\hyperlink{structEigen_1_1internal_1_1true__type}{ResPacketQuarter}};}
\DoxyCodeLine{319 }
\DoxyCodeLine{320 EIGEN\_DEVICE\_FUNC EIGEN\_DONT\_INLINE \textcolor{keyword}{static} \textcolor{keywordtype}{void} run(}
\DoxyCodeLine{321   \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} rows, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} cols,}
\DoxyCodeLine{322   \textcolor{keyword}{const} LhsMapper\& lhs,}
\DoxyCodeLine{323   \textcolor{keyword}{const} RhsMapper\& rhs,}
\DoxyCodeLine{324         ResScalar* res, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} resIncr,}
\DoxyCodeLine{325   ResScalar alpha);}
\DoxyCodeLine{326 \};}
\DoxyCodeLine{327 }
\DoxyCodeLine{328 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Index, \textcolor{keyword}{typename} LhsScalar, \textcolor{keyword}{typename} LhsMapper, \textcolor{keywordtype}{bool} ConjugateLhs, \textcolor{keyword}{typename} RhsScalar, \textcolor{keyword}{typename} RhsMapper, \textcolor{keywordtype}{bool} ConjugateRhs, \textcolor{keywordtype}{int} Version>}
\DoxyCodeLine{329 EIGEN\_DEVICE\_FUNC EIGEN\_DONT\_INLINE \textcolor{keywordtype}{void} \mbox{\hyperlink{structEigen_1_1internal_1_1general__matrix__vector__product}{general\_matrix\_vector\_product<Index,LhsScalar,LhsMapper,RowMajor,ConjugateLhs,RhsScalar,RhsMapper,ConjugateRhs,Version>::run}}(}
\DoxyCodeLine{330   \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} rows, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} cols,}
\DoxyCodeLine{331   \textcolor{keyword}{const} LhsMapper\& alhs,}
\DoxyCodeLine{332   \textcolor{keyword}{const} RhsMapper\& rhs,}
\DoxyCodeLine{333   ResScalar* res, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} resIncr,}
\DoxyCodeLine{334   ResScalar alpha)}
\DoxyCodeLine{335 \{}
\DoxyCodeLine{336   \textcolor{comment}{// The following copy tells the compiler that lhs's attributes are not modified outside this function}}
\DoxyCodeLine{337   \textcolor{comment}{// This helps GCC to generate propoer code.}}
\DoxyCodeLine{338   LhsMapper lhs(alhs);}
\DoxyCodeLine{339 }
\DoxyCodeLine{340   eigen\_internal\_assert(rhs.stride()==1);}
\DoxyCodeLine{341   \mbox{\hyperlink{structEigen_1_1internal_1_1conj__helper}{conj\_helper<LhsScalar,RhsScalar,ConjugateLhs,ConjugateRhs>}} cj;}
\DoxyCodeLine{342   \mbox{\hyperlink{structEigen_1_1internal_1_1conj__helper}{conj\_helper<LhsPacket,RhsPacket,ConjugateLhs,ConjugateRhs>}} pcj;}
\DoxyCodeLine{343   \mbox{\hyperlink{structEigen_1_1internal_1_1conj__helper}{conj\_helper<LhsPacketHalf,RhsPacketHalf,ConjugateLhs,ConjugateRhs>}} pcj\_half;}
\DoxyCodeLine{344   \mbox{\hyperlink{structEigen_1_1internal_1_1conj__helper}{conj\_helper<LhsPacketQuarter,RhsPacketQuarter,ConjugateLhs,ConjugateRhs>}} pcj\_quarter;}
\DoxyCodeLine{345 }
\DoxyCodeLine{346   \textcolor{comment}{// TODO: fine tune the following heuristic. The rationale is that if the matrix is very large,}}
\DoxyCodeLine{347   \textcolor{comment}{//       processing 8 rows at once might be counter productive wrt cache.}}
\DoxyCodeLine{348   \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} n8 = lhs.stride()*\textcolor{keyword}{sizeof}(LhsScalar)>32000 ? 0 : rows-\/7;}
\DoxyCodeLine{349   \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} n4 = rows-\/3;}
\DoxyCodeLine{350   \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} n2 = rows-\/1;}
\DoxyCodeLine{351 }
\DoxyCodeLine{352   \textcolor{comment}{// TODO: for padded aligned inputs, we could enable aligned reads}}
\DoxyCodeLine{353   \textcolor{keyword}{enum} \{ LhsAlignment = \mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}},}
\DoxyCodeLine{354          ResPacketSize = Traits::ResPacketSize,}
\DoxyCodeLine{355          ResPacketSizeHalf = HalfTraits::ResPacketSize,}
\DoxyCodeLine{356          ResPacketSizeQuarter = QuarterTraits::ResPacketSize,}
\DoxyCodeLine{357          LhsPacketSize = Traits::LhsPacketSize,}
\DoxyCodeLine{358          LhsPacketSizeHalf = HalfTraits::LhsPacketSize,}
\DoxyCodeLine{359          LhsPacketSizeQuarter = QuarterTraits::LhsPacketSize,}
\DoxyCodeLine{360          HasHalf = (int)ResPacketSizeHalf < (\textcolor{keywordtype}{int})ResPacketSize,}
\DoxyCodeLine{361          HasQuarter = (int)ResPacketSizeQuarter < (\textcolor{keywordtype}{int})ResPacketSizeHalf}
\DoxyCodeLine{362   \};}
\DoxyCodeLine{363 }
\DoxyCodeLine{364   \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} i=0;}
\DoxyCodeLine{365   \textcolor{keywordflow}{for}(; i<n8; i+=8)}
\DoxyCodeLine{366   \{}
\DoxyCodeLine{367     ResPacket c0 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{368               c1 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{369               c2 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{370               c3 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{371               c4 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{372               c5 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{373               c6 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{374               c7 = pset1<ResPacket>(ResScalar(0));}
\DoxyCodeLine{375 }
\DoxyCodeLine{376     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j=0;}
\DoxyCodeLine{377     \textcolor{keywordflow}{for}(; j+LhsPacketSize<=cols; j+=LhsPacketSize)}
\DoxyCodeLine{378     \{}
\DoxyCodeLine{379       RhsPacket b0 = rhs.template load<RhsPacket, Unaligned>(j,0);}
\DoxyCodeLine{380 }
\DoxyCodeLine{381       c0 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+0,j),b0,c0);}
\DoxyCodeLine{382       c1 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+1,j),b0,c1);}
\DoxyCodeLine{383       c2 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+2,j),b0,c2);}
\DoxyCodeLine{384       c3 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+3,j),b0,c3);}
\DoxyCodeLine{385       c4 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+4,j),b0,c4);}
\DoxyCodeLine{386       c5 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+5,j),b0,c5);}
\DoxyCodeLine{387       c6 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+6,j),b0,c6);}
\DoxyCodeLine{388       c7 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+7,j),b0,c7);}
\DoxyCodeLine{389     \}}
\DoxyCodeLine{390     ResScalar cc0 = predux(c0);}
\DoxyCodeLine{391     ResScalar cc1 = predux(c1);}
\DoxyCodeLine{392     ResScalar cc2 = predux(c2);}
\DoxyCodeLine{393     ResScalar cc3 = predux(c3);}
\DoxyCodeLine{394     ResScalar cc4 = predux(c4);}
\DoxyCodeLine{395     ResScalar cc5 = predux(c5);}
\DoxyCodeLine{396     ResScalar cc6 = predux(c6);}
\DoxyCodeLine{397     ResScalar cc7 = predux(c7);}
\DoxyCodeLine{398     \textcolor{keywordflow}{for}(; j<cols; ++j)}
\DoxyCodeLine{399     \{}
\DoxyCodeLine{400       RhsScalar b0 = rhs(j,0);}
\DoxyCodeLine{401 }
\DoxyCodeLine{402       cc0 += cj.pmul(lhs(i+0,j), b0);}
\DoxyCodeLine{403       cc1 += cj.pmul(lhs(i+1,j), b0);}
\DoxyCodeLine{404       cc2 += cj.pmul(lhs(i+2,j), b0);}
\DoxyCodeLine{405       cc3 += cj.pmul(lhs(i+3,j), b0);}
\DoxyCodeLine{406       cc4 += cj.pmul(lhs(i+4,j), b0);}
\DoxyCodeLine{407       cc5 += cj.pmul(lhs(i+5,j), b0);}
\DoxyCodeLine{408       cc6 += cj.pmul(lhs(i+6,j), b0);}
\DoxyCodeLine{409       cc7 += cj.pmul(lhs(i+7,j), b0);}
\DoxyCodeLine{410     \}}
\DoxyCodeLine{411     res[(i+0)*resIncr] += alpha*cc0;}
\DoxyCodeLine{412     res[(i+1)*resIncr] += alpha*cc1;}
\DoxyCodeLine{413     res[(i+2)*resIncr] += alpha*cc2;}
\DoxyCodeLine{414     res[(i+3)*resIncr] += alpha*cc3;}
\DoxyCodeLine{415     res[(i+4)*resIncr] += alpha*cc4;}
\DoxyCodeLine{416     res[(i+5)*resIncr] += alpha*cc5;}
\DoxyCodeLine{417     res[(i+6)*resIncr] += alpha*cc6;}
\DoxyCodeLine{418     res[(i+7)*resIncr] += alpha*cc7;}
\DoxyCodeLine{419   \}}
\DoxyCodeLine{420   \textcolor{keywordflow}{for}(; i<n4; i+=4)}
\DoxyCodeLine{421   \{}
\DoxyCodeLine{422     ResPacket c0 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{423               c1 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{424               c2 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{425               c3 = pset1<ResPacket>(ResScalar(0));}
\DoxyCodeLine{426 }
\DoxyCodeLine{427     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j=0;}
\DoxyCodeLine{428     \textcolor{keywordflow}{for}(; j+LhsPacketSize<=cols; j+=LhsPacketSize)}
\DoxyCodeLine{429     \{}
\DoxyCodeLine{430       RhsPacket b0 = rhs.template load<RhsPacket, Unaligned>(j,0);}
\DoxyCodeLine{431 }
\DoxyCodeLine{432       c0 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+0,j),b0,c0);}
\DoxyCodeLine{433       c1 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+1,j),b0,c1);}
\DoxyCodeLine{434       c2 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+2,j),b0,c2);}
\DoxyCodeLine{435       c3 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+3,j),b0,c3);}
\DoxyCodeLine{436     \}}
\DoxyCodeLine{437     ResScalar cc0 = predux(c0);}
\DoxyCodeLine{438     ResScalar cc1 = predux(c1);}
\DoxyCodeLine{439     ResScalar cc2 = predux(c2);}
\DoxyCodeLine{440     ResScalar cc3 = predux(c3);}
\DoxyCodeLine{441     \textcolor{keywordflow}{for}(; j<cols; ++j)}
\DoxyCodeLine{442     \{}
\DoxyCodeLine{443       RhsScalar b0 = rhs(j,0);}
\DoxyCodeLine{444 }
\DoxyCodeLine{445       cc0 += cj.pmul(lhs(i+0,j), b0);}
\DoxyCodeLine{446       cc1 += cj.pmul(lhs(i+1,j), b0);}
\DoxyCodeLine{447       cc2 += cj.pmul(lhs(i+2,j), b0);}
\DoxyCodeLine{448       cc3 += cj.pmul(lhs(i+3,j), b0);}
\DoxyCodeLine{449     \}}
\DoxyCodeLine{450     res[(i+0)*resIncr] += alpha*cc0;}
\DoxyCodeLine{451     res[(i+1)*resIncr] += alpha*cc1;}
\DoxyCodeLine{452     res[(i+2)*resIncr] += alpha*cc2;}
\DoxyCodeLine{453     res[(i+3)*resIncr] += alpha*cc3;}
\DoxyCodeLine{454   \}}
\DoxyCodeLine{455   \textcolor{keywordflow}{for}(; i<n2; i+=2)}
\DoxyCodeLine{456   \{}
\DoxyCodeLine{457     ResPacket c0 = pset1<ResPacket>(ResScalar(0)),}
\DoxyCodeLine{458               c1 = pset1<ResPacket>(ResScalar(0));}
\DoxyCodeLine{459 }
\DoxyCodeLine{460     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j=0;}
\DoxyCodeLine{461     \textcolor{keywordflow}{for}(; j+LhsPacketSize<=cols; j+=LhsPacketSize)}
\DoxyCodeLine{462     \{}
\DoxyCodeLine{463       RhsPacket b0 = rhs.template load<RhsPacket, Unaligned>(j,0);}
\DoxyCodeLine{464 }
\DoxyCodeLine{465       c0 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+0,j),b0,c0);}
\DoxyCodeLine{466       c1 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i+1,j),b0,c1);}
\DoxyCodeLine{467     \}}
\DoxyCodeLine{468     ResScalar cc0 = predux(c0);}
\DoxyCodeLine{469     ResScalar cc1 = predux(c1);}
\DoxyCodeLine{470     \textcolor{keywordflow}{for}(; j<cols; ++j)}
\DoxyCodeLine{471     \{}
\DoxyCodeLine{472       RhsScalar b0 = rhs(j,0);}
\DoxyCodeLine{473 }
\DoxyCodeLine{474       cc0 += cj.pmul(lhs(i+0,j), b0);}
\DoxyCodeLine{475       cc1 += cj.pmul(lhs(i+1,j), b0);}
\DoxyCodeLine{476     \}}
\DoxyCodeLine{477     res[(i+0)*resIncr] += alpha*cc0;}
\DoxyCodeLine{478     res[(i+1)*resIncr] += alpha*cc1;}
\DoxyCodeLine{479   \}}
\DoxyCodeLine{480   \textcolor{keywordflow}{for}(; i<rows; ++i)}
\DoxyCodeLine{481   \{}
\DoxyCodeLine{482     ResPacket c0 = pset1<ResPacket>(ResScalar(0));}
\DoxyCodeLine{483     ResPacketHalf c0\_h = pset1<ResPacketHalf>(ResScalar(0));}
\DoxyCodeLine{484     ResPacketQuarter c0\_q = pset1<ResPacketQuarter>(ResScalar(0));}
\DoxyCodeLine{485     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j=0;}
\DoxyCodeLine{486     \textcolor{keywordflow}{for}(; j+LhsPacketSize<=cols; j+=LhsPacketSize)}
\DoxyCodeLine{487     \{}
\DoxyCodeLine{488       RhsPacket b0 = rhs.template load<RhsPacket,Unaligned>(j,0);}
\DoxyCodeLine{489       c0 = pcj.pmadd(lhs.template load<LhsPacket,LhsAlignment>(i,j),b0,c0);}
\DoxyCodeLine{490     \}}
\DoxyCodeLine{491     ResScalar cc0 = predux(c0);}
\DoxyCodeLine{492     \textcolor{keywordflow}{if} (HasHalf) \{}
\DoxyCodeLine{493       \textcolor{keywordflow}{for}(; j+LhsPacketSizeHalf<=cols; j+=LhsPacketSizeHalf)}
\DoxyCodeLine{494         \{}
\DoxyCodeLine{495           RhsPacketHalf b0 = rhs.template load<RhsPacketHalf,Unaligned>(j,0);}
\DoxyCodeLine{496           c0\_h = pcj\_half.pmadd(lhs.template load<LhsPacketHalf,LhsAlignment>(i,j),b0,c0\_h);}
\DoxyCodeLine{497         \}}
\DoxyCodeLine{498       cc0 += predux(c0\_h);}
\DoxyCodeLine{499     \}}
\DoxyCodeLine{500     \textcolor{keywordflow}{if} (HasQuarter) \{}
\DoxyCodeLine{501       \textcolor{keywordflow}{for}(; j+LhsPacketSizeQuarter<=cols; j+=LhsPacketSizeQuarter)}
\DoxyCodeLine{502         \{}
\DoxyCodeLine{503           RhsPacketQuarter b0 = rhs.template load<RhsPacketQuarter,Unaligned>(j,0);}
\DoxyCodeLine{504           c0\_q = pcj\_quarter.pmadd(lhs.template load<LhsPacketQuarter,LhsAlignment>(i,j),b0,c0\_q);}
\DoxyCodeLine{505         \}}
\DoxyCodeLine{506       cc0 += predux(c0\_q);}
\DoxyCodeLine{507     \}}
\DoxyCodeLine{508     \textcolor{keywordflow}{for}(; j<cols; ++j)}
\DoxyCodeLine{509     \{}
\DoxyCodeLine{510       cc0 += cj.pmul(lhs(i,j), rhs(j,0));}
\DoxyCodeLine{511     \}}
\DoxyCodeLine{512     res[i*resIncr] += alpha*cc0;}
\DoxyCodeLine{513   \}}
\DoxyCodeLine{514 \}}
\DoxyCodeLine{515 }
\DoxyCodeLine{516 \} \textcolor{comment}{// end namespace internal}}
\DoxyCodeLine{517 }
\DoxyCodeLine{518 \} \textcolor{comment}{// end namespace Eigen}}
\DoxyCodeLine{519 }
\DoxyCodeLine{520 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// EIGEN\_GENERAL\_MATRIX\_VECTOR\_H}}

\end{DoxyCode}
