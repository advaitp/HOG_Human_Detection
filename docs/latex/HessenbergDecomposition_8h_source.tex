\hypertarget{HessenbergDecomposition_8h_source}{}\doxysection{Hessenberg\+Decomposition.\+h}
\label{HessenbergDecomposition_8h_source}\index{include/Eigen/src/Eigenvalues/HessenbergDecomposition.h@{include/Eigen/src/Eigenvalues/HessenbergDecomposition.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}}
\DoxyCodeLine{2 \textcolor{comment}{// for linear algebra.}}
\DoxyCodeLine{3 \textcolor{comment}{//}}
\DoxyCodeLine{4 \textcolor{comment}{// Copyright (C) 2008-\/2009 Gael Guennebaud <gael.guennebaud@inria.fr>}}
\DoxyCodeLine{5 \textcolor{comment}{// Copyright (C) 2010 Jitse Niesen <jitse@maths.leeds.ac.uk>}}
\DoxyCodeLine{6 \textcolor{comment}{//}}
\DoxyCodeLine{7 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}}
\DoxyCodeLine{8 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}}
\DoxyCodeLine{9 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{preprocessor}{\#ifndef EIGEN\_HESSENBERGDECOMPOSITION\_H}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#define EIGEN\_HESSENBERGDECOMPOSITION\_H}}
\DoxyCodeLine{13 }
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include "{}./InternalHeaderCheck.h"{}}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceEigen}{Eigen}} \{ }
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{keyword}{namespace }internal \{}
\DoxyCodeLine{19   }
\DoxyCodeLine{20 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType> \textcolor{keyword}{struct }HessenbergDecompositionMatrixHReturnType;}
\DoxyCodeLine{21 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>}
\DoxyCodeLine{22 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}<\mbox{\hyperlink{structEigen_1_1internal_1_1HessenbergDecompositionMatrixHReturnType}{HessenbergDecompositionMatrixHReturnType}}<MatrixType> >}
\DoxyCodeLine{23 \{}
\DoxyCodeLine{24   \textcolor{keyword}{typedef} MatrixType ReturnType;}
\DoxyCodeLine{25 \};}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \}}
\DoxyCodeLine{28 }
\DoxyCodeLine{59 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType\_> \textcolor{keyword}{class }\mbox{\hyperlink{classEigen_1_1HessenbergDecomposition}{HessenbergDecomposition}}}
\DoxyCodeLine{60 \{}
\DoxyCodeLine{61   \textcolor{keyword}{public}:}
\DoxyCodeLine{62 }
\DoxyCodeLine{64     \textcolor{keyword}{typedef} MatrixType\_ \mbox{\hyperlink{classEigen_1_1HessenbergDecomposition_ae7caa77e42d01241ee2acb653e878431}{MatrixType}};}
\DoxyCodeLine{65 }
\DoxyCodeLine{66     \textcolor{keyword}{enum} \{}
\DoxyCodeLine{67       Size = MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{68       SizeMinusOne = Size == \mbox{\hyperlink{namespaceEigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}} ? \mbox{\hyperlink{namespaceEigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}} : Size -\/ 1,}
\DoxyCodeLine{69       Options = MatrixType::Options,}
\DoxyCodeLine{70       MaxSize = MatrixType::MaxRowsAtCompileTime,}
\DoxyCodeLine{71       MaxSizeMinusOne = MaxSize == \mbox{\hyperlink{namespaceEigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}} ? \mbox{\hyperlink{namespaceEigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}} : MaxSize -\/ 1}
\DoxyCodeLine{72     \};}
\DoxyCodeLine{73 }
\DoxyCodeLine{75     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Scalar \mbox{\hyperlink{classEigen_1_1HessenbergDecomposition_a31c9b1902c14a85109da3fd9b7b1f221}{Scalar}};}
\DoxyCodeLine{76     \textcolor{keyword}{typedef} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Eigen::Index}} \mbox{\hyperlink{classEigen_1_1HessenbergDecomposition_a94e001b3a7c99b1813cfeba43e947eef}{Index}}; }
\DoxyCodeLine{77 }
\DoxyCodeLine{84     \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix<Scalar, SizeMinusOne, 1, Options \& \string~RowMajor, MaxSizeMinusOne, 1>}} \mbox{\hyperlink{classEigen_1_1HessenbergDecomposition_a02f99fc02c6d591efa640febabb5c085}{CoeffVectorType}};}
\DoxyCodeLine{85 }
\DoxyCodeLine{87     \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1HouseholderSequence}{HouseholderSequence<MatrixType,typename internal::remove\_all<typename CoeffVectorType::ConjugateReturnType>::type}}> \mbox{\hyperlink{classEigen_1_1HessenbergDecomposition_ae887b5bcfa63839fdceaee4dd83bdbc9}{HouseholderSequenceType}};}
\DoxyCodeLine{88     }
\DoxyCodeLine{89     \textcolor{keyword}{typedef} \mbox{\hyperlink{structEigen_1_1internal_1_1HessenbergDecompositionMatrixHReturnType}{internal::HessenbergDecompositionMatrixHReturnType<MatrixType>}} \mbox{\hyperlink{structEigen_1_1internal_1_1HessenbergDecompositionMatrixHReturnType}{MatrixHReturnType}};}
\DoxyCodeLine{90 }
\DoxyCodeLine{102     \textcolor{keyword}{explicit} \mbox{\hyperlink{classEigen_1_1HessenbergDecomposition_a0dad58827e37748391d463674d80bcf4}{HessenbergDecomposition}}(\mbox{\hyperlink{classEigen_1_1HessenbergDecomposition_a94e001b3a7c99b1813cfeba43e947eef}{Index}} size = Size==\mbox{\hyperlink{namespaceEigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}} ? 2 : Size)}
\DoxyCodeLine{103       : m\_matrix(size,size),}
\DoxyCodeLine{104         m\_temp(size),}
\DoxyCodeLine{105         m\_isInitialized(false)}
\DoxyCodeLine{106     \{}
\DoxyCodeLine{107       \textcolor{keywordflow}{if}(size>1)}
\DoxyCodeLine{108         m\_hCoeffs.resize(size-\/1);}
\DoxyCodeLine{109     \}}
\DoxyCodeLine{110 }
\DoxyCodeLine{120     \textcolor{keyword}{template}<\textcolor{keyword}{typename} InputType>}
\DoxyCodeLine{121     \textcolor{keyword}{explicit} \mbox{\hyperlink{classEigen_1_1HessenbergDecomposition_a4e2aeb88b7d1d9f580f33d3c7735c9e7}{HessenbergDecomposition}}(\textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1EigenBase}{EigenBase<InputType>}}\& matrix)}
\DoxyCodeLine{122       : m\_matrix(matrix.derived()),}
\DoxyCodeLine{123         m\_temp(matrix.rows()),}
\DoxyCodeLine{124         m\_isInitialized(false)}
\DoxyCodeLine{125     \{}
\DoxyCodeLine{126       \textcolor{keywordflow}{if}(matrix.\mbox{\hyperlink{structEigen_1_1EigenBase_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}()<2)}
\DoxyCodeLine{127       \{}
\DoxyCodeLine{128         m\_isInitialized = \textcolor{keyword}{true};}
\DoxyCodeLine{129         \textcolor{keywordflow}{return};}
\DoxyCodeLine{130       \}}
\DoxyCodeLine{131       m\_hCoeffs.resize(matrix.\mbox{\hyperlink{structEigen_1_1EigenBase_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}()-\/1,1);}
\DoxyCodeLine{132       \_compute(m\_matrix, m\_hCoeffs, m\_temp);}
\DoxyCodeLine{133       m\_isInitialized = \textcolor{keyword}{true};}
\DoxyCodeLine{134     \}}
\DoxyCodeLine{135 }
\DoxyCodeLine{153     \textcolor{keyword}{template}<\textcolor{keyword}{typename} InputType>}
\DoxyCodeLine{154     \mbox{\hyperlink{classEigen_1_1HessenbergDecomposition}{HessenbergDecomposition}}\& \mbox{\hyperlink{classEigen_1_1HessenbergDecomposition_aae9f6d9d7431eb6b7cd518bfd43dc11b}{compute}}(\textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1EigenBase}{EigenBase<InputType>}}\& matrix)}
\DoxyCodeLine{155     \{}
\DoxyCodeLine{156       m\_matrix = matrix.\mbox{\hyperlink{structEigen_1_1EigenBase_ab4cf3e6bb046a94a46b69b857bd3dbc9}{derived}}();}
\DoxyCodeLine{157       \textcolor{keywordflow}{if}(matrix.\mbox{\hyperlink{structEigen_1_1EigenBase_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}()<2)}
\DoxyCodeLine{158       \{}
\DoxyCodeLine{159         m\_isInitialized = \textcolor{keyword}{true};}
\DoxyCodeLine{160         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{161       \}}
\DoxyCodeLine{162       m\_hCoeffs.resize(matrix.\mbox{\hyperlink{structEigen_1_1EigenBase_af1d12fdb3361e150427e1fd94ebb1f14}{rows}}()-\/1,1);}
\DoxyCodeLine{163       \_compute(m\_matrix, m\_hCoeffs, m\_temp);}
\DoxyCodeLine{164       m\_isInitialized = \textcolor{keyword}{true};}
\DoxyCodeLine{165       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{166     \}}
\DoxyCodeLine{167 }
\DoxyCodeLine{181     \textcolor{keyword}{const} \mbox{\hyperlink{classEigen_1_1Matrix}{CoeffVectorType}}\& \mbox{\hyperlink{classEigen_1_1HessenbergDecomposition_aeca14d158d202bfa9522ab40c1759551}{householderCoefficients}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{182 \textcolor{keyword}{    }\{}
\DoxyCodeLine{183       eigen\_assert(m\_isInitialized \&\& \textcolor{stringliteral}{"{}HessenbergDecomposition is not initialized."{}});}
\DoxyCodeLine{184       \textcolor{keywordflow}{return} m\_hCoeffs;}
\DoxyCodeLine{185     \}}
\DoxyCodeLine{186 }
\DoxyCodeLine{216     \textcolor{keyword}{const} \mbox{\hyperlink{classEigen_1_1HessenbergDecomposition_ae7caa77e42d01241ee2acb653e878431}{MatrixType}}\& \mbox{\hyperlink{classEigen_1_1HessenbergDecomposition_a83392cf3cb999db6150d64218ba0d5a8}{packedMatrix}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{217 \textcolor{keyword}{    }\{}
\DoxyCodeLine{218       eigen\_assert(m\_isInitialized \&\& \textcolor{stringliteral}{"{}HessenbergDecomposition is not initialized."{}});}
\DoxyCodeLine{219       \textcolor{keywordflow}{return} m\_matrix;}
\DoxyCodeLine{220     \}}
\DoxyCodeLine{221 }
\DoxyCodeLine{236     \mbox{\hyperlink{classEigen_1_1HouseholderSequence}{HouseholderSequenceType}} \mbox{\hyperlink{classEigen_1_1HessenbergDecomposition_a89702bceeb4b3d4ebedeb62d4f3e224b}{matrixQ}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{237 \textcolor{keyword}{    }\{}
\DoxyCodeLine{238       eigen\_assert(m\_isInitialized \&\& \textcolor{stringliteral}{"{}HessenbergDecomposition is not initialized."{}});}
\DoxyCodeLine{239       \textcolor{keywordflow}{return} \mbox{\hyperlink{classEigen_1_1HessenbergDecomposition_ae887b5bcfa63839fdceaee4dd83bdbc9}{HouseholderSequenceType}}(m\_matrix, m\_hCoeffs.conjugate())}
\DoxyCodeLine{240              .setLength(m\_matrix.rows() -\/ 1)}
\DoxyCodeLine{241              .setShift(1);}
\DoxyCodeLine{242     \}}
\DoxyCodeLine{243 }
\DoxyCodeLine{264     \mbox{\hyperlink{structEigen_1_1internal_1_1HessenbergDecompositionMatrixHReturnType}{MatrixHReturnType}} \mbox{\hyperlink{classEigen_1_1HessenbergDecomposition_a860542861de9cfec2543423c7313d7a2}{matrixH}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{265 \textcolor{keyword}{    }\{}
\DoxyCodeLine{266       eigen\_assert(m\_isInitialized \&\& \textcolor{stringliteral}{"{}HessenbergDecomposition is not initialized."{}});}
\DoxyCodeLine{267       \textcolor{keywordflow}{return} \mbox{\hyperlink{structEigen_1_1internal_1_1HessenbergDecompositionMatrixHReturnType}{MatrixHReturnType}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{268     \}}
\DoxyCodeLine{269 }
\DoxyCodeLine{270   \textcolor{keyword}{private}:}
\DoxyCodeLine{271 }
\DoxyCodeLine{272     \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix}}<\mbox{\hyperlink{classEigen_1_1HessenbergDecomposition_a31c9b1902c14a85109da3fd9b7b1f221}{Scalar}}, 1, Size, int(Options) | int(\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a77c993a8d9f6efe5c1159fb2ab07dd4f}{RowMajor}}), 1, MaxSize> VectorType;}
\DoxyCodeLine{273     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \mbox{\hyperlink{structEigen_1_1NumTraits}{NumTraits<Scalar>::Real}} RealScalar;}
\DoxyCodeLine{274     \textcolor{keyword}{static} \textcolor{keywordtype}{void} \_compute(\mbox{\hyperlink{classEigen_1_1HessenbergDecomposition_ae7caa77e42d01241ee2acb653e878431}{MatrixType}}\& matA, \mbox{\hyperlink{classEigen_1_1HessenbergDecomposition_a02f99fc02c6d591efa640febabb5c085}{CoeffVectorType}}\& hCoeffs, VectorType\& temp);}
\DoxyCodeLine{275 }
\DoxyCodeLine{276   \textcolor{keyword}{protected}:}
\DoxyCodeLine{277     \mbox{\hyperlink{classEigen_1_1HessenbergDecomposition_ae7caa77e42d01241ee2acb653e878431}{MatrixType}} m\_matrix;}
\DoxyCodeLine{278     \mbox{\hyperlink{classEigen_1_1HessenbergDecomposition_a02f99fc02c6d591efa640febabb5c085}{CoeffVectorType}} m\_hCoeffs;}
\DoxyCodeLine{279     VectorType m\_temp;}
\DoxyCodeLine{280     \textcolor{keywordtype}{bool} m\_isInitialized;}
\DoxyCodeLine{281 \};}
\DoxyCodeLine{282 }
\DoxyCodeLine{295 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>}
\DoxyCodeLine{296 \textcolor{keywordtype}{void} HessenbergDecomposition<MatrixType>::\_compute(MatrixType\& matA, CoeffVectorType\& hCoeffs, VectorType\& temp)}
\DoxyCodeLine{297 \{}
\DoxyCodeLine{298   eigen\_assert(matA.rows()==matA.cols());}
\DoxyCodeLine{299   \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} n = matA.rows();}
\DoxyCodeLine{300   temp.resize(n);}
\DoxyCodeLine{301   \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} i = 0; i<n-\/1; ++i)}
\DoxyCodeLine{302   \{}
\DoxyCodeLine{303     \textcolor{comment}{// let's consider the vector v = i-\/th column starting at position i+1}}
\DoxyCodeLine{304     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} remainingSize = n-\/i-\/1;}
\DoxyCodeLine{305     RealScalar beta;}
\DoxyCodeLine{306     Scalar h;}
\DoxyCodeLine{307     matA.col(i).tail(remainingSize).makeHouseholderInPlace(h, beta);}
\DoxyCodeLine{308     matA.col(i).coeffRef(i+1) = beta;}
\DoxyCodeLine{309     hCoeffs.coeffRef(i) = h;}
\DoxyCodeLine{310 }
\DoxyCodeLine{311     \textcolor{comment}{// Apply similarity transformation to remaining columns,}}
\DoxyCodeLine{312     \textcolor{comment}{// i.e., compute A = H A H'}}
\DoxyCodeLine{313 }
\DoxyCodeLine{314     \textcolor{comment}{// A = H A}}
\DoxyCodeLine{315     matA.bottomRightCorner(remainingSize, remainingSize)}
\DoxyCodeLine{316         .applyHouseholderOnTheLeft(matA.col(i).tail(remainingSize-\/1), h, \&temp.coeffRef(0));}
\DoxyCodeLine{317 }
\DoxyCodeLine{318     \textcolor{comment}{// A = A H'}}
\DoxyCodeLine{319     matA.rightCols(remainingSize)}
\DoxyCodeLine{320         .applyHouseholderOnTheRight(matA.col(i).tail(remainingSize-\/1), numext::conj(h), \&temp.coeffRef(0));}
\DoxyCodeLine{321   \}}
\DoxyCodeLine{322 \}}
\DoxyCodeLine{323 }
\DoxyCodeLine{324 \textcolor{keyword}{namespace }internal \{}
\DoxyCodeLine{325 }
\DoxyCodeLine{341 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType> \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1HessenbergDecompositionMatrixHReturnType}{HessenbergDecompositionMatrixHReturnType}}}
\DoxyCodeLine{342 : \textcolor{keyword}{public} \mbox{\hyperlink{classEigen_1_1ReturnByValue}{ReturnByValue}}<HessenbergDecompositionMatrixHReturnType<MatrixType> >}
\DoxyCodeLine{343 \{}
\DoxyCodeLine{344   \textcolor{keyword}{public}:}
\DoxyCodeLine{349     \mbox{\hyperlink{structEigen_1_1internal_1_1HessenbergDecompositionMatrixHReturnType_aa6d46d84c1343c964c50457ca4ddf9fa}{HessenbergDecompositionMatrixHReturnType}}(\textcolor{keyword}{const} \mbox{\hyperlink{classEigen_1_1HessenbergDecomposition}{HessenbergDecomposition<MatrixType>}}\& hess) : m\_hess(hess) \{ \}}
\DoxyCodeLine{350 }
\DoxyCodeLine{356     \textcolor{keyword}{template} <\textcolor{keyword}{typename} ResultType>}
\DoxyCodeLine{357     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{structEigen_1_1internal_1_1HessenbergDecompositionMatrixHReturnType_a7f1d84113072d2d2e507d3821ff9f15c}{evalTo}}(ResultType\& result)\textcolor{keyword}{ const}}
\DoxyCodeLine{358 \textcolor{keyword}{    }\{}
\DoxyCodeLine{359       result = m\_hess.packedMatrix();}
\DoxyCodeLine{360       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} n = result.rows();}
\DoxyCodeLine{361       \textcolor{keywordflow}{if} (n>2)}
\DoxyCodeLine{362         result.bottomLeftCorner(n-\/2, n-\/2).template triangularView<Lower>().setZero();}
\DoxyCodeLine{363     \}}
\DoxyCodeLine{364 }
\DoxyCodeLine{365     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} rows()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_hess.packedMatrix().rows(); \}}
\DoxyCodeLine{366     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} cols()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_hess.packedMatrix().cols(); \}}
\DoxyCodeLine{367 }
\DoxyCodeLine{368   \textcolor{keyword}{protected}:}
\DoxyCodeLine{369     \textcolor{keyword}{const} HessenbergDecomposition<MatrixType>\& m\_hess;}
\DoxyCodeLine{370 \};}
\DoxyCodeLine{371 }
\DoxyCodeLine{372 \} \textcolor{comment}{// end namespace internal}}
\DoxyCodeLine{373 }
\DoxyCodeLine{374 \} \textcolor{comment}{// end namespace Eigen}}
\DoxyCodeLine{375 }
\DoxyCodeLine{376 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// EIGEN\_HESSENBERGDECOMPOSITION\_H}}

\end{DoxyCode}
