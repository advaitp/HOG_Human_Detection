\hypertarget{BFloat16_8h_source}{}\doxysection{BFloat16.\+h}
\label{BFloat16_8h_source}\index{include/Eigen/src/Core/arch/Default/BFloat16.h@{include/Eigen/src/Core/arch/Default/BFloat16.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/* Copyright 2017 The TensorFlow Authors. All Rights Reserved.}}
\DoxyCodeLine{2 \textcolor{comment}{}}
\DoxyCodeLine{3 \textcolor{comment}{Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{4 \textcolor{comment}{you may not use this file except in compliance with the License.}}
\DoxyCodeLine{5 \textcolor{comment}{You may obtain a copy of the License at}}
\DoxyCodeLine{6 \textcolor{comment}{}}
\DoxyCodeLine{7 \textcolor{comment}{    http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{}}
\DoxyCodeLine{9 \textcolor{comment}{Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{==============================================================================*/}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#ifndef EIGEN\_BFLOAT16\_H}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#define EIGEN\_BFLOAT16\_H}}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include "{}../../InternalHeaderCheck.h"{}}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#define BF16\_PACKET\_FUNCTION(PACKET\_F, PACKET\_BF16, METHOD)         \(\backslash\)}}
\DoxyCodeLine{22 \textcolor{preprocessor}{  template <>                                                       \(\backslash\)}}
\DoxyCodeLine{23 \textcolor{preprocessor}{  EIGEN\_DEFINE\_FUNCTION\_ALLOWING\_MULTIPLE\_DEFINITIONS EIGEN\_UNUSED  \(\backslash\)}}
\DoxyCodeLine{24 \textcolor{preprocessor}{  PACKET\_BF16 METHOD<PACKET\_BF16>(const PACKET\_BF16\& \_x) \{          \(\backslash\)}}
\DoxyCodeLine{25 \textcolor{preprocessor}{    return F32ToBf16(METHOD<PACKET\_F>(Bf16ToF32(\_x)));              \(\backslash\)}}
\DoxyCodeLine{26 \textcolor{preprocessor}{  \}}}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceEigen}{Eigen}} \{}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{keyword}{struct }bfloat16;}
\DoxyCodeLine{31 }
\DoxyCodeLine{32 \textcolor{keyword}{namespace }bfloat16\_impl \{}
\DoxyCodeLine{33 }
\DoxyCodeLine{34 \textcolor{comment}{// Make our own \_\_bfloat16\_raw definition.}}
\DoxyCodeLine{35 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1____bfloat16__raw}{\_\_bfloat16\_raw}} \{}
\DoxyCodeLine{36   EIGEN\_DEVICE\_FUNC EIGEN\_CONSTEXPR \mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1____bfloat16__raw}{\_\_bfloat16\_raw}}() : value(0) \{\}}
\DoxyCodeLine{37   \textcolor{keyword}{explicit} EIGEN\_DEVICE\_FUNC EIGEN\_CONSTEXPR \mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1____bfloat16__raw}{\_\_bfloat16\_raw}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} raw) : value(raw) \{\}}
\DoxyCodeLine{38   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} value;}
\DoxyCodeLine{39 \};}
\DoxyCodeLine{40 }
\DoxyCodeLine{41 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC EIGEN\_CONSTEXPR \mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1____bfloat16__raw}{\_\_bfloat16\_raw}} raw\_uint16\_to\_bfloat16(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} value);}
\DoxyCodeLine{42 \textcolor{keyword}{template} <\textcolor{keywordtype}{bool} AssumeArgumentIsNormalOrInfinityOrZero>}
\DoxyCodeLine{43 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC \mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1____bfloat16__raw}{\_\_bfloat16\_raw}} float\_to\_bfloat16\_rtne(\textcolor{keywordtype}{float} ff);}
\DoxyCodeLine{44 \textcolor{comment}{// Forward declarations of template specializations, to avoid Visual C++ 2019 errors, saying:}}
\DoxyCodeLine{45 \textcolor{comment}{// > error C2908: explicit specialization; 'float\_to\_bfloat16\_rtne' has already been instantiated}}
\DoxyCodeLine{46 \textcolor{keyword}{template} <>}
\DoxyCodeLine{47 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC \mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1____bfloat16__raw}{\_\_bfloat16\_raw}} float\_to\_bfloat16\_rtne<false>(\textcolor{keywordtype}{float} ff);}
\DoxyCodeLine{48 \textcolor{keyword}{template} <>}
\DoxyCodeLine{49 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC \mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1____bfloat16__raw}{\_\_bfloat16\_raw}} float\_to\_bfloat16\_rtne<true>(\textcolor{keywordtype}{float} ff);}
\DoxyCodeLine{50 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC \textcolor{keywordtype}{float} bfloat16\_to\_float(\mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1____bfloat16__raw}{\_\_bfloat16\_raw}} h);}
\DoxyCodeLine{51 }
\DoxyCodeLine{52 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1bfloat16__base}{bfloat16\_base}} : \textcolor{keyword}{public} \mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1____bfloat16__raw}{\_\_bfloat16\_raw}} \{}
\DoxyCodeLine{53   EIGEN\_DEVICE\_FUNC EIGEN\_CONSTEXPR \mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1bfloat16__base}{bfloat16\_base}}() \{\}}
\DoxyCodeLine{54   EIGEN\_DEVICE\_FUNC EIGEN\_CONSTEXPR \mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1bfloat16__base}{bfloat16\_base}}(\textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1____bfloat16__raw}{\_\_bfloat16\_raw}}\& h) : \mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1____bfloat16__raw}{\_\_bfloat16\_raw}}(h) \{\}}
\DoxyCodeLine{55 \};}
\DoxyCodeLine{56 }
\DoxyCodeLine{57 \} \textcolor{comment}{// namespace bfloat16\_impl}}
\DoxyCodeLine{58 }
\DoxyCodeLine{59 \textcolor{comment}{// Class definition.}}
\DoxyCodeLine{60 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1bfloat16}{bfloat16}} : \textcolor{keyword}{public} \mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1bfloat16__base}{bfloat16\_impl::bfloat16\_base}} \{}
\DoxyCodeLine{61 }
\DoxyCodeLine{62   \textcolor{keyword}{typedef} \mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1____bfloat16__raw}{bfloat16\_impl::\_\_bfloat16\_raw}} \mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1____bfloat16__raw}{\_\_bfloat16\_raw}};}
\DoxyCodeLine{63 }
\DoxyCodeLine{64   EIGEN\_DEVICE\_FUNC EIGEN\_CONSTEXPR \mbox{\hyperlink{structEigen_1_1bfloat16}{bfloat16}}() \{\}}
\DoxyCodeLine{65 }
\DoxyCodeLine{66   EIGEN\_DEVICE\_FUNC EIGEN\_CONSTEXPR \mbox{\hyperlink{structEigen_1_1bfloat16}{bfloat16}}(\textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1____bfloat16__raw}{\_\_bfloat16\_raw}}\& h) : \mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1bfloat16__base}{bfloat16\_impl::bfloat16\_base}}(h) \{\}}
\DoxyCodeLine{67 }
\DoxyCodeLine{68   \textcolor{keyword}{explicit} EIGEN\_DEVICE\_FUNC EIGEN\_CONSTEXPR \mbox{\hyperlink{structEigen_1_1bfloat16}{bfloat16}}(\textcolor{keywordtype}{bool} b)}
\DoxyCodeLine{69       : \mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1bfloat16__base}{bfloat16\_impl::bfloat16\_base}}(bfloat16\_impl::raw\_uint16\_to\_bfloat16(b ? 0x3f80 : 0)) \{\}}
\DoxyCodeLine{70 }
\DoxyCodeLine{71   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{72   \textcolor{keyword}{explicit} EIGEN\_DEVICE\_FUNC EIGEN\_CONSTEXPR \mbox{\hyperlink{structEigen_1_1bfloat16}{bfloat16}}(T val)}
\DoxyCodeLine{73       : \mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1bfloat16__base}{bfloat16\_impl::bfloat16\_base}}(bfloat16\_impl::float\_to\_bfloat16\_rtne<\mbox{\hyperlink{structEigen_1_1internal_1_1is__integral}{internal::is\_integral<T>::value}}>(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(val))) \{\}}
\DoxyCodeLine{74 }
\DoxyCodeLine{75   \textcolor{keyword}{explicit} EIGEN\_DEVICE\_FUNC \mbox{\hyperlink{structEigen_1_1bfloat16}{bfloat16}}(\textcolor{keywordtype}{float} f)}
\DoxyCodeLine{76       : \mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1bfloat16__base}{bfloat16\_impl::bfloat16\_base}}(bfloat16\_impl::float\_to\_bfloat16\_rtne<false>(f)) \{\}}
\DoxyCodeLine{77 }
\DoxyCodeLine{78   \textcolor{comment}{// Following the convention of numpy, converting between complex and}}
\DoxyCodeLine{79   \textcolor{comment}{// float will lead to loss of imag value.}}
\DoxyCodeLine{80   \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealScalar>}
\DoxyCodeLine{81   \textcolor{keyword}{explicit} EIGEN\_DEVICE\_FUNC EIGEN\_CONSTEXPR \mbox{\hyperlink{structEigen_1_1bfloat16}{bfloat16}}(\textcolor{keyword}{const} std::complex<RealScalar>\& val)}
\DoxyCodeLine{82       : \mbox{\hyperlink{structEigen_1_1bfloat16__impl_1_1bfloat16__base}{bfloat16\_impl::bfloat16\_base}}(bfloat16\_impl::float\_to\_bfloat16\_rtne<false>(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(val.real()))) \{\}}
\DoxyCodeLine{83 }
\DoxyCodeLine{84   EIGEN\_DEVICE\_FUNC \textcolor{keyword}{operator} float()\textcolor{keyword}{ const }\{  \textcolor{comment}{// NOLINT: Allow implicit conversion to float, because it is lossless.}}
\DoxyCodeLine{85     \textcolor{keywordflow}{return} bfloat16\_impl::bfloat16\_to\_float(*\textcolor{keyword}{this});}
\DoxyCodeLine{86   \}}
\DoxyCodeLine{87 \};}
\DoxyCodeLine{88 \} \textcolor{comment}{// namespace Eigen}}
\DoxyCodeLine{89 }
\DoxyCodeLine{90 \textcolor{keyword}{namespace }std \{}
\DoxyCodeLine{91 \textcolor{keyword}{template}<>}
\DoxyCodeLine{92 \textcolor{keyword}{struct }numeric\_limits<\mbox{\hyperlink{namespaceEigen}{Eigen}}::bfloat16> \{}
\DoxyCodeLine{93   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{bool} is\_specialized = \textcolor{keyword}{true};}
\DoxyCodeLine{94   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{bool} is\_signed = \textcolor{keyword}{true};}
\DoxyCodeLine{95   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{bool} is\_integer = \textcolor{keyword}{false};}
\DoxyCodeLine{96   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{bool} is\_exact = \textcolor{keyword}{false};}
\DoxyCodeLine{97   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{bool} has\_infinity = \textcolor{keyword}{true};}
\DoxyCodeLine{98   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{bool} has\_quiet\_NaN = \textcolor{keyword}{true};}
\DoxyCodeLine{99   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{bool} has\_signaling\_NaN = \textcolor{keyword}{true};}
\DoxyCodeLine{100   \textcolor{keyword}{static} \textcolor{keyword}{const} float\_denorm\_style has\_denorm = std::denorm\_absent;}
\DoxyCodeLine{101   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{bool} has\_denorm\_loss = \textcolor{keyword}{false};}
\DoxyCodeLine{102   \textcolor{keyword}{static} \textcolor{keyword}{const} std::float\_round\_style round\_style = numeric\_limits<float>::round\_style;}
\DoxyCodeLine{103   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{bool} is\_iec559 = \textcolor{keyword}{false};}
\DoxyCodeLine{104   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{bool} is\_bounded = \textcolor{keyword}{true};}
\DoxyCodeLine{105   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{bool} is\_modulo = \textcolor{keyword}{false};}
\DoxyCodeLine{106   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} digits = 8;}
\DoxyCodeLine{107   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} digits10 = 2;}
\DoxyCodeLine{108   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} max\_digits10 = 4;}
\DoxyCodeLine{109   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} radix = 2;}
\DoxyCodeLine{110   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} min\_exponent = numeric\_limits<float>::min\_exponent;}
\DoxyCodeLine{111   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} min\_exponent10 = numeric\_limits<float>::min\_exponent10;}
\DoxyCodeLine{112   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} max\_exponent = numeric\_limits<float>::max\_exponent;}
\DoxyCodeLine{113   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} max\_exponent10 = numeric\_limits<float>::max\_exponent10;}
\DoxyCodeLine{114   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{bool} traps = numeric\_limits<float>::traps;}
\DoxyCodeLine{115   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{bool} tinyness\_before = numeric\_limits<float>::tinyness\_before;}
\DoxyCodeLine{116 }
\DoxyCodeLine{117   \textcolor{keyword}{static} \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}} (min)() \{ \textcolor{keywordflow}{return} Eigen::bfloat16\_impl::raw\_uint16\_to\_bfloat16(0x0080); \}}
\DoxyCodeLine{118   \textcolor{keyword}{static} \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}} lowest() \{ \textcolor{keywordflow}{return} Eigen::bfloat16\_impl::raw\_uint16\_to\_bfloat16(0xff7f); \}}
\DoxyCodeLine{119   \textcolor{keyword}{static} \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}} (max)() \{ \textcolor{keywordflow}{return} Eigen::bfloat16\_impl::raw\_uint16\_to\_bfloat16(0x7f7f); \}}
\DoxyCodeLine{120   \textcolor{keyword}{static} \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}} epsilon() \{ \textcolor{keywordflow}{return} Eigen::bfloat16\_impl::raw\_uint16\_to\_bfloat16(0x3c00); \}}
\DoxyCodeLine{121   \textcolor{keyword}{static} \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}} round\_error() \{ \textcolor{keywordflow}{return} \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}}(0x3f00); \}}
\DoxyCodeLine{122   \textcolor{keyword}{static} \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}} infinity() \{ \textcolor{keywordflow}{return} Eigen::bfloat16\_impl::raw\_uint16\_to\_bfloat16(0x7f80); \}}
\DoxyCodeLine{123   \textcolor{keyword}{static} \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}} quiet\_NaN() \{ \textcolor{keywordflow}{return} Eigen::bfloat16\_impl::raw\_uint16\_to\_bfloat16(0x7fc0); \}}
\DoxyCodeLine{124   \textcolor{keyword}{static} \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}} signaling\_NaN() \{ \textcolor{keywordflow}{return} Eigen::bfloat16\_impl::raw\_uint16\_to\_bfloat16(0x7f81); \}}
\DoxyCodeLine{125   \textcolor{keyword}{static} \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}} denorm\_min() \{ \textcolor{keywordflow}{return} Eigen::bfloat16\_impl::raw\_uint16\_to\_bfloat16(0x0001); \}}
\DoxyCodeLine{126 \};}
\DoxyCodeLine{127 }
\DoxyCodeLine{128 \textcolor{comment}{// If std::numeric\_limits<T> is specialized, should also specialize}}
\DoxyCodeLine{129 \textcolor{comment}{// std::numeric\_limits<const T>, std::numeric\_limits<volatile T>, and}}
\DoxyCodeLine{130 \textcolor{comment}{// std::numeric\_limits<const volatile T>}}
\DoxyCodeLine{131 \textcolor{comment}{// https://stackoverflow.com/a/16519653/}}
\DoxyCodeLine{132 \textcolor{keyword}{template}<>}
\DoxyCodeLine{133 \textcolor{keyword}{struct }numeric\_limits<const \mbox{\hyperlink{namespaceEigen}{Eigen}}::bfloat16> : numeric\_limits<Eigen::bfloat16> \{\};}
\DoxyCodeLine{134 \textcolor{keyword}{template}<>}
\DoxyCodeLine{135 \textcolor{keyword}{struct }numeric\_limits<volatile \mbox{\hyperlink{namespaceEigen}{Eigen}}::bfloat16> : numeric\_limits<Eigen::bfloat16> \{\};}
\DoxyCodeLine{136 \textcolor{keyword}{template}<>}
\DoxyCodeLine{137 \textcolor{keyword}{struct }numeric\_limits<const volatile \mbox{\hyperlink{namespaceEigen}{Eigen}}::bfloat16> : numeric\_limits<Eigen::bfloat16> \{\};}
\DoxyCodeLine{138 \} \textcolor{comment}{// namespace std}}
\DoxyCodeLine{139 }
\DoxyCodeLine{140 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceEigen}{Eigen}} \{}
\DoxyCodeLine{141 }
\DoxyCodeLine{142 \textcolor{keyword}{namespace }bfloat16\_impl \{}
\DoxyCodeLine{143 }
\DoxyCodeLine{144 \textcolor{comment}{// We need to distinguish ‘clang as the CUDA compiler’ from ‘clang as the host compiler,}}
\DoxyCodeLine{145 \textcolor{comment}{// invoked by NVCC’ (e.g. on MacOS). The former needs to see both host and device implementation}}
\DoxyCodeLine{146 \textcolor{comment}{// of the functions, while the latter can only deal with one of them.}}
\DoxyCodeLine{147 \textcolor{preprocessor}{\#if !defined(EIGEN\_HAS\_NATIVE\_BF16) || (EIGEN\_COMP\_CLANG \&\& !EIGEN\_COMP\_NVCC) }\textcolor{comment}{// Emulate support for bfloat16 floats}}
\DoxyCodeLine{148 }
\DoxyCodeLine{149 \textcolor{preprocessor}{\#if EIGEN\_COMP\_CLANG \&\& defined(EIGEN\_CUDACC)}}
\DoxyCodeLine{150 \textcolor{comment}{// We need to provide emulated *host-\/side* BF16 operators for clang.}}
\DoxyCodeLine{151 \textcolor{preprocessor}{\#pragma push\_macro("{}EIGEN\_DEVICE\_FUNC"{}})}
\DoxyCodeLine{152 \textcolor{preprocessor}{\#undef EIGEN\_DEVICE\_FUNC}}
\DoxyCodeLine{153 \textcolor{preprocessor}{\#if defined(EIGEN\_HAS\_CUDA\_BF16) \&\& defined(EIGEN\_HAS\_NATIVE\_BF16)}}
\DoxyCodeLine{154 \textcolor{preprocessor}{\#define EIGEN\_DEVICE\_FUNC \_\_host\_\_}}
\DoxyCodeLine{155 \textcolor{preprocessor}{\#else }\textcolor{comment}{// both host and device need emulated ops.}}
\DoxyCodeLine{156 \textcolor{preprocessor}{\#define EIGEN\_DEVICE\_FUNC \_\_host\_\_ \_\_device\_\_}}
\DoxyCodeLine{157 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{158 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{159 }
\DoxyCodeLine{160 \textcolor{comment}{// Definitions for CPUs, mostly working through conversion}}
\DoxyCodeLine{161 \textcolor{comment}{// to/from fp32.}}
\DoxyCodeLine{162 }
\DoxyCodeLine{163 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 operator + (\textcolor{keyword}{const} bfloat16\& a, \textcolor{keyword}{const} bfloat16\& b) \{}
\DoxyCodeLine{164   \textcolor{keywordflow}{return} bfloat16(\textcolor{keywordtype}{float}(a) + \textcolor{keywordtype}{float}(b));}
\DoxyCodeLine{165 \}}
\DoxyCodeLine{166 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 operator + (\textcolor{keyword}{const} bfloat16\& a, \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& b) \{}
\DoxyCodeLine{167   \textcolor{keywordflow}{return} bfloat16(\textcolor{keywordtype}{float}(a) + \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(b));}
\DoxyCodeLine{168 \}}
\DoxyCodeLine{169 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 operator + (\textcolor{keyword}{const} \textcolor{keywordtype}{int}\& a, \textcolor{keyword}{const} bfloat16\& b) \{}
\DoxyCodeLine{170   \textcolor{keywordflow}{return} bfloat16(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(a) + \textcolor{keywordtype}{float}(b));}
\DoxyCodeLine{171 \}}
\DoxyCodeLine{172 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 \mbox{\hyperlink{namespaceEigen_a32970f7eb62fe31eeefee72d24a046d0}{operator * }}(\textcolor{keyword}{const} bfloat16\& a, \textcolor{keyword}{const} bfloat16\& b) \{}
\DoxyCodeLine{173   \textcolor{keywordflow}{return} bfloat16(\textcolor{keywordtype}{float}(a) * \textcolor{keywordtype}{float}(b));}
\DoxyCodeLine{174 \}}
\DoxyCodeLine{175 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 operator -\/ (\textcolor{keyword}{const} bfloat16\& a, \textcolor{keyword}{const} bfloat16\& b) \{}
\DoxyCodeLine{176   \textcolor{keywordflow}{return} bfloat16(\textcolor{keywordtype}{float}(a) -\/ \textcolor{keywordtype}{float}(b));}
\DoxyCodeLine{177 \}}
\DoxyCodeLine{178 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 operator / (\textcolor{keyword}{const} bfloat16\& a, \textcolor{keyword}{const} bfloat16\& b) \{}
\DoxyCodeLine{179   \textcolor{keywordflow}{return} bfloat16(\textcolor{keywordtype}{float}(a) / \textcolor{keywordtype}{float}(b));}
\DoxyCodeLine{180 \}}
\DoxyCodeLine{181 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 operator -\/ (\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{182   bfloat16 result;}
\DoxyCodeLine{183   result.value = a.value \string^ 0x8000;}
\DoxyCodeLine{184   \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{185 \}}
\DoxyCodeLine{186 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16\& operator += (bfloat16\& a, \textcolor{keyword}{const} bfloat16\& b) \{}
\DoxyCodeLine{187   a = bfloat16(\textcolor{keywordtype}{float}(a) + \textcolor{keywordtype}{float}(b));}
\DoxyCodeLine{188   \textcolor{keywordflow}{return} a;}
\DoxyCodeLine{189 \}}
\DoxyCodeLine{190 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16\& operator *= (bfloat16\& a, \textcolor{keyword}{const} bfloat16\& b) \{}
\DoxyCodeLine{191   a = bfloat16(\textcolor{keywordtype}{float}(a) * \textcolor{keywordtype}{float}(b));}
\DoxyCodeLine{192   \textcolor{keywordflow}{return} a;}
\DoxyCodeLine{193 \}}
\DoxyCodeLine{194 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16\& operator -\/= (bfloat16\& a, \textcolor{keyword}{const} bfloat16\& b) \{}
\DoxyCodeLine{195   a = bfloat16(\textcolor{keywordtype}{float}(a) -\/ \textcolor{keywordtype}{float}(b));}
\DoxyCodeLine{196   \textcolor{keywordflow}{return} a;}
\DoxyCodeLine{197 \}}
\DoxyCodeLine{198 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16\& operator /= (bfloat16\& a, \textcolor{keyword}{const} bfloat16\& b) \{}
\DoxyCodeLine{199   a = bfloat16(\textcolor{keywordtype}{float}(a) / \textcolor{keywordtype}{float}(b));}
\DoxyCodeLine{200   \textcolor{keywordflow}{return} a;}
\DoxyCodeLine{201 \}}
\DoxyCodeLine{202 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 operator++(bfloat16\& a) \{}
\DoxyCodeLine{203   a += bfloat16(1);}
\DoxyCodeLine{204   \textcolor{keywordflow}{return} a;}
\DoxyCodeLine{205 \}}
\DoxyCodeLine{206 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 operator-\/-\/(bfloat16\& a) \{}
\DoxyCodeLine{207   a -\/= bfloat16(1);}
\DoxyCodeLine{208   \textcolor{keywordflow}{return} a;}
\DoxyCodeLine{209 \}}
\DoxyCodeLine{210 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 operator++(bfloat16\& a, \textcolor{keywordtype}{int}) \{}
\DoxyCodeLine{211   bfloat16 original\_value = a;}
\DoxyCodeLine{212   ++a;}
\DoxyCodeLine{213   \textcolor{keywordflow}{return} original\_value;}
\DoxyCodeLine{214 \}}
\DoxyCodeLine{215 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 operator-\/-\/(bfloat16\& a, \textcolor{keywordtype}{int}) \{}
\DoxyCodeLine{216   bfloat16 original\_value = a;}
\DoxyCodeLine{217   -\/-\/a;}
\DoxyCodeLine{218   \textcolor{keywordflow}{return} original\_value;}
\DoxyCodeLine{219 \}}
\DoxyCodeLine{220 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC \textcolor{keywordtype}{bool} operator == (\textcolor{keyword}{const} bfloat16\& a, \textcolor{keyword}{const} bfloat16\& b) \{}
\DoxyCodeLine{221   \textcolor{keywordflow}{return} numext::equal\_strict(\textcolor{keywordtype}{float}(a),\textcolor{keywordtype}{float}(b));}
\DoxyCodeLine{222 \}}
\DoxyCodeLine{223 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC \textcolor{keywordtype}{bool} operator != (\textcolor{keyword}{const} bfloat16\& a, \textcolor{keyword}{const} bfloat16\& b) \{}
\DoxyCodeLine{224   \textcolor{keywordflow}{return} numext::not\_equal\_strict(\textcolor{keywordtype}{float}(a), \textcolor{keywordtype}{float}(b));}
\DoxyCodeLine{225 \}}
\DoxyCodeLine{226 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC \textcolor{keywordtype}{bool} operator < (\textcolor{keyword}{const} bfloat16\& a, \textcolor{keyword}{const} bfloat16\& b) \{}
\DoxyCodeLine{227   \textcolor{keywordflow}{return} float(a) < float(b);}
\DoxyCodeLine{228 \}}
\DoxyCodeLine{229 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC \textcolor{keywordtype}{bool} operator <= (\textcolor{keyword}{const} bfloat16\& a, \textcolor{keyword}{const} bfloat16\& b) \{}
\DoxyCodeLine{230   \textcolor{keywordflow}{return} float(a) <= float(b);}
\DoxyCodeLine{231 \}}
\DoxyCodeLine{232 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC \textcolor{keywordtype}{bool} operator > (\textcolor{keyword}{const} bfloat16\& a, \textcolor{keyword}{const} bfloat16\& b) \{}
\DoxyCodeLine{233   \textcolor{keywordflow}{return} float(a) > float(b);}
\DoxyCodeLine{234 \}}
\DoxyCodeLine{235 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC \textcolor{keywordtype}{bool} operator >= (\textcolor{keyword}{const} bfloat16\& a, \textcolor{keyword}{const} bfloat16\& b) \{}
\DoxyCodeLine{236   \textcolor{keywordflow}{return} float(a) >= float(b);}
\DoxyCodeLine{237 \}}
\DoxyCodeLine{238 }
\DoxyCodeLine{239 \textcolor{preprocessor}{\#if EIGEN\_COMP\_CLANG \&\& defined(EIGEN\_CUDACC)}}
\DoxyCodeLine{240 \textcolor{preprocessor}{\#pragma pop\_macro("{}EIGEN\_DEVICE\_FUNC"{}})}
\DoxyCodeLine{241 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{242 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// Emulate support for bfloat16 floats}}
\DoxyCodeLine{243 }
\DoxyCodeLine{244 \textcolor{comment}{// Division by an index. Do it in full float precision to avoid accuracy}}
\DoxyCodeLine{245 \textcolor{comment}{// issues in converting the denominator to bfloat16.}}
\DoxyCodeLine{246 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 operator / (\textcolor{keyword}{const} bfloat16\& a, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} b) \{}
\DoxyCodeLine{247   \textcolor{keywordflow}{return} bfloat16(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(a) / \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(b));}
\DoxyCodeLine{248 \}}
\DoxyCodeLine{249 }
\DoxyCodeLine{250 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC \_\_bfloat16\_raw truncate\_to\_bfloat16(\textcolor{keyword}{const} \textcolor{keywordtype}{float} v) \{}
\DoxyCodeLine{251   \_\_bfloat16\_raw output;}
\DoxyCodeLine{252   \textcolor{keywordflow}{if} (Eigen::numext::isnan EIGEN\_NOT\_A\_MACRO(v)) \{}
\DoxyCodeLine{253     output.value = std::signbit(v) ? 0xFFC0: 0x7FC0;}
\DoxyCodeLine{254     \textcolor{keywordflow}{return} output;}
\DoxyCodeLine{255   \}}
\DoxyCodeLine{256   output.value = \textcolor{keyword}{static\_cast<}numext::uint16\_t\textcolor{keyword}{>}(numext::bit\_cast<numext::uint32\_t>(v) >> 16);}
\DoxyCodeLine{257   \textcolor{keywordflow}{return} output;}
\DoxyCodeLine{258 \}}
\DoxyCodeLine{259 }
\DoxyCodeLine{260 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC EIGEN\_CONSTEXPR \_\_bfloat16\_raw raw\_uint16\_to\_bfloat16(numext::uint16\_t value) \{}
\DoxyCodeLine{261   \textcolor{keywordflow}{return} \_\_bfloat16\_raw(value);}
\DoxyCodeLine{262 \}}
\DoxyCodeLine{263 }
\DoxyCodeLine{264 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC EIGEN\_CONSTEXPR numext::uint16\_t raw\_bfloat16\_as\_uint16(\textcolor{keyword}{const} \_\_bfloat16\_raw\& bf) \{}
\DoxyCodeLine{265   \textcolor{keywordflow}{return} bf.value;}
\DoxyCodeLine{266 \}}
\DoxyCodeLine{267 }
\DoxyCodeLine{268 \textcolor{comment}{// float\_to\_bfloat16\_rtne template specialization that does not make any}}
\DoxyCodeLine{269 \textcolor{comment}{// assumption about the value of its function argument (ff).}}
\DoxyCodeLine{270 \textcolor{keyword}{template} <>}
\DoxyCodeLine{271 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC \_\_bfloat16\_raw float\_to\_bfloat16\_rtne<false>(\textcolor{keywordtype}{float} ff) \{}
\DoxyCodeLine{272 \textcolor{preprocessor}{\#if (defined(EIGEN\_HAS\_CUDA\_BF16) \&\& defined(EIGEN\_HAS\_HIP\_BF16))}}
\DoxyCodeLine{273   \textcolor{comment}{// Nothing to do here}}
\DoxyCodeLine{274 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{275   \_\_bfloat16\_raw output;}
\DoxyCodeLine{276 }
\DoxyCodeLine{277   \textcolor{keywordflow}{if} (Eigen::numext::isnan EIGEN\_NOT\_A\_MACRO(ff)) \{}
\DoxyCodeLine{278     \textcolor{comment}{// If the value is a NaN, squash it to a qNaN with msb of fraction set,}}
\DoxyCodeLine{279     \textcolor{comment}{// this makes sure after truncation we don't end up with an inf.}}
\DoxyCodeLine{280     \textcolor{comment}{//}}
\DoxyCodeLine{281     \textcolor{comment}{// qNaN magic: All exponent bits set + most significant bit of fraction}}
\DoxyCodeLine{282     \textcolor{comment}{// set.}}
\DoxyCodeLine{283     output.value = std::signbit(ff) ? 0xFFC0: 0x7FC0;}
\DoxyCodeLine{284   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{285     \textcolor{comment}{// Fast rounding algorithm that rounds a half value to nearest even. This}}
\DoxyCodeLine{286     \textcolor{comment}{// reduces expected error when we convert a large number of floats. Here}}
\DoxyCodeLine{287     \textcolor{comment}{// is how it works:}}
\DoxyCodeLine{288     \textcolor{comment}{//}}
\DoxyCodeLine{289     \textcolor{comment}{// Definitions:}}
\DoxyCodeLine{290     \textcolor{comment}{// To convert a float 32 to bfloat16, a float 32 can be viewed as 32 bits}}
\DoxyCodeLine{291     \textcolor{comment}{// with the following tags:}}
\DoxyCodeLine{292     \textcolor{comment}{//}}
\DoxyCodeLine{293     \textcolor{comment}{// Sign |  Exp (8 bits) | Frac (23 bits)}}
\DoxyCodeLine{294     \textcolor{comment}{//  S     EEEEEEEE         FFFFFFLRTTTTTTTTTTTTTTT}}
\DoxyCodeLine{295     \textcolor{comment}{//}}
\DoxyCodeLine{296     \textcolor{comment}{//  S: Sign bit.}}
\DoxyCodeLine{297     \textcolor{comment}{//  E: Exponent bits.}}
\DoxyCodeLine{298     \textcolor{comment}{//  F: First 6 bits of fraction.}}
\DoxyCodeLine{299     \textcolor{comment}{//  L: Least significant bit of resulting bfloat16 if we truncate away the}}
\DoxyCodeLine{300     \textcolor{comment}{//  rest of the float32. This is also the 7th bit of fraction}}
\DoxyCodeLine{301     \textcolor{comment}{//  R: Rounding bit, 8th bit of fraction.}}
\DoxyCodeLine{302     \textcolor{comment}{//  T: Sticky bits, rest of fraction, 15 bits.}}
\DoxyCodeLine{303     \textcolor{comment}{//}}
\DoxyCodeLine{304     \textcolor{comment}{// To round half to nearest even, there are 3 cases where we want to round}}
\DoxyCodeLine{305     \textcolor{comment}{// down (simply truncate the result of the bits away, which consists of}}
\DoxyCodeLine{306     \textcolor{comment}{// rounding bit and sticky bits) and two cases where we want to round up}}
\DoxyCodeLine{307     \textcolor{comment}{// (truncate then add one to the result).}}
\DoxyCodeLine{308     \textcolor{comment}{//}}
\DoxyCodeLine{309     \textcolor{comment}{// The fast converting algorithm simply adds lsb (L) to 0x7fff (15 bits of}}
\DoxyCodeLine{310     \textcolor{comment}{// 1s) as the rounding bias, adds the rounding bias to the input, then}}
\DoxyCodeLine{311     \textcolor{comment}{// truncates the last 16 bits away.}}
\DoxyCodeLine{312     \textcolor{comment}{//}}
\DoxyCodeLine{313     \textcolor{comment}{// To understand how it works, we can analyze this algorithm case by case:}}
\DoxyCodeLine{314     \textcolor{comment}{//}}
\DoxyCodeLine{315     \textcolor{comment}{// 1. L = 0, R = 0:}}
\DoxyCodeLine{316     \textcolor{comment}{//   Expect: round down, this is less than half value.}}
\DoxyCodeLine{317     \textcolor{comment}{//}}
\DoxyCodeLine{318     \textcolor{comment}{//   Algorithm:}}
\DoxyCodeLine{319     \textcolor{comment}{//   -\/ Rounding bias: 0x7fff + 0 = 0x7fff}}
\DoxyCodeLine{320     \textcolor{comment}{//   -\/ Adding rounding bias to input may create any carry, depending on}}
\DoxyCodeLine{321     \textcolor{comment}{//   whether there is any value set to 1 in T bits.}}
\DoxyCodeLine{322     \textcolor{comment}{//   -\/ R may be set to 1 if there is a carry.}}
\DoxyCodeLine{323     \textcolor{comment}{//   -\/ L remains 0.}}
\DoxyCodeLine{324     \textcolor{comment}{//   -\/ Note that this case also handles Inf and -\/Inf, where all fraction}}
\DoxyCodeLine{325     \textcolor{comment}{//   bits, including L, R and Ts are all 0. The output remains Inf after}}
\DoxyCodeLine{326     \textcolor{comment}{//   this algorithm.}}
\DoxyCodeLine{327     \textcolor{comment}{//}}
\DoxyCodeLine{328     \textcolor{comment}{// 2. L = 1, R = 0:}}
\DoxyCodeLine{329     \textcolor{comment}{//   Expect: round down, this is less than half value.}}
\DoxyCodeLine{330     \textcolor{comment}{//}}
\DoxyCodeLine{331     \textcolor{comment}{//   Algorithm:}}
\DoxyCodeLine{332     \textcolor{comment}{//   -\/ Rounding bias: 0x7fff + 1 = 0x8000}}
\DoxyCodeLine{333     \textcolor{comment}{//   -\/ Adding rounding bias to input doesn't change sticky bits but}}
\DoxyCodeLine{334     \textcolor{comment}{//   adds 1 to rounding bit.}}
\DoxyCodeLine{335     \textcolor{comment}{//   -\/ L remains 1.}}
\DoxyCodeLine{336     \textcolor{comment}{//}}
\DoxyCodeLine{337     \textcolor{comment}{// 3. L = 0, R = 1, all of T are 0:}}
\DoxyCodeLine{338     \textcolor{comment}{//   Expect: round down, this is exactly at half, the result is already}}
\DoxyCodeLine{339     \textcolor{comment}{//   even (L=0).}}
\DoxyCodeLine{340     \textcolor{comment}{//}}
\DoxyCodeLine{341     \textcolor{comment}{//   Algorithm:}}
\DoxyCodeLine{342     \textcolor{comment}{//   -\/ Rounding bias: 0x7fff + 0 = 0x7fff}}
\DoxyCodeLine{343     \textcolor{comment}{//   -\/ Adding rounding bias to input sets all sticky bits to 1, but}}
\DoxyCodeLine{344     \textcolor{comment}{//   doesn't create a carry.}}
\DoxyCodeLine{345     \textcolor{comment}{//   -\/ R remains 1.}}
\DoxyCodeLine{346     \textcolor{comment}{//   -\/ L remains 0.}}
\DoxyCodeLine{347     \textcolor{comment}{//}}
\DoxyCodeLine{348     \textcolor{comment}{// 4. L = 1, R = 1:}}
\DoxyCodeLine{349     \textcolor{comment}{//   Expect: round up, this is exactly at half, the result needs to be}}
\DoxyCodeLine{350     \textcolor{comment}{//   round to the next even number.}}
\DoxyCodeLine{351     \textcolor{comment}{//}}
\DoxyCodeLine{352     \textcolor{comment}{//   Algorithm:}}
\DoxyCodeLine{353     \textcolor{comment}{//   -\/ Rounding bias: 0x7fff + 1 = 0x8000}}
\DoxyCodeLine{354     \textcolor{comment}{//   -\/ Adding rounding bias to input doesn't change sticky bits, but}}
\DoxyCodeLine{355     \textcolor{comment}{//   creates a carry from rounding bit.}}
\DoxyCodeLine{356     \textcolor{comment}{//   -\/ The carry sets L to 0, creates another carry bit and propagate}}
\DoxyCodeLine{357     \textcolor{comment}{//   forward to F bits.}}
\DoxyCodeLine{358     \textcolor{comment}{//   -\/ If all the F bits are 1, a carry then propagates to the exponent}}
\DoxyCodeLine{359     \textcolor{comment}{//   bits, which then creates the minimum value with the next exponent}}
\DoxyCodeLine{360     \textcolor{comment}{//   value. Note that we won't have the case where exponents are all 1,}}
\DoxyCodeLine{361     \textcolor{comment}{//   since that's either a NaN (handled in the other if condition) or inf}}
\DoxyCodeLine{362     \textcolor{comment}{//   (handled in case 1).}}
\DoxyCodeLine{363     \textcolor{comment}{//}}
\DoxyCodeLine{364     \textcolor{comment}{// 5. L = 0, R = 1, any of T is 1:}}
\DoxyCodeLine{365     \textcolor{comment}{//   Expect: round up, this is greater than half.}}
\DoxyCodeLine{366     \textcolor{comment}{//}}
\DoxyCodeLine{367     \textcolor{comment}{//   Algorithm:}}
\DoxyCodeLine{368     \textcolor{comment}{//   -\/ Rounding bias: 0x7fff + 0 = 0x7fff}}
\DoxyCodeLine{369     \textcolor{comment}{//   -\/ Adding rounding bias to input creates a carry from sticky bits,}}
\DoxyCodeLine{370     \textcolor{comment}{//   sets rounding bit to 0, then create another carry.}}
\DoxyCodeLine{371     \textcolor{comment}{//   -\/ The second carry sets L to 1.}}
\DoxyCodeLine{372     \textcolor{comment}{//}}
\DoxyCodeLine{373     \textcolor{comment}{// Examples:}}
\DoxyCodeLine{374     \textcolor{comment}{//}}
\DoxyCodeLine{375     \textcolor{comment}{//  Exact half value that is already even:}}
\DoxyCodeLine{376     \textcolor{comment}{//    Input:}}
\DoxyCodeLine{377     \textcolor{comment}{//    Sign |  Exp (8 bit)     | Frac (first 7 bit) | Frac (last 16 bit)}}
\DoxyCodeLine{378     \textcolor{comment}{//     S     E E E E E E E E      F F F F F F L     RTTTTTTTTTTTTTTT}}
\DoxyCodeLine{379     \textcolor{comment}{//     0     0 0 0 0 0 0 0 0      0 0 0 0 0 1 0     1000000000000000}}
\DoxyCodeLine{380     \textcolor{comment}{//}}
\DoxyCodeLine{381     \textcolor{comment}{//     This falls into case 3. We truncate the rest of 16 bits and no}}
\DoxyCodeLine{382     \textcolor{comment}{//     carry is created into F and L:}}
\DoxyCodeLine{383     \textcolor{comment}{//}}
\DoxyCodeLine{384     \textcolor{comment}{//    Output:}}
\DoxyCodeLine{385     \textcolor{comment}{//    Sign |  Exp (8 bit)     | Frac (first 7 bit)}}
\DoxyCodeLine{386     \textcolor{comment}{//     S     E E E E E E E E      F F F F F F L}}
\DoxyCodeLine{387     \textcolor{comment}{//     0     0 0 0 0 0 0 0 0      0 0 0 0 0 1 0}}
\DoxyCodeLine{388     \textcolor{comment}{//}}
\DoxyCodeLine{389     \textcolor{comment}{//  Exact half value, round to next even number:}}
\DoxyCodeLine{390     \textcolor{comment}{//    Input:}}
\DoxyCodeLine{391     \textcolor{comment}{//    Sign |  Exp (8 bit)     | Frac (first 7 bit) | Frac (last 16 bit)}}
\DoxyCodeLine{392     \textcolor{comment}{//     S     E E E E E E E E      F F F F F F L     RTTTTTTTTTTTTTTT}}
\DoxyCodeLine{393     \textcolor{comment}{//     0     0 0 0 0 0 0 0 0      0 0 0 0 0 0 1     1000000000000000}}
\DoxyCodeLine{394     \textcolor{comment}{//}}
\DoxyCodeLine{395     \textcolor{comment}{//     This falls into case 4. We create a carry from R and T,}}
\DoxyCodeLine{396     \textcolor{comment}{//     which then propagates into L and F:}}
\DoxyCodeLine{397     \textcolor{comment}{//}}
\DoxyCodeLine{398     \textcolor{comment}{//    Output:}}
\DoxyCodeLine{399     \textcolor{comment}{//    Sign |  Exp (8 bit)     | Frac (first 7 bit)}}
\DoxyCodeLine{400     \textcolor{comment}{//     S     E E E E E E E E      F F F F F F L}}
\DoxyCodeLine{401     \textcolor{comment}{//     0     0 0 0 0 0 0 0 0      0 0 0 0 0 1 0}}
\DoxyCodeLine{402     \textcolor{comment}{//}}
\DoxyCodeLine{403     \textcolor{comment}{//}}
\DoxyCodeLine{404     \textcolor{comment}{//  Max denormal value round to min normal value:}}
\DoxyCodeLine{405     \textcolor{comment}{//    Input:}}
\DoxyCodeLine{406     \textcolor{comment}{//    Sign |  Exp (8 bit)     | Frac (first 7 bit) | Frac (last 16 bit)}}
\DoxyCodeLine{407     \textcolor{comment}{//     S     E E E E E E E E      F F F F F F L     RTTTTTTTTTTTTTTT}}
\DoxyCodeLine{408     \textcolor{comment}{//     0     0 0 0 0 0 0 0 0      1 1 1 1 1 1 1     1111111111111111}}
\DoxyCodeLine{409     \textcolor{comment}{//}}
\DoxyCodeLine{410     \textcolor{comment}{//     This falls into case 4. We create a carry from R and T,}}
\DoxyCodeLine{411     \textcolor{comment}{//     propagate into L and F, which then propagates into exponent}}
\DoxyCodeLine{412     \textcolor{comment}{//     bits:}}
\DoxyCodeLine{413     \textcolor{comment}{//}}
\DoxyCodeLine{414     \textcolor{comment}{//    Output:}}
\DoxyCodeLine{415     \textcolor{comment}{//    Sign |  Exp (8 bit)     | Frac (first 7 bit)}}
\DoxyCodeLine{416     \textcolor{comment}{//     S     E E E E E E E E      F F F F F F L}}
\DoxyCodeLine{417     \textcolor{comment}{//     0     0 0 0 0 0 0 0 1      0 0 0 0 0 0 0}}
\DoxyCodeLine{418     \textcolor{comment}{//}}
\DoxyCodeLine{419     \textcolor{comment}{//  Max normal value round to Inf:}}
\DoxyCodeLine{420     \textcolor{comment}{//    Input:}}
\DoxyCodeLine{421     \textcolor{comment}{//    Sign |  Exp (8 bit)     | Frac (first 7 bit) | Frac (last 16 bit)}}
\DoxyCodeLine{422     \textcolor{comment}{//     S     E E E E E E E E      F F F F F F L     RTTTTTTTTTTTTTTT}}
\DoxyCodeLine{423     \textcolor{comment}{//     0     1 1 1 1 1 1 1 0      1 1 1 1 1 1 1     1111111111111111}}
\DoxyCodeLine{424     \textcolor{comment}{//}}
\DoxyCodeLine{425     \textcolor{comment}{//     This falls into case 4. We create a carry from R and T,}}
\DoxyCodeLine{426     \textcolor{comment}{//     propagate into L and F, which then propagates into exponent}}
\DoxyCodeLine{427     \textcolor{comment}{//     bits:}}
\DoxyCodeLine{428     \textcolor{comment}{//}}
\DoxyCodeLine{429     \textcolor{comment}{//    Sign |  Exp (8 bit)     | Frac (first 7 bit)}}
\DoxyCodeLine{430     \textcolor{comment}{//     S     E E E E E E E E      F F F F F F L}}
\DoxyCodeLine{431     \textcolor{comment}{//     0     1 1 1 1 1 1 1 1      0 0 0 0 0 0 0}}
\DoxyCodeLine{432 }
\DoxyCodeLine{433     \textcolor{comment}{// At this point, ff must be either a normal float, or +/-\/infinity.}}
\DoxyCodeLine{434     output = float\_to\_bfloat16\_rtne<true>(ff);}
\DoxyCodeLine{435   \}}
\DoxyCodeLine{436   \textcolor{keywordflow}{return} output;}
\DoxyCodeLine{437 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{438 \}}
\DoxyCodeLine{439 }
\DoxyCodeLine{440 \textcolor{comment}{// float\_to\_bfloat16\_rtne template specialization that assumes that its function}}
\DoxyCodeLine{441 \textcolor{comment}{// argument (ff) is either a normal floating point number, or +/-\/infinity, or}}
\DoxyCodeLine{442 \textcolor{comment}{// zero. Used to improve the runtime performance of conversion from an integer}}
\DoxyCodeLine{443 \textcolor{comment}{// type to bfloat16.}}
\DoxyCodeLine{444 \textcolor{keyword}{template} <>}
\DoxyCodeLine{445 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC \_\_bfloat16\_raw float\_to\_bfloat16\_rtne<true>(\textcolor{keywordtype}{float} ff) \{}
\DoxyCodeLine{446 \textcolor{preprocessor}{\#if (defined(EIGEN\_HAS\_CUDA\_BF16) \&\& defined(EIGEN\_HAS\_HIP\_BF16))}}
\DoxyCodeLine{447     \textcolor{comment}{// Nothing to do here}}
\DoxyCodeLine{448 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{449     numext::uint32\_t input = numext::bit\_cast<numext::uint32\_t>(ff);}
\DoxyCodeLine{450     \_\_bfloat16\_raw output;}
\DoxyCodeLine{451 }
\DoxyCodeLine{452     \textcolor{comment}{// Least significant bit of resulting bfloat.}}
\DoxyCodeLine{453     numext::uint32\_t lsb = (input >> 16) \& 1;}
\DoxyCodeLine{454     numext::uint32\_t rounding\_bias = 0x7fff + lsb;}
\DoxyCodeLine{455     input += rounding\_bias;}
\DoxyCodeLine{456     output.value = \textcolor{keyword}{static\_cast<}numext::uint16\_t\textcolor{keyword}{>}(input >> 16);}
\DoxyCodeLine{457     \textcolor{keywordflow}{return} output;}
\DoxyCodeLine{458 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{459 \}}
\DoxyCodeLine{460 }
\DoxyCodeLine{461 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC \textcolor{keywordtype}{float} bfloat16\_to\_float(\_\_bfloat16\_raw h) \{}
\DoxyCodeLine{462     \textcolor{keywordflow}{return} numext::bit\_cast<float>(\textcolor{keyword}{static\_cast<}numext::uint32\_t\textcolor{keyword}{>}(h.value) << 16);}
\DoxyCodeLine{463 \}}
\DoxyCodeLine{464 \textcolor{comment}{// -\/-\/-\/ standard functions -\/-\/-\/}}
\DoxyCodeLine{465 }
\DoxyCodeLine{466 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bool (isinf)(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{467   EIGEN\_USING\_STD(isinf);}
\DoxyCodeLine{468   \textcolor{keywordflow}{return} (isinf)(float(a));}
\DoxyCodeLine{469 \}}
\DoxyCodeLine{470 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bool (isnan)(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{471   EIGEN\_USING\_STD(isnan);}
\DoxyCodeLine{472   \textcolor{keywordflow}{return} (isnan)(float(a));}
\DoxyCodeLine{473 \}}
\DoxyCodeLine{474 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bool (isfinite)(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{475   \textcolor{keywordflow}{return} !(isinf EIGEN\_NOT\_A\_MACRO (a)) \&\& !(isnan EIGEN\_NOT\_A\_MACRO (a));}
\DoxyCodeLine{476 \}}
\DoxyCodeLine{477 }
\DoxyCodeLine{478 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 abs(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{479   bfloat16 result;}
\DoxyCodeLine{480   result.value = a.value \& 0x7FFF;}
\DoxyCodeLine{481   \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{482 \}}
\DoxyCodeLine{483 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 exp(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{484    \textcolor{keywordflow}{return} bfloat16(::expf(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{485 \}}
\DoxyCodeLine{486 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 expm1(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{487   \textcolor{keywordflow}{return} bfloat16(numext::expm1(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{488 \}}
\DoxyCodeLine{489 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 log(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{490   \textcolor{keywordflow}{return} bfloat16(::logf(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{491 \}}
\DoxyCodeLine{492 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 log1p(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{493   \textcolor{keywordflow}{return} bfloat16(numext::log1p(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{494 \}}
\DoxyCodeLine{495 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 log10(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{496   \textcolor{keywordflow}{return} bfloat16(::log10f(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{497 \}}
\DoxyCodeLine{498 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 log2(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{499   \textcolor{keywordflow}{return} bfloat16(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(EIGEN\_LOG2E) * ::logf(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{500 \}}
\DoxyCodeLine{501 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 sqrt(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{502     \textcolor{keywordflow}{return} bfloat16(::sqrtf(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{503 \}}
\DoxyCodeLine{504 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 pow(\textcolor{keyword}{const} bfloat16\& a, \textcolor{keyword}{const} bfloat16\& b) \{}
\DoxyCodeLine{505   \textcolor{keywordflow}{return} bfloat16(::powf(\textcolor{keywordtype}{float}(a), \textcolor{keywordtype}{float}(b)));}
\DoxyCodeLine{506 \}}
\DoxyCodeLine{507 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 sin(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{508   \textcolor{keywordflow}{return} bfloat16(::sinf(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{509 \}}
\DoxyCodeLine{510 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 cos(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{511   \textcolor{keywordflow}{return} bfloat16(::cosf(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{512 \}}
\DoxyCodeLine{513 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 tan(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{514   \textcolor{keywordflow}{return} bfloat16(::tanf(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{515 \}}
\DoxyCodeLine{516 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 asin(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{517   \textcolor{keywordflow}{return} bfloat16(::asinf(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{518 \}}
\DoxyCodeLine{519 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 acos(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{520   \textcolor{keywordflow}{return} bfloat16(::acosf(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{521 \}}
\DoxyCodeLine{522 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 atan(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{523   \textcolor{keywordflow}{return} bfloat16(::atanf(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{524 \}}
\DoxyCodeLine{525 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 sinh(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{526   \textcolor{keywordflow}{return} bfloat16(::sinhf(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{527 \}}
\DoxyCodeLine{528 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 cosh(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{529   \textcolor{keywordflow}{return} bfloat16(::coshf(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{530 \}}
\DoxyCodeLine{531 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 tanh(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{532   \textcolor{keywordflow}{return} bfloat16(::tanhf(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{533 \}}
\DoxyCodeLine{534 \textcolor{preprocessor}{\#if EIGEN\_HAS\_CXX11\_MATH}}
\DoxyCodeLine{535 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 asinh(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{536   \textcolor{keywordflow}{return} bfloat16(::asinhf(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{537 \}}
\DoxyCodeLine{538 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 acosh(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{539   \textcolor{keywordflow}{return} bfloat16(::acoshf(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{540 \}}
\DoxyCodeLine{541 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 atanh(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{542   \textcolor{keywordflow}{return} bfloat16(::atanhf(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{543 \}}
\DoxyCodeLine{544 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{545 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 floor(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{546   \textcolor{keywordflow}{return} bfloat16(::floorf(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{547 \}}
\DoxyCodeLine{548 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 ceil(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{549   \textcolor{keywordflow}{return} bfloat16(::ceilf(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{550 \}}
\DoxyCodeLine{551 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 rint(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{552   \textcolor{keywordflow}{return} bfloat16(::rintf(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{553 \}}
\DoxyCodeLine{554 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 round(\textcolor{keyword}{const} bfloat16\& a) \{}
\DoxyCodeLine{555   \textcolor{keywordflow}{return} bfloat16(::roundf(\textcolor{keywordtype}{float}(a)));}
\DoxyCodeLine{556 \}}
\DoxyCodeLine{557 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 fmod(\textcolor{keyword}{const} bfloat16\& a, \textcolor{keyword}{const} bfloat16\& b) \{}
\DoxyCodeLine{558   \textcolor{keywordflow}{return} bfloat16(::fmodf(\textcolor{keywordtype}{float}(a), \textcolor{keywordtype}{float}(b)));}
\DoxyCodeLine{559 \}}
\DoxyCodeLine{560 }
\DoxyCodeLine{561 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 (min)(\textcolor{keyword}{const} bfloat16\& a, \textcolor{keyword}{const} bfloat16\& b) \{}
\DoxyCodeLine{562   \textcolor{keyword}{const} \textcolor{keywordtype}{float} f1 = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(a);}
\DoxyCodeLine{563   \textcolor{keyword}{const} \textcolor{keywordtype}{float} f2 = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(b);}
\DoxyCodeLine{564   \textcolor{keywordflow}{return} f2 < f1 ? b : a;}
\DoxyCodeLine{565 \}}
\DoxyCodeLine{566 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 (max)(\textcolor{keyword}{const} bfloat16\& a, \textcolor{keyword}{const} bfloat16\& b) \{}
\DoxyCodeLine{567   \textcolor{keyword}{const} \textcolor{keywordtype}{float} f1 = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(a);}
\DoxyCodeLine{568   \textcolor{keyword}{const} \textcolor{keywordtype}{float} f2 = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(b);}
\DoxyCodeLine{569   \textcolor{keywordflow}{return} f1 < f2 ? b : a;}
\DoxyCodeLine{570 \}}
\DoxyCodeLine{571 }
\DoxyCodeLine{572 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 fmin(\textcolor{keyword}{const} bfloat16\& a, \textcolor{keyword}{const} bfloat16\& b) \{}
\DoxyCodeLine{573   \textcolor{keyword}{const} \textcolor{keywordtype}{float} f1 = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(a);}
\DoxyCodeLine{574   \textcolor{keyword}{const} \textcolor{keywordtype}{float} f2 = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(b);}
\DoxyCodeLine{575   \textcolor{keywordflow}{return} bfloat16(::fminf(f1, f2));}
\DoxyCodeLine{576 \}}
\DoxyCodeLine{577 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC bfloat16 fmax(\textcolor{keyword}{const} bfloat16\& a, \textcolor{keyword}{const} bfloat16\& b) \{}
\DoxyCodeLine{578   \textcolor{keyword}{const} \textcolor{keywordtype}{float} f1 = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(a);}
\DoxyCodeLine{579   \textcolor{keyword}{const} \textcolor{keywordtype}{float} f2 = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(b);}
\DoxyCodeLine{580   \textcolor{keywordflow}{return} bfloat16(::fmaxf(f1, f2));}
\DoxyCodeLine{581 \}}
\DoxyCodeLine{582 }
\DoxyCodeLine{583 \textcolor{preprocessor}{\#ifndef EIGEN\_NO\_IO}}
\DoxyCodeLine{584 EIGEN\_ALWAYS\_INLINE std::ostream\& operator << (std::ostream\& os, \textcolor{keyword}{const} bfloat16\& v) \{}
\DoxyCodeLine{585   os << static\_cast<float>(v);}
\DoxyCodeLine{586   \textcolor{keywordflow}{return} os;}
\DoxyCodeLine{587 \}}
\DoxyCodeLine{588 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{589 }
\DoxyCodeLine{590 \} \textcolor{comment}{// namespace bfloat16\_impl}}
\DoxyCodeLine{591 }
\DoxyCodeLine{592 \textcolor{keyword}{namespace }internal \{}
\DoxyCodeLine{593 }
\DoxyCodeLine{594 \textcolor{keyword}{template}<>}
\DoxyCodeLine{595 \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1random__default__impl}{random\_default\_impl}}<\mbox{\hyperlink{structEigen_1_1bfloat16}{bfloat16}}, false, false>}
\DoxyCodeLine{596 \{}
\DoxyCodeLine{597   \textcolor{keyword}{static} \textcolor{keyword}{inline} \mbox{\hyperlink{structEigen_1_1bfloat16}{bfloat16}} run(\textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1bfloat16}{bfloat16}}\& x, \textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1bfloat16}{bfloat16}}\& y)}
\DoxyCodeLine{598   \{}
\DoxyCodeLine{599     \textcolor{keywordflow}{return} x + (y-\/x) * \mbox{\hyperlink{structEigen_1_1bfloat16}{bfloat16}}(\textcolor{keywordtype}{float}(std::rand()) / float(RAND\_MAX));}
\DoxyCodeLine{600   \}}
\DoxyCodeLine{601   \textcolor{keyword}{static} \textcolor{keyword}{inline} \mbox{\hyperlink{structEigen_1_1bfloat16}{bfloat16}} run()}
\DoxyCodeLine{602   \{}
\DoxyCodeLine{603     \textcolor{keywordflow}{return} run(\mbox{\hyperlink{structEigen_1_1bfloat16}{bfloat16}}(-\/1.f), \mbox{\hyperlink{structEigen_1_1bfloat16}{bfloat16}}(1.f));}
\DoxyCodeLine{604   \}}
\DoxyCodeLine{605 \};}
\DoxyCodeLine{606 }
\DoxyCodeLine{607 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1internal_1_1is__arithmetic}{is\_arithmetic}}<\mbox{\hyperlink{structEigen_1_1bfloat16}{bfloat16}}> \{ \textcolor{keyword}{enum} \{ value = \textcolor{keyword}{true} \}; \};}
\DoxyCodeLine{608 }
\DoxyCodeLine{609 \} \textcolor{comment}{// namespace internal}}
\DoxyCodeLine{610 }
\DoxyCodeLine{611 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\mbox{\hyperlink{structEigen_1_1NumTraits}{NumTraits}}<\mbox{\hyperlink{namespaceEigen}{Eigen}}::\mbox{\hyperlink{structEigen_1_1bfloat16}{bfloat16}}>}
\DoxyCodeLine{612     : \mbox{\hyperlink{structEigen_1_1GenericNumTraits}{GenericNumTraits}}<Eigen::bfloat16>}
\DoxyCodeLine{613 \{}
\DoxyCodeLine{614   \textcolor{keyword}{enum} \{}
\DoxyCodeLine{615     IsSigned = \textcolor{keyword}{true},}
\DoxyCodeLine{616     IsInteger = \textcolor{keyword}{false},}
\DoxyCodeLine{617     IsComplex = \textcolor{keyword}{false},}
\DoxyCodeLine{618     RequireInitialization = \textcolor{keyword}{false}}
\DoxyCodeLine{619   \};}
\DoxyCodeLine{620 }
\DoxyCodeLine{621   EIGEN\_DEVICE\_FUNC EIGEN\_CONSTEXPR \textcolor{keyword}{static} EIGEN\_STRONG\_INLINE \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}} epsilon() \{}
\DoxyCodeLine{622     \textcolor{keywordflow}{return} bfloat16\_impl::raw\_uint16\_to\_bfloat16(0x3c00);}
\DoxyCodeLine{623   \}}
\DoxyCodeLine{624   EIGEN\_DEVICE\_FUNC EIGEN\_CONSTEXPR \textcolor{keyword}{static} EIGEN\_STRONG\_INLINE \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}} dummy\_precision() \{}
\DoxyCodeLine{625     \textcolor{keywordflow}{return} bfloat16\_impl::raw\_uint16\_to\_bfloat16(0x3D4D);  \textcolor{comment}{// bfloat16(5e-\/2f);}}
\DoxyCodeLine{626 }
\DoxyCodeLine{627   \}}
\DoxyCodeLine{628   EIGEN\_DEVICE\_FUNC EIGEN\_CONSTEXPR \textcolor{keyword}{static} EIGEN\_STRONG\_INLINE \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}} highest() \{}
\DoxyCodeLine{629     \textcolor{keywordflow}{return} bfloat16\_impl::raw\_uint16\_to\_bfloat16(0x7F7F);}
\DoxyCodeLine{630   \}}
\DoxyCodeLine{631   EIGEN\_DEVICE\_FUNC EIGEN\_CONSTEXPR \textcolor{keyword}{static} EIGEN\_STRONG\_INLINE \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}} lowest() \{}
\DoxyCodeLine{632     \textcolor{keywordflow}{return} bfloat16\_impl::raw\_uint16\_to\_bfloat16(0xFF7F);}
\DoxyCodeLine{633   \}}
\DoxyCodeLine{634   EIGEN\_DEVICE\_FUNC EIGEN\_CONSTEXPR \textcolor{keyword}{static} EIGEN\_STRONG\_INLINE \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}} infinity() \{}
\DoxyCodeLine{635     \textcolor{keywordflow}{return} bfloat16\_impl::raw\_uint16\_to\_bfloat16(0x7f80);}
\DoxyCodeLine{636   \}}
\DoxyCodeLine{637   EIGEN\_DEVICE\_FUNC EIGEN\_CONSTEXPR \textcolor{keyword}{static} EIGEN\_STRONG\_INLINE \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}} quiet\_NaN() \{}
\DoxyCodeLine{638     \textcolor{keywordflow}{return} bfloat16\_impl::raw\_uint16\_to\_bfloat16(0x7fc0);}
\DoxyCodeLine{639   \}}
\DoxyCodeLine{640 \};}
\DoxyCodeLine{641 }
\DoxyCodeLine{642 \} \textcolor{comment}{// namespace Eigen}}
\DoxyCodeLine{643 }
\DoxyCodeLine{644 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceEigen}{Eigen}} \{}
\DoxyCodeLine{645 \textcolor{keyword}{namespace }numext \{}
\DoxyCodeLine{646 }
\DoxyCodeLine{647 \textcolor{keyword}{template}<>}
\DoxyCodeLine{648 EIGEN\_DEVICE\_FUNC EIGEN\_ALWAYS\_INLINE}
\DoxyCodeLine{649 bool (isnan)(\textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}}\& h) \{}
\DoxyCodeLine{650   \textcolor{keywordflow}{return} (bfloat16\_impl::isnan)(h);}
\DoxyCodeLine{651 \}}
\DoxyCodeLine{652 }
\DoxyCodeLine{653 \textcolor{keyword}{template}<>}
\DoxyCodeLine{654 EIGEN\_DEVICE\_FUNC EIGEN\_ALWAYS\_INLINE}
\DoxyCodeLine{655 bool (isinf)(\textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}}\& h) \{}
\DoxyCodeLine{656   \textcolor{keywordflow}{return} (bfloat16\_impl::isinf)(h);}
\DoxyCodeLine{657 \}}
\DoxyCodeLine{658 }
\DoxyCodeLine{659 \textcolor{keyword}{template}<>}
\DoxyCodeLine{660 EIGEN\_DEVICE\_FUNC EIGEN\_ALWAYS\_INLINE}
\DoxyCodeLine{661 bool (isfinite)(\textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}}\& h) \{}
\DoxyCodeLine{662   \textcolor{keywordflow}{return} (bfloat16\_impl::isfinite)(h);}
\DoxyCodeLine{663 \}}
\DoxyCodeLine{664 }
\DoxyCodeLine{665 \textcolor{keyword}{template} <>}
\DoxyCodeLine{666 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}} bit\_cast<Eigen::bfloat16, uint16\_t>(\textcolor{keyword}{const} uint16\_t\& src) \{}
\DoxyCodeLine{667   \textcolor{keywordflow}{return} \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}}(Eigen::bfloat16\_impl::raw\_uint16\_to\_bfloat16(src));}
\DoxyCodeLine{668 \}}
\DoxyCodeLine{669 }
\DoxyCodeLine{670 \textcolor{keyword}{template} <>}
\DoxyCodeLine{671 EIGEN\_STRONG\_INLINE EIGEN\_DEVICE\_FUNC uint16\_t bit\_cast<uint16\_t, Eigen::bfloat16>(\textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}}\& src) \{}
\DoxyCodeLine{672   \textcolor{keywordflow}{return} Eigen::bfloat16\_impl::raw\_bfloat16\_as\_uint16(src);}
\DoxyCodeLine{673 \}}
\DoxyCodeLine{674 }
\DoxyCodeLine{675 \}  \textcolor{comment}{// namespace numext}}
\DoxyCodeLine{676 \}  \textcolor{comment}{// namespace Eigen}}
\DoxyCodeLine{677 }
\DoxyCodeLine{678 \textcolor{preprocessor}{\#if EIGEN\_HAS\_STD\_HASH}}
\DoxyCodeLine{679 \textcolor{keyword}{namespace }std \{}
\DoxyCodeLine{680 \textcolor{keyword}{template} <>}
\DoxyCodeLine{681 \textcolor{keyword}{struct }hash<\mbox{\hyperlink{namespaceEigen}{Eigen}}::bfloat16> \{}
\DoxyCodeLine{682   EIGEN\_STRONG\_INLINE std::size\_t operator()(\textcolor{keyword}{const} \mbox{\hyperlink{structEigen_1_1bfloat16}{Eigen::bfloat16}}\& a)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{683     \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}std::size\_t\textcolor{keyword}{>}(Eigen::numext::bit\_cast<Eigen::numext::uint16\_t>(a));}
\DoxyCodeLine{684   \}}
\DoxyCodeLine{685 \};}
\DoxyCodeLine{686 \} \textcolor{comment}{// namespace std}}
\DoxyCodeLine{687 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{688 }
\DoxyCodeLine{689 }
\DoxyCodeLine{690 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// EIGEN\_BFLOAT16\_H}}

\end{DoxyCode}
