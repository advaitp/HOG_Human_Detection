\hypertarget{SparseLU__SupernodalMatrix_8h_source}{}\doxysection{Sparse\+LU\+\_\+\+Supernodal\+Matrix.\+h}
\label{SparseLU__SupernodalMatrix_8h_source}\index{include/Eigen/src/SparseLU/SparseLU\_SupernodalMatrix.h@{include/Eigen/src/SparseLU/SparseLU\_SupernodalMatrix.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}}
\DoxyCodeLine{2 \textcolor{comment}{// for linear algebra.}}
\DoxyCodeLine{3 \textcolor{comment}{//}}
\DoxyCodeLine{4 \textcolor{comment}{// Copyright (C) 2012 Désiré Nuentsa-\/Wakam <desire.nuentsa\_wakam@inria.fr>}}
\DoxyCodeLine{5 \textcolor{comment}{// Copyright (C) 2012 Gael Guennebaud <gael.guennebaud@inria.fr>}}
\DoxyCodeLine{6 \textcolor{comment}{//}}
\DoxyCodeLine{7 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}}
\DoxyCodeLine{8 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}}
\DoxyCodeLine{9 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{preprocessor}{\#ifndef EIGEN\_SPARSELU\_SUPERNODAL\_MATRIX\_H}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#define EIGEN\_SPARSELU\_SUPERNODAL\_MATRIX\_H}}
\DoxyCodeLine{13 }
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include "{}./InternalHeaderCheck.h"{}}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceEigen}{Eigen}} \{}
\DoxyCodeLine{17 \textcolor{keyword}{namespace }internal \{}
\DoxyCodeLine{18 }
\DoxyCodeLine{29 \textcolor{comment}{/* TODO}}
\DoxyCodeLine{30 \textcolor{comment}{ * InnerIterator as for sparsematrix }}
\DoxyCodeLine{31 \textcolor{comment}{ * SuperInnerIterator to iterate through all supernodes }}
\DoxyCodeLine{32 \textcolor{comment}{ * Function for triangular solve}}
\DoxyCodeLine{33 \textcolor{comment}{ */}}
\DoxyCodeLine{34 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Scalar\_, \textcolor{keyword}{typename} StorageIndex\_>}
\DoxyCodeLine{35 \textcolor{keyword}{class }\mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix}{MappedSuperNodalMatrix}}}
\DoxyCodeLine{36 \{}
\DoxyCodeLine{37   \textcolor{keyword}{public}:}
\DoxyCodeLine{38     \textcolor{keyword}{typedef} Scalar\_ Scalar;}
\DoxyCodeLine{39     \textcolor{keyword}{typedef} StorageIndex\_ StorageIndex;}
\DoxyCodeLine{40     \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix<StorageIndex,Dynamic,1>}} \mbox{\hyperlink{classEigen_1_1Matrix}{IndexVector}};}
\DoxyCodeLine{41     \textcolor{keyword}{typedef} \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix<Scalar,Dynamic,1>}} \mbox{\hyperlink{classEigen_1_1Matrix}{ScalarVector}};}
\DoxyCodeLine{42   \textcolor{keyword}{public}:}
\DoxyCodeLine{43     \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix}{MappedSuperNodalMatrix}}()}
\DoxyCodeLine{44     \{}
\DoxyCodeLine{45       }
\DoxyCodeLine{46     \}}
\DoxyCodeLine{47     \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix}{MappedSuperNodalMatrix}}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} m, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} n,  \mbox{\hyperlink{classEigen_1_1Matrix}{ScalarVector}}\& nzval, \mbox{\hyperlink{classEigen_1_1Matrix}{IndexVector}}\& nzval\_colptr, \mbox{\hyperlink{classEigen_1_1Matrix}{IndexVector}}\& rowind,}
\DoxyCodeLine{48              \mbox{\hyperlink{classEigen_1_1Matrix}{IndexVector}}\& rowind\_colptr, \mbox{\hyperlink{classEigen_1_1Matrix}{IndexVector}}\& col\_to\_sup, \mbox{\hyperlink{classEigen_1_1Matrix}{IndexVector}}\& sup\_to\_col )}
\DoxyCodeLine{49     \{}
\DoxyCodeLine{50       \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_a3c086eaa5cbc895b81f27b2b7563d382}{setInfos}}(m, n, nzval, nzval\_colptr, rowind, rowind\_colptr, col\_to\_sup, sup\_to\_col);}
\DoxyCodeLine{51     \}}
\DoxyCodeLine{52     }
\DoxyCodeLine{53     \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix}{\string~MappedSuperNodalMatrix}}()}
\DoxyCodeLine{54     \{}
\DoxyCodeLine{55       }
\DoxyCodeLine{56     \}}
\DoxyCodeLine{63     \textcolor{keywordtype}{void} \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_a3c086eaa5cbc895b81f27b2b7563d382}{setInfos}}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} m, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} n, \mbox{\hyperlink{classEigen_1_1Matrix}{ScalarVector}}\& nzval, \mbox{\hyperlink{classEigen_1_1Matrix}{IndexVector}}\& nzval\_colptr, \mbox{\hyperlink{classEigen_1_1Matrix}{IndexVector}}\& rowind,}
\DoxyCodeLine{64              \mbox{\hyperlink{classEigen_1_1Matrix}{IndexVector}}\& rowind\_colptr, \mbox{\hyperlink{classEigen_1_1Matrix}{IndexVector}}\& col\_to\_sup, \mbox{\hyperlink{classEigen_1_1Matrix}{IndexVector}}\& sup\_to\_col )}
\DoxyCodeLine{65     \{}
\DoxyCodeLine{66       m\_row = m;}
\DoxyCodeLine{67       m\_col = n; }
\DoxyCodeLine{68       m\_nzval = nzval.data(); }
\DoxyCodeLine{69       m\_nzval\_colptr = nzval\_colptr.data(); }
\DoxyCodeLine{70       m\_rowind = rowind.data(); }
\DoxyCodeLine{71       m\_rowind\_colptr = rowind\_colptr.data(); }
\DoxyCodeLine{72       m\_nsuper = col\_to\_sup(n); }
\DoxyCodeLine{73       m\_col\_to\_sup = col\_to\_sup.data(); }
\DoxyCodeLine{74       m\_sup\_to\_col = sup\_to\_col.data(); }
\DoxyCodeLine{75     \}}
\DoxyCodeLine{76     }
\DoxyCodeLine{80     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_aca75a69790b2874aac11d9afc96d22f6}{rows}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_row; \}}
\DoxyCodeLine{81     }
\DoxyCodeLine{85     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_af0c1fa2230a2b35f8599a666c1d14d53}{cols}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_col; \}}
\DoxyCodeLine{86     }
\DoxyCodeLine{92     Scalar* \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_af18a05edcfadc9e618025808f5af903c}{valuePtr}}() \{  \textcolor{keywordflow}{return} m\_nzval; \}}
\DoxyCodeLine{93     }
\DoxyCodeLine{94     \textcolor{keyword}{const} Scalar* \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_af18a05edcfadc9e618025808f5af903c}{valuePtr}}()\textcolor{keyword}{ const }}
\DoxyCodeLine{95 \textcolor{keyword}{    }\{}
\DoxyCodeLine{96       \textcolor{keywordflow}{return} m\_nzval; }
\DoxyCodeLine{97     \}}
\DoxyCodeLine{101     StorageIndex* \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_a82f01057ceaafd196ac9d0b83e58c097}{colIndexPtr}}()}
\DoxyCodeLine{102     \{}
\DoxyCodeLine{103       \textcolor{keywordflow}{return} m\_nzval\_colptr; }
\DoxyCodeLine{104     \}}
\DoxyCodeLine{105     }
\DoxyCodeLine{106     \textcolor{keyword}{const} StorageIndex* \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_a82f01057ceaafd196ac9d0b83e58c097}{colIndexPtr}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{107 \textcolor{keyword}{    }\{}
\DoxyCodeLine{108       \textcolor{keywordflow}{return} m\_nzval\_colptr; }
\DoxyCodeLine{109     \}}
\DoxyCodeLine{110     }
\DoxyCodeLine{114     StorageIndex* \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_a508c7c3276c012ddd503e11dc62cff27}{rowIndex}}()  \{ \textcolor{keywordflow}{return} m\_rowind; \}}
\DoxyCodeLine{115     }
\DoxyCodeLine{116     \textcolor{keyword}{const} StorageIndex* \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_a508c7c3276c012ddd503e11dc62cff27}{rowIndex}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{117 \textcolor{keyword}{    }\{}
\DoxyCodeLine{118       \textcolor{keywordflow}{return} m\_rowind; }
\DoxyCodeLine{119     \}}
\DoxyCodeLine{120     }
\DoxyCodeLine{124     StorageIndex* \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_a1a62a3b1a7344634e88b4a44b05b048b}{rowIndexPtr}}() \{ \textcolor{keywordflow}{return} m\_rowind\_colptr; \}}
\DoxyCodeLine{125     }
\DoxyCodeLine{126     \textcolor{keyword}{const} StorageIndex* \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_a1a62a3b1a7344634e88b4a44b05b048b}{rowIndexPtr}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{127 \textcolor{keyword}{    }\{}
\DoxyCodeLine{128       \textcolor{keywordflow}{return} m\_rowind\_colptr; }
\DoxyCodeLine{129     \}}
\DoxyCodeLine{130     }
\DoxyCodeLine{134     StorageIndex* \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_ae7582a1dc9c96a8c38cd11d71ef18129}{colToSup}}()  \{ \textcolor{keywordflow}{return} m\_col\_to\_sup; \}}
\DoxyCodeLine{135     }
\DoxyCodeLine{136     \textcolor{keyword}{const} StorageIndex* \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_ae7582a1dc9c96a8c38cd11d71ef18129}{colToSup}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{137 \textcolor{keyword}{    }\{}
\DoxyCodeLine{138       \textcolor{keywordflow}{return} m\_col\_to\_sup;       }
\DoxyCodeLine{139     \}}
\DoxyCodeLine{143     StorageIndex* \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_a883cfaf41a42dfe0372db1cffece4ee1}{supToCol}}() \{ \textcolor{keywordflow}{return} m\_sup\_to\_col; \}}
\DoxyCodeLine{144     }
\DoxyCodeLine{145     \textcolor{keyword}{const} StorageIndex* \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_a883cfaf41a42dfe0372db1cffece4ee1}{supToCol}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{146 \textcolor{keyword}{    }\{}
\DoxyCodeLine{147       \textcolor{keywordflow}{return} m\_sup\_to\_col;}
\DoxyCodeLine{148     \}}
\DoxyCodeLine{149     }
\DoxyCodeLine{153     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_a5b9d24437c4e75011e75321f0f59ea6b}{nsuper}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{154 \textcolor{keyword}{    }\{}
\DoxyCodeLine{155       \textcolor{keywordflow}{return} m\_nsuper; }
\DoxyCodeLine{156     \}}
\DoxyCodeLine{157     }
\DoxyCodeLine{158     \textcolor{keyword}{class }\mbox{\hyperlink{classEigen_1_1InnerIterator}{InnerIterator}}; }
\DoxyCodeLine{159     \textcolor{keyword}{template}<\textcolor{keyword}{typename} Dest>}
\DoxyCodeLine{160     \textcolor{keywordtype}{void} \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_ab93581127fd87b6bc467b6f67fcf4eeb}{solveInPlace}}( \mbox{\hyperlink{classEigen_1_1MatrixBase}{MatrixBase<Dest>}}\&X) \textcolor{keyword}{const};}
\DoxyCodeLine{161     \textcolor{keyword}{template}<\textcolor{keywordtype}{bool} Conjugate, \textcolor{keyword}{typename} Dest>}
\DoxyCodeLine{162     \textcolor{keywordtype}{void} solveTransposedInPlace( \mbox{\hyperlink{classEigen_1_1MatrixBase}{MatrixBase<Dest>}}\&X) \textcolor{keyword}{const};}
\DoxyCodeLine{163 }
\DoxyCodeLine{164     }
\DoxyCodeLine{165       }
\DoxyCodeLine{166       }
\DoxyCodeLine{167     }
\DoxyCodeLine{168   \textcolor{keyword}{protected}:}
\DoxyCodeLine{169     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} m\_row; \textcolor{comment}{// Number of rows}}
\DoxyCodeLine{170     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} m\_col; \textcolor{comment}{// Number of columns}}
\DoxyCodeLine{171     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} m\_nsuper; \textcolor{comment}{// Number of supernodes}}
\DoxyCodeLine{172     Scalar* m\_nzval; \textcolor{comment}{//array of nonzero values packed by column}}
\DoxyCodeLine{173     StorageIndex* m\_nzval\_colptr; \textcolor{comment}{//nzval\_colptr[j] Stores the location in nzval[] which starts column j}}
\DoxyCodeLine{174     StorageIndex* m\_rowind; \textcolor{comment}{// Array of compressed row indices of rectangular supernodes}}
\DoxyCodeLine{175     StorageIndex* m\_rowind\_colptr; \textcolor{comment}{//rowind\_colptr[j] stores the location in rowind[] which starts column j}}
\DoxyCodeLine{176     StorageIndex* m\_col\_to\_sup; \textcolor{comment}{// col\_to\_sup[j] is the supernode number to which column j belongs}}
\DoxyCodeLine{177     StorageIndex* m\_sup\_to\_col; \textcolor{comment}{//sup\_to\_col[s] points to the starting column of the s-\/th supernode}}
\DoxyCodeLine{178     }
\DoxyCodeLine{179   private :}
\DoxyCodeLine{180 \};}
\DoxyCodeLine{181 }
\DoxyCodeLine{186 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} StorageIndex>}
\DoxyCodeLine{187 \textcolor{keyword}{class }\mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix}{MappedSuperNodalMatrix}}<Scalar,StorageIndex>::\mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_1_1InnerIterator}{InnerIterator}}}
\DoxyCodeLine{188 \{}
\DoxyCodeLine{189   \textcolor{keyword}{public}:}
\DoxyCodeLine{190      \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_1_1InnerIterator}{InnerIterator}}(\textcolor{keyword}{const} \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix}{MappedSuperNodalMatrix}}\& mat, \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} outer)}
\DoxyCodeLine{191       : m\_matrix(mat),}
\DoxyCodeLine{192         m\_outer(outer),}
\DoxyCodeLine{193         m\_supno(mat.\mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_ae7582a1dc9c96a8c38cd11d71ef18129}{colToSup}}()[outer]),}
\DoxyCodeLine{194         m\_idval(mat.\mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_a82f01057ceaafd196ac9d0b83e58c097}{colIndexPtr}}()[outer]),}
\DoxyCodeLine{195         m\_startidval(m\_idval),}
\DoxyCodeLine{196         m\_endidval(mat.\mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_a82f01057ceaafd196ac9d0b83e58c097}{colIndexPtr}}()[outer+1]),}
\DoxyCodeLine{197         m\_idrow(mat.\mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_a1a62a3b1a7344634e88b4a44b05b048b}{rowIndexPtr}}()[mat.\mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_a883cfaf41a42dfe0372db1cffece4ee1}{supToCol}}()[mat.\mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_ae7582a1dc9c96a8c38cd11d71ef18129}{colToSup}}()[outer]]]),}
\DoxyCodeLine{198         m\_endidrow(mat.\mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_a1a62a3b1a7344634e88b4a44b05b048b}{rowIndexPtr}}()[mat.\mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_a883cfaf41a42dfe0372db1cffece4ee1}{supToCol}}()[mat.\mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_ae7582a1dc9c96a8c38cd11d71ef18129}{colToSup}}()[outer]]+1])}
\DoxyCodeLine{199     \{\}}
\DoxyCodeLine{200     \textcolor{keyword}{inline} \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_1_1InnerIterator}{InnerIterator}}\& operator++()}
\DoxyCodeLine{201     \{ }
\DoxyCodeLine{202       m\_idval++; }
\DoxyCodeLine{203       m\_idrow++;}
\DoxyCodeLine{204       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{205     \}}
\DoxyCodeLine{206     \textcolor{keyword}{inline} Scalar value()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_matrix.valuePtr()[m\_idval]; \}}
\DoxyCodeLine{207     }
\DoxyCodeLine{208     \textcolor{keyword}{inline} Scalar\& valueRef() \{ \textcolor{keywordflow}{return} \textcolor{keyword}{const\_cast<}Scalar\&\textcolor{keyword}{>}(m\_matrix.valuePtr()[m\_idval]); \}}
\DoxyCodeLine{209     }
\DoxyCodeLine{210     \textcolor{keyword}{inline} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} index()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_matrix.rowIndex()[m\_idrow]; \}}
\DoxyCodeLine{211     \textcolor{keyword}{inline} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} row()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} index(); \}}
\DoxyCodeLine{212     \textcolor{keyword}{inline} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} col()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_outer; \}}
\DoxyCodeLine{213     }
\DoxyCodeLine{214     \textcolor{keyword}{inline} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} supIndex()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_supno; \}}
\DoxyCodeLine{215     }
\DoxyCodeLine{216     \textcolor{keyword}{inline} \textcolor{keyword}{operator} bool()\textcolor{keyword}{ const }}
\DoxyCodeLine{217 \textcolor{keyword}{    }\{ }
\DoxyCodeLine{218       \textcolor{keywordflow}{return} ( (m\_idval < m\_endidval) \&\& (m\_idval >= m\_startidval)}
\DoxyCodeLine{219                 \&\& (m\_idrow < m\_endidrow) );}
\DoxyCodeLine{220     \}}
\DoxyCodeLine{221     }
\DoxyCodeLine{222   \textcolor{keyword}{protected}:}
\DoxyCodeLine{223     \textcolor{keyword}{const} \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix}{MappedSuperNodalMatrix}}\& m\_matrix; \textcolor{comment}{// Supernodal lower triangular matrix }}
\DoxyCodeLine{224     \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} m\_outer;                    \textcolor{comment}{// Current column }}
\DoxyCodeLine{225     \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} m\_supno;                    \textcolor{comment}{// Current SuperNode number}}
\DoxyCodeLine{226     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} m\_idval;                          \textcolor{comment}{// Index to browse the values in the current column}}
\DoxyCodeLine{227     \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} m\_startidval;               \textcolor{comment}{// Start of the column value}}
\DoxyCodeLine{228     \textcolor{keyword}{const} \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} m\_endidval;                 \textcolor{comment}{// End of the column value}}
\DoxyCodeLine{229     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} m\_idrow;                          \textcolor{comment}{// Index to browse the row indices }}
\DoxyCodeLine{230     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} m\_endidrow;                       \textcolor{comment}{// End index of row indices of the current column}}
\DoxyCodeLine{231 \};}
\DoxyCodeLine{232 }
\DoxyCodeLine{237 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} Index\_>}
\DoxyCodeLine{238 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Dest>}
\DoxyCodeLine{239 \textcolor{keywordtype}{void} \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_ab93581127fd87b6bc467b6f67fcf4eeb}{MappedSuperNodalMatrix<Scalar,Index\_>::solveInPlace}}( \mbox{\hyperlink{classEigen_1_1MatrixBase}{MatrixBase<Dest>}}\&X)\textcolor{keyword}{ const}}
\DoxyCodeLine{240 \textcolor{keyword}{}\{}
\DoxyCodeLine{241     \textcolor{comment}{/* Explicit type conversion as the Index type of MatrixBase<Dest> may be wider than Index */}}
\DoxyCodeLine{242 \textcolor{comment}{//    eigen\_assert(X.rows() <= NumTraits<Index>::highest());}}
\DoxyCodeLine{243 \textcolor{comment}{//    eigen\_assert(X.cols() <= NumTraits<Index>::highest());}}
\DoxyCodeLine{244     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} n    = int(X.rows());}
\DoxyCodeLine{245     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} nrhs = \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}(X.cols());}
\DoxyCodeLine{246     \textcolor{keyword}{const} Scalar * Lval = valuePtr();                 \textcolor{comment}{// Nonzero values }}
\DoxyCodeLine{247     \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix<Scalar,Dynamic,Dest::ColsAtCompileTime, ColMajor>}} work(n, nrhs);     \textcolor{comment}{// working vector}}
\DoxyCodeLine{248     work.\mbox{\hyperlink{classEigen_1_1PlainObjectBase_ac21ad5f989f320e46958b75ac8d9a1da}{setZero}}();}
\DoxyCodeLine{249     \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k = 0; k <= nsuper(); k ++)}
\DoxyCodeLine{250     \{}
\DoxyCodeLine{251       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} fsupc = supToCol()[k];                    \textcolor{comment}{// First column of the current supernode }}
\DoxyCodeLine{252       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} istart = rowIndexPtr()[fsupc];            \textcolor{comment}{// Pointer index to the subscript of the current column}}
\DoxyCodeLine{253       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} nsupr = rowIndexPtr()[fsupc+1] -\/ istart;  \textcolor{comment}{// Number of rows in the current supernode}}
\DoxyCodeLine{254       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} nsupc = supToCol()[k+1] -\/ fsupc;          \textcolor{comment}{// Number of columns in the current supernode}}
\DoxyCodeLine{255       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} nrow = nsupr -\/ nsupc;                     \textcolor{comment}{// Number of rows in the non-\/diagonal part of the supernode}}
\DoxyCodeLine{256       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} irow;                                     \textcolor{comment}{//Current index row}}
\DoxyCodeLine{257       }
\DoxyCodeLine{258       \textcolor{keywordflow}{if} (nsupc == 1 )}
\DoxyCodeLine{259       \{}
\DoxyCodeLine{260         \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j = 0; j < nrhs; j++)}
\DoxyCodeLine{261         \{}
\DoxyCodeLine{262           \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix_1_1InnerIterator}{InnerIterator}} it(*\textcolor{keyword}{this}, fsupc);}
\DoxyCodeLine{263           ++it; \textcolor{comment}{// Skip the diagonal element}}
\DoxyCodeLine{264           \textcolor{keywordflow}{for} (; it; ++it)}
\DoxyCodeLine{265           \{}
\DoxyCodeLine{266             irow = it.row();}
\DoxyCodeLine{267             X(irow, j) -\/= X(fsupc, j) * it.value();}
\DoxyCodeLine{268           \}}
\DoxyCodeLine{269         \}}
\DoxyCodeLine{270       \}}
\DoxyCodeLine{271       \textcolor{keywordflow}{else}}
\DoxyCodeLine{272       \{}
\DoxyCodeLine{273         \textcolor{comment}{// The supernode has more than one column }}
\DoxyCodeLine{274         \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} luptr = colIndexPtr()[fsupc]; }
\DoxyCodeLine{275         \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} lda = colIndexPtr()[fsupc+1] -\/ luptr;}
\DoxyCodeLine{276         }
\DoxyCodeLine{277         \textcolor{comment}{// Triangular solve }}
\DoxyCodeLine{278         \mbox{\hyperlink{classEigen_1_1Map}{Map<const Matrix<Scalar,Dynamic,Dynamic, ColMajor>}}, 0, \mbox{\hyperlink{classEigen_1_1OuterStride}{OuterStride<>}} > A( \&(Lval[luptr]), nsupc, nsupc, \mbox{\hyperlink{classEigen_1_1OuterStride}{OuterStride<>}}(lda) );}
\DoxyCodeLine{279         \mbox{\hyperlink{classEigen_1_1Map}{Map< Matrix<Scalar,Dynamic,Dest::ColsAtCompileTime, ColMajor>}}, 0, \mbox{\hyperlink{classEigen_1_1OuterStride}{OuterStride<>}} > U (\&(X(fsupc,0)), nsupc, nrhs, \mbox{\hyperlink{classEigen_1_1OuterStride}{OuterStride<>}}(n) );}
\DoxyCodeLine{280         U = A.template triangularView<UnitLower>().solve(U); }
\DoxyCodeLine{281         }
\DoxyCodeLine{282         \textcolor{comment}{// Matrix-\/vector product }}
\DoxyCodeLine{283         \textcolor{keyword}{new} (\&A) \mbox{\hyperlink{classEigen_1_1Map}{Map}}<\textcolor{keyword}{const} \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix<Scalar,Dynamic,Dynamic, ColMajor>}}, 0, \mbox{\hyperlink{classEigen_1_1OuterStride}{OuterStride<>}} > ( \&(Lval[luptr+nsupc]), nrow, nsupc, \mbox{\hyperlink{classEigen_1_1OuterStride}{OuterStride<>}}(lda) );}
\DoxyCodeLine{284         work.topRows(nrow).noalias() = A * U;}
\DoxyCodeLine{285         }
\DoxyCodeLine{286         \textcolor{comment}{//Begin Scatter }}
\DoxyCodeLine{287         \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j = 0; j < nrhs; j++)}
\DoxyCodeLine{288         \{}
\DoxyCodeLine{289           \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} iptr = istart + nsupc; }
\DoxyCodeLine{290           \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} i = 0; i < nrow; i++)}
\DoxyCodeLine{291           \{}
\DoxyCodeLine{292             irow = rowIndex()[iptr]; }
\DoxyCodeLine{293             X(irow, j) -\/= work(i, j); \textcolor{comment}{// Scatter operation}}
\DoxyCodeLine{294             work(i, j) = Scalar(0); }
\DoxyCodeLine{295             iptr++;}
\DoxyCodeLine{296           \}}
\DoxyCodeLine{297         \}}
\DoxyCodeLine{298       \}}
\DoxyCodeLine{299     \} }
\DoxyCodeLine{300 \}}
\DoxyCodeLine{301 }
\DoxyCodeLine{302 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} Index\_>}
\DoxyCodeLine{303 \textcolor{keyword}{template}<\textcolor{keywordtype}{bool} Conjugate, \textcolor{keyword}{typename} Dest>}
\DoxyCodeLine{304 \textcolor{keywordtype}{void} \mbox{\hyperlink{classEigen_1_1internal_1_1MappedSuperNodalMatrix}{MappedSuperNodalMatrix<Scalar,Index\_>::solveTransposedInPlace}}( \mbox{\hyperlink{classEigen_1_1MatrixBase}{MatrixBase<Dest>}}\&X)\textcolor{keyword}{ const}}
\DoxyCodeLine{305 \textcolor{keyword}{}\{}
\DoxyCodeLine{306     \textcolor{keyword}{using} numext::conj;}
\DoxyCodeLine{307   \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} n    = int(X.rows());}
\DoxyCodeLine{308   \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} nrhs = \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}(X.cols());}
\DoxyCodeLine{309   \textcolor{keyword}{const} Scalar * Lval = valuePtr();                 \textcolor{comment}{// Nonzero values}}
\DoxyCodeLine{310   \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix<Scalar,Dynamic,Dest::ColsAtCompileTime, ColMajor>}} work(n, nrhs);     \textcolor{comment}{// working vector}}
\DoxyCodeLine{311   work.setZero();}
\DoxyCodeLine{312   \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} k = nsuper(); k >= 0; k-\/-\/)}
\DoxyCodeLine{313   \{}
\DoxyCodeLine{314     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} fsupc = supToCol()[k];                    \textcolor{comment}{// First column of the current supernode}}
\DoxyCodeLine{315     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} istart = rowIndexPtr()[fsupc];            \textcolor{comment}{// Pointer index to the subscript of the current column}}
\DoxyCodeLine{316     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} nsupr = rowIndexPtr()[fsupc+1] -\/ istart;  \textcolor{comment}{// Number of rows in the current supernode}}
\DoxyCodeLine{317     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} nsupc = supToCol()[k+1] -\/ fsupc;          \textcolor{comment}{// Number of columns in the current supernode}}
\DoxyCodeLine{318     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} nrow = nsupr -\/ nsupc;                     \textcolor{comment}{// Number of rows in the non-\/diagonal part of the supernode}}
\DoxyCodeLine{319     \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} irow;                                     \textcolor{comment}{//Current index row}}
\DoxyCodeLine{320 }
\DoxyCodeLine{321     \textcolor{keywordflow}{if} (nsupc == 1 )}
\DoxyCodeLine{322     \{}
\DoxyCodeLine{323       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j = 0; j < nrhs; j++)}
\DoxyCodeLine{324       \{}
\DoxyCodeLine{325         \mbox{\hyperlink{classEigen_1_1InnerIterator}{InnerIterator}} it(*\textcolor{keyword}{this}, fsupc);}
\DoxyCodeLine{326         ++it; \textcolor{comment}{// Skip the diagonal element}}
\DoxyCodeLine{327         \textcolor{keywordflow}{for} (; it; ++it)}
\DoxyCodeLine{328         \{}
\DoxyCodeLine{329           irow = it.row();}
\DoxyCodeLine{330           X(fsupc,j) -\/= X(irow, j) * (\mbox{\hyperlink{classEigen_1_1Conjugate}{Conjugate}}?conj(it.value()):it.value());}
\DoxyCodeLine{331         \}}
\DoxyCodeLine{332       \}}
\DoxyCodeLine{333     \}}
\DoxyCodeLine{334     \textcolor{keywordflow}{else}}
\DoxyCodeLine{335     \{}
\DoxyCodeLine{336       \textcolor{comment}{// The supernode has more than one column}}
\DoxyCodeLine{337       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} luptr = colIndexPtr()[fsupc];}
\DoxyCodeLine{338       \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} lda = colIndexPtr()[fsupc+1] -\/ luptr;}
\DoxyCodeLine{339 }
\DoxyCodeLine{340       \textcolor{comment}{//Begin Gather}}
\DoxyCodeLine{341       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} j = 0; j < nrhs; j++)}
\DoxyCodeLine{342       \{}
\DoxyCodeLine{343         \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} iptr = istart + nsupc;}
\DoxyCodeLine{344         \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}} i = 0; i < nrow; i++)}
\DoxyCodeLine{345         \{}
\DoxyCodeLine{346           irow = rowIndex()[iptr];}
\DoxyCodeLine{347           work.topRows(nrow)(i,j)= X(irow,j); \textcolor{comment}{// Gather operation}}
\DoxyCodeLine{348           iptr++;}
\DoxyCodeLine{349         \}}
\DoxyCodeLine{350       \}}
\DoxyCodeLine{351 }
\DoxyCodeLine{352       \textcolor{comment}{// Matrix-\/vector product with transposed submatrix}}
\DoxyCodeLine{353       Map<const Matrix<Scalar,Dynamic,Dynamic, ColMajor>, 0, OuterStride<> > A( \&(Lval[luptr+nsupc]), nrow, nsupc, OuterStride<>(lda) );}
\DoxyCodeLine{354       Map< Matrix<Scalar,Dynamic,Dest::ColsAtCompileTime, ColMajor>, 0, OuterStride<> > U (\&(X(fsupc,0)), nsupc, nrhs, OuterStride<>(n) );}
\DoxyCodeLine{355       \textcolor{keywordflow}{if}(Conjugate)}
\DoxyCodeLine{356         U = U -\/ A.adjoint() * work.topRows(nrow);}
\DoxyCodeLine{357       \textcolor{keywordflow}{else}}
\DoxyCodeLine{358         U = U -\/ A.transpose() * work.topRows(nrow);}
\DoxyCodeLine{359 }
\DoxyCodeLine{360       \textcolor{comment}{// Triangular solve (of transposed diagonal block)}}
\DoxyCodeLine{361       \textcolor{keyword}{new} (\&A) Map<\textcolor{keyword}{const} Matrix<Scalar,Dynamic,Dynamic, ColMajor>, 0, OuterStride<> > ( \&(Lval[luptr]), nsupc, nsupc, OuterStride<>(lda) );}
\DoxyCodeLine{362       \textcolor{keywordflow}{if}(Conjugate)}
\DoxyCodeLine{363         U = A.adjoint().template triangularView<UnitUpper>().solve(U);}
\DoxyCodeLine{364       \textcolor{keywordflow}{else}}
\DoxyCodeLine{365         U = A.transpose().template triangularView<UnitUpper>().solve(U);}
\DoxyCodeLine{366 }
\DoxyCodeLine{367     \}}
\DoxyCodeLine{368 }
\DoxyCodeLine{369   \}}
\DoxyCodeLine{370 \}}
\DoxyCodeLine{371 }
\DoxyCodeLine{372 }
\DoxyCodeLine{373 \} \textcolor{comment}{// end namespace internal}}
\DoxyCodeLine{374 }
\DoxyCodeLine{375 \} \textcolor{comment}{// end namespace Eigen}}
\DoxyCodeLine{376 }
\DoxyCodeLine{377 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// EIGEN\_SPARSELU\_MATRIX\_H}}

\end{DoxyCode}
